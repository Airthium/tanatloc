"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1938],{61938:function(e,t,a){a.r(t),a.d(t,{_exportCSV:function(){return D},default:function(){return I},errors:function(){return z}});var l=a(14288),n=a(67294),o=a(26713),i=a(32808),r=a(97183),c=a(83062),d=a(71577),s=a(85265),u=a(71648),h=a(2997),m=a(56299),f=a(56880),p=a(9253),b=a(10400),x=a(14195),k=a(3023),v=a(75358),y=a(14888),Z=a(19264),C=a(96486),g=a(12271),S=a(64376),w=a(23853),E=a(86159),M=a(70917);let B={data:(0,M.iv)({position:"absolute",zIndex:100,right:50,bottom:25,backgroundColor:"rgba(255, 255, 255, 0)"}),button:(0,M.iv)({width:"40px !important",height:"40px",border:"1px solid #5E14FA",borderRadius:20,marginBottom:-20}),container:(0,M.iv)({display:"flex",height:"100%",padding:"10px",justifyContent:"space-between"}),tableContainer:(0,M.iv)({display:"flex",height:"100%",width:"49%",overflow:"auto","& .column":{".ant-checkbox":{display:"none"}},".selected":{backgroundColor:E.Rl.colorPrimary+"55",svg:{color:E.Rl.colorPrimary}}})},z={download:"Unable to download CSV"},D=function(e,t,a,l){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:";",o="";o="x"+n+a.join(n)+"\n",t.forEach(e=>{o+=e.x,null==l||l.forEach(t=>{void 0!==e[t]&&(o+=n+e[t])}),o+="\n"});let i=e.name+".csv",r=new File([o],i,{type:"text/csv"}),c=window.URL.createObjectURL(r),d=document.createElement("a");d.href=c,d.setAttribute("download",i),d.click(),d.remove()},R=e=>{let{name:t,index:a,columnSelection:r,setColumnSelection:c}=e,d=(0,n.useCallback)(e=>{let t=e.target.checked,l=[...r];l[a]=t,c(l)},[a,r,c]);return(0,l.BX)(o.Z,{children:[t,(0,l.tZ)(i.Z,{"data-testid":"table-checkbox",checked:r[a],onChange:d,children:(0,l.tZ)(m.Z,{style:{fontSize:20}})})]})},_=e=>{let{simulation:t}=e,[a,o]=(0,n.useState)(!1),[i,E]=(0,n.useState)(),[M,_]=(0,n.useState)(),[I,N]=(0,n.useState)(),[X,j]=(0,n.useState)(),[F,K]=(0,n.useState)(),[P,U]=(0,n.useState)([!0]),[V,A]=(0,n.useState)(),[L,q]=(0,n.useState)(!1),[G]=w.Z.useSimulation(null==t?void 0:t.id);(0,n.useEffect)(()=>{let e=null==G?void 0:G.tasks;if(!e){E(void 0),N(void 0),j(void 0);return}let t=e.map(e=>e.datas).filter(e=>e).flatMap(e=>e);if(!t.length||!t[0].names){N(void 0),j(void 0);return}t.sort((e,t)=>e.x-t.x);let a=t[0].title,l=t.map(e=>e.names).flatMap(e=>e).filter((e,t,a)=>a.findIndex(t=>t===e)===t),n=l.map(e=>(0,C.camelCase)(e)),o=[];t.forEach((e,t)=>{e.names.forEach((a,l)=>{let n=o.find(t=>t.x===e.x);n?n[(0,C.camelCase)(a)]=e.ys[l]:o.push({key:t,x:e.x,[(0,C.camelCase)(a)]:e.ys[l]})})}),_(a),E(o),N(l),j(n)},[G]),(0,n.useEffect)(()=>{if(!i||!I||!X){K(void 0);return}let e=I.map((e,t)=>({align:"center",className:"column"+(P[t]?" selected":""),title:(0,l.tZ)(R,{name:e,index:t,columnSelection:P,setColumnSelection:U}),dataIndex:X[t],key:X[t]}));e.unshift({title:M,dataIndex:"x",key:"x",fixed:"left"}),K(e)},[M,i,I,X,P]),(0,n.useEffect)(()=>{if(!i||!I||!X){A(void 0);return}let e=[],t=S.Z.colorGenerator(P.length),a=P.map((a,n)=>{if(!a)return;let o=X[n],i=I[n],r=t[n];return e.push(o),(0,l.tZ)(f.x,{name:i,type:"monotone",dataKey:o,stroke:r,strokeWidth:2},o)}).filter(e=>e),n=i.map(t=>{let a={x:t.x};return e.forEach(e=>{t[e]&&(a[e]=t[e])}),a}).filter(e=>e),o=Math.min(...e.flatMap(e=>n.map(t=>t[e]))),r=Math.max(...e.flatMap(e=>n.map(t=>t[e]))),c=r-o;A({data:n,min:o,max:r,domainMin:o-.1*c,domainMax:r+.1*c,lines:a})},[i,I,X,P]);let O=(0,n.useCallback)(()=>o(!0),[]),W=(0,n.useCallback)(()=>o(!1),[]),H=(0,n.useCallback)(()=>{q(!0);try{D(t,i,I,X,"	")}catch(e){(0,g.lt)(z.download,e)}finally{q(!1)}},[t,i,I,X]),J=(0,n.useCallback)(()=>{q(!0);try{D(t,i,I,X,",")}catch(e){(0,g.lt)(z.download,e)}finally{q(!1)}},[t,i,I,X]),Q=(0,n.useCallback)(()=>{q(!0);try{D(t,i,I,X)}catch(e){(0,g.lt)(z.download,e)}finally{q(!1)}},[t,i,I,X]),T=(0,n.useCallback)(e=>Number(e).toExponential(3),[]);return t&&i&&I&&X?(0,l.tZ)(r.Z,{css:B.data,children:(0,l.BX)(r.Z.Content,{children:[(0,l.tZ)(c.Z,{title:"Data visualization",children:(0,l.tZ)(d.ZP,{type:"primary",icon:(0,l.tZ)(m.Z,{}),onClick:O,css:B.button})}),(0,l.tZ)(s.Z,{title:"Data visualization",placement:"bottom",closable:!0,onClose:W,open:a,mask:!1,maskClosable:!1,height:"50vh",bodyStyle:{height:"100%",overflow:"hidden"},extra:(0,l.tZ)(u.Z.Button,{loading:L,disabled:!i,menu:{items:[{label:"Default separator: semicolon",key:"semicolon",disabled:!0},{label:"Separator: tab",key:"tab",onClick:H},{label:"Separator: comma",key:",",onClick:J}]},onClick:Q,children:"Export CSV"}),children:(0,l.BX)("div",{css:B.container,children:[(0,l.tZ)("div",{css:B.tableContainer,children:(0,l.tZ)(h.Z,{size:"small",sticky:!0,pagination:!1,dataSource:i,columns:F,scroll:{x:"calc(60vw)"}})}),(0,l.tZ)(p.h,{width:"49%",height:"100%",children:(0,l.BX)(b.w,{data:null==V?void 0:V.data,margin:{top:0,right:40,left:40,bottom:0},children:[(0,l.tZ)(x.q,{strokeDasharray:"3 3"}),(0,l.tZ)(k.K,{dataKey:"x"}),(0,l.tZ)(v.B,{domain:V?[V.domainMin,V.domainMax]:[-1,1],tickFormatter:T}),(0,l.tZ)(y.u,{}),(0,l.tZ)(Z.D,{}),null==V?void 0:V.lines]})})]})})]})}):null};var I=_}}]);