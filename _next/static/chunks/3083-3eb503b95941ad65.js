(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3083],{9819:function(e,l,t){"use strict";t.d(l,{E:function(){return i},j:function(){return a}});let a=[{label:"Density",symbol:"Rho",units:[{label:"\\(kg.m^{-3}\\)"}],unit:{label:"\\(kg.m^{-3}\\)"}},{label:"Young's modulus",symbol:"E",units:[{label:"\\(Pa\\)"}],unit:{label:"\\(Pa\\)"}},{label:"Poisson's ratio",symbol:"Nu"},{label:"Thermal conductivity",symbol:"Lambda",units:[{label:"\\(W.m^{-1}.K^{-1}\\)"}],unit:{label:"\\(W.m^{-1}.K^{-1}\\)"}},{label:"Heat capacity",symbol:"Cp",units:[{label:"\\(J.K^{-1}.kg^{-1}\\)"}],unit:{label:"\\(J.K^{-1}.kg^{-1}\\)"}},{label:"Dynamic viscosity",symbol:"Mu",units:[{label:"\\(Pa.s\\)"}],unit:{label:"\\(Pa.s\\)"}}],i={metal:{label:"Metal",children:[{key:"steel",label:"Generic Steel",children:[{label:"Density",symbol:"Rho",value:"7850"},{label:"Young's modulus",symbol:"E",value:"2.1e11"},{label:"Poisson's ratio",symbol:"Nu",value:"0.3"},{label:"Thermal conductivity",symbol:"Lambda",value:"15"},{label:"Heat capacity",symbol:"Cp",value:"502"}]},{key:"S235JR+AR",label:"Steel (S235JR+AR)",children:[{label:"Density",symbol:"Rho",value:"7850"},{label:"Young's modulus",symbol:"E",value:"2.1e11"},{label:"Poisson's ratio",symbol:"Nu",value:"0.27"},{label:"Thermal conductivity",symbol:"Lambda",value:"15"},{label:"Heat capacity",symbol:"Cp",value:"502"}]},{key:"304",label:"Stainless Steel 304",children:[{label:"Density",symbol:"Rho",value:"8000"},{label:"Young's modulus",symbol:"E",value:"193e9"},{label:"Poisson's ratio",symbol:"Nu",value:"0.29"},{label:"Thermal conductivity",symbol:"Lambda",value:"16.2"},{label:"Heat capacity",symbol:"Cp",value:"500"},{label:"Yield strength",symbol:"SigmaY",value:"215e6"}]},{key:"316L",label:"Stainless Steel 316L",children:[{label:"Density",symbol:"Rho",value:"7990"},{label:"Young's modulus",symbol:"E",value:"193e9"},{label:"Poisson's ratio",symbol:"Nu",value:"0.25"},{label:"Thermal conductivity",symbol:"Lambda",value:"16.2"},{label:"Heat capacity",symbol:"Cp",value:"500"},{label:"Yield strength",symbol:"SigmaY",value:"290e6"}]},{key:"6082-O",label:"Aluminium 6082-O",children:[{label:"Density",symbol:"Rho",value:"2700"},{label:"Young's modulus",symbol:"E",value:"69e9"},{label:"Poisson's ratio",symbol:"Nu",value:"0.33"},{label:"Thermal conductivity",symbol:"Lambda",value:"170"},{label:"Heat capacity",symbol:"Cp",value:"960"},{label:"Yield strength",symbol:"SigmaY",value:"60e6"}]},{key:"7075-O",label:"Aluminium 7075-O",children:[{label:"Density",symbol:"Rho",value:"2810"},{label:"Young's modulus",symbol:"E",value:"71.7e9"},{label:"Poisson's ratio",symbol:"Nu",value:"0.33"},{label:"Thermal conductivity",symbol:"Lambda",value:"173"},{label:"Heat capacity",symbol:"Cp",value:"960"},{label:"Yield strength",symbol:"SigmaY",value:"110e6"}]},{key:"2017A",label:"Aluminium 2017A",children:[{label:"Density",symbol:"Rho",value:"2790"},{label:"Young's modulus",symbol:"E",value:"72.5e9"},{label:"Poisson's ratio",symbol:"Nu",value:"0.33"},{label:"Thermal conductivity",symbol:"Lambda",value:"134"},{label:"Heat capacity",symbol:"Cp",value:"873"},{label:"Yield strength",symbol:"SigmaY",value:"275e6"}]}]},polymer:{label:"Polymer",children:[{key:"PMMA",label:"PMMA",children:[{label:"Density",symbol:"Rho",value:"1180"},{label:"Young's modulus",symbol:"E",value:"2.9e9"},{label:"Poisson's ratio",symbol:"Nu",value:"0.36"},{label:"Thermal conductivity",symbol:"Lambda",value:"0.193"},{label:"Heat capacity",symbol:"Cp",value:"1480"},{label:"Yield strength",symbol:"SigmaY",value:"69e6"}]}]},fluid:{label:"Fluid",children:[{key:"water",label:"Water",children:[{label:"Density",symbol:"Rho",value:"1e3"},{label:"Dynamic viscosity",symbol:"Mu",value:"1e-3"},{label:"Thermal conductivity",symbol:"Lambda",value:"0.6"},{label:"Heat capacity",symbol:"Cp",value:"4185"}]}]},contact:{label:"Contact",children:[{key:"fundation",label:"Fundation",children:[]}]}}},85615:function(e,l,t){"use strict";t.d(l,{Z:function(){return i}});var a=t(948);let load=async(e,l)=>{let t=await (0,a.R)("/api/result",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({simulation:e,result:l})});return t.json()},download=async(e,l)=>(0,a.R)("/api/result/download",{method:"POST",body:JSON.stringify({simulation:e,result:l})}),archive=async e=>(0,a.R)("/api/result/archive",{method:"POST",body:JSON.stringify({simulation:e})});var i={load:load,download:download,archive:archive}},43083:function(e,l,t){"use strict";t.d(l,{ZP:function(){return e6}});var a=t(85893),i=t(67294),n=t(16373),s=t(12386),o=t(56697),u=t(64749),r=t(20838),d=t(94055),c=t(53740),m=t(60052),h=t(68245),v=t(82492),y=t.n(v),p=t(8061),f=t(54509),b=t(95590),g=t(8418),x=t(88053),j=t(28456),C=t(97221),k=t(81229),Z=t(70459),w=t(4863),S=t(70302),_=t(74048),E=t(89552),N=t(65400),T=t.n(N),M=t(52655),O=t(35304),P=t.n(O);let L={copy:"Unable to copy simulation"},_onCopy=async(e,l,t,a)=>{try{let a=await k.Z.copy(l);await t.addOneSimulation(a),await t.mutateProject({id:e.id,simulations:[...e.simulations,a.id]})}catch(e){a((0,f.iT)({title:L.copy,err:e}))}};var copy=e=>{let{project:l,simulation:t,swr:n}=e,[s,o]=(0,i.useState)(!1),{dispatch:u}=(0,i.useContext)(p.uj),r=(0,i.useCallback)(()=>{(async()=>{o(!0);try{await _onCopy(l,t,n,u)}finally{o(!1)}})()},[l,t,n,u]);return(0,a.jsx)(d.default,{title:"Copy simulation",children:(0,a.jsx)(T(),{className:P().noBorder,loading:s,icon:(0,a.jsx)(M.default,{}),onClick:r})})},I=t(97538),A=t(51024),R=t(51274);let U={update:"Unable to update simulation"},_onEdit=async(e,l,t,a)=>{try{await k.Z.update({id:e.id},[{key:"name",value:l.name}]),await t.mutateOneSimulation({id:e.id,name:l.name})}catch(e){throw a((0,f.iT)({title:U.update,err:e})),e}};var edit=e=>{let{simulation:l,swr:t}=e,n=(0,i.useRef)(null),[s,o]=(0,i.useState)(!1),[u,r]=(0,i.useState)(!1),{dispatch:d}=(0,i.useContext)(p.uj);(0,i.useEffect)(()=>{n.current&&n.current.focus()});let c=(0,i.useCallback)(async e=>{r(!0);try{await _onEdit(l,e,t,d),r(!1),o(!1)}catch(e){throw r(!1),e}},[l,t,d]),m=(0,i.useCallback)(()=>o(!0),[]),h=(0,i.useCallback)(()=>o(!1),[]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.w6,{onEdit:m}),(0,a.jsx)(R.ZP,{title:"Edit the simulation's name",visible:s,initialValues:{name:l.name},onCancel:h,onOk:c,loading:u,children:(0,a.jsx)(I.Z.Item,{name:"name",label:"Name:",rules:[{required:!0,message:"Name is required"}],children:(0,a.jsx)(A.default,{ref:n})})})]})};let F={del:"Unable to delete simulation"},_onDelete=async(e,l,t,a)=>{try{await k.Z.del(l);let a=e.simulations.filter(e=>e!==l.id);await t.mutateProject({id:e.id,simulations:a}),await t.delOneSimulation({id:l.id})}catch(e){throw a((0,f.iT)({title:F.del,err:e})),e}};var simulation_delete=e=>{let{project:l,simulation:t,swr:n}=e,[s,o]=(0,i.useState)(!1),{dispatch:u}=(0,i.useContext)(p.uj),r=(0,i.useCallback)(async()=>{o(!0);try{await _onDelete(l,t,n,u)}finally{o(!1)}},[l,t,n,u]);return(0,a.jsx)(x.m1,{loading:s,text:(0,a.jsxs)(a.Fragment,{children:["Are you sure you want to delete the simulation"," ",(0,a.jsx)(c.Z.Text,{strong:!0,children:t.name}),"?"]}),onDelete:r})},D=t(31059),H=t(48138),z=t(4851),Y=t(68469),B=t(64713),W=t(2307),V=t(86994),G=t(68130),large=e=>{let{dimension:l,initialValue:t,additionalKeywords:n,unit:s,units:o,onChange:u,onUnitChange:r}=e,[m,h]=(0,i.useState)(!1),[v,y]=(0,i.useState)(t),[p,f]=(0,i.useState)(),b=(0,i.useMemo)(()=>[{title:"Label",dataIndex:"label",key:"label"},{title:"Keyword",dataIndex:"value",key:"value"}],[]),x=(0,i.useCallback)(()=>h(!0),[]),j=(0,i.useCallback)(()=>h(!1),[]),C=(0,i.useCallback)(e=>{let t=e.target.value;try{f(void 0),(0,G.Q)(t,{additionalKeywords:null==n?void 0:n.map(e=>{if(2!==l||!e.only3D)return e.value}).filter(e=>e)})}catch(e){f(e.message)}y(t)},[l,n]),k=(0,i.useCallback)(e=>{let l=e.target.value,t=null==o?void 0:o.find(e=>e.label===l);null==r||r(t)},[o,r]),Z=(0,i.useCallback)(async()=>{u({target:{value:v}})},[v,u]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.default,{title:"Complex formula",children:(0,a.jsx)(V.default,{onClick:x})}),(0,a.jsxs)(R.ZP,{title:"Formula",visible:m,initialValues:{formula:t},onOk:Z,onCancel:j,children:[(0,a.jsx)(I.Z.Item,{extra:(0,a.jsx)("span",{style:{color:"red"},children:p}),style:{marginBottom:0},children:(0,a.jsx)(A.default.TextArea,{value:v,onChange:C,style:p?{borderColor:"red"}:{}})}),o?(0,a.jsx)(I.Z.Item,{children:(0,a.jsx)(B.default.Group,{value:null==s?void 0:s.label,onChange:k,children:null==o?void 0:o.map(e=>(0,a.jsx)(B.default.Button,{value:e.label,children:(0,a.jsx)(g.Z.Inline,{text:e.label})},e.label))})}):null,n?(0,a.jsx)(I.Z.Item,{children:(0,a.jsx)(Y.Z,{items:[{key:"additional",label:"Additional keywords",children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Z.Text,{children:"Additional keywods are model-specific keywords, in addition to FreeFEM keywords."}),(0,a.jsx)(W.Z,{pagination:!1,columns:b,dataSource:n.map(e=>({key:e.label,...e})).filter(e=>!(2===l&&e.only3D))})]})}]})}):null]})]})},K=t(2594),q=t.n(K),formula=e=>{let{label:l,noLarge:t,className:n,dimension:s,defaultValue:o,defaultChecked:r,additionalKeywords:d,units:c,unit:m,onValueChange:h,onCheckedChange:v,onUnitChange:y}=e,[p,f]=(0,i.useState)(String(null!=o?o:0)),[b,x]=(0,i.useState)(!!r),[j,C]=(0,i.useState)(void 0!==r&&!r),[k,Z]=(0,i.useState)(0),[w,S]=(0,i.useState)(!1);(0,i.useEffect)(()=>{f(String(null!=o?o:0))},[o]),(0,i.useEffect)(()=>{x(!!r)},[r]);let E=(0,i.useCallback)(e=>{let l=e.target.checked;x(l),null==v||v(l),C(!l)},[v]),N=(0,i.useCallback)(e=>{k&&clearTimeout(k);let l=setTimeout(()=>{h(e),S(!1)},500);Z(+l)},[k,h]),T=(0,i.useCallback)(e=>{let l=e.target.value;f(l),S(!0),N(l)},[N]),M=(0,i.useCallback)(e=>{let l=null==c?void 0:c.find(l=>l.label===e);null==y||y(l)},[c,y]),O=(0,i.useMemo)(()=>m?c&&c.length>1?(0,a.jsx)(u.default,{className:q().select,options:c.map(e=>({value:e.label,label:(0,a.jsx)(g.Z.Inline,{text:e.label})})),onChange:M,value:null==m?void 0:m.label}):(0,a.jsx)(g.Z.Inline,{text:m.label}):null,[m,c,M]),L=(0,i.useMemo)(()=>(0,a.jsx)(z.default,{spin:!0,className:P().textOrange}),[]),R=(0,i.useMemo)(()=>t?(0,a.jsx)(H.Z,{className:P().textGreen}):(0,a.jsx)(large,{dimension:s,initialValue:p,additionalKeywords:d,unit:m,units:c,onChange:T,onUnitChange:y}),[t,s,p,d,m,c,T,y]);return(0,a.jsx)(_.default,{className:"".concat(P().fullWidth," ").concat(q().formula," ").concat(n),style:q(),align:"start",children:(0,a.jsx)(I.Z,{layout:"vertical",children:(0,a.jsx)(I.Z.Item,{label:(0,a.jsxs)(a.Fragment,{children:[void 0!==r&&(0,a.jsx)(D.default,{checked:b,onChange:E,style:{marginRight:"5px"}}),l]}),children:(0,a.jsx)(A.default,{className:q().input,disabled:j,value:p,onChange:T,addonBefore:w?L:R,addonAfter:O})})})})};let J={update:"Unable to update simulation"},_onMeshGlobalType=async(e,l,t,a)=>{try{let a=C.Z.deepCopy(e);a.scheme.configuration.geometry.meshParameters={type:l,value:"auto"===l?"normal":"1"};let i={...a.scheme.configuration.geometry,done:!0};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","geometry"],value:i}]),await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...a.scheme.configuration.run,done:!1}}]),await t.mutateOneSimulation(a)}catch(e){throw a((0,f.iT)({title:J.update,err:e})),e}},_onMeshGlobalSize=async(e,l,t,a)=>{try{var i;let a=C.Z.deepCopy(e);a.scheme.configuration.geometry.meshParameters={...a.scheme.configuration.geometry.meshParameters,type:null===(i=a.scheme.configuration.geometry.meshParameters)||void 0===i?void 0:i.type,value:l};let n={...a.scheme.configuration.geometry,done:!0};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","geometry"],value:n}]),await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...a.scheme.configuration.run,done:!1}}]),await t.mutateOneSimulation(a)}catch(e){throw a((0,f.iT)({title:J.update,err:e})),e}},_onMeshGlobalUnit=async(e,l,t,a)=>{try{var i,n;let a=C.Z.deepCopy(e);a.scheme.configuration.geometry.meshParameters={...a.scheme.configuration.geometry.meshParameters,type:null===(i=a.scheme.configuration.geometry.meshParameters)||void 0===i?void 0:i.type,value:null===(n=a.scheme.configuration.geometry.meshParameters)||void 0===n?void 0:n.value,unit:l};let s={...a.scheme.configuration.geometry,done:!0};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","geometry"],value:s}]),await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...a.scheme.configuration.run,done:!1}}]),await t.mutateOneSimulation(a)}catch(e){throw a((0,f.iT)({title:J.update,err:e})),e}};var mesh=e=>{let{simulation:l,swr:t}=e,[n,s]=(0,i.useState)(),[o,r]=(0,i.useState)(),[d,c]=(0,i.useState)(),{dispatch:m}=(0,i.useContext)(p.uj);(0,i.useEffect)(()=>{let e=l.scheme.configuration.geometry.meshParameters;if(e){var t;s(e.type),r(e.value),c(null!==(t=e.unit)&&void 0!==t?t:{label:"m"})}else s("auto"),r("normal"),c({label:"m"})},[l]);let h=(0,i.useCallback)(e=>{(async()=>{try{await _onMeshGlobalType(l,e,t,m),s(e),"auto"===e?r("normal"):r("1")}catch(e){}})()},[l,t,m]),v=(0,i.useCallback)(e=>{(async()=>{try{await _onMeshGlobalSize(l,e,t,m),r(e)}catch(e){}})()},[l,t,m]),y=(0,i.useCallback)(e=>{(async()=>{try{await _onMeshGlobalUnit(l,e,t,m),c(e)}catch(e){}})()},[l,t,m]);return(0,a.jsx)(S.Z,{size:"small",title:"Mesh refinement",children:(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,children:[(0,a.jsx)(I.Z,{layout:"vertical",children:(0,a.jsx)(I.Z.Item,{label:"Type",children:(0,a.jsxs)(u.default,{className:P().fullWidth,value:n,onChange:h,children:[(0,a.jsx)(u.default.Option,{value:"auto",children:"Automatic"}),(0,a.jsx)(u.default.Option,{value:"manual",children:"Manual"})]})})}),"auto"===n&&(0,a.jsx)(I.Z,{layout:"vertical",children:(0,a.jsx)(I.Z.Item,{label:"Size",children:(0,a.jsxs)(u.default,{className:P().fullWidth,value:o,onChange:v,children:[(0,a.jsx)(u.default.Option,{value:"veryfine",children:"Very fine"}),(0,a.jsx)(u.default.Option,{value:"fine",children:"Fine"}),(0,a.jsx)(u.default.Option,{value:"normal",children:"Normal"}),(0,a.jsx)(u.default.Option,{value:"coarse",children:"Coarse"}),(0,a.jsx)(u.default.Option,{value:"verycoarse",children:"Very coarse"})]})})}),"manual"===n&&(0,a.jsx)(formula,{label:"Size",noLarge:!0,defaultValue:o,units:[{label:"m"},{label:"mm",multiplicator:1e3}],unit:d,onValueChange:v,onUnitChange:y})]})})},$=t(29040),Q=t.n($);let X={update:"Unable to update simulation"},_onSelect=async(e,l,t,a,i,n)=>{try{var s;let n=C.Z.deepCopy(e),o=l.find(e=>e.id===t);n.scheme.configuration.geometry.value=t,n.scheme.configuration.geometry.values=void 0;let u={...n.scheme.configuration,dimension:null!==(s=o.summary.dimension)&&void 0!==s?s:3,geometry:{...n.scheme.configuration.geometry,done:!0},run:{...n.scheme.configuration.run,done:!1}};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration"],value:u}]),await i.mutateOneSimulation(n),a([o])}catch(e){n((0,f.iT)({title:X.update,err:e}))}},_onMultipleSelect=async(e,l,t,a,i,n)=>{try{var s;let n=C.Z.deepCopy(e),o=l.filter(e=>t.includes(e.id));n.scheme.configuration.geometry.value=void 0,n.scheme.configuration.geometry.values=t;let u={...n.scheme.configuration,dimension:null!==(s=o[0].summary.dimension)&&void 0!==s?s:3,geometry:{...n.scheme.configuration.geometry,done:!0},run:{...n.scheme.configuration.run,done:!1}};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration"],value:u}]),await i.mutateOneSimulation(n),a(o)}catch(e){n((0,f.iT)({title:X.update,err:e}))}};var ee=t(40561),el=t(54523),et=t(78804);let ea={update:"Unable to delete material"},delete_onDelete=async(e,l,t,a,i)=>{try{let i=C.Z.deepCopy(e),n=i.scheme.configuration.materials,s=n.values[l];s.selected.forEach(e=>{a((0,et.hF)(e))}),n.values=[...n.values.slice(0,l),...n.values.slice(l+1)];let o={...n,done:!!n.values.length};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:o}]),await t.mutateOneSimulation(i)}catch(e){throw i((0,f.iT)({title:ea.update,err:e})),e}};var materials_delete=e=>{let{simulation:l,index:t,swr:n}=e,[s,o]=(0,i.useState)(!1),{dispatch:u}=(0,i.useContext)(p.uj),{dispatch:r}=(0,i.useContext)(el.ZB),d=(0,i.useMemo)(()=>l.scheme.configuration.materials,[l]),m=(0,i.useMemo)(()=>d.values[t],[d,t]),h=(0,i.useCallback)(async()=>{o(!0);try{await delete_onDelete(l,t,n,r,u)}finally{o(!1)}},[l,t,n,r,u]);return(0,a.jsx)(x.m1,{loading:s,text:(0,a.jsxs)(a.Fragment,{children:["Are you sure you want to delete the material"," ",(0,a.jsx)(c.Z.Text,{strong:!0,children:m.material.label})]}),onDelete:h})};let ListItem=e=>{let{geometries:l,simulation:t,material:n,index:s,swr:o,_onEdit:u}=e,[r,d]=(0,i.useState)(!0),{dispatch:m}=(0,i.useContext)(el.ZB),h=(0,i.useCallback)(()=>{m((0,et.wp)());let e=n.geometry,t=l.find(l=>l.id===e);m((0,et.rx)(null==t?void 0:t.summary.uuid));let a=n.selected;null==a||a.forEach(e=>{m((0,et.Ys)(e))})},[l,n,m]),v=(0,i.useCallback)(()=>{r&&m((0,et.h$)())},[r,m]),y=(0,i.useCallback)(()=>{d(!1),u(s),setTimeout(()=>d(!0),500)},[s,u]);return(0,a.jsx)(S.Z,{className:"".concat(P().textAlignCenter," ").concat(Q().listItem),hoverable:!0,onMouseEnter:h,onMouseLeave:v,actions:[(0,a.jsx)(x.w6,{onEdit:y},"edit"),(0,a.jsx)(materials_delete,{index:s,simulation:t,swr:o},"delete")],children:(0,a.jsx)(c.Z.Text,{strong:!0,className:P().textAlignCenter,children:n.material.label})})};var list=e=>{var l;let{geometries:t,simulation:n,swr:s,onEdit:o}=e,u=(0,i.useMemo)(()=>n.scheme.configuration.materials,[n]);return(0,a.jsx)(a.Fragment,{children:null===(l=u.values)||void 0===l?void 0:l.map((e,l)=>(0,a.jsx)(ListItem,{geometries:t,simulation:n,material:e,index:l,swr:s,_onEdit:o},e.uuid)).filter(e=>e)})},ei=t(1825),en=t(83482),es=t(3855),eo=t(59361),eu=t(95286),er=t(91873),ed=t(7737),ec=t(49031);let ColorFilter=e=>{let{color:l,setFilter:t}=e,n=(0,i.useCallback)(()=>{t(l)},[l,t]);return(0,a.jsx)(d.default,{title:"Color",children:(0,a.jsx)(T(),{style:{backgroundColor:C.Z.rgbToHex(l)},onClick:n,children:" "})},JSON.stringify(l))},ColorFilters=e=>{let{colors:l,setFilter:t}=e,n=(0,i.useCallback)(()=>{t(void 0)},[t]);return(0,a.jsx)(a.Fragment,{children:l.length>1&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.default,{title:"Reset",children:(0,a.jsx)(T(),{icon:(0,a.jsx)(en.default,{}),onClick:n})}),l.map(e=>(0,a.jsx)(ColorFilter,{color:e,setFilter:t},JSON.stringify(e)))]})})},GeometryElementCard=e=>{let{element:l,alreadySelected:t,filter:n,search:s,context:o}=e,u=(0,i.useCallback)(e=>{var l,t,a;return(!n||n.r===(null===(l=e.color)||void 0===l?void 0:l.r)&&n.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&n.b===(null===(a=e.color)||void 0===a?void 0:a.b))&&(!s||!e.name||!!e.name.includes(s))},[n,s]),r=(0,i.useCallback)(e=>{o.dispatch((0,et.CH)(e))},[o]),d=(0,i.useCallback)(()=>{o.dispatch((0,et.HW)())},[o]),c=(0,i.useCallback)(e=>{o.selected.find(l=>l.uuid===e.uuid)?o.dispatch((0,et.hF)(e)):o.dispatch((0,et.Ys)(e))},[o]),m=(0,i.useMemo)(()=>{var e;return o.selected.find(e=>e.uuid===l.uuid)?"#EE9817":(null===(e=o.highlighted)||void 0===e?void 0:e.uuid)===l.uuid?"#FAD114":"transparent"},[l,o]),h=(0,i.useMemo)(()=>{var e;return o.selected.find(e=>e.uuid===l.uuid)?"rgba(238, 152, 23, 0.3)":(null===(e=o.highlighted)||void 0===e?void 0:e.uuid)===l.uuid?"rgba(250, 209, 20, 0.3)":"transparent"},[l,o]),v=(0,i.useCallback)(()=>r({uuid:l.uuid,label:l.label}),[l,r]),y=(0,i.useCallback)(()=>c({uuid:l.uuid,label:l.label}),[l,c]);return u(l)?(0,a.jsx)(S.Z,{style:{marginBottom:"10px"},bodyStyle:{position:"relative",padding:"10px 10px 10px 40px",borderWidth:"2px",borderStyle:"solid",borderColor:m,backgroundColor:h},onMouseEnter:v,onMouseLeave:d,onClick:y,children:(0,a.jsxs)(_.default,{direction:"vertical",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{position:"absolute",left:"-2px",top:"-2px",bottom:"-2px",width:"30px",backgroundColor:C.Z.rgbToRgba(l.color,1)}}),l.name]}),null==t?void 0:t.map(e=>{if(e.selected.find(e=>e.uuid===l.uuid))return(0,a.jsx)(eo.Z,{color:C.Z.stringToColor(e.label),children:e.label},l.uuid)})]})}):null};var selector=e=>{var l;let{geometry:t,alreadySelected:n,updateSelected:s}=e,[o,u]=(0,i.useState)([]),[r,m]=(0,i.useState)(),[h,v]=(0,i.useState)(),{type:y,highlighted:p,selected:f,dispatch:g}=(0,i.useContext)(el.ZB);(0,b.Z)(()=>s(f),[f],[s]),(0,b.Z)(()=>{var e;let l=[];y&&(null===(e=t.summary[y])||void 0===e||e.forEach(e=>{if(e.color){let t=l.find(l=>l.r===e.color.r&&l.g===e.color.g&&l.b===e.color.b);t||l.push(e.color)}})),u(l)},[t,y]);let x=(0,i.useCallback)(()=>{var e;null===(e=t.summary[y])||void 0===e||e.forEach(e=>{var l,t,a;(!r||r&&r.r===(null===(l=e.color)||void 0===l?void 0:l.r)&&r.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&r.b===(null===(a=e.color)||void 0===a?void 0:a.b))&&g((0,et.Ys)({uuid:e.uuid,label:e.label}))})},[t,y,r,g]),j=(0,i.useCallback)(()=>{var e;null===(e=t.summary[y])||void 0===e||e.forEach(e=>{var l,t,a;(!r||r&&r.r===(null===(l=e.color)||void 0===l?void 0:l.r)&&r.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&r.b===(null===(a=e.color)||void 0===a?void 0:a.b))&&g((0,et.hF)({uuid:e.uuid,label:e.label}))})},[t,y,r,g]),C=(0,i.useCallback)(()=>{var e;null===(e=t.summary[y])||void 0===e||e.forEach(e=>{var l,t,a;(!r||r&&r.r===(null===(l=e.color)||void 0===l?void 0:l.r)&&r.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&r.b===(null===(a=e.color)||void 0===a?void 0:a.b))&&f.find(l=>l.uuid===e.uuid)?g((0,et.hF)({uuid:e.uuid,label:e.label})):g((0,et.Ys)({uuid:e.uuid,label:e.label}))})},[t,f,y,r,g]),k=(0,i.useCallback)(e=>{let l=e.target.value;v(l)},[]);return(0,a.jsxs)(S.Z,{size:"small",className:P().noBorderBottom,children:[(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,children:[(0,a.jsx)(c.Z.Text,{strong:!0,children:"Filters"}),(0,a.jsxs)(_.default,{direction:"horizontal",wrap:!0,children:[(0,a.jsx)(ColorFilters,{colors:o,setFilter:m}),(0,a.jsx)(d.default,{title:"Select all",children:(0,a.jsx)(T(),{icon:(0,a.jsx)(er.default,{}),onClick:x})}),(0,a.jsx)(d.default,{title:"Unselect all",children:(0,a.jsx)(T(),{icon:(0,a.jsx)(eu.Z,{}),onClick:j})}),(0,a.jsx)(d.default,{title:"Swap",children:(0,a.jsx)(T(),{icon:(0,a.jsx)(ec.Z,{}),onClick:C})})]}),(0,a.jsx)(A.default,{placeholder:"Search",value:h,onChange:k,suffix:(0,a.jsx)(ed.default,{className:P().textLight})})]}),(0,a.jsx)("div",{className:P().fullWidth,style:{marginTop:"20px"},children:y?null===(l=t.summary[y])||void 0===l?void 0:l.map(e=>(0,a.jsx)(GeometryElementCard,{element:e,alreadySelected:n,filter:r,search:h,context:{selected:f,highlighted:p,dispatch:g}},e.uuid)):null})]})},em=t(56590),eh=t(69590),ev=t(9819),database=e=>{let{onSelect:l}=e,[t,u]=(0,i.useState)(),[r,d]=(0,i.useState)(),[c,m]=(0,i.useState)(),[h,v]=(0,i.useState)(),y=(0,i.useMemo)(()=>Object.keys(ev.E),[]),p=(0,i.useCallback)(()=>u(!0),[]),f=(0,i.useCallback)(()=>u(!1),[]),b=(0,i.useCallback)(e=>{let{key:l}=e,t=ev.E[l];d({key:l,children:t.children}),m(void 0),v(void 0)},[]),g=(0,i.useCallback)(e=>{let{key:l}=e,t=ev.E[r.key],a=t.children.find(e=>e.key===l);m({key:l}),v(a)},[r]),x=(0,i.useCallback)(()=>{l(h),u(!1)},[h,l]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T(),{icon:(0,a.jsx)(eh.Z,{}),onClick:p,className:P().fullWidth,children:"Pick a material"}),(0,a.jsx)(o.Z,{open:t,title:"Material database",onCancel:f,onOk:x,okText:"Choose",okButtonProps:{disabled:!h},width:"50%",children:(0,a.jsx)(n.Z,{children:(0,a.jsx)(n.Z.Content,{children:(0,a.jsxs)(_.default,{style:{alignItems:"stretch"},children:[(0,a.jsx)(s.default,{mode:"inline",items:y.map(e=>({key:e,label:ev.E[e].label})),onClick:b}),(0,a.jsx)(s.default,{mode:"inline",items:null==r?void 0:r.children.map(e=>({key:e.key,label:e.label})),selectedKeys:(null==c?void 0:c.key)?[null==c?void 0:c.key]:[],onClick:g}),h&&(0,a.jsx)(em.Z,{itemLayout:"vertical",children:h.children.map(e=>(0,a.jsxs)(em.Z.Item,{children:[e.label,": ",e.symbol," = ",e.value]},e.label))})]})})})})]})},ey=t(57632);let ep={material:"You need to define a material",selected:"You need to select a solid",update:"Unable to add material"},_onAdd=async(e,l,t,a)=>{try{var i;let a=C.Z.deepCopy(l);a.uuid=(0,ey.Z)();let n=C.Z.deepCopy(e),s=n.scheme.configuration.materials;s.values=[...null!==(i=s.values)&&void 0!==i?i:[],a];let o={...s,done:!0};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:o}]),await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...n.scheme.configuration.run,done:!1}}]),await t.mutateOneSimulation(n)}catch(e){throw a((0,f.iT)({title:ep.update,err:e})),e}};var add=e=>{let{simulation:l,material:t,swr:n,onError:s,onClose:o}=e,[u,r]=(0,i.useState)(!1),{dispatch:d}=(0,i.useContext)(p.uj),c=(0,i.useCallback)(()=>{(async()=>{r(!0);try{var e;if(!t.material){s(ep.material),r(!1);return}if(!(null===(e=t.selected)||void 0===e?void 0:e.length)){s(ep.selected),r(!1);return}s(),await _onAdd(l,t,n,d),r(!1),o()}catch(e){r(!1)}})()},[l,t,n,s,o,d]);return(0,a.jsx)(x.HS,{loading:u,needMargin:!0,onAdd:c,children:"Add"})};let ef={material:"You need to define a material",selected:"You need to select a solid",update:"Unable to edit material"},edit_onEdit=async(e,l,t,a)=>{try{let a=C.Z.deepCopy(e),i=a.scheme.configuration.materials,n=i.values.findIndex(e=>e.uuid===l.uuid);i.values=[...i.values.slice(0,n),l,...i.values.slice(n+1)];let s={...i};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:s}]),await t.mutateOneSimulation(a)}catch(e){throw a((0,f.iT)({title:ef.update,err:e})),e}};var materials_edit=e=>{let{simulation:l,material:t,swr:n,onError:s,onClose:o}=e,[u,r]=(0,i.useState)(!1),{dispatch:d}=(0,i.useContext)(p.uj),c=(0,i.useCallback)(()=>{(async()=>{r(!0);try{var e;if(!t.material){s(ef.material),r(!1);return}if(!(null===(e=t.selected)||void 0===e?void 0:e.length)){s(ef.selected),r(!1);return}s(),await edit_onEdit(l,t,n,d),r(!1),o()}catch(e){r(!1)}})()},[l,t,n,s,o,d]);return(0,a.jsx)(x.w6,{loading:u,primary:!0,needMargin:!0,onEdit:c,children:"Edit"})},eb=t(64098),eg=t.n(eb);let MaterialsChild=e=>{let{dimension:l,variables:t,child:n,index:s,value:o,unit:u,_onMaterialChange:r,_onUnitChange:d}=e,c=(0,i.useCallback)(e=>{r(n,s,e)},[n,s,r]),m=(0,i.useCallback)(e=>{d(s,e)},[s,d]);return(0,a.jsx)(formula,{dimension:l,label:n.name,defaultValue:null!=o?o:String(n.default),additionalKeywords:t,units:n.units,unit:null!=u?u:n.unit,onValueChange:c,onUnitChange:m},n.name)};var materials_material=e=>{var l,t,n,s,o,u,d;let{visible:m,geometries:h,simulation:v,material:y,swr:p,onClose:f}=e,[g,j]=(0,i.useState)(),[C,k]=(0,i.useState)(),[Z,w]=(0,i.useState)(),[E,N]=(0,i.useState)(),{dispatch:M}=(0,i.useContext)(el.ZB),O=(0,i.useMemo)(()=>v.scheme.configuration.dimension,[v]),L=(0,i.useMemo)(()=>v.scheme.variables,[v]),I=(0,i.useMemo)(()=>v.scheme.configuration.materials,[v]);(0,b.Z)(()=>{var e;M((0,et.rx)(null===(e=h[0])||void 0===e?void 0:e.summary.uuid)),w(null==y?void 0:y.geometry)},[h,y],[M]),(0,b.Z)(()=>{!m&&C&&k(void 0)},[m,C]),(0,b.Z)(()=>{var e,l;m&&!C&&y?k(y):!m||C||y||k({material:{label:"Default",children:null!==(l=null==I?void 0:I.children.map(e=>({label:e.label,symbol:e.name,value:e.default})))&&void 0!==l?l:[]},geometry:null===(e=h[0])||void 0===e?void 0:e.id})},[m,h,I,C]),(0,b.Z)(()=>{var e;let l=null==I?void 0:null===(e=I.values)||void 0===e?void 0:e.map(e=>{if(e.uuid!==(null==y?void 0:y.uuid))return{label:e.material.label,selected:e.selected}}).filter(e=>e);j(null!=l?l:[])},[v,y,I]);let A=(0,i.useCallback)(e=>{k(l=>({...l,material:e}))},[]),R=(0,i.useCallback)((e,l,t)=>{k(a=>({...a,material:{label:"Custom",children:[...a.material.children.slice(0,l),{...a.material.children[l],label:e.label,symbol:e.name,value:t},...a.material.children.slice(l+1)]}}))},[]),U=(0,i.useCallback)((e,l)=>{k(t=>({...t,material:{...t.material,children:[...t.material.children.slice(0,e),{...t.material.children[e],unit:l},...t.material.children.slice(e+1)]}}))},[]),F=(0,i.useCallback)(e=>{k(l=>({...l,selected:e}))},[]),D=(0,i.useCallback)(e=>{w(e);let l=h.find(l=>l.id===e);M((0,et.rx)(l.summary.uuid)),k(l=>({...l,geometry:e}))},[h,M]),H=(0,i.useCallback)(()=>{k(void 0),f()},[f]);return(0,a.jsx)(ei.Z,{className:eg().subPanel,title:"Material",placement:"left",closable:!1,open:m,mask:!1,maskClosable:!1,width:300,extra:(0,a.jsx)(T(),{type:"text",icon:(0,a.jsx)(en.default,{}),onClick:H}),footer:(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,a.jsx)(x.Lw,{onCancel:H}),y?(0,a.jsx)(materials_edit,{material:{uuid:null!==(n=null==C?void 0:C.uuid)&&void 0!==n?n:y.uuid,material:null!==(s=null==C?void 0:C.material)&&void 0!==s?s:y.material,geometry:null!==(o=null==C?void 0:C.geometry)&&void 0!==o?o:y.geometry,selected:null!==(u=null==C?void 0:C.selected)&&void 0!==u?u:y.selected},simulation:{id:v.id,scheme:v.scheme},swr:{mutateOneSimulation:p.mutateOneSimulation},onError:N,onClose:H}):(0,a.jsx)(add,{material:{material:null==C?void 0:C.material,geometry:null==C?void 0:C.geometry,selected:null==C?void 0:C.selected},simulation:{id:v.id,scheme:v.scheme},swr:{mutateOneSimulation:p.mutateOneSimulation},onError:N,onClose:H})]}),children:(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,children:[(0,a.jsx)(S.Z,{size:"small",children:(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,children:[(0,a.jsx)(database,{onSelect:A}),(0,a.jsxs)(c.Z.Text,{children:["Material: ",null!==(d=null==C?void 0:null===(l=C.material)||void 0===l?void 0:l.label)&&void 0!==d?d:"default"]}),null==I?void 0:null===(t=I.children)||void 0===t?void 0:t.map((e,l)=>{var t,i,n;let s=null==C?void 0:null===(i=C.material)||void 0===i?void 0:null===(t=i.children)||void 0===t?void 0:t.find(l=>l.symbol===e.name);return(0,a.jsx)(MaterialsChild,{dimension:O,variables:L,child:e,index:l,value:null==s?void 0:s.value,unit:null!==(n=null==s?void 0:s.unit)&&void 0!==n?n:e.unit,_onMaterialChange:R,_onUnitChange:U},e.name)})]})}),(0,a.jsx)(r.default,{items:h.map(e=>({key:e.id,label:e.name,children:(0,a.jsx)(selector,{geometry:e,alreadySelected:g,updateSelected:F})})),activeKey:Z,onChange:D}),E&&(0,a.jsxs)(c.Z.Text,{children:[(0,a.jsx)(es.Z,{style:{color:"red"}})," ",E]})]})})};let ex={update:"Unable to update simulation"},_build2DFormula=(e,l,t,i,n)=>{var s,o;return(0,a.jsx)(formula,{dimension:2,label:null!==(s=t.label2D)&&void 0!==s?s:t.label,defaultValue:null!==(o=t.value)&&void 0!==o?o:t.default,additionalKeywords:l,onValueChange:i,onUnitChange:n,units:t.units,unit:t.unit},e)},_build2DSelect=(e,l,t)=>{var i,n,s,o;return(0,a.jsx)(I.Z,{layout:"vertical",children:(0,a.jsx)(I.Z.Item,{label:null!==(n=l.label2D)&&void 0!==n?n:l.label,children:(0,a.jsx)(u.default,{options:null===(i=l.options)||void 0===i?void 0:i.map(e=>{var l;return{label:e.label,value:null!==(l=e.value2D)&&void 0!==l?l:e.value}}),defaultValue:null!==(o=null!==(s=l.value)&&void 0!==s?s:l.default2D)&&void 0!==o?o:l.default,onChange:t})})},e)},_build2DCheckbox=(e,l,t)=>{var i;return(0,a.jsx)(I.Z,{layout:"horizontal",children:(0,a.jsx)(I.Z.Item,{label:null!==(i=l.label2D)&&void 0!==i?i:l.label,children:(0,a.jsx)(D.default,{defaultChecked:l.value,onChange:t})})},e)},_buildFormula=(e,l,t,i,n)=>{var s;return(0,a.jsx)(formula,{dimension:3,label:t.label,defaultValue:null!==(s=t.value)&&void 0!==s?s:t.default,additionalKeywords:l,units:t.units,unit:t.unit,onValueChange:i,onUnitChange:n},e)},_buildSelect=(e,l,t)=>{var i;return(0,a.jsx)(I.Z,{layout:"vertical",children:(0,a.jsx)(I.Z.Item,{label:l.label,children:(0,a.jsx)(u.default,{options:l.options,defaultValue:null!==(i=l.value)&&void 0!==i?i:l.default,onChange:t})})},e)},_buildCheckbox=(e,l,t)=>(0,a.jsx)(I.Z,{layout:"horizontal",children:(0,a.jsx)(I.Z.Item,{label:l.label,children:(0,a.jsx)(D.default,{defaultChecked:l.value,onChange:t})})},e),_buildRadio=(e,l,t)=>{var i;return(0,a.jsx)(I.Z,{layout:"vertical",children:(0,a.jsx)(I.Z.Item,{label:l.label,children:(0,a.jsx)(B.default.Group,{options:l.options,defaultValue:null!==(i=l.value)&&void 0!==i?i:l.default,onChange:t})})},e)},_onDone=async(e,l,t)=>{try{let t=C.Z.deepCopy(e),a=t.scheme.configuration.parameters,i={...a,done:!0};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","parameters"],value:i}]),await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...t.scheme.configuration.run,done:!1}}]),await l.mutateOneSimulation(t)}catch(e){t((0,f.iT)({title:ex.update,err:e}))}},_onChange=async(e,l,t,a,i,n)=>{try{let n=C.Z.deepCopy(e),s=n.scheme.configuration.parameters,o=s[l];o.children[t].value=a;let u={...s};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","parameters"],value:u}]),await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...n.scheme.configuration.run,done:!1}}]),await i.mutateOneSimulation(n)}catch(e){n((0,f.iT)({title:ex.update,err:e}))}},_onUnitChange=async(e,l,t,a,i,n)=>{try{let n=C.Z.deepCopy(e),s=n.scheme.configuration.parameters,o=s[l];o.children[t].unit=a;let u={...s};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","parameters"],value:u}]),await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...n.scheme.configuration.run,done:!1}}]),await i.mutateOneSimulation(n)}catch(e){n((0,f.iT)({title:ex.update,err:e}))}},ParameterChild=e=>{let{simulation:l,dimension:t,child:a,pkey:n,index:s,swr:o}=e,{dispatch:u}=(0,i.useContext)(p.uj),r=(0,i.useMemo)(()=>l.scheme.variables,[l]),d=(0,i.useCallback)(e=>{(async()=>{await _onChange(l,n,s,e,o,u)})()},[l,n,s,o,u]),c=(0,i.useCallback)(e=>{(async()=>{await _onUnitChange(l,n,s,e,o,u)})()},[l,n,s,o,u]),m=(0,i.useCallback)(e=>{(async()=>{await _onChange(l,n,s,e.target.checked,o,u)})()},[l,n,s,o,u]);if(2===t){if(a.only3D);else if("formula"===a.htmlEntity)return _build2DFormula(n+"&"+s,r,a,d,c);else if("select"===a.htmlEntity)return _build2DSelect(n+"&"+s,a,d);else if("checkbox"===a.htmlEntity)return _build2DCheckbox(n+"&"+s,a,m);return null}return"formula"===a.htmlEntity?_buildFormula(n+"&"+s,r,a,d,c):"select"===a.htmlEntity?_buildSelect(n+"&"+s,a,d):"checkbox"===a.htmlEntity?_buildCheckbox(n+"&"+s,a,m):"radio"===a.htmlEntity?_buildRadio(n+"&"+s,a,m):null},Parameter=e=>{let{simulation:l,dimension:t,pkey:n,parameter:s,swr:o}=e,u=(0,i.useMemo)(()=>s.children.map((e,i)=>(0,a.jsx)(ParameterChild,{simulation:l,dimension:t,child:e,pkey:n,index:i,swr:o},n+"&"+e.label)),[l,t,n,s,o]);return(0,a.jsx)(S.Z,{size:"small",title:null==s?void 0:s.label,children:(0,a.jsx)(_.default,{direction:"vertical",children:u})},n)},getFilesNumbers=(e,l)=>e.map(e=>{let t=e.fileName.replace(new RegExp(l.prefixPattern),"").replace(new RegExp(l.suffixPattern),"");return{...e,number:+t}}),getMultiplicator=(e,l)=>{let t=l.multiplicator;if(t){var a;let l=t.reduce((e,l)=>e[l],e);return null!==(a=l.value)&&void 0!==a?a:l.default}},ej={update:"Unable to update simulation"},_onSelectorChange=async(e,l,t,a)=>{try{let a=C.Z.deepCopy(e),i=a.scheme.configuration.initialization;i.value={type:l},await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:i}]),await t.mutateOneSimulation(a)}catch(e){throw a((0,f.iT)({title:ej.update,err:e})),e}},_onCouplingChange=async(e,l,t,a,i)=>{try{var n;let i=await _loadResults(e,t),s=C.Z.deepCopy(l),o=s.scheme.configuration.initialization;o.value={...o.value,simulation:t,result:null==i?void 0:null===(n=i[0])||void 0===n?void 0:n.value},await k.Z.update({id:l.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:o}]),await a.mutateOneSimulation(s)}catch(e){throw i((0,f.iT)({title:ej.update,err:e})),e}},_onCouplingResultChange=async(e,l,t,a,i)=>{try{let i=C.Z.deepCopy(e),n=i.scheme.configuration.initialization;n.value={...n.value,number:+l,result:t.file},await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:n}]),await a.mutateOneSimulation(i)}catch(e){i((0,f.iT)({title:ej.update,err:e}))}},initialization_onChange=async(e,l,t,a,i)=>{try{let i=C.Z.deepCopy(e),n=i.scheme.configuration.initialization;n.value.values||(n.value.values=[]),n.value.values[l]=t,await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:n}]),await a.mutateOneSimulation(i)}catch(e){i((0,f.iT)({title:ej.update,err:e}))}},_loadResults=async(e,l)=>{var t;let a=await k.Z.tasks({id:l}),i=e.find(e=>e.id===l),n=i.scheme.configuration,s=null==n?void 0:null===(t=n.run)||void 0===t?void 0:t.resultsFilter,o=[];return a.forEach(e=>{if(e.file&&"result"===e.file.type&&o.push({label:e.file.fileName,value:e.file.fileName,file:e.file.fileName}),e.files){if(s){let l=new RegExp(s.pattern),t=e.files.filter(e=>!l.test(e.fileName)).filter(e=>"result"===e.type),a=e.files.filter(e=>l.test(e.fileName)),i=getFilesNumbers(a,s),u=i.map(e=>({number:e.number,fileName:e.fileName.replace(new RegExp(s.suffixPattern),"")})).filter((e,l,t)=>t.findIndex(l=>l.number===e.number)===l).sort((e,l)=>e.number-l.number),r=getMultiplicator(n,s),d=u.map((e,l)=>{let t=r?e.number*r:l;return{label:String(Math.round(1e15*t)/1e15),value:e.fileName,file:e.fileName}});o.push(...t.map(e=>({label:e.fileName,value:e.fileName,file:e.fileName})).filter(e=>e)),o.push(...d)}else e.files.forEach(e=>{"result"===e.type&&o.push({label:e.fileName,value:e.fileName,file:e.fileName})})}}),o},DirectItem=e=>{let{simulation:l,child:t,index:n,value:s,swr:o,dispatch:u}=e,r=(0,i.useCallback)(e=>{(async()=>{await initialization_onChange(l,n,e,o,u)})()},[l,n,o,u]);return(0,a.jsx)(formula,{label:t.label,defaultValue:(null!=s?s:t.default).toString(),units:t.units,unit:t.unit,onValueChange:r})},eC={update:"Unable to delete boundary condition"},boundaryConditions_delete_onDelete=async(e,l,t,a,i,n)=>{try{let n=C.Z.deepCopy(e),s=n.scheme.configuration.boundaryConditions,o=s[l],u=o.values[t];u.selected.forEach(e=>{i((0,et.hF)(e))}),o.values=[...o.values.slice(0,t),...o.values.slice(t+1)];let r=!1;Object.keys(s).forEach(e=>{var l;if("index"===e||"title"===e||"done"===e)return;let t=s[e];(null===(l=t.values)||void 0===l?void 0:l.length)&&(r=!0)});let d={...s,done:r};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:d}]),await a.mutateOneSimulation(n)}catch(e){throw n((0,f.iT)({title:eC.update,err:e})),e}};var boundaryConditions_delete=e=>{let{type:l,index:t,simulation:n,swr:s}=e,[o,u]=(0,i.useState)(!1),{dispatch:r}=(0,i.useContext)(el.ZB),{dispatch:d}=(0,i.useContext)(p.uj),m=(0,i.useMemo)(()=>n.scheme.configuration.boundaryConditions,[n]),h=(0,i.useMemo)(()=>m[l],[m,l]),v=(0,i.useMemo)(()=>h.values[t],[h,t]),y=(0,i.useCallback)(async()=>{u(!0);try{await boundaryConditions_delete_onDelete(n,l,t,s,r,d)}finally{u(!1)}},[n,l,t,s,r,d]);return(0,a.jsx)(x.m1,{loading:o,onDelete:y,text:(0,a.jsxs)(a.Fragment,{children:["Are you sure you want to delete the condition"," ",(0,a.jsx)(c.Z.Text,{strong:!0,children:null==v?void 0:v.name}),"?"]})})};let list_ListItem=e=>{let{geometries:l,simulation:t,boundaryCondition:n,index:s,type:o,swr:u,_onEdit:r}=e,[d,m]=(0,i.useState)(!0),{dispatch:h}=(0,i.useContext)(el.ZB),v=(0,i.useCallback)(()=>{h((0,et.wp)());let e=n.geometry,t=l.find(l=>l.id===e);h((0,et.rx)(null==t?void 0:t.summary.uuid));let a=n.selected;null==a||a.forEach(e=>{h((0,et.Ys)(e))})},[l,n,h]),y=(0,i.useCallback)(()=>{d&&h((0,et.h$)())},[d,h]),p=(0,i.useCallback)(()=>{m(!1),r(o,s),setTimeout(()=>m(!0),500)},[s,o,r]);return(0,a.jsxs)(S.Z,{className:Q().listItem,hoverable:!0,onMouseEnter:v,onMouseLeave:y,actions:[(0,a.jsx)(x.w6,{onEdit:p},"edit"),(0,a.jsx)(boundaryConditions_delete,{simulation:{id:t.id,scheme:t.scheme},type:o,index:s,swr:{mutateOneSimulation:u.mutateOneSimulation}},"delete")],children:[(0,a.jsx)(c.Z.Text,{strong:!0,children:n.name})," ",(0,a.jsxs)(c.Z.Text,{children:["(",n.type.label,")"]})]})};var boundaryConditions_list=e=>{let{geometries:l,simulation:t,swr:n,onEdit:s}=e,o=(0,i.useMemo)(()=>t.scheme.configuration.boundaryConditions,[t]);return(0,a.jsx)(a.Fragment,{children:Object.keys(o).map(e=>{var i;if("index"===e||"title"===e||"done"===e)return;let u=o[e];return null===(i=u.values)||void 0===i?void 0:i.map((i,o)=>(0,a.jsx)(list_ListItem,{geometries:l,simulation:t,boundaryCondition:i,index:o,type:e,swr:n,_onEdit:s},i.uuid))}).filter(e=>e)})};let ek={name:"You need to define a name",type:"You need to select a type",selected:"You need to select a face",update:"Unable to add boundary condition"},add_onAdd=async(e,l,t,a)=>{try{var i;let a={...l},n=a.type.key;a.uuid=(0,ey.Z)();let s=C.Z.deepCopy(e),o=s.scheme.configuration.boundaryConditions,u=o[n];u.values=[...null!==(i=u.values)&&void 0!==i?i:[],a];let r={...o,done:!0};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:r}]),await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...s.scheme.configuration.run,done:!1}}]),await t.mutateOneSimulation(s)}catch(e){throw a((0,f.iT)({title:ek.update,err:e})),e}};var boundaryConditions_add=e=>{let{simulation:l,boundaryCondition:t,swr:n,onError:s,onClose:o}=e,[u,r]=(0,i.useState)(!1),{dispatch:d}=(0,i.useContext)(p.uj),c=(0,i.useCallback)(()=>{(async()=>{r(!0);try{var e,a;if(!t.name){s(ek.name),r(!1);return}if(!(null===(e=t.type)||void 0===e?void 0:e.key)){s(ek.type),r(!1);return}if(!(null===(a=t.selected)||void 0===a?void 0:a.length)){s(ek.selected),r(!1);return}s(),await add_onAdd(l,t,n,d),r(!1),o()}catch(e){r(!1)}})()},[l,t,n,s,o,d]);return(0,a.jsx)(x.HS,{loading:u,onAdd:c,needMargin:!0,children:"Add"})};let eZ={name:"You need to define a name",type:"You need to select a type",selected:"You need to select a face",update:"Unable to edit boundary condition"},boundaryConditions_edit_onEdit=async(e,l,t,a,i)=>{try{let i=C.Z.deepCopy(e),s=i.scheme.configuration.boundaryConditions,o=l.type.key,u=t.type.key;if(u!==o){let e=s[u],l=e.values.findIndex(e=>e.uuid===t.uuid);e.values=[...e.values.slice(0,l),...e.values.slice(l+1)]}if(u!==o){var n;let e=s[o];e.values=[...null!==(n=e.values)&&void 0!==n?n:[],l]}else{let e=s[o],t=e.values.findIndex(e=>e.uuid===l.uuid);e.values=[...e.values.slice(0,t),l,...e.values.slice(t+1)]}let r={...s};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:r}]),await a.mutateOneSimulation(i)}catch(e){throw i((0,f.iT)({title:eZ.update,err:e})),e}};var boundaryConditions_edit=e=>{let{simulation:l,boundaryCondition:t,oldBoundaryCondition:n,swr:s,onError:o,onClose:u}=e,[r,d]=(0,i.useState)(!1),{dispatch:c}=(0,i.useContext)(p.uj),m=(0,i.useCallback)(()=>{(async()=>{d(!0);try{var e,a;if(!t.name){o(eZ.name),d(!1);return}if(!(null===(e=t.type)||void 0===e?void 0:e.key)){o(eZ.type),d(!1);return}if(!(null===(a=t.selected)||void 0===a?void 0:a.length)){o(eZ.selected),d(!1);return}o(),await boundaryConditions_edit_onEdit(l,t,n,s,c),d(!1),u()}catch(e){d(!1)}})()},[l,t,n,s,o,u,c]);return(0,a.jsx)(x.w6,{loading:r,onEdit:m,primary:!0,needMargin:!0,children:"Edit"})};let BoundaryConditionItem=e=>{let{dimension:l,variables:t,boundaryCondition:n,index:s,value:o,checked:u,unit:r,_onValueChange:d,_onCheckedChange:c,_onUnitChange:m}=e,h=(0,i.useCallback)(e=>d(s,e),[s,d]),v=(0,i.useCallback)(e=>c(s,e),[s,c]),y=(0,i.useCallback)(e=>m(s,e),[s,m]);return(0,a.jsx)(formula,{label:n.label,dimension:l,defaultValue:o,defaultChecked:u,additionalKeywords:t,onValueChange:h,onCheckedChange:v,onUnitChange:y,units:n.units,unit:r})};var boundaryConditions_boundaryCondition=e=>{var l,t,n,s,o,u,d,m;let{visible:h,geometries:v,simulation:y,boundaryCondition:p,swr:f,onClose:g}=e,[j,C]=(0,i.useState)([]),[k,Z]=(0,i.useState)([]),[w,E]=(0,i.useState)(),[N,M]=(0,i.useState)(),[O,L]=(0,i.useState)(),[R,U]=(0,i.useState)(),{dispatch:F}=(0,i.useContext)(el.ZB),D=(0,i.useMemo)(()=>y.scheme.variables,[y]),H=(0,i.useMemo)(()=>y.scheme.configuration.boundaryConditions,[y]),z=(0,i.useMemo)(()=>y.scheme.configuration.dimension,[y]);(0,b.Z)(()=>{var e;F((0,et.rx)(null===(e=v[0])||void 0===e?void 0:e.summary.uuid)),L(null==p?void 0:p.geometry)},[v,p],[F]),(0,b.Z)(()=>{!h&&N&&M(void 0)},[h,N]),(0,b.Z)(()=>{let e=Object.keys(H).map(e=>{if("index"===e||"title"===e||"done"===e)return;let l=H[e];return{key:e,label:l.label,children:l.children,values:l.values}}).filter(e=>e);Z(e)},[H]),(0,b.Z)(()=>{let e=null==k?void 0:k.map(e=>{var l;return null===(l=e.values)||void 0===l?void 0:l.length}).filter(e=>e).reduce((e,l)=>e+l,0);E(e)},[k]),(0,b.Z)(()=>{h&&!N&&p?M(p):!h||N||p||void 0===w||M(e=>{var l;return{...e,name:"Boundary condition "+(w+1),geometry:null===(l=v[0])||void 0===l?void 0:l.id}})},[h,p,N,w]),(0,b.Z)(()=>{let e=Object.keys(H).map(e=>{var l;if("index"===e||"title"===e||"done"===e)return;let t=H[e];return null==t?void 0:null===(l=t.values)||void 0===l?void 0:l.map(e=>{if(e.uuid!==(null==p?void 0:p.uuid))return{label:e.name,selected:e.selected}}).filter(e=>e)}).flat().filter(e=>e);C(e)},[H,p]);let Y=(0,i.useCallback)(e=>{let l=e.target.value;M(e=>({...e,name:l}))},[]),W=(0,i.useCallback)(e=>{var l;let t=e.target.value,a=k.find(e=>e.key===t),i=H[t],n=null===(l=i.children)||void 0===l?void 0:l.map(e=>({checked:!0,value:e.default}));M(e=>({...e,type:{key:a.key,label:a.label,children:a.children},values:n}))},[H,k]),V=(0,i.useCallback)((e,l)=>{M(t=>({...t,values:[...t.values.slice(0,e),{...t.values[e],value:l},...t.values.slice(e+1)]}))},[]),G=(0,i.useCallback)((e,l)=>{M(t=>({...t,values:[...t.values.slice(0,e),{...t.values[e],checked:l},...t.values.slice(e+1)]}))},[]),K=(0,i.useCallback)((e,l)=>{M(t=>({...t,values:[...t.values.slice(0,e),{...t.values[e],unit:l},...t.values.slice(e+1)]}))},[]),q=(0,i.useCallback)(e=>{M(l=>({...l,selected:e}))},[]),J=(0,i.useMemo)(()=>{var e;return(null==N?void 0:N.type)&&(null===(e=N.type)||void 0===e?void 0:e.children)?(0,a.jsx)(S.Z,{children:N.type.children.map((e,l)=>{var t;if(2!==z||!e.only3D)return(0,a.jsx)(BoundaryConditionItem,{dimension:z,variables:D,boundaryCondition:e,index:l,value:String(N.values[l].value),checked:N.type.children.length>1?N.values[l].checked:void 0,unit:null!==(t=N.values[l].unit)&&void 0!==t?t:e.unit,_onValueChange:V,_onCheckedChange:G,_onUnitChange:K},e.label)})}):null},[N,z,D,G,V,K]),$=(0,i.useCallback)(e=>{L(e);let l=v.find(l=>l.id===e);F((0,et.rx)(null==l?void 0:l.summary.uuid)),M(l=>({...l,geometry:e}))},[v,F]),Q=(0,i.useCallback)(()=>{M(void 0),g()},[g]);return(0,a.jsx)(ei.Z,{className:eg().subPanel,title:"Boundary condition",placement:"left",closable:!1,open:h,mask:!1,maskClosable:!1,width:300,extra:(0,a.jsx)(T(),{type:"text",icon:(0,a.jsx)(en.default,{}),onClick:Q}),footer:(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,a.jsx)(x.Lw,{onCancel:Q}),p?(0,a.jsx)(boundaryConditions_edit,{boundaryCondition:{uuid:null!==(t=null==N?void 0:N.uuid)&&void 0!==t?t:p.uuid,name:null!==(n=null==N?void 0:N.name)&&void 0!==n?n:p.name,type:null!==(s=null==N?void 0:N.type)&&void 0!==s?s:p.type,geometry:null!==(o=null==N?void 0:N.geometry)&&void 0!==o?o:p.geometry,selected:null!==(u=null==N?void 0:N.selected)&&void 0!==u?u:p.selected,values:null!==(d=null==N?void 0:N.values)&&void 0!==d?d:p.values},oldBoundaryCondition:{uuid:p.uuid,name:p.name,type:p.type,geometry:p.geometry,selected:p.selected,values:p.values},simulation:{id:y.id,scheme:y.scheme},swr:{mutateOneSimulation:f.mutateOneSimulation},onError:U,onClose:g}):(0,a.jsx)(boundaryConditions_add,{boundaryCondition:{name:null==N?void 0:N.name,type:null==N?void 0:N.type,geometry:null==N?void 0:N.geometry,selected:null==N?void 0:N.selected,values:null==N?void 0:N.values},simulation:{id:y.id,scheme:y.scheme},swr:{mutateOneSimulation:f.mutateOneSimulation},onError:U,onClose:g})]}),children:(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,children:[(0,a.jsx)(S.Z,{size:"small",children:(0,a.jsx)(I.Z,{layout:"vertical",children:(0,a.jsx)(I.Z.Item,{label:(0,a.jsx)(c.Z.Text,{strong:!0,children:"Boundary condition name"}),children:(0,a.jsx)(A.default,{value:null!==(m=null==N?void 0:N.name)&&void 0!==m?m:"",onChange:Y,maxLength:50})})})}),(0,a.jsx)(S.Z,{size:"small",children:(0,a.jsx)(I.Z,{layout:"vertical",children:(0,a.jsx)(I.Z.Item,{label:(0,a.jsx)(c.Z.Text,{strong:!0,children:"Boundary condition type"}),children:(0,a.jsx)(B.default.Group,{optionType:"button",buttonStyle:"solid",value:null==N?void 0:null===(l=N.type)||void 0===l?void 0:l.key,onChange:W,children:null==k?void 0:k.map(e=>(0,a.jsx)(B.default.Button,{value:e.key,children:e.label},e.key))})})})}),J,(0,a.jsx)(r.default,{items:v.map(e=>({key:e.id,label:e.name,children:(0,a.jsx)(selector,{geometry:e,alreadySelected:j,updateSelected:q})})),activeKey:O,onChange:$}),R&&(0,a.jsxs)(c.Z.Text,{children:[(0,a.jsx)(es.Z,{style:{color:"red"}})," ",R]})]})})},ew=t(94704),eS=t(46650),e_=t(25256),eE=t(97935),eN=t(9470);let eT={name:"You need to define a name",point:"You need to select a point",formula:"You need to define a formula",update:"Unable to update simulation"},sensors_edit_onEdit=async(e,l,t,a)=>{try{let a=C.Z.deepCopy(e),i=a.scheme.configuration.run,n=l.index;delete l.index,i.sensors[n]=l,await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:i}]),await t.mutateOneSimulation(a)}catch(e){throw a((0,f.iT)({title:eT.update,err:e})),e}};var sensors_edit=e=>{let{simulation:l,sensor:t,onError:n,onClose:s,swr:o}=e,[u,r]=(0,i.useState)(),{dispatch:d}=(0,i.useContext)(p.uj),c=(0,i.useCallback)(()=>{(async()=>{r(!0);try{if(!t.name){n(eT.name),r(!1);return}if(!t.point){n(eT.point),r(!1);return}if(!t.formula){n(eT.formula),r(!1);return}n(),await sensors_edit_onEdit(l,t,o,d),r(!1),s()}catch(e){r(!1)}})()},[l,t,n,s,o,d]);return(0,a.jsx)(x.w6,{loading:u,primary:!0,needMargin:!0,onEdit:c,children:"Edit"})};let eM={name:"You need to define a name",point:"You need to select a point",formula:"You need to define a formula",update:"Unable to update simulation"},sensors_add_onAdd=async(e,l,t,a)=>{try{var i;let a=C.Z.deepCopy(e),n=a.scheme.configuration.run,s={...n,sensors:[...null!==(i=n.sensors)&&void 0!==i?i:[],l]};await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:s}]),await t.mutateOneSimulation(a)}catch(e){throw a((0,f.iT)({title:eM.update,err:e})),e}};var sensors_add=e=>{let{simulation:l,sensor:t,onError:n,onClose:s,swr:o}=e,[u,r]=(0,i.useState)(),{dispatch:d}=(0,i.useContext)(p.uj),c=(0,i.useCallback)(()=>{(async()=>{r(!0);try{if(!t.name){n(eM.name),r(!1);return}if(!t.point){n(eM.point),r(!1);return}if(!t.formula){n(eM.formula),r(!1);return}n(),await sensors_add_onAdd(l,t,o,d),r(!1),s()}catch(e){r(!1)}})()},[l,t,n,s,o,d]);return(0,a.jsx)(x.HS,{loading:u,needMargin:!0,onAdd:c,children:"Add"})},sensors_sensor=e=>{var l,t,n;let{visible:s,geometries:o,simulation:u,sensor:m,onClose:h,swr:v}=e,[y,p]=(0,i.useState)(),[f,g]=(0,i.useState)(),[j,C]=(0,i.useState)(),[k,Z]=(0,i.useState)(),w=(0,i.useMemo)(()=>u.scheme.configuration.dimension,[u]),E=(0,i.useMemo)(()=>u.scheme.variables,[u]),{point:N,dispatch:M}=(0,i.useContext)(el.ZB);(0,b.Z)(()=>{var e;M((0,et.rx)(null===(e=o[0])||void 0===e?void 0:e.summary.uuid)),C(null==m?void 0:m.geometry)},[o,m],[M]),(0,b.Z)(()=>{M((0,et.Cw)("point"))},[M]),(0,b.Z)(()=>{if(!m){let e=u.scheme.configuration.run;g(l=>({...l,name:"Sensor "+(e.sensors?e.sensors.length+1:1)}))}},[u,m]),(0,b.Z)(()=>{m&&(g(m),M((0,et.N7)({x:m.point.x,y:m.point.y,z:m.point.z})))},[m],[M]),(0,b.Z)(()=>{N&&g(e=>({...e,point:N}))},[N]);let O=(0,i.useCallback)(()=>{p(!1),M((0,et.h$)()),window.removeEventListener("click",O)},[M]),L=(0,i.useCallback)(()=>{y?O():(p(!0),M((0,et.wp)()),setTimeout(()=>window.addEventListener("click",O),50))},[y,O,M]),I=(0,i.useCallback)(e=>{C(e);let l=o.find(l=>l.id===e);M((0,et.rx)(l.summary.uuid)),g(l=>({...l,geometry:e}))},[o,M]),R=(0,i.useCallback)((e,l,t)=>{M((0,et.N7)({x:e,y:l,z:t}))},[M]),U=(0,i.useCallback)(e=>{g(l=>({...l,formula:e}))},[]),F=(0,i.useCallback)(()=>{g(void 0),Z(void 0),M((0,et.N7)()),M((0,et.h$)()),h()},[M,h]),D=(0,i.useCallback)(e=>{g(l=>({...l,name:e.target.value}))},[]),H=(0,i.useCallback)(e=>{var l,t;return R(+e,null!==(l=null==N?void 0:N.y)&&void 0!==l?l:0,null!==(t=null==N?void 0:N.z)&&void 0!==t?t:0)},[N,R]),z=(0,i.useCallback)(e=>{var l,t;return R(null!==(l=null==N?void 0:N.x)&&void 0!==l?l:0,+e,null!==(t=null==N?void 0:N.z)&&void 0!==t?t:0)},[N,R]),Y=(0,i.useCallback)(e=>{var l,t;return R(null!==(l=null==N?void 0:N.x)&&void 0!==l?l:0,null!==(t=null==N?void 0:N.y)&&void 0!==t?t:0,+e)},[N,R]);return(0,a.jsx)(ei.Z,{title:"Sensor",placement:"left",closable:!1,open:s,mask:!1,maskClosable:!1,width:300,extra:(0,a.jsx)(T(),{type:"text",icon:(0,a.jsx)(en.default,{}),onClick:F}),footer:(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,a.jsx)(x.Lw,{onCancel:F}),m?(0,a.jsx)(sensors_edit,{simulation:u,sensor:{...m,...f},onError:Z,onClose:F,swr:v}):(0,a.jsx)(sensors_add,{simulation:u,sensor:f,onError:Z,onClose:F,swr:v})]}),children:(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,children:[(0,a.jsxs)(S.Z,{size:"small",children:[(0,a.jsx)(c.Z.Text,{children:"Name"}),(0,a.jsx)(A.default,{value:null==f?void 0:f.name,onChange:D})]}),(0,a.jsxs)(S.Z,{size:"small",children:[(0,a.jsx)(r.default,{items:o.map(e=>({key:e.id,label:e.name})),activeKey:j,onChange:I}),(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,children:[(0,a.jsxs)(_.default,{className:P().fullWidth,style:{justifyContent:"space-between"},children:[(0,a.jsx)(c.Z.Text,{children:"Point selection"}),(0,a.jsx)(d.default,{title:"Pin in the geometry",children:(0,a.jsx)(T(),{size:"small",type:y?"primary":"default",icon:(0,a.jsx)(eN.Z,{}),onClick:L})})]}),(0,a.jsx)(formula,{label:"X",noLarge:!0,defaultValue:null==f?void 0:null===(l=f.point)||void 0===l?void 0:l.x,onValueChange:H}),(0,a.jsx)(formula,{label:"Y",noLarge:!0,defaultValue:null==f?void 0:null===(t=f.point)||void 0===t?void 0:t.y,onValueChange:z}),(0,a.jsx)(formula,{label:"Z",noLarge:!0,defaultValue:null==f?void 0:null===(n=f.point)||void 0===n?void 0:n.z,onValueChange:Y})]})]}),(0,a.jsx)(S.Z,{size:"small",className:P().noBorderBottom,children:(0,a.jsx)(formula,{label:"Formula",dimension:w,defaultValue:null==f?void 0:f.formula,additionalKeywords:E,onValueChange:U})}),k&&(0,a.jsxs)(c.Z.Text,{children:[(0,a.jsx)(es.Z,{style:{color:"red"}})," ",k]})]})})};let eO={update:"Unable to update simulation"},sensors_delete_onDelete=async(e,l,t,a,i)=>{try{let i=C.Z.deepCopy(e),n=i.scheme.configuration.run;a((0,et.N7)()),n.sensors=[...n.sensors.slice(0,l),...n.sensors.slice(l+1)],await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:n}]),await t.mutateOneSimulation(i)}catch(e){throw i((0,f.iT)({title:eO.update,err:e})),e}};var sensors_delete=e=>{let{simulation:l,index:t,swr:n}=e,[s,o]=(0,i.useState)(),{dispatch:u}=(0,i.useContext)(el.ZB),{dispatch:r}=(0,i.useContext)(p.uj),d=(0,i.useMemo)(()=>l.scheme.configuration.run,[l]),m=(0,i.useMemo)(()=>d.sensors[t],[t,d]),h=(0,i.useCallback)(async()=>{o(!0);try{await sensors_delete_onDelete(l,t,n,u,r)}finally{o(!1)}},[l,t,n,u,r]);return(0,a.jsx)(x.m1,{loading:s,text:(0,a.jsxs)(a.Fragment,{children:["Are you sure you want to delete the sensor"," ",(0,a.jsx)(c.Z.Text,{strong:!0,children:m.name})]}),onDelete:h})};let sensors_list_ListItem=e=>{let{simulation:l,sensor:t,index:n,_onEdit:s,swr:o}=e,{dispatch:u}=(0,i.useContext)(el.ZB),r=(0,i.useCallback)(()=>{u((0,et.wp)()),u((0,et.N7)(t.point))},[t,u]),d=(0,i.useCallback)(()=>{u((0,et.h$)())},[u]),m=(0,i.useCallback)(()=>s({...t,index:n}),[t,n,s]);return(0,a.jsx)(S.Z,{className:"".concat(P().textAlignCenter," ").concat(Q().listItem),hoverable:!0,onMouseEnter:r,onMouseLeave:d,actions:[(0,a.jsx)(x.w6,{onEdit:m},"edit"),(0,a.jsx)(sensors_delete,{simulation:l,index:n,swr:o},"delete")],children:(0,a.jsx)(c.Z.Text,{strong:!0,className:P().textAlignCenter,children:t.name})})};var sensors_list=e=>{var l;let{simulation:t,onEdit:n,swr:s}=e,o=(0,i.useMemo)(()=>t.scheme.configuration.run,[t]);return(0,a.jsx)(a.Fragment,{children:null===(l=o.sensors)||void 0===l?void 0:l.map((e,l)=>(0,a.jsx)(sensors_list_ListItem,{simulation:t,sensor:e,index:l,_onEdit:n,swr:s},e.name))})},sensors=e=>{let{geometries:l,simulation:t,setVisible:n,setResults:s,setPostprocessing:o,swr:u}=e,[r,d]=(0,i.useState)(),[c,m]=(0,i.useState)(),h=(0,i.useCallback)(()=>{s([]),o(void 0),m(void 0),n(!1),d(!0)},[n,s,o]),v=(0,i.useCallback)(e=>{s([]),o(void 0),m(e),n(!1),d(!0)},[n,s,o]),y=(0,i.useCallback)(()=>{m(void 0),n(!0),d(!1)},[n]);return(0,a.jsxs)(S.Z,{size:"small",title:"Sensors",children:[(0,a.jsx)(sensors_sensor,{visible:r,geometries:l,simulation:t,sensor:c,onClose:y,swr:u}),(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,children:[(0,a.jsx)(T(),{className:P().fullWidth,disabled:!1,type:"primary",icon:(0,a.jsx)(eE.Z,{}),onClick:h,children:"Add a sensor"}),(0,a.jsx)(sensors_list,{simulation:t,onEdit:v,swr:u})]})]})},eP=t(5152),eL=t.n(eP),eI=t(11163),eA=t(72078),eR=t(9160),eU=t(66769);let eF={plugins:"Plugins error",pluginsLoad:"Unable to load plugins",extra:"Unable to execute extra action"},_onExtra=async(e,l,t)=>{try{await eU.Z.extra(e,l)}catch(e){t((0,f.iT)({title:eF.extra,err:e}))}},Plugin=e=>{let{plugin:l,onOk:n,setVisible:s}=e,o=eL()(()=>t(64546)("./".concat(l.key,"/src/components"))),u=(0,i.useCallback)(e=>{(async()=>{y()(l,e),await n(l),s(!1)})()},[l,n,s]);return(0,a.jsx)(S.Z,{title:l.configuration.name.value,children:(0,a.jsx)(o,{data:l.data,onSelect:u})},l.uuid)},Plugins=e=>{let{pluginsList:l,plugins:t,onOk:i,setVisible:n}=e;return(null==t?void 0:t.length)?(0,a.jsx)(_.default,{align:"start",direction:"horizontal",wrap:!0,children:t.map(e=>{let t=l.find(l=>l.key===e.key);return t?(0,a.jsx)(Plugin,{plugin:e,onOk:i,setVisible:n},e.uuid):null})}):null};var cloudServer=e=>{let{disabled:l,cloudServer:t,onOk:n}=e,[s,u]=(0,i.useState)(!1),[r,m]=(0,i.useState)([]),{dispatch:h}=(0,i.useContext)(p.uj),v=(0,eI.useRouter)(),[y,{errorPlugins:b}]=eU.Z.usePlugins();(0,i.useEffect)(()=>{b&&h((0,f.iT)({title:eF.plugins,err:b}))},[b,h]),(0,i.useEffect)(()=>{(async()=>{try{let e=await Z.Z.list();m(e)}catch(e){h((0,f.iT)({title:eF.pluginsLoad,err:e}))}})()},[h]);let g=(0,i.useCallback)(()=>u(!0),[]),j=(0,i.useCallback)(()=>u(!1),[]),C=(0,i.useCallback)(()=>{(async()=>{await v.push({pathname:"/dashboard",query:{page:"account",tab:"hpc"}})})()},[v]),k=(0,i.useCallback)(e=>{(async()=>{await _onExtra(t,e,h)})()},[t,h]),w=(0,i.useMemo)(()=>{let e=null==t?void 0:t.extra;if(!e)return(0,a.jsx)(a.Fragment,{});let l=Object.keys(e).map(l=>{let t=e[l],i="cloud-download"===t.icon?(0,a.jsx)(eA.Z,{}):null;if("button"===t.type)return(0,a.jsx)(d.default,{title:t.label,children:(0,a.jsx)(T(),{icon:i,onClick:()=>k(t.action)})},t.action)});return(0,a.jsxs)("div",{children:["Custom plugin actions:",(0,a.jsx)("br",{}),l]})},[null==t?void 0:t.extra,k]);return(0,a.jsxs)(S.Z,{size:"small",title:"Computational resource",children:[(0,a.jsx)(o.Z,{open:s,title:"Computational resource",okButtonProps:{disabled:!0,style:{display:"none"}},onCancel:j,style:{width:"unset"},children:(0,a.jsxs)(_.default,{direction:"vertical",children:[(0,a.jsxs)(c.Z.Text,{children:["Your computational resource does not appear in this list? Create one in your"," ",(0,a.jsx)(x.Qj,{onClick:C,children:"account settings"})]}),(0,a.jsx)(Plugins,{pluginsList:r,plugins:y,onOk:n,setVisible:u})]})}),(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,children:[t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c.Z.Text,{children:[(0,a.jsx)("span",{className:P().textLight,children:"Plugin:"})," ",t.name]}),(0,a.jsxs)(c.Z.Text,{children:[(0,a.jsx)("span",{className:P().textLight,children:"Name:"})," ",t.configuration.name.value]}),Object.keys(t.inUseConfiguration).map(e=>{let l=t.inUseConfiguration[e],i=l.value;return"boolean"==typeof i&&(i=i?"yes":"no"),(0,a.jsxs)(c.Z.Text,{children:[(0,a.jsxs)("span",{className:P().textLight,children:[l.label,":"]})," ",i]},e)})]}),(0,a.jsx)(T(),{className:P().fullWidth,disabled:l,type:t?"link":"primary",icon:(0,a.jsx)(eR.Z,{}),onClick:g,children:t?"Modify the resource":"Select a resource"}),w]})]})},eD=t(75624),eH=t(47311),ez=t(48764).lW;let eY={log:"Unable to get system log"},_getCompleteLog=async(e,l,t)=>{try{let t=await k.Z.log({id:e.id},l.systemLog),i=ez.from(t.log).toString();o.Z.info({title:"System log",width:"unset",content:(0,a.jsx)("div",{style:{maxHeight:"70vh",overflow:"auto"},children:(0,a.jsx)("pre",{children:(0,a.jsx)("code",{children:(0,eH.ZP)(i.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))})})})})}catch(e){t((0,f.iT)({title:eY.log,err:e}))}},Step=e=>{var l,t,n,s;let{simulation:o,step:u,loading:r,setLoading:d}=e,{dispatch:m}=(0,i.useContext)(p.uj),h=(0,i.useCallback)(()=>{(async()=>{d(!0);try{await _getCompleteLog(o,u,m)}catch(e){}finally{d(!1)}})()},[o,u,d,m]),v=(0,i.useMemo)(()=>{let e=[];return u.warning&&e.push({key:"warnings",className:Q().warning,label:(0,a.jsx)(c.Z.Text,{type:"warning",children:"Warnings"}),children:(0,eH.ZP)(u.warning.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))}),u.error&&e.push({key:"errors",className:Q().error,label:(0,a.jsx)(c.Z.Text,{type:"danger",children:"Errors"}),children:(0,eH.ZP)(u.error.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))}),e},[u]);return(0,a.jsxs)(a.Fragment,{children:[u.systemLog&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T(),{loading:r,onClick:h,children:"Complete log"}),(0,a.jsx)("br",{})]}),u.link&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("a",{href:"https://"+u.link.href,target:"_blank",rel:"noreferrer",children:(0,a.jsx)(T(),{type:"primary",children:u.link.label})}),(0,a.jsx)("br",{})]}),(0,a.jsx)(Y.Z,{ghost:!0,items:v}),(0,eH.ZP)(null!==(n=null===(l=u.pluginLog)||void 0===l?void 0:l.replace(/\n\n/g,"\n").replace(/\n/g,"<br />").replace(/Warning:/g,'<span style="color: orange; font-weight: bold;">Info: </span>').replace(/Error:/g,'<span style="color: red; font-weight: bold;">Error:</span>'))&&void 0!==n?n:""),(0,eH.ZP)(null!==(s=null===(t=u.log)||void 0===t?void 0:t.replace(/^PERCENT.*\n?/gm,"").replace(/Info\s*:/g,'<span style="color: blue; font-weight: bold;">Info: </span>').replace(/Error:/g,'<span style="color: red; font-weight: bold;">Error:</span>').replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))&&void 0!==s?s:"")]})};var log=e=>{let{simulation:l,steps:t}=e,[n,s]=(0,i.useState)(!1),[o,u]=(0,i.useState)(!1),c=(0,i.useCallback)(()=>s(!0),[]),m=(0,i.useCallback)(()=>s(!1),[]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ei.Z,{title:"Log",open:n,onClose:m,width:"50%",children:(0,a.jsx)(r.default,{items:null==t?void 0:t.map((e,t)=>({key:""+t,label:e.label,children:(0,a.jsx)(Step,{simulation:l,step:e,loading:o,setLoading:u})}))})}),(0,a.jsx)(d.default,{title:"Log",children:(0,a.jsx)(T(),{disabled:!(null==t?void 0:t.length),icon:(0,a.jsx)(eD.Z,{}),onClick:c})})]})},eB=t(42419),eW=t(34265),eV=t(30744),eG=t(85615);let eK={download:"Unable to download file"},_onDownload=async(e,l,t)=>{try{let t=await eG.Z.download({id:e.id},{originPath:l.originPath,fileName:l.fileName}),a=await t.blob(),i=window.URL.createObjectURL(new Blob([a])),n=document.createElement("a");n.href=i,n.setAttribute("download",l.name+"."+l.fileName.split(".").pop()),n.click()}catch(e){t((0,f.iT)({title:eK.download,err:e}))}};var download=e=>{let{simulation:l,file:t}=e,[n,s]=(0,i.useState)(!1),{dispatch:o}=(0,i.useContext)(p.uj),u=(0,i.useCallback)(()=>{(async()=>{s(!0);try{await _onDownload(l,t,o)}catch(e){}finally{s(!1)}})()},[l,t,o]);return(0,a.jsx)(d.default,{title:"Download",children:(0,a.jsx)(T(),{loading:n,icon:(0,a.jsx)(eV.default,{}),onClick:u})})};let eq={archive:"Unable to download archive"},_onArchive=async(e,l)=>{try{let l=await eG.Z.archive({id:e.id}),t=await l.blob(),a=window.URL.createObjectURL(new Blob([t])),i=document.createElement("a");i.href=a,i.setAttribute("download",e.scheme.name+".zip"),i.click()}catch(e){l((0,f.iT)({title:eq.archive,err:e}))}};var archive=e=>{let{simulation:l}=e,[t,n]=(0,i.useState)(!1),{dispatch:s}=(0,i.useContext)(p.uj),o=(0,i.useCallback)(()=>{(async()=>{n(!0);try{await _onArchive(l,s)}catch(e){}finally{n(!1)}})()},[l,s]);return(0,a.jsx)(x.o6,{loading:t,onDownload:o})};let SingleResult=e=>{var l;let{simulation:t,results:n,file:s,setResults:o}=e,u=(0,i.useCallback)(()=>{let e=n.findIndex(e=>e.fileName===s.fileName&&e.name===s.name);if(-1===e){let e=s.geometry,l=n.filter(l=>l.geometry!==e);o([...l,s])}else o([...n.slice(0,e),...n.slice(e+1)])},[n,s,o]),r=(0,i.useMemo)(()=>n.find(e=>e.fileName===s.fileName&&e.name===s.name),[n,s]);return(0,a.jsxs)(_.default,{style:{alignItems:"center"},children:[(0,a.jsx)(T(),{icon:r?(0,a.jsx)(eB.default,{style:{color:"#fad114"}}):(0,a.jsx)(eW.default,{}),onClick:u}),(0,a.jsx)(download,{simulation:{id:t.id},file:{name:s.name,fileName:s.fileName,originPath:s.originPath}}),null===(l=s.name)||void 0===l?void 0:l.replaceAll("_"," ")]})};var run_results=e=>{let{simulation:l,results:t,setResults:n}=e,[s,o]=(0,i.useState)(),[r,d]=(0,i.useState)(),[c,m]=(0,i.useState)(),h=(0,i.useMemo)(()=>{var e;return null==l?void 0:null===(e=l.scheme)||void 0===e?void 0:e.configuration},[l]);(0,b.Z)(()=>{var e;if(!(null==l?void 0:l.tasks)){o([]),d(void 0);return}let t=[],a=null==h?void 0:null===(e=h.run)||void 0===e?void 0:e.resultsFilter;l.tasks.forEach(e=>{if(e.file&&t.push(e.file),e.files){if(a){let l=new RegExp(a.pattern),i=e.files.filter(e=>!l.test(e.fileName)),n=e.files.filter(e=>l.test(e.fileName)),s=getFilesNumbers(n,a),o=s.map(e=>e.number).filter((e,l,t)=>t.indexOf(e)===l).sort((e,l)=>e-l),u=getMultiplicator(h,a),r=o.map((e,l)=>({label:Math.round(1e15*(u?e*u:l))/1e15,value:e}));t.push(...i),d({filtered:!0,name:a.name,files:s,options:r})}else t.push(...e.files)}}),o(t)},[l,h]),(0,b.Z)(()=>{!c&&r&&m(null==r?void 0:r.options[0].value)},[r,c]);let v=(0,i.useCallback)(e=>{let l=r.files.filter(l=>l.number===e&&t.find(e=>e.name===l.name));n(l),m(e)},[t,r,n]);return s||r?(null==s?void 0:s.length)||r?(0,a.jsx)(S.Z,{size:"small",title:"Results",extra:(0,a.jsx)(archive,{simulation:l&&{id:l.id,scheme:l.scheme}}),children:(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,children:[null==s?void 0:s.map(e=>(0,a.jsx)(SingleResult,{simulation:l,results:t,file:e,setResults:n},e.name)),r&&(0,a.jsxs)(a.Fragment,{children:[r.name,(0,a.jsx)(u.default,{className:P().fullWidth,options:r.options,value:c,onChange:v}),r.files.map(e=>{if(e.number===c)return(0,a.jsx)(SingleResult,{simulation:l,results:t,file:e,setResults:n},e.name)})]})]})}):(0,a.jsx)(S.Z,{size:"small",children:"No results yet"}):(0,a.jsx)(E.default,{})};let eJ={run:"Unable to run simulation",stop:"Unable to stop simulation",update:"Unable to update simulation"},_onCloudServer=async(e,l,t,a)=>{try{let a=C.Z.deepCopy(e),i=e.scheme.configuration;i.run.cloudServer=l,a.scheme.configuration=i,await k.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:i.run}]),await t.mutateOneSimulation(a),await t.mutateSimulation(a)}catch(e){a((0,f.iT)({title:eJ.update,err:e}))}},_onRun=async(e,l,t)=>{try{await k.Z.run({id:e.id},t)}catch(e){throw l((0,f.iT)({title:eJ.run,err:e})),e}},_onStop=async(e,l)=>{try{await k.Z.stop({id:e.id})}catch(e){throw l((0,f.iT)({title:eJ.stop,err:e})),e}};var e$=t(31709),eQ=[{key:"warpByVector",label:"Warp by vector",parameters:[{key:"Vectors",label:"Vectors",rules:[{required:!0,message:"Vectors is required"}]},{key:"ScaleFactor",label:"Scale factor",default:"1",rules:[{required:!0,message:"Scale factor is required"}]}]},{key:"contour",label:"Contour",parameters:[{key:"ContourBy",label:"Contour by",rules:[{required:!0,message:"ContourBy by is required"}]},{key:"isosurface",label:"Isosurface",default:"0",rules:[{required:!0,message:"Isosurface is required"}]}]},{key:"streamTracer",label:"Stream tracer",parameters:[{key:"Vectors",label:"Vectors",rules:[{required:!0,message:"Vectors is required"}]}]}],eX=t(948);let run_run=async(e,l,t,a)=>{let i=await (0,eX.R)("/api/postprocessing",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({simulation:e,result:l,filter:t,parameters:a})});return i.json()};var e0={run:run_run},e1=t(1751),e5=t.n(e1);let e2={run:"Unable to run filter"},_run=async(e,l,t,a,i)=>{try{return await e0.run(e,l,t,a)}catch(e){throw i((0,f.iT)({title:e2.run,err:e})),e}},Result=e=>{let{simulation:l,postprocessing:t,result:n,setResult:s}=e,o=(0,i.useCallback)(()=>s((null==t?void 0:t.fileName)===n.fileName&&(null==t?void 0:t.name)===n.name?void 0:{type:"postprocessing",...n}),[t,n,s]);return(0,a.jsxs)(_.default,{children:[(0,a.jsx)(T(),{icon:(null==t?void 0:t.fileName)===n.fileName&&(null==t?void 0:t.name)===n.name?(0,a.jsx)(eB.default,{className:P().primaryColor}):(0,a.jsx)(eW.default,{}),onClick:o}),(0,a.jsx)(download,{simulation:{id:l.id},file:{name:n.name,fileName:n.fileName,originPath:n.originPath}}),n.name]},n.glb)},postprocessing_Results=e=>{let{simulation:l,postprocessing:t,results:i,setResult:n}=e;return i.length?(0,a.jsx)(_.default,{direction:"vertical",className:P().fullWidth,children:i.map(e=>(0,a.jsx)(Result,{simulation:l,postprocessing:t,result:e,setResult:n},e.glb))}):(0,a.jsx)(a.Fragment,{children:"No results"})},e3={plugins:"Unable to load plugins",update:"Unable to update simulation"},_pluginsList=async(e,l)=>{try{let l=await Z.Z.list();return _loadModels(e,j.Z,l)}catch(e){return l((0,f.iT)({title:e3.plugins,err:e})),[]}},_loadModels=(e,l,t)=>{let a=l;return t.forEach(l=>{var t;(null===(t=e.authorizedplugins)||void 0===t?void 0:t.includes(l.key))&&"Model"===l.category&&(a=[...a,...l.models])}),a},_isInCategories=(e,l)=>{if(!(null==l?void 0:l.length))return!0;if(Array.isArray(e)){let t=l.filter(l=>e.includes(l));return t.length==l.length}return!!(1===l.length&&l.includes(e))},_onUpdate=async(e,l,t,a)=>{try{let a=l.find(l=>{var t;return l.algorithm===(null==e?void 0:null===(t=e.scheme)||void 0===t?void 0:t.algorithm)}),i=C.Z.deepCopy(e);y()(i.scheme,a),await k.Z.update({id:e.id},[{key:"scheme",value:i.scheme}]),await t.mutateOneSimulation(i)}catch(e){a((0,f.iT)({title:e3.update,err:e}))}};var e6={Selector:e=>{let{visible:l,user:t,title:m,okText:h,onOk:v,onCancel:y,onDelete:f}=e,[j,k]=(0,i.useState)(),[Z,w]=(0,i.useState)(),[S,_]=(0,i.useState)(!1),[E,N]=(0,i.useState)([]),[T,M]=(0,i.useState)(),[O,L]=(0,i.useState)([]),{dispatch:I}=(0,i.useContext)(p.uj);(0,b.Z)(()=>{(async()=>{let e=await _pluginsList(t,I);N(e)})()},[t],[I]),(0,b.Z)(()=>{let e=E.map(e=>e.category).flat().filter((e,l,t)=>t.indexOf(e)===l).map(e=>({key:e,value:e}));M(e)},[E]);let A=(0,i.useCallback)(e=>{let{key:l}=e;k(l);let t=E.find(e=>e.algorithm===l);w({model:t})},[E]),R=(0,i.useCallback)(e=>{let{key:l}=e,a=l.split("&").pop();k(a);let i=t.usermodels.find(e=>e.model.algorithm===a);w(C.Z.deepCopy(i))},[t]),U=(0,i.useCallback)(()=>{(async()=>{if(_(!0),Z)try{await v(Z)}catch(e){}_(!1),w(void 0),k(void 0)})()},[Z,v]),F=(0,i.useCallback)(()=>{w(void 0),k(void 0),y()},[y]),D=(0,i.useMemo)(()=>{let e=[{key:"category",disabled:!0,label:(0,a.jsx)(u.default,{mode:"multiple",className:P().fullWidth,options:T,allowClear:!0,suffixIcon:null,placeholder:"Category filter",onChange:L,value:O,style:{textOverflow:"ellipsis"}})}];return E.forEach(l=>{_isInCategories(l.category,O)&&e.push({key:l.algorithm,label:l.name})}),e},[E,T,O]),H=(0,i.useMemo)(()=>{let e=[{key:"category",disabled:!0,label:(0,a.jsx)(u.default,{mode:"multiple",className:P().fullWidth,options:T,allowClear:!0,suffixIcon:null,placeholder:"Category filter",onChange:L,value:O})}];return t.usermodels.forEach((l,i)=>{_isInCategories(l.model.category,O)&&e.push({key:l.id+"&"+l.model.algorithm,label:(0,a.jsxs)(a.Fragment,{children:[f?(0,a.jsx)(x.m1,{onDelete:async()=>f(i)}):null,(0,a.jsx)(d.default,{title:l.model.name,children:(0,a.jsx)(c.Z.Text,{ellipsis:!0,children:l.model.name})}),l.owners.find(e=>e.id===t.id)?null:(0,a.jsx)("div",{className:"shared",children:C.Z.userToAvatar(l.owners[0])})]})})}),e},[t,T,O,f]);return(0,a.jsx)(o.Z,{open:l,title:null!=m?m:"Create simulation",okText:null!=h?h:"Create",okButtonProps:{loading:S},onOk:U,onCancel:F,width:"80%",children:(0,a.jsxs)(n.Z,{className:Q().selectorContent,children:[(0,a.jsx)(n.Z.Sider,{theme:"light",width:300,className:Q().selectorSider,children:(0,a.jsx)(r.default,{defaultActiveKey:"tanatloc",items:[{key:"tanatloc",label:"Tanatloc algorithm",children:(0,a.jsx)(s.default,{selectedKeys:j?[j]:void 0,mode:"inline",items:D,onClick:A})},{key:"personal",label:"User algorithm",children:(0,a.jsx)(s.default,{selectedKeys:j?[j]:void 0,mode:"inline",className:Q().userMenu,items:H,onClick:R})}]})}),(0,a.jsx)(n.Z.Content,{className:Q().selector,children:(0,a.jsx)(g.Z.Html,{html:null==Z?void 0:Z.model.description})})]})})},Updater:e=>{let{user:l,simulation:t,swr:a}=e,[n,s]=(0,i.useState)([]),{dispatch:u}=(0,i.useContext)(p.uj);return(0,b.Z)(()=>{(async()=>{let e=await _pluginsList(l,u);s(e)})()},[l],[u]),(0,b.Z)(()=>{let e=n.find(e=>{var l;return e.algorithm===(null==t?void 0:null===(l=t.scheme)||void 0===l?void 0:l.algorithm)});if(e&&(null==t?void 0:t.scheme)){let l=(0,m.Z)(t.scheme,e,{excludedKeys:["value","unit"]}),i=(0,h.Z)(t.scheme,e,{excludedKeys:["value","unit"]});(Object.keys(l).length||Object.keys(i).length)&&(o.Z.info({title:"Update",content:"Your model need an update, please wait.",closable:!1,okButtonProps:{hidden:!0}}),_onUpdate(t,n,a,u).finally(()=>o.Z.destroyAll()))}},[t,n,a]),null},About:e=>{let{project:l,simulation:t,swr:i}=e;return l&&t?(0,a.jsx)(n.Z,{children:(0,a.jsx)(n.Z.Content,{children:(0,a.jsx)(S.Z,{size:"small",title:(0,a.jsx)(c.Z.Title,{level:5,ellipsis:!0,children:t.name}),actions:[(0,a.jsx)(copy,{project:{id:l.id,simulations:l.simulations},simulation:t,swr:{mutateProject:i.mutateProject,addOneSimulation:i.addOneSimulation}},"copy"),(0,a.jsx)(edit,{simulation:{id:t.id,name:t.name},swr:{mutateOneSimulation:i.mutateOneSimulation}},"edit"),(0,a.jsx)(simulation_delete,{project:{id:l.id,simulations:l.simulations},simulation:{id:t.id,name:t.name},swr:{mutateProject:i.mutateProject,delOneSimulation:i.delOneSimulation}},"delete")],children:(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,children:[t.scheme.userModelId&&(0,a.jsx)(w.Z,{message:"User algorithm",type:"info",showIcon:!0}),(0,a.jsxs)(c.Z.Text,{children:[(0,a.jsx)("span",{className:P().textLight,children:"Category:"})," ",t.scheme.category]}),(0,a.jsxs)(c.Z.Text,{children:[(0,a.jsx)("span",{className:P().textLight,children:"Algorithm:"})," ",t.scheme.algorithm]}),(0,a.jsxs)(c.Z.Text,{children:[(0,a.jsx)("span",{className:P().textLight,children:"Code:"})," ",t.scheme.code]}),(0,a.jsxs)(c.Z.Text,{children:[(0,a.jsx)("span",{className:P().textLight,children:"Version:"})," ",t.scheme.version]}),(0,a.jsx)("div",{className:"".concat(P().fullWidth," ").concat(P().scroll),children:(0,a.jsx)(g.Z.Html,{html:t.scheme.description})})]})})})}):(0,a.jsx)(S.Z,{children:(0,a.jsx)(E.default,{})})},Geometry:e=>{let{loadedGeometries:l,geometries:t,simulation:n,setGeometries:s,swr:o}=e,{dispatch:r}=(0,i.useContext)(p.uj),d=(0,i.useMemo)(()=>n.scheme.configuration.geometry.multiple,[n]),m=(0,i.useMemo)(()=>n.scheme.configuration.geometry.n,[n]),h=(0,i.useMemo)(()=>n.scheme.configuration.geometry.value,[n]),v=(0,i.useMemo)(()=>n.scheme.configuration.geometry.values,[n]);(0,b.Z)(()=>{(async()=>{d||h||!t.length?d&&!v&&t.length&&await _onMultipleSelect(n,l,t.map(e=>e.id),s,o,r):await _onSelect(n,l,t[0].id,s,o,r)})()},[d,h,v,l,t,o],[r]);let y=(0,i.useCallback)(e=>{(async()=>{d?await _onMultipleSelect(n,l,e,s,o,r):await _onSelect(n,l,e,s,o,r)})()},[d,l,n,s,o,r]),f=(0,i.useMemo)(()=>(0,a.jsx)("div",{className:Q().geometriesList,children:(0,a.jsx)(u.default,{mode:d?"multiple":void 0,options:l.map(e=>({value:e.id,label:e.name})),value:d?v:h,onChange:y})}),[d,h,v,y,l]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{size:"small",children:(0,a.jsx)(c.Z.Text,{children:"When changing the simulation domain, you might lose your topological entity assignments"})}),(0,a.jsxs)(S.Z,{size:"small",children:[(0,a.jsx)(c.Z.Text,{strong:!0,children:"Select a simulation domain"}),m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("br",{}),(0,a.jsxs)(c.Z.Text,{children:[m," geometries needed"]})]}):null]}),f,n.scheme.configuration.geometry.meshable&&(0,a.jsx)(mesh,{simulation:{id:n.id,scheme:n.scheme},swr:{mutateOneSimulation:o.mutateOneSimulation}})]})},Materials:e=>{let{geometries:l,simulation:t,swr:s,setVisible:o}=e,[u,r]=(0,i.useState)(),[d,c]=(0,i.useState)(!1),{dispatch:m}=(0,i.useContext)(el.ZB),h=(0,i.useMemo)(()=>t.scheme.configuration.materials,[t]);(0,b.Z)(()=>{var e;(null===(e=l[0])||void 0===e?void 0:e.summary)&&m((0,et.Cw)(2===l[0].summary.dimension?"faces":"solids"))},[l],[m]);let v=(0,i.useCallback)(()=>{r(void 0),c(!0),o(!1),m((0,et.wp)())},[m,o]),y=(0,i.useCallback)(e=>{let l=h.values[e];r(l),c(!0),o(!1),m((0,et.wp)())},[h,m,o]),p=(0,i.useCallback)(()=>{m((0,et.h$)()),c(!1),r(void 0),o(!0)},[m,o]);return l.length?(0,a.jsx)(n.Z,{children:(0,a.jsx)(n.Z.Content,{children:(0,a.jsxs)(S.Z,{size:"small",children:[(0,a.jsx)(x.HS,{onAdd:v,fullWidth:!0,primary:!1,children:"Add material"}),(0,a.jsx)(list,{geometries:l.map(e=>({id:e.id,summary:e.summary})),simulation:{id:t.id,scheme:t.scheme},swr:s,onEdit:y}),(0,a.jsx)(materials_material,{visible:d,geometries:l.map(e=>({id:e.id,name:e.name,summary:e.summary})),simulation:{id:t.id,scheme:t.scheme},material:u&&{uuid:u.uuid,material:u.material,geometry:u.geometry,selected:u.selected},swr:{mutateOneSimulation:s.mutateOneSimulation},onClose:p})]})})}):(0,a.jsx)(ee.Z.Simple,{})},Parameters:e=>{let{simulation:l,swr:t}=e,{dispatch:s}=(0,i.useContext)(p.uj),o=(0,i.useMemo)(()=>null==l?void 0:l.scheme.configuration.parameters,[l]),u=(0,i.useMemo)(()=>null==l?void 0:l.scheme.configuration.dimension,[l]);(0,i.useEffect)(()=>{(async()=>{(null==o?void 0:o.done)||await _onDone(l,t,s)})()},[l,o,t,s]);let r=(0,i.useMemo)(()=>Object.keys(o).map(e=>{if("index"===e||"title"===e||"done"==e)return null;let i=o[e];return i.advanced?null:(0,a.jsx)(Parameter,{simulation:l,dimension:u,pkey:e,parameter:i,swr:t},e)}).filter(e=>e),[l,u,o,t]),d=(0,i.useMemo)(()=>Object.keys(o).map(e=>{if("index"===e||"title"===e||"done"==e)return null;let i=o[e];return i.advanced?(0,a.jsx)(Parameter,{simulation:l,dimension:u,pkey:e,parameter:i,swr:t},e):null}).filter(e=>e),[l,u,o,t]);return(0,a.jsx)(n.Z,{children:(0,a.jsx)(n.Z.Content,{children:(0,a.jsxs)(_.default,{direction:"vertical",children:[r,d.length?(0,a.jsx)(Y.Z,{items:[{key:"advanced",label:"Advanced",children:(0,a.jsx)(_.default,{direction:"vertical",children:d})}]}):null]})})})},Initialization:e=>{let{simulations:l,simulation:t,swr:s}=e,[o,r]=(0,i.useState)(!1),[d,m]=(0,i.useState)(),[h,v]=(0,i.useState)(),[y,f]=(0,i.useState)(),{dispatch:g}=(0,i.useContext)(p.uj),x=(0,i.useMemo)(()=>null==t?void 0:t.scheme.configuration.initialization,[t]),j=(0,i.useMemo)(()=>null==t?void 0:t.scheme.configuration.dimension,[t]),C=(0,i.useCallback)(e=>{let t=l.find(l=>l.id===e);v(t)},[l]);(0,b.Z)(()=>{var e,l;!d&&x.value&&m(x.value.type),!h&&(null===(e=x.value)||void 0===e?void 0:e.simulation)&&C(null===(l=x.value)||void 0===l?void 0:l.simulation)},[x,d,h],[C]),(0,b.Z)(()=>{(async()=>{if(h){let e=await _loadResults(l,h.id);f(e)}})()},[l,h]);let k=(0,i.useMemo)(()=>{let e=[{label:"None",value:"none"}];return x.coupling&&e.push({label:x.coupling.label,value:"coupling"}),x.direct&&e.push({label:x.direct.label,value:"direct"}),e},[x]),Z=x.value,w=(0,i.useCallback)(e=>{(async()=>{r(!0);try{await _onCouplingChange(l,t,e,s,g),C(e)}catch(e){}finally{r(!1)}})()},[l,t,s,C,g]),N=(0,i.useCallback)((e,l)=>{(async()=>{await _onCouplingResultChange(t,e,l,s,g)})()},[t,s,g]),T=(0,i.useCallback)((e,l)=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Z.Text,{children:"If you use coupling, the selected simulation mesh will be used, at least for the first iteration."}),(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,style:{marginTop:"10px"},children:[(0,a.jsx)(u.default,{className:P().fullWidth,options:e,placeholder:"Select a simulation",value:null==Z?void 0:Z.simulation,onChange:w}),o&&(0,a.jsx)(E.default,{}),(null==y?void 0:y.length)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c.Z.Text,{children:[null==l?void 0:l.name,":"]},"simulation"),(0,a.jsx)(u.default,{className:P().fullWidth,options:y,placeholder:"Select a "+l.name,value:null==Z?void 0:Z.result,onChange:N})]}):(0,a.jsx)(c.Z.Text,{type:"danger",children:"No results, please select an other simulation."})]})]}),[Z,y,o,w,N]),M=(0,i.useCallback)(e=>(0,a.jsx)(_.default,{direction:"vertical",className:P().fullWidth,children:e.children.map((e,l)=>{var i;if(2!==j||!e.only3D)return(0,a.jsx)(DirectItem,{simulation:t,child:e,index:l,value:null==Z?void 0:null===(i=Z.values)||void 0===i?void 0:i[l],swr:s,dispatch:g},e.label)})}),[Z,j,t,s,g]),O=(0,i.useMemo)(()=>{let e={none:(0,a.jsx)("div",{})},i=x.coupling;if(null==i?void 0:i.compatibility){let a=l.map(e=>{let l=e.id===t.id||!i.compatibility.find(l=>l.algorithm===e.scheme.algorithm);return{label:e.name,value:e.id,disabled:l}}),n=i.compatibility.find(e=>{var l;return e.algorithm===(null==h?void 0:null===(l=h.scheme)||void 0===l?void 0:l.algorithm)}),s=null==n?void 0:n.filter;e.coupling=T(a,s)}let n=x.direct;return(null==n?void 0:n.children)&&(e.direct=M(n)),e},[l,t,h,x,T,M]),L=(0,i.useCallback)(e=>{(async()=>{try{await _onSelectorChange(t,e,s,g),m(e)}catch(e){}})()},[t,s,g]);return(0,a.jsx)(n.Z,{children:(0,a.jsx)(n.Z.Content,{children:(0,a.jsxs)(S.Z,{size:"small",children:[(0,a.jsx)(u.default,{className:P().fullWidth,style:{marginTop:"10px"},defaultValue:"none",value:d,options:k,onChange:L}),O[null!=d?d:"none"]]})})})},BoundaryConditions:e=>{let{simulation:l,geometries:t,swr:s,setVisible:o}=e,[u,r]=(0,i.useState)(),[d,c]=(0,i.useState)(!1),{dispatch:m}=(0,i.useContext)(el.ZB),h=(0,i.useMemo)(()=>l.scheme.configuration.boundaryConditions,[l]);(0,b.Z)(()=>{var e;(null===(e=t[0])||void 0===e?void 0:e.summary)&&m((0,et.Cw)(2===t[0].summary.dimension?"edges":"faces"))},[t],[m]);let v=(0,i.useCallback)(()=>{r(void 0),c(!0),o(!1),m((0,et.wp)())},[m,o]),y=(0,i.useCallback)((e,l)=>{let t=h[e],a=t.values[l];r(a),c(!0),o(!1),m((0,et.wp)())},[h,m,o]),p=(0,i.useCallback)(()=>{m((0,et.h$)()),c(!1),r(void 0),o(!0)},[m,o]);return t.length?(0,a.jsx)(n.Z,{children:(0,a.jsx)(n.Z.Content,{children:(0,a.jsxs)(S.Z,{size:"small",children:[(0,a.jsx)(x.HS,{onAdd:v,fullWidth:!0,primary:!1,children:"Add boundary condition"}),(0,a.jsx)(boundaryConditions_list,{geometries:t.map(e=>({id:e.id,summary:e.summary})),simulation:{id:l.id,scheme:l.scheme},swr:{mutateOneSimulation:s.mutateOneSimulation},onEdit:y}),(0,a.jsx)(boundaryConditions_boundaryCondition,{visible:d,geometries:t.map(e=>({id:e.id,name:e.name,summary:e.summary})),simulation:{id:l.id,scheme:l.scheme},boundaryCondition:u&&{uuid:u.uuid,name:u.name,type:u.type,geometry:u.geometry,selected:u.selected,values:u.values},swr:{mutateOneSimulation:s.mutateOneSimulation},onClose:p})]})})}):(0,a.jsx)(ee.Z.Simple,{})},Run:e=>{var l;let{geometries:t,simulation:s,results:o,setResults:u,setPostprocessing:r,setVisible:d,swr:c}=e,[m,h]=(0,i.useState)(!1),[v,y]=(0,i.useState)(!1),[f,g]=(0,i.useState)(!1),[x,j]=(0,i.useState)(!1),[C,Z]=(0,i.useState)([]),[w,N]=(0,i.useState)(0),{dispatch:M}=(0,i.useContext)(p.uj),[O,{mutateSimulation:L}]=k.Z.useSimulation(s.id,2e3),I=(0,i.useMemo)(()=>s.scheme.configuration,[s]),A=(0,i.useMemo)(()=>{var e;return null==O?void 0:null===(e=O.scheme)||void 0===e?void 0:e.configuration},[O]);(0,b.Z)(()=>{if(!I){h(!0);return}let e=!0;Object.keys(I).forEach(l=>{if("dimension"!==l&&"run"!==l){let t=I[l];t.done||(e=!1)}}),I.run.cloudServer||(e=!1),h(!e)},[I]),(0,i.useEffect)(()=>{var e;let l=null===(e=s.scheme.configuration)||void 0===e?void 0:e.geometry;(null==l?void 0:l.mesh)||(null==l?void 0:l.meshes)?g(!0):(g(!1),j(!1))},[s]),(0,b.Z)(()=>{var e,l,t;(null==O?void 0:null===(e=O.tasks)||void 0===e?void 0:e.find(e=>(null==e?void 0:e.status)==="error"))?y(!1):(null==O?void 0:null===(l=O.tasks)||void 0===l?void 0:l.find(e=>e&&"finish"!==e.status))?y(!0):y(!1);let a=[];null==O||null===(t=O.tasks)||void 0===t||t.forEach((e,l)=>{if(e){if(l===O.tasks.length-1){var t,i;let l=null!==(i=null===(t=e.log)||void 0===t?void 0:t.split("\n"))&&void 0!==i?i:[],a=l.filter(e=>e.startsWith("PERCENT:")).filter(e=>e),n=null==a?void 0:a.pop(),s=n?parseFloat(n.replace("PERCENT: ","").replace("%","")):0;s&&N(s)}a[e.index]={index:e.index,label:e.label,status:e.status,log:e.log,pluginLog:e.pluginLog,warning:e.warning,error:e.error,systemLog:e.systemLog,link:e.link}}}),Z(a)},[null==O?void 0:O.tasks]);let R=(0,i.useCallback)(async e=>_onCloudServer(s,e,{...c,mutateSimulation:L},M),[s,c,L,M]),U=(0,i.useCallback)(e=>{j(e.target.checked)},[]),F=(0,i.useCallback)(()=>{(async()=>{y(!0);try{await _onRun(s,M,x)}catch(e){y(!1)}})()},[s,x,M]),H=(0,i.useCallback)(()=>{(async()=>{try{await _onStop(s,M),y(!1)}catch(e){}})()},[s,M]);return s&&O&&(null==O?void 0:O.id)!=="0"?(0,a.jsx)(n.Z,{children:(0,a.jsx)(n.Z.Content,{children:(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,children:[(0,a.jsx)(sensors,{geometries:t,simulation:s,setVisible:d,setResults:u,setPostprocessing:r,swr:{mutateOneSimulation:c.mutateOneSimulation}}),(0,a.jsx)(cloudServer,{disabled:v,cloudServer:null==A?void 0:null===(l=A.run)||void 0===l?void 0:l.cloudServer,onOk:R}),(0,a.jsx)(S.Z,{size:"small",title:"Run",children:(0,a.jsxs)(_.default,{direction:"vertical",className:P().fullWidth,size:20,children:[f?(0,a.jsx)(D.default,{checked:x,onChange:U,children:"Keep mesh?"}):null,(0,a.jsxs)("div",{className:P().fullWidth,style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsxs)(_.default,{children:[(0,a.jsx)(T(),{disabled:m,type:"primary",icon:(0,a.jsx)(eS.Z,{}),loading:v,onClick:F,children:"Run"}),(0,a.jsx)(T(),{disabled:!v,danger:!0,icon:(0,a.jsx)(e_.Z,{}),shape:"circle",onClick:H})]}),(0,a.jsx)(log,{simulation:{id:s.id},steps:C})]}),(0,a.jsx)(ew.Z,{direction:"vertical",current:C.length-1,percent:w,items:C.map((e,l)=>({key:l,title:e.label,description:"("+(l+1)+"/"+C.length+")",status:e.status}))})]})}),(0,a.jsx)(run_results,{simulation:O&&{id:O.id,scheme:O.scheme,tasks:O.tasks},results:o,setResults:u})]})})}):(0,a.jsx)(n.Z,{children:(0,a.jsx)(n.Z.Content,{children:(0,a.jsx)(S.Z,{size:"small",children:(0,a.jsx)(E.default,{})})})})},Postprocessing:e=>{let{simulation:l,results:t,postprocessing:s,setResult:o}=e,[r,c]=(0,i.useState)(),[m,h]=(0,i.useState)(),[v,y]=(0,i.useState)(),[f,b]=(0,i.useState)(),{dispatch:g}=(0,i.useContext)(p.uj);(0,i.useEffect)(()=>{1!==t.length&&r&&c(!1)},[t,r]);let x=(0,i.useMemo)(()=>t[0],[t]);(0,i.useEffect)(()=>{l||(h(void 0),b(void 0))},[l]);let j=(0,i.useMemo)(()=>null==l?void 0:l.scheme.configuration.run.postprocessing,[l]),C=(0,i.useMemo)(()=>eQ.map(e=>{if(null==j?void 0:j.find(l=>l.key===e.key))return{label:e.label,value:e.key}}).filter(e=>e),[j]),k=(0,i.useMemo)(()=>{if(!j||!m)return;let e=eQ.find(e=>e.key===m),l=j.find(e=>e.key===m);if(null==e?void 0:e.parameters)return e.parameters.map((e,t)=>{var i;let n=null==l?void 0:null===(i=l.parameters)||void 0===i?void 0:i.find(l=>l.key===e.key);return(null==n?void 0:n.value)?(0,a.jsx)(I.Z.Item,{label:e.label,name:["parameters",t],initialValue:n.value,rules:e.rules,children:(0,a.jsx)(A.default,{disabled:!0})},e.key):(null==n?void 0:n.options)?(0,a.jsx)(I.Z.Item,{label:e.label,name:["parameters",t],rules:e.rules,children:(0,a.jsx)(u.default,{options:n.options.map(e=>({label:e,value:e}))})},e.key):(0,a.jsx)(I.Z.Item,{label:e.label,name:["parameters",t],rules:e.rules,initialValue:e.default,children:(0,a.jsx)(A.default,{})},e.key)})},[j,m]),Z=(0,i.useCallback)(()=>c(!0),[]),w=(0,i.useCallback)(()=>c(!1),[]),_=(0,i.useCallback)(e=>{(async()=>{y(!0);try{var t;let a=await _run({id:l.id},x,m,null!==(t=e.parameters)&&void 0!==t?t:[],g);b({filter:m,results:a})}catch(e){}y(!1)})()},[l,x,m,g]);return l&&1===t.length&&j&&C.length?(0,a.jsx)(n.Z,{className:e5().postprocessing,children:(0,a.jsxs)(n.Z.Content,{children:[(0,a.jsx)(d.default,{title:"Post-processing",children:(0,a.jsx)(T(),{type:"primary",icon:(0,a.jsx)(e$.Z,{}),onClick:Z,className:e5().button})}),(0,a.jsxs)(ei.Z,{title:"Post-processing",closable:!0,onClose:w,open:r,mask:!1,maskClosable:!1,children:[(0,a.jsx)(I.Z,{children:(0,a.jsx)(I.Z.Item,{name:"filter",label:"Filter",children:(0,a.jsx)(u.default,{placeholder:"Select a filter",options:C,onChange:h})})}),(0,a.jsxs)(I.Z,{layout:"vertical",style:{margin:"24px 0"},onFinish:_,children:[k,(0,a.jsx)(I.Z.Item,{children:(0,a.jsx)(T(),{type:"primary",loading:v,htmlType:"submit",icon:(0,a.jsx)(eS.Z,{}),children:"Run"})})]}),f&&(0,a.jsx)(S.Z,{size:"small",title:"Post-processing",extra:f.filter,children:(0,a.jsx)(postprocessing_Results,{simulation:l,postprocessing:s,results:f.results,setResult:o})})]})]})}):null}}},78804:function(e,l,t){"use strict";t.d(l,{CH:function(){return highlight},Cw:function(){return setType},HW:function(){return unhighlight},N7:function(){return setPoint},Ys:function(){return select},h$:function(){return disable},hF:function(){return unselect},rx:function(){return setPart},wp:function(){return enable}});var a=t(54523);let enable=()=>({type:a.Hp.ENABLE}),disable=()=>({type:a.Hp.DISABLE}),setType=e=>({type:a.Hp.SETTYPE,value:e}),setPart=e=>({type:a.Hp.SETPART,value:e}),highlight=e=>{let{uuid:l,label:t}=e;return{type:a.Hp.HIGHLIGHT,value:{uuid:l,label:t}}},unhighlight=()=>({type:a.Hp.UNHIGHLIGHT}),select=e=>{let{uuid:l,label:t}=e;return{type:a.Hp.SELECT,value:{uuid:l,label:t}}},unselect=e=>{let{uuid:l,label:t}=e;return{type:a.Hp.UNSELECT,value:{uuid:l,label:t}}},setPoint=e=>({type:a.Hp.SETPOINT,value:e})},54523:function(e,l,t){"use strict";t.d(l,{Hp:function(){return s},ZB:function(){return o}});var a=t(85893),i=t(67294);let n={enabled:!1,type:void 0,part:void 0,highlighted:void 0,selected:[],point:void 0,dispatch:()=>void 0},s={ENABLE:"ENABLE",DISABLE:"DISABLE",CLEAR:"CLEAR",SETTYPE:"SETTYPE",SETPART:"SETPART",HIGHLIGHT:"HIGHLIGHT",UNHIGHLIGHT:"UNHIGHLIGHT",SELECT:"SELECT",UNSELECT:"UNSELECT",SETPOINT:"SETPOINT"},o=(0,i.createContext)(n),selectReducer=(e,l)=>{let t;switch(l.type){case s.ENABLE:return{...e,enabled:!0};case s.DISABLE:return{...e,enabled:!1,highlighted:void 0,selected:[],point:void 0};case s.CLEAR:return{...n};case s.SETTYPE:return{...e,type:l.value};case s.SETPART:return{...e,part:l.value};case s.HIGHLIGHT:return{...e,highlighted:l.value};case s.UNHIGHLIGHT:return{...e,highlighted:void 0};case s.SELECT:if(-1===(t=e.selected.findIndex(e=>e.uuid===l.value.uuid)))return{...e,selected:[...e.selected,l.value]};return e;case s.UNSELECT:if(-1===(t=e.selected.findIndex(e=>e.uuid===l.value.uuid)))return e;return{...e,selected:[...e.selected.slice(0,t),...e.selected.slice(t+1)]};case s.SETPOINT:return{...e,point:l.value};default:return e}};l.ZP=e=>{let{children:l}=e,[t,s]=(0,i.useReducer)(selectReducer,n),u=(0,i.useMemo)(()=>({...t,dispatch:s}),[t]);return(0,a.jsx)(o.Provider,{value:u,children:l})}},2594:function(e){e.exports={formula:"formula_formula__5J08n",select:"formula_select__yg4qe"}},64098:function(e){e.exports={panel:"panel_panel__0UqOC",subPanel:"panel_subPanel__xW1ud"}},29040:function(e){e.exports={userMenu:"simulation_userMenu__B0_qd",selectorContent:"simulation_selectorContent__NJ9PO",selectorSider:"simulation_selectorSider__gozkv",selector:"simulation_selector__y2Udd",geometriesList:"simulation_geometriesList__Lzj7P",waring:"simulation_waring___VG9C",error:"simulation_error__E54cQ",listItem:"simulation_listItem__PQKrU"}},1751:function(e){e.exports={postprocessing:"postprocessing_postprocessing___RGdA",button:"postprocessing_button__0pr6l"}},64546:function(e,l,t){var a={"./local/src/components":[13534,3534]};function webpackAsyncContext(e){if(!t.o(a,e))return Promise.resolve().then(function(){var l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l});var l=a[e],i=l[0];return t.e(l[1]).then(function(){return t(i)})}webpackAsyncContext.keys=function(){return Object.keys(a)},webpackAsyncContext.id=64546,e.exports=webpackAsyncContext}}]);