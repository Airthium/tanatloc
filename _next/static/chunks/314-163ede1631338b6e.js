(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[314],{70314:function(e,n,t){"use strict";t.d(n,{ZP:function(){return Za}});var i=t(47568),r=t(828),a=t(29815),l=t(34051),o=t.n(l),u=t(85893),s=t(11163),c=t(67294),d=t(97183),m=t(34155),f=t(6880),p=t(71577),h=t(48869),v=t(8751),x=t(18429),b=t(11475),y=t(22844),g=t(50888),j=t(88484),w=t(64789),Z=t(41641),k=t(96844),S=t(75107),P=t(81474),C=t(26713),E=t(20280),N="You are not authorized to be there.",M=function(){var e=(0,s.useRouter)();return(0,c.useEffect)((function(){e.prefetch("/")}),[e]),(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsx)(P.Z,{title:"Not allowed",children:(0,u.jsxs)(C.Z,{direction:"vertical",children:[(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)(E.Z,{style:{color:"red"}})," ",N]}),(0,u.jsxs)(f.Z.Text,{children:["Go back"," ",(0,u.jsx)(p.Z,{type:"link",onClick:function(){return function(e){e.push("/")}(e)},children:"home"})]})]})})})})},O=t(26042),T=t(69396),D={enabled:!1,type:void 0,part:void 0,highlighted:void 0,selected:[],point:void 0,dispatch:function(){}},U="ENABLE",z="DISABLE",F="CLEAR",R="SETTYPE",A="SETPART",L="HIGHLIGHT",V="UNHIGHLIGHT",G="SELECT",I="UNSELECT",_="SETPOINT",B=(0,c.createContext)(D),H=function(e,n){var t;switch(n.type){case U:return(0,T.Z)((0,O.Z)({},e),{enabled:!0});case z:return(0,T.Z)((0,O.Z)({},e),{enabled:!1,highlighted:void 0,selected:[]});case F:return(0,O.Z)({},D);case R:return(0,T.Z)((0,O.Z)({},e),{type:n.value});case A:return(0,T.Z)((0,O.Z)({},e),{part:n.value});case L:return(0,T.Z)((0,O.Z)({},e),{highlighted:n.value});case V:return(0,T.Z)((0,O.Z)({},e),{highlighted:void 0});case G:return-1===(t=e.selected.findIndex((function(e){return e.uuid===n.value.uuid})))?(0,T.Z)((0,O.Z)({},e),{selected:(0,a.Z)(e.selected).concat([n.value])}):e;case I:return-1===(t=e.selected.findIndex((function(e){return e.uuid===n.value.uuid})))?e:(0,T.Z)((0,O.Z)({},e),{selected:(0,a.Z)(e.selected.slice(0,t)).concat((0,a.Z)(e.selected.slice(t+1)))});case _:return(0,T.Z)((0,O.Z)({},e),{point:n.value});default:return e}},Y=function(e){var n=e.children,t=(0,c.useReducer)(H,D),i=t[0],r=t[1];return(0,u.jsx)(B.Provider,{value:(0,T.Z)((0,O.Z)({},i),{dispatch:r}),children:n})},W=t(67169),q=t(94370),K=t(8100),J=t(87492),$=function(){var e=(0,i.Z)(o().mark((function e(n,t){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/simulation",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({project:{id:n.id},simulation:t})});case 2:return i=e.sent,e.abrupt("return",i.json());case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),X=function(){var e=(0,i.Z)(o().mark((function e(n,t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/simulation/"+n.id,{method:"PUT",body:JSON.stringify(t)});case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),Q=function(){var e=(0,i.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/simulation/"+n.id,{method:"DELETE"});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ee=function(){var e=(0,i.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/simulation/"+n.id+"/run",{method:"GET"});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ne=function(){var e=(0,i.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/simulation/"+n.id+"/stop",{method:"GET"});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),te=function(){var e=(0,i.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/simulation/"+n.id+"/tasks",{method:"GET",headers:{Accept:"application/json"}});case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ie=function(){var e=(0,i.Z)(o().mark((function e(n,t){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/simulation/"+n.id+"/log",{method:"POST",body:JSON.stringify({file:t})});case 2:return i=e.sent,e.abrupt("return",i.json());case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),re={useSimulations:function(e){var n=(0,K.ZP)(["/api/simulations",JSON.stringify({ids:e})],J._),t=n.data,i=n.error,r=n.mutate,l=!t,o=(null===t||void 0===t?void 0:t.simulations)||[],u=(0,c.useCallback)((function(e){var n=(0,a.Z)(o).concat([e]);r({simulations:n})}),[o,r]),s=(0,c.useCallback)((function(e){var n=o.filter((function(n){return n.id!==e.id}));r({simulations:n})}),[o,r]),d=(0,c.useCallback)((function(e,n){var t=o.map((function(n){return n.id===e.id&&(n=(0,O.Z)({},n,e)),n}));r({simulations:t},n)}),[o,r]);return[o,{addOneSimulation:u,delOneSimulation:s,mutateOneSimulation:d,errorSimulations:i,loadingSimulations:l}]},useSimulation:function(e,n){var t=(0,K.ZP)("/api/simulation"+(e?"/"+e:""),J._,{refreshInterval:n||0}),i=t.data,r=t.error,a=t.mutate,l=!i,o=(null===i||void 0===i?void 0:i.simulation)||{id:"0"},u=(0,c.useCallback)((function(e){a({simulation:(0,O.Z)({},o,e)})}),[o,a]);return[o,{mutateSimulation:u,errorSimulation:r,loadingSimulation:l}]},add:$,update:X,del:Q,run:ee,stop:ne,tasks:te,log:ie},ae=re,le=function(){var e=(0,i.Z)(o().mark((function e(n,t){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/geometry",{method:"POST",body:JSON.stringify({project:n,geometry:t})});case 2:return i=e.sent,e.abrupt("return",i.json());case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),oe=function(){var e=(0,i.Z)(o().mark((function e(n,t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/geometry/"+n.id,{method:"PUT",body:JSON.stringify(t)});case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),ue=function(){var e=(0,i.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/geometry/"+n.id,{method:"DELETE"});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),se=function(){var e=(0,i.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/geometry/"+n.id+"/download");case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ce=function(){var e=(0,i.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/geometry/"+n.id+"/part");case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),de={useGeometries:function(e){var n=(0,K.ZP)(["/api/geometries",JSON.stringify({ids:e})],J._),t=n.data,i=n.error,r=n.mutate,l=!t,o=(null===t||void 0===t?void 0:t.geometries)||[],u=(0,c.useCallback)((function(e){var n=(0,a.Z)(o).concat([e]);r({geometries:n})}),[o,r]),s=(0,c.useCallback)((function(e){var n=o.filter((function(n){return n.id!==e.id}));r({geometries:n})}),[o,r]),d=(0,c.useCallback)((function(e){var n=o.map((function(n){return n.id===e.id&&(n=(0,O.Z)({},n,e)),n}));r({geometries:n})}),[o,r]);return[o,{addOneGeometry:u,delOneGeometry:s,mutateOneGeometry:d,errorGeometries:i,loadingGeometries:l}]},add:le,update:oe,del:ue,download:se,getPart:ce},me=de,fe=t(97937),pe=function(e){var n=e.visible,t=e.title,i=e.children,r=e.onClose;return(0,u.jsx)(P.Z,{className:"panel",bodyStyle:{maxHeight:"calc(100vh - 65px)",overflow:"auto",padding:0},title:t,extra:(0,u.jsx)(p.Z,{type:"text",icon:(0,u.jsx)(fe.Z,{}),onClick:function(){return r()}}),style:{display:n?"block":"none"},children:i})},he=t(42473),ve=t(78116),xe=t(32834),be=t(48764).lW,ye="Unable to add geometry",ge=function(e){return e.name.toLowerCase().includes(".stp")||e.name.toLowerCase().includes(".step")||e.name.toLowerCase().includes(".dxf")},je=function(){var e=(0,i.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new FileReader,e.abrupt("return",new Promise((function(e){t.addEventListener("load",(function(){e(t.result)})),t.readAsArrayBuffer(n)})));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),we=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("uploading"!==t.file.status){e.next=2;break}return e.abrupt("return",!0);case 2:if("done"!==t.file.status){e.next=18;break}return e.next=5,je(t.file.originFileObj);case 5:return r=e.sent,e.prev=6,e.next=9,me.add({id:n.id},{name:t.file.name,uid:t.file.uid,buffer:be.from(r)});case 9:l=e.sent,i.addOneGeometry(l),i.mutateProject({id:n.id,geometries:(0,a.Z)(n.geometries).concat([l.id])}),e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(6),(0,k.lt)(ye,e.t0),e.t0;case 18:return e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(n,t,i){return e.apply(this,arguments)}}(),Ze=function(e){var n=e.visible,t=e.project,r=e.swr,a=e.setVisible,l=(0,c.useState)(!1),s=l[0],d=l[1];return(0,u.jsx)(xe.ZP,{title:"Upload geometry",visible:n,onCancel:function(){return a(!1)},cancelButtonProps:{loading:s},children:(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(ve.Z,{className:"upload",action:"/api/noop",accept:".stp,.step,.dxf",showUploadList:!1,listType:"picture-card",beforeUpload:ge,onChange:function(){var e=(0,i.Z)(o().mark((function e(n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,we(t,n,r);case 3:i=e.sent,d(i),a(i),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),d(!1);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n){return e.apply(this,arguments)}}(),children:(0,u.jsx)("div",{children:s?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(g.Z,{style:{fontSize:25}}),(0,u.jsxs)("div",{style:{marginTop:8},children:[(0,u.jsx)("b",{children:"Loading"}),", converting, ..."]})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(j.Z,{style:{fontSize:25}}),(0,u.jsxs)("div",{style:{marginTop:8},children:[(0,u.jsx)("b",{children:"Choose a file"})," or drop it here"]})]})})}),(0,u.jsx)(f.Z.Text,{children:(0,u.jsx)("p",{style:{color:"rgba(0, 0, 0, 0.45)",textAlign:"center"},children:"Native file format preferred: STEP (3D) or DXF (2D) file"})})]})})},ke=t(81579),Se=t(69677),Pe=function(e){var n=e.visible,t=e.geometry,r=e.setVisible,a=e.onEdit,l=(0,c.useState)(!1),s=l[0],d=l[1];return(0,u.jsx)(xe.ZP,{title:"Edit the geometry's name",visible:n,initialValues:{name:t.name},onCancel:function(){return r(!1)},onOk:function(){var e=(0,i.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,a(n);case 4:d(!1),r(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),d(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),loading:s,children:(0,u.jsx)(ke.Z.Item,{name:"name",label:"Name:",rules:[{required:!0,message:"Name is required"}],children:(0,u.jsx)(Se.Z,{})})})},Ce=t(48764).lW,Ee="Unable to download geometry",Ne="Unable to update geometry",Me="Unable to delete geometry",Oe=function(){var e=(0,i.Z)(o().mark((function e(n){var t,i,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,me.download({id:n.id});case 3:t=e.sent,i=new File([Ce.from(t.buffer).toString()],n.name+"."+t.extension),r=window.URL.createObjectURL(i),(a=document.createElement("a")).href=r,a.setAttribute("download",n.name+"."+t.extension),a.click(),a.remove(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),(0,k.lt)(Ee,e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(n){return e.apply(this,arguments)}}(),Te=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,me.update({id:n.id},[{key:"name",value:t.name}]);case 3:n.name=t.name,i.mutateOneGeometry(n),e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),(0,k.lt)(Ne,e.t0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,t,i){return e.apply(this,arguments)}}(),De=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,me.del({id:n.id});case 3:a=t.geometries.filter((function(e){return e!==n.id})),r.mutateProject({id:t.id,geometries:a}),r.delOneGeometry(n),i(),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),(0,k.lt)(Me,e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n,t,i,r){return e.apply(this,arguments)}}(),Ue=function(e){var n,t,r,a,l,s,m=e.project,p=e.geometry,h=e.swr,v=e.close,x=e.onCleanup,b=(0,c.useState)(!1),y=b[0],g=b[1],j=(0,c.useState)(!1),w=j[0],k=j[1],E=(0,c.useState)(!1),N=E[0],M=E[1];return p?(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsx)(P.Z,{size:"small",title:"Informations",actions:[(0,u.jsx)(Z.o6,{loading:y,onDownload:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.prev=1,e.next=4,Oe(p);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.prev=8,g(!1),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[1,6,8,11]])})))},"download"),(0,u.jsxs)("div",{children:[(0,u.jsx)(Pe,{visible:w,geometry:{id:null===p||void 0===p?void 0:p.id,name:null===p||void 0===p?void 0:p.name},setVisible:k,onEdit:function(){var e=(0,i.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Te(p,n,h));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}),(0,u.jsx)(Z.w6,{onEdit:function(){return k(!0)}})]},"edit"),(0,u.jsx)(Z.m1,{loading:N,text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the geometry"," ",(0,u.jsx)(f.Z.Text,{strong:!0,children:p.name}),"?"]}),onDelete:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M(!0),e.prev=1,e.next=4,De(p,m,v,h);case 4:x();case 5:return e.prev=5,M(!1),e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[1,,5,8]])})))},"delete")],children:(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"File:"})," ",p.name," "]}),(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Unit:"})," ",(0,u.jsx)(he.Z.Inline,{text:"m"})]}),(0,u.jsxs)(u.Fragment,{children:[3===p.summary.dimension&&(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Number of solids:"})," ",null!==(a=null===(n=p.summary.solids)||void 0===n?void 0:n.length)&&void 0!==a?a:0]}),(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Number of faces:"})," ",null!==(l=null===(t=p.summary.faces)||void 0===t?void 0:t.length)&&void 0!==l?l:0]}),2===p.summary.dimension&&(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Number of edges:"})," ",null!==(s=null===(r=p.summary.edges)||void 0===r?void 0:r.length)&&void 0!==s?s:0]})]})]})})})}):(0,u.jsx)(S.Z.Simple,{})};Ue.Add=Ze;var ze,Fe,Re,Ae=Ue,Le=function(){var e=(0,i.Z)(o().mark((function e(n,t){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/result",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({simulation:n,result:t})});case 2:return i=e.sent,e.abrupt("return",i.json());case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),Ve=function(){var e=(0,i.Z)(o().mark((function e(n,t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,J.R)("/api/result/download",{method:"POST",body:JSON.stringify({simulation:n,result:t})}));case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),Ge=function(){var e=(0,i.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,J.R)("/api/result/archive",{method:"POST",body:JSON.stringify({simulation:n})}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Ie={load:Le,download:Ve,archive:Ge},_e=Ie,Be=t(58191),He=t(13013),Ye=t(27049),We=t(94594),qe=t(11382),Ke=t(41428),Je=t(38095),$e=t(86350),Xe=t(15668),Qe=t(74317),en=t(35598),nn=t(49591),tn=t(19478),rn=t(87784),an=t(90420),ln=t(75843),on=t(99477),un=t(25934),sn=t(79753),cn=t(54458),dn=t(58939),mn=t(24065),fn=t(54327),pn=function(e){var n=new on.fHI(.025,.025,.8,50);n.translate(0,.4,0);var t=new on.vBJ({color:e}),i=new on.Kj0(n,t),r=new on.b_z(.05,.2,50);r.translate(0,.9,0);var a=new on.vBJ({color:e}),l=new on.Kj0(r,a),o=new on.ZAu;o.type="ArrowHelper",o.add(i),o.add(l);return o.dispose=function(){n.dispose(),t.dispose(),r.dispose(),a.dispose()},o},hn=function(e,n,t){var i=document.createElement("canvas");i.width=(null===t||void 0===t?void 0:t.width)||256,i.height=256;var r=i.getContext("2d");r.fillStyle="grey",r.font="50px sans-serif",r.textAlign=(null===t||void 0===t?void 0:t.align)||"center",r.textBaseline="middle",r.fillText(n,i.width/2,i.height/2);var a=new on.xEZ(i);a.flipY=!0,a.needsUpdate=!0;var l=new on.xeV({map:a,transparent:!0,depthWrite:!1});l.map.anisotropy=e.capabilities.getMaxAnisotropy();var o=new on.jyi(l);o.type="LabelHelper",(null===t||void 0===t?void 0:t.position)&&o.position.copy(t.position),(null===t||void 0===t?void 0:t.scale)&&o.scale.setScalar(t.scale);return o.dispose=function(){a.dispose(),l.dispose()},o},vn=function(e){return Math.abs(e)<1e-12?"0":Math.abs(e)>1e3||Math.abs(e)<.001?e.toExponential(2):e.toFixed(3)},xn=function(e,n,t,i){var r,a,l,o=function(e,n,t,i,r){for(var a=new on.ZAu,l=new on.nls({color:8947848}),o=new on.Pa4(-e/2,0,-n/2),u=e/(t-1),s=n/(i-1),c=0;c<i;++c){var d=(new on.u9r).setFromPoints([new on.Pa4(o.x,0,o.z+c*s),new on.Pa4(o.x+e,0,o.z+c*s)]);a.add(new on.x12(d,l))}for(var m=0;m<t;++m){var f=(new on.u9r).setFromPoints([new on.Pa4(o.x+m*u,0,o.z),new on.Pa4(o.x+m*u,0,o.z+n)]);a.add(new on.x12(f,l))}return null===r||void 0===r||r(a),a},u=function(n,t,i,r){for(var a=new on.ZAu,l=Math.abs(t-n),o=l/(r-1),u=(new on.Pa4).copy(i).multiplyScalar(-l/2),s=(new on.Pa4).copy(i).multiplyScalar(o),c=n,d=0;d<r;++d){var m=hn(e,vn(c));m.position.copy(u),a.add(m),u.add(s),c+=o}return a},s=function(){var e=n.boundingBox,t=n.boundingSphere.center,i=new on.Pa4(e.max.x-e.min.x,e.max.y-e.min.y,e.max.z-e.min.z),l=function(e){var n=Math.max(e.x,e.y,e.z),t=Math.max(Math.ceil(e.x/n*5),2),i=Math.max(Math.ceil(e.y/n*5),2),r=Math.max(Math.ceil(e.z/n*5),2);return new on.Pa4(t,i,r)}(i);r=.1*Math.max(i.x,i.y,i.z),a=1*r;var s=new on.ZAu,c=o(i.x,i.z,l.x,l.z),d=o(i.x,i.y,l.x,l.y,(function(e){e.rotateX(Math.PI/2)})),f=o(i.y,i.z,l.y,l.z,(function(e){e.rotateZ(-Math.PI/2)}));s.add(c,d,f);var p=u(e.min.x,e.max.x,new on.Pa4(1,0,0),l.x),h=u(e.min.y,e.max.y,new on.Pa4(0,1,0),l.y),v=u(e.min.z,e.max.z,new on.Pa4(0,0,1),l.z);return s.add(p,h,v),s.position.set(t.x,t.y,t.z),s.type="GridHelper",s.dispose=m,s},c=function(e){return e<=0?-1:1},d=function(e){return Math.abs(e)<=.5?1:-1},m=function(){null===l||void 0===l||l.children.forEach((function(e){e.children.forEach((function(e){if("Line"===e.type){var n=e;n.geometry.dispose(),n.material.dispose()}else{e.dispose()}}))}))};return{dispose:m,setVisible:function(e){l.visible=e},update:function(){var e=n.boundingBox,o=new on.Pa4(e.max.x-e.min.x,e.max.y-e.min.y,e.max.z-e.min.z),u=!1;n.children.forEach((function(e){if("GridHelper"===e.type){var t=e;u=t.visible,n.remove(t),t.dispose()}})),l=s();var m=i.object.position.distanceTo(i.target);l.traverse((function(e){"LabelHelper"===e.type&&e.scale.setScalar(.05*m)}));var f=new on.Pa4;t.getWorldDirection(f);var p=m/10/(i.minDistance+.001),h=l.children[0],v=l.children[1],x=l.children[2];h.position.set(0,c(f.y)*(o.y/2+r),0),v.position.set(0,0,c(f.z)*(o.z/2+r)),x.position.set(c(f.x)*(o.x/2+r),0,0);var b=l.children[3],y=l.children[4],g=l.children[5];b.position.set(0,c(f.y)*d(f.y)*(o.y/2+a),c(f.z)*d(f.y)*-(o.z/2+a)),y.position.set(c(f.x)*d(f.x)*(o.x/2+a),0,c(f.z)*d(f.x)*-(o.z/2+a)),g.position.set(c(f.x)*d(f.x)*(o.x/2+a),c(f.y)*d(f.x)*-(o.y/2+a),0);var j=.2*p,w=.3*p;b.visible=Math.abs(f.y)>j||Math.abs(f.z)>w,y.visible=Math.abs(f.x)>w||Math.abs(f.z)>w,g.visible=Math.abs(f.x)>w||Math.abs(f.y)>j,l.visible=u,n.add(l)}}},bn=t(51438),yn=t(28668),gn=t(91224),jn=function(e,n,t,i){var r,a,l,o=new on.Ilk("#fad114"),u=new on.Ilk("#E98A15"),s=new on.Pa4(-1,0,0),c=new on.JOQ(s),d={up:new on.Pa4,forward:new on.Pa4,right:new on.Pa4},m=new on.Pa4,f=new on.Pa4,p=new on.USm,h=new on.Pa4,v=new on.FM8,x=new on.JOQ,b=new on.Pa4,y=new on.Pa4,g=new on.Zzh,j={up:new on.Pa4,forward:new on.Pa4,right:new on.Pa4},w=new on.iMs,Z=s,k=new on.ZAu;k.type="SectionViewHelper",k.visible=!1,n.add(k);!function(){var e=new on._12(1,1),n=new on.vBJ({color:o,side:on.ehD,transparent:!0,opacity:.5}),t=new on.Kj0(e,n);t.type="Plane",k.add(t)}();!function(){var e=new on.xo$(.2,32,32,Math.PI,-Math.PI),n=new on.vBJ({color:o,side:on.ehD,transparent:!0,opacity:.5}),t=new on.Kj0(e,n);t.type="Dome",k.add(t)}();!function(){var e=new(function(e){(0,yn.Z)(t,e);var n=(0,gn.Z)(t);function t(e){var i;return(0,bn.Z)(this,t),(i=n.call(this)).radius=e,i}return t.prototype.getPoint=function(e){return(new on.Pa4).set(this.radius*Math.cos(Math.PI*e),this.radius*Math.sin(Math.PI*e),0)},t}(on.Hyl))(.2),n=new on.WXh(e,32,.2*.1,32),t=new on.vBJ({color:o,side:on.ehD,transparent:!0,opacity:.5}),i=new on.Kj0(n,t);i.rotateX(Math.PI/2),i.type="ArcX",k.add(i);var r=new on.WXh(e,32,.2*.1,32),a=new on.vBJ({color:o,side:on.ehD,transparent:!0,opacity:.5}),l=new on.Kj0(r,a);l.rotateX(Math.PI/2),l.rotateY(Math.PI/2),l.type="ArcY",k.add(l)}();var S=function(){var e=new on.Pa4;n.boundingBox.getCenter(e),k.position.copy(e)},P=function(){k.rotateX(Math.PI);var e=c.normal.multiplyScalar(-1);c.setFromNormalAndCoplanarPoint(e,k.position)},C=function(e){var n=e.target.getBoundingClientRect(),t=e.clientX-n.left,i=e.clientY-n.top,r=new on.FM8;return r.x=t/n.width*2-1,r.y=-i/n.height*2+1,r},E=function(e){r&&r.material.color.set(o),r=e,e&&e.material.color.set(u)},N=function(e){if(k.visible){var n=C(e);if(w.setFromCamera(n,t),a){var r=new on.Pa4;w.ray.intersectPlane(x,r),"Plane"===(null===l||void 0===l?void 0:l.type)?M(r):"Dome"===(null===l||void 0===l?void 0:l.type)?O(n):D(r),function(){var e=new on.Pa4(0,0,1).applyQuaternion(k.quaternion).multiplyScalar(-1);c.setFromNormalAndCoplanarPoint(e,k.position)}()}else{var o=w.intersectObject(k);o.length?(i.enabled=!1,l=o[0].object,E(l),f.copy(o[0].point),t.getWorldDirection(d.forward),d.forward.normalize(),d.up.copy(t.up).normalize(),d.right.crossVectors(d.up,d.forward).normalize()):(l=null,E(),i.enabled=!0)}}},M=function(e){e.sub(b);var n=new on.Pa4;g.closestPointToPoint(e,!1,n),k.position.copy(n)},O=function(e){k.rotation.copy(p),k.rotateOnWorldAxis(d.up,5*-(v.x-e.x)),k.rotateOnWorldAxis(d.right,5*-(v.y-e.y))},T=function(){l.getWorldDirection(h),p.copy(k.rotation),b.copy(f).sub(k.position),y.copy(b).normalize(),j.up.copy(y),j.right.copy(h),j.forward.crossVectors(j.right,j.up),g.set(f,(new on.Pa4).copy(f).add(j.forward)),x.setFromNormalAndCoplanarPoint(d.forward,f)},D=function(e){var n=i.object.position.distanceTo(i.target),t=new on.Pa4;g.closestPointToPoint(e,!1,t);var r=f.distanceTo(t);t.sub(f);var a=(new on.Pa4).copy(y).cross(t).normalize(),l=Math.sign(h.dot(a))*r*1/(n/100);k.rotation.copy(p),k.rotateOnWorldAxis(h,l)},U=function(e){switch(null===l||void 0===l?void 0:l.type){case"Plane":!function(){x.setFromNormalAndCoplanarPoint(d.forward,f),m.copy(k.position);var e=new on.Pa4;w.ray.intersectPlane(x,e),b.copy(e).sub(m),y.copy(b).normalize(),g.set(m,(new on.Pa4).copy(m).add(c.normal))}();break;case"Dome":!function(e){p.copy(k.rotation),v.copy(e)}(e);break;case"ArcX":case"ArcY":T()}},z=function(e){if(k.visible&&l){a=!0;var n=C(e);U(n)}},F=function(){k.visible&&(a=!1,E())};return e.domElement.addEventListener("pointermove",N),e.domElement.addEventListener("pointerdown",z),e.domElement.addEventListener("pointerup",F),{getClippingPlane:function(){return c},toggleVisible:function(){var e=k.visible;k.visible=!e},start:function(){e.localClippingEnabled=!0,k.visible=!0,function(){var e=new on.Pa4;n.boundingBox.getSize(e),e.multiplyScalar(1.2);var t=Math.max(Math.max(e.x,e.y),e.z);k.scale.setScalar(t)}(),S();var t=(new on.Pa4).copy(k.position).sub(s);k.lookAt(t),c.setFromNormalAndCoplanarPoint(s,k.position)},stop:function(){e.localClippingEnabled=!1,k.visible=!1},toAxis:function(e){if(S(),Z.equals(e))P();else{var n=(new on.Pa4).copy(k.position).sub(e);k.lookAt(n),c.setFromNormalAndCoplanarPoint(e,k.position),Z.copy(e)}},flip:P,dispose:function(){k.traverse((function(e){if("Plane"===e.type||"Dome"===e.type||"ArcX"===e.type||"ArcY"===e.type){var n=e;n.geometry.dispose(),n.material.dispose()}})),e.domElement.removeEventListener("pointermove",N),e.domElement.removeEventListener("pointerdown",z),e.domElement.removeEventListener("pointerup",F)}}},wn=t(54104),Zn=function(e){var n,t=new on.xsS,i=new on.iKG(-1,1,1,-1,2,1);i.position.set(0,0,1);var r=function(n){var i=vn(n.minV),r=vn(n.maxV),a=hn(e,String(i),{position:new on.Pa4(-.62,0,0),width:512,align:"right"});a.scale.x=.4,a.scale.y=2.8;var l=hn(e,String(r),{position:new on.Pa4(.62,0,0),width:512,align:"left"});l.scale.x=.4,l.scale.y=2.8,t.add(a),t.add(l)};return{render:function(){var n=e.domElement.getBoundingClientRect();e.setViewport(n.width/2-350,n.height-50,700,50),e.render(t,i)},setLUT:function(e){t.children.forEach((function(e){return e.dispose()})),t.clear();var i=new wn.A("rainbow",e.n);i.setMin(e.minV),i.setMax(e.maxV);var a=new on.ROQ(i.createCanvas()),l=new on.xeV({map:a});(n=new on.jyi(l)).material.rotation=-Math.PI/2,n.scale.x=.2,n.scale.y=1.2,n.dispose=n.material.dispose,t.add(n),r(i)},setVisible:function(e){t.children.forEach((function(n){n.visible=e}))}}},kn=function(e){var n=new on.ZAu;n.type="PointHelper",n.visible=!1,e.add(n);var t=function(e,n){var t=(new on.u9r).setFromPoints([e,n]),i=new on.nls({color:16711680});return new on.x12(t,i)},i=function(){n.children.forEach((function(e){n.remove(e);var t=e;t.geometry.dispose(),t.material.dispose()}))};return{build:function(){var r;i();var l=function(){var n,t,i=(null!==(t=null===(n=e.boundingSphere)||void 0===n?void 0:n.radius)&&void 0!==t?t:1)/100,r=new on.xo$(i),a=new on.Wid({color:16711680});return new on.Kj0(r,a)}(),o=function(){var n=[],i=e.boundingBox.max.x-e.boundingBox.min.x,r=e.boundingBox.max.y-e.boundingBox.min.y,a=e.boundingBox.max.z-e.boundingBox.min.z,l=Math.max(i,r,a),o=t(new on.Pa4(-l/2,0,0),new on.Pa4(l/2,0,0));n.push(o);var u=t(new on.Pa4(0,-l/2,0),new on.Pa4(0,l/2,0));n.push(u);var s=t(new on.Pa4(0,0,-l/2),new on.Pa4(0,0,l/2));return n.push(s),n}();n.add(l),(r=n).add.apply(r,(0,a.Z)(o))},dispose:i,update:function(e){e?(n.position.set(e.x,e.y,e.z),n.visible=!0):n.visible=!1}}},Sn=t(1217),Pn=t(82854),Cn=t(70385),En=t(48764).lW,Nn=function(e,n){var t=new on.Ilk("#FAD114"),r=new on.Ilk("#EE9817"),l=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r,a,l,d,m,f,p,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Blob([En.from(n.buffer)]),a=URL.createObjectURL(r),l=new Sn.E,(d=new Pn._).setDecoderPath("/three/libs/draco/"),l.setDRACOLoader(d),(m=new Cn.a).setTranscoderPath("node_modules/three//examples/js/libs/basis/"),l.setKTX2Loader(m),e.next=11,new Promise((function(e,n){l.load(a,(function(n){e(n)}),(function(){}),(function(e){return n(e)}))}));case 11:return f=e.sent,p=f.scene,(h=new on.Tme).type="Part",h.uuid=n.summary.uuid,h.children=p.children,h.userData=p.userData,"mesh"===n.summary.type?h.traverse((function(e){if("Mesh"===e.type){var n=e,t=new on.Uk6(n.geometry),r=new on.nls({color:n.material.color,linewidth:1}),a=new on.ejS(t,r);n.add(a),n.material.visible=!1,n.material.clippingPlanes=[i]}})):"result"===n.summary.type?h.traverse((function(e){if("Mesh"===e.type||"Line"===e.type){var n=e,t=n.geometry.getAttribute("data");if(t){var r=t.array.reduce((function(e,n){return Math.min(e,n)}),t.array[0]),a=t.array.reduce((function(e,n){return Math.max(e,n)}),t.array[0]);r===a&&(r-=1,a+=1);var l=new wn.A;l.setMin(r),l.setMax(a);for(var o=new Float32Array(3*t.count),u=0;u<t.count;u++){var s=l.getColor(t.array[u]);o[3*u+0]=s.r,o[3*u+1]=s.g,o[3*u+2]=s.b}n.geometry.setAttribute("color",new on.a$l(o,3)),n.userData=(0,T.Z)((0,O.Z)({},n.userData),{lut:l})}if("Mesh"===e.type){var c=new on.Uk6(n.geometry),d=new on.nls({linewidth:1}),m=new on.ejS(c,d);n.add(m)}n.material.vertexColors=!0,n.material.clippingPlanes=[i]}})):"geometry3D"!==n.summary.type&&"geometry2D"!==n.summary.type||h.traverse((function(e){if("Mesh"===e.type){var n=e;n.material.clippingPlanes=[i],n.material.originalColor=n.material.color}})),c(h,t),h.boundingBox=u(h),h.dispose=function(){return s(h)},h.setTransparent=function(e){return c(h,e)},h.startSelection=function(e,n,t,i){return y(h,e,n,t,i)},h.stopSelection=function(){return g()},h.getHighlighted=function(){return x},h.getSelected=function(){return b},h.highlight=S,h.unhighlight=P,h.select=E,h.unselect=N,e.abrupt("return",h);case 32:case"end":return e.stop()}}),e)})));return function(n,t,i){return e.apply(this,arguments)}}(),u=function(e){var n=new on.ZzF;return e.traverse((function(e){n.expandByObject(e)})),n},s=function(e){e.traverse((function(e){if("Mesh"===e.type){var n=e;n.geometry.dispose(),n.material.dispose()}}))},c=function(e,n){e.traverse((function(e){if("Mesh"===e.type){var t=e;t.material.transparent=n,t.material.opacity=n?.5:1,t.material.depthWrite=!n}}))},d=new on.iMs,m=null,f=null,p=null,h=null,v=null,x=null,b=[],y=function(e,n,t,i,r){m=e,f=r,p=n,h=t,(v=i).selectedObjects=[],x=null,b.length=0,p.domElement.addEventListener("pointermove",w),p.domElement.addEventListener("pointerdown",C)},g=function(){p&&p.domElement.removeEventListener("pointermove",w),p&&p.domElement.removeEventListener("pointerdown",C),P(),x=null,b.forEach((function(e){N(e.uuid)})),b.length=0,f=null,m=null,p=null,h=null,v=null},j=function(e,n){var t;if(e&&n)return e.traverse((function(e){e.userData.uuid===n&&(t=e)})),t},w=function(n){var t=function(e){var n=e.target.getBoundingClientRect(),t=e.clientX-n.left,i=e.clientY-n.top,r=new on.FM8;return r.x=t/n.width*2-1,r.y=-i/n.height*2+1,r}(n);d.setFromCamera(t,h);var i,r=m.userData;switch(f){case"solids":if((i=d.intersectObject(m,!0)).length){var a=i[0].object.parent;a&&e(m,a.userData.uuid,a.userData.label)}else e(m);break;case"faces":if(2===r.dimension)if((i=d.intersectObject(m,!0)).length){var l=i[0].object,o=l.parent;"Mesh"===(null===o||void 0===o?void 0:o.type)?e(m,o.userData.uuid,o.userData.label):e(m,l.userData.uuid,l.userData.label)}else e(m);else if((i=d.intersectObject(m,!0)).length){var u=i[0].object;e(m,u.userData.uuid,u.userData.label)}else e(m);break;case"edges":var s=r.edges;if((i=d.intersectObject(m,!0)).length){var c=i[0].object;(null===s||void 0===s?void 0:s.find((function(e){return e.uuid===c.userData.uuid})))?e(m,c.userData.uuid,c.userData.label):e(m)}else e(m);break;case"point":if((i=d.intersectObject(m,!0)).length){var p=i[0];e(m,void 0,void 0,p.point)}else e(m)}},Z=function(e,n){n?v.selectedObjects.find((function(n){return n.userData.uuid===e.userData.uuid}))||v.selectedObjects.push(e):b.find((function(n){return n.uuid===e.userData.uuid}))||v.selectedObjects.push(e)},k=function(e,n){if(n){var t=v.selectedObjects.findIndex((function(n){return n.userData.uuid===e.userData.uuid}));v.selectedObjects=(0,a.Z)(v.selectedObjects.slice(0,t)).concat((0,a.Z)(v.selectedObjects.slice(t+1)))}else{if(!b.find((function(n){return n.uuid===e.userData.uuid}))){var i=v.selectedObjects.findIndex((function(n){return n.userData.uuid===e.userData.uuid}));v.selectedObjects=(0,a.Z)(v.selectedObjects.slice(0,i)).concat((0,a.Z)(v.selectedObjects.slice(i+1)))}}},S=function(e){if(e!==(null===x||void 0===x?void 0:x.uuid)){P();var n=j(m,e);if(n)if(x={uuid:n.userData.uuid,label:n.userData.label},Z(n),"Mesh"===n.type)n.material.color=t;else n.traverse((function(e){"Mesh"===e.type&&(e.material.color=t)}))}},P=function(){var e=j(m,null===x||void 0===x?void 0:x.uuid);if(e){k(e);var n=b.findIndex((function(n){return n.uuid===e.userData.uuid}));if("Mesh"===e.type){var t=e;t.material.color=-1===n?t.material.originalColor:r}else{e.traverse((function(e){if("Mesh"===e.type){var t=e;t.material.color=-1===n?t.material.originalColor:r}}))}}x=null},C=function(){x&&n(m,x.uuid,x.label)},E=function(e){var n=j(m,e);n&&(b.push({uuid:e,label:n.userData.label}),Z(n,!0),"Mesh"===n.type?n.material.color=r:n.traverse((function(e){"Mesh"===e.type&&(e.material.color=r)})))},N=function(e){var n=j(m,e),t=b.findIndex((function(n){return n.uuid===e}));if(-1!==t&&(b=(0,a.Z)(b.slice(0,t)).concat((0,a.Z)(b.slice(t+1)))),n){if(k(n,!0),"Mesh"===n.type){var i=n;i.material.color=i.material.originalColor}else{n.traverse((function(e){if("Mesh"===e.type){var n=e;n.material.color=n.material.originalColor}}))}n.visible=!0}};return{load:l}},Mn=function(){return{type:U}},On=function(){return{type:z}},Tn=function(e){return{type:R,value:e}},Dn=function(e){return{type:A,value:e}},Un=function(e){var n=e.uuid,t=e.label;return{type:L,value:{uuid:n,label:t}}},zn=function(){return{type:V}},Fn=function(e){var n=e.uuid,t=e.label;return{type:G,value:{uuid:n,label:t}}},Rn=function(e){var n=e.uuid,t=e.label;return{type:I,value:{uuid:n,label:t}}},An=function(e){return{type:_,value:e}},Ln=t(41686),Vn="Load part error",Gn="Snapshot error",In="Unable to save screenshot",_n=function(e){var n=new on.ZzF;e.children.forEach((function(e){if(e.visible&&"Part"===e.type){var t=e.boundingBox,i=new on.Pa4(Math.min(n.min.x,t.min.x),Math.min(n.min.y,t.min.y),Math.min(n.min.z,t.min.z)),r=new on.Pa4(Math.max(n.max.x,t.max.x),Math.max(n.max.y,t.max.y),Math.max(n.max.z,t.max.z));n.set(i,r)}}));var t=new on.aLr;n.getBoundingSphere(t),e.boundingBox=n,e.boundingSphere=t},Bn=function(e,n,t){var i=n.object.position.distanceTo(n.target)*t*.01,r=n.target.clone().sub(e.position).normalize().multiplyScalar(i);e.position.add(r)},Hn=void 0,Yn=function(e,n){Bn(e,n,1);Hn=requestAnimationFrame((function(){return Yn(e,n)}))},Wn=function(e,n){Bn(e,n,-1);Hn=requestAnimationFrame((function(){return Wn(e,n)}))},qn=function(){Hn&&cancelAnimationFrame(Hn),Hn=void 0},Kn=function(e,n,t){var i=e.boundingSphere,r=i.center,a=2*i.radius/(2*Math.atan(Math.PI*n.fov/360)),l=a/n.aspect,o=1.1*Math.max(a,l),u=t.target.clone().sub(n.position).normalize().multiplyScalar(o);t.target.copy(r),t.minDistance=o/10,t.maxDistance=10*o,n.position.copy(r).sub(u),n.near=o/100,n.far=100*o,n.updateProjectionMatrix()},Jn=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r,a,l,u){var s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Nn((function(e,n,t,i){n?(e.highlight(n),setTimeout((function(){return u(Un({uuid:n,label:t}))}),1)):i?u(An({x:i.x,y:i.y,z:i.z})):(e.unhighlight(),setTimeout((function(){return u(zn())}),1))}),(function(e,n,t){e.getSelected().find((function(e){return e.uuid===n}))?(e.unselect(n),setTimeout((function(){return u(Rn({uuid:n,label:t}))}),1)):(e.select(n),setTimeout((function(){return u(Fn({uuid:n,label:t}))}),1))})),e.next=5,s.load(n,t,l.sectionViewHelper.getClippingPlane());case 5:c=e.sent,u(Dn(c)),i.add(c),_n(i),Kn(i,r,a),l.gridHelper.update(),l.gridHelper.update(),l.gridHelper.setVisible(!0),c.children[0].userData.lut?(l.colorbarHelper.setLUT(c.children[0].userData.lut),l.colorbarHelper.setVisible(!0)):l.colorbarHelper.setVisible(!1),l.pointHelper.build();case 15:case"end":return e.stop()}}),e)})));return function(n,t,i,r,a,l,o){return e.apply(this,arguments)}}(),$n=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r){var a,l,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=r.domElement.width,l=r.domElement.height,u=i.aspect,520,312,r.domElement.width=520,r.domElement.height=312,i.aspect=520/312,i.updateProjectionMatrix(),r.clear(),r.setViewport(0,0,520,312),r.render(t,i),s=r.domElement.toDataURL(),r.domElement.width=a,r.domElement.height=l,i.aspect=u,i.updateProjectionMatrix(),e.next=20,Ln.Z.add({name:"snapshot",uid:"snapshot_"+(0,un.Z)(),data:s},{id:n.id});case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),(0,k.lt)(Gn,e.t0);case 25:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(n,t,i,r){return e.apply(this,arguments)}}(),Xn=function(e){var n=e.loading,t=e.project,r=e.part,a=(0,c.useRef)(null),l=(0,c.useRef)(),f=(0,c.useRef)(),h=(0,c.useRef)(),v=(0,c.useRef)(),x=(0,c.useRef)(),b=(0,c.useRef)(),y=(0,c.useRef)(),j=(0,c.useRef)(),w=(0,c.useRef)(),Z=(0,c.useRef)(),S=(0,c.useRef)(),P=(0,c.useState)(!1),C=P[0],E=P[1],N=(0,c.useState)(!1),M=N[0],O=N[1],T=(0,c.useState)(!1),D=T[0],U=T[1],z=(0,c.useState)(!1),F=z[0],R=z[1],A=(0,s.useRouter)(),L=(0,c.useContext)(B),V=L.enabled,G=L.part,I=L.highlighted,_=L.selected,H=L.point,Y=L.type,W=L.dispatch;(0,c.useEffect)((function(){if(fn.Z.isWebGLAvailable()){var e,n=a.current,t=n.clientWidth,i=n.clientHeight;l.current=new on.xsS,f.current=new on.cPb(50,t/i,.1,1e3),f.current.position.z=10;var r=new on.Mig("#aaa",.75);l.current.add(r);var o=new on.cek("#fff",.5);o.decay=2,f.current.add(o),l.current.add(f.current),h.current=new on.CP7({antialias:!0,alpha:!0}),h.current.setClearColor("#ffffff"),h.current.setSize(t,i),h.current.setPixelRatio(window.devicePixelRatio||1),h.current.shadowMap.enabled=!0,h.current.autoClear=!1,n.appendChild(h.current.domElement);var u=new cn.C(l.current,f.current);v.current=new dn.f(new on.FM8(t,i),l.current,f.current),v.current.visibleEdgeColor.set("#FAD114"),v.current.hiddenEdgeColor.set("#FAD114"),x.current=new mn.xC(h.current),x.current.addPass(u),x.current.addPass(v.current),b.current=new sn.$(f.current,n),b.current.rotateSpeed=3,b.current.panSpeed=.1;var s=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{offsetWidth:0,offsetHeight:0,width:150,height:150},i=t.offsetWidth,r=t.offsetHeight,a=t.width,l=t.height,o="green",u="blue",s="black",c=i,d=r,m=a,f=l,p=pn("red");p.rotateZ(-Math.PI/2);var h=hn(e,"X",{position:new on.Pa4(1.1,0,0)}),v=pn(o),x=hn(e,"Y",{position:new on.Pa4(0,1.1,0)}),b=pn(u);b.rotateX(Math.PI/2);var y=hn(e,"Z",{position:new on.Pa4(0,0,1.1)}),g=new on.xo$(.05,50,50),j=new on.vBJ({color:s}),w=new on.Kj0(g,j),Z=new on.ZAu;Z.type="AxisHelper",Z.add(p),Z.add(h),Z.add(v),Z.add(x),Z.add(b),Z.add(y),Z.add(w);var k=new on.xsS;k.add(Z);var S=new on.iKG(-1.2,1.2,1.2,-1.2,-2,2),P=function(e){var n=e.newOffsetWidth,t=e.newOffsetHeight,i=e.newWidth,r=e.newHeight;c=n,d=t,m=i,f=r};return{dispose:function(){g.dispose(),j.dispose(),Z.children.forEach((function(e){"ArrowHelper"!==e.type&&"LabelHelper"!==e.type||e.dispose()})),k.remove(Z)},render:function(){e.setViewport(c,d,m,f),S.rotation.copy(n.rotation),e.render(k,S)},resize:P}}(h.current,f.current,{offsetWidth:t-155,offsetHeight:i-155,width:150,height:150}),c=function(e,n,t,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{offsetWidth:0,offsetHeight:0,width:150,height:150},a=r.offsetWidth,l=r.offsetHeight,o=r.width,u=r.height,s="#d3d3d3",c="#ffffff",d="#000000",m="#FAD114",f=100,p=.25,h=null,v=null,x=[{text:"FRONT",normal:new on.Pa4(0,0,1),up:new on.Pa4(0,1,0)},{text:"BACK",normal:new on.Pa4(0,0,-1),up:new on.Pa4(0,1,0)},{text:"RIGHT",normal:new on.Pa4(1,0,0),up:new on.Pa4(0,1,0)},{text:"LEFT",normal:new on.Pa4(-1,0,0),up:new on.Pa4(0,1,0)},{text:"UP",normal:new on.Pa4(0,1,0),up:new on.Pa4(0,0,-1)},{text:"DOWN",normal:new on.Pa4(0,-1,0),up:new on.Pa4(0,0,1)}],b=new on._12(f*(1-p),f*(1-p)),y=new on.TOt(b),g=new on.xo$(f*(1-p)/2,10,10,0,Math.PI,0),j=new on.ZAu;x.forEach((function(e){var n=document.createElement("canvas"),t=n.getContext("2d");n.width=n.height=256,t.fillStyle=s,t.fillRect(0,0,n.width,n.height),t.font="bold 50pt sans-serif",t.fillStyle=d,t.textAlign="center",t.textBaseline="middle",t.fillText(e.text,n.width/2,n.height/2);var i=new on.ROQ(n);i.needsUpdate=!0;var r=new on.vBJ({map:i}),a=new on.vBJ({color:s}),l=new on.Kj0(b,r),o=new on.Kj0(b,a);o.rotateY(Math.PI);var u=new on.nls({color:c}),m=new on.ejS(y,u),p=new on.vBJ({color:s,transparent:!0,opacity:.2}),h=new on.Kj0(g,p),v=new on.ZAu;v.add(l,o,m,h),v.lookAt(e.normal),v.translateZ(f/2),v.normal=e.normal,v.up=e.up,j.add(v)}));var w=new on.Mig("#ffffff",1),Z=new on.xsS;Z.add(j),Z.add(w);var k=new on.iKG(-f,f,f,-f,-f,f);k.position.z=2;var S=new on.iMs,P=function(e){var n=C(e);E(n)?(h=N(n),M(),(null===h||void 0===h?void 0:h.uuid)!==(null===v||void 0===v?void 0:v.uuid)&&(O(),v=h)):(h=null,O())},C=function(e){var n=e.target.getBoundingClientRect(),t=e.clientX-n.left,i=e.clientY-n.top,r=new on.FM8;return r.x=(t-a)/o*2-1,r.y=-(i+u-n.height+l)/u*2+1,r},E=function(e){return e.x>-1&&e.x<1&&e.y>-1&&e.y<1},N=function(e){var n=new on.Pa4(e.x,e.y,-1);n.unproject(k);var t=new on.Pa4;k.getWorldDirection(t),S.set(n,t);var i=S.intersectObjects(Z.children,!0);return i.length?i[0].object.parent:null},M=function(){h&&h.children&&h.children.forEach((function(e){var n=e;n.material&&n.material.color&&(n.material.previousColor=n.material.color,n.material.color=new on.Ilk(m))}))},O=function(){v&&v.children&&v.children.forEach((function(e){var n=e;n.material&&n.material.color&&(n.material.color=new on.Ilk(s))}))},T=function(e){if(h){var r=h.normal,a=h.up,l=new on.Pa4;n.boundingBox&&n.boundingBox.getCenter(l);var o=t.position.distanceTo(i.target),u=r.clone().multiplyScalar(o),s=l.add(u);t.position.copy(s),t.up.copy(a),h=null,O(),P(e)}};e.domElement.addEventListener("pointermove",P),e.domElement.addEventListener("pointerdown",T);var D=function(e){var n=e.newOffsetWidth,t=e.newOffsetHeight,i=e.newWidth,r=e.newHeight;a=n,l=t,o=i,u=r},U=function(){e.domElement.removeEventListener("pointermove",P),e.domElement.removeEventListener("pointerdown",T),j.children.forEach((function(e){e.children.forEach((function(e){var n=e;n.geometry.dispose(),n.material.dispose()}))})),Z.remove(j)};return{resize:D,render:function(){e.setViewport(a,l,o,u),k.rotation.copy(t.rotation),e.render(Z,k)},dispose:U}}(h.current,l.current,f.current,b.current,{offsetWidth:t-155,offsetHeight:i-155,width:150,height:150});y.current=xn(h.current,l.current,f.current,b.current),j.current=function(e,n,t,i){var r=document.createElement("div");r.style.pointerEvents="none",r.style.border="1px solid #55aaff",r.style.backgroundColor="rgba(75, 160, 255, 0.3)",r.style.position="fixed";var a=new on.FM8,l=new on.FM8,o=new on.FM8,u=new on.FM8,s=!1,c=!1,d=new on.iMs,m=function(){s=!1},f=function(e){s&&0===e.button&&(c=!0,v(e))},p=function(e){s&&c&&x(e)},h=function(e){c=!1,s&&b(e)};e.domElement.addEventListener("pointerdown",f),e.domElement.addEventListener("pointermove",p),e.domElement.addEventListener("pointerup",h);var v=function(n){i.enabled=!1,e.domElement.parentElement.appendChild(r),r.style.left=n.clientX+"px",r.style.top=n.clientY+"px",r.style.width="0px",r.style.height="0px",a.x=n.clientX,a.y=n.clientY},x=function(e){u.x=Math.max(a.x,e.clientX),u.y=Math.max(a.y,e.clientY),o.x=Math.min(a.x,e.clientX),o.y=Math.min(a.y,e.clientY),r.style.left=o.x+"px",r.style.top=o.y+"px",r.style.width=u.x-o.x+"px",r.style.height=u.y-o.y+"px"},b=function(e){i.enabled=!0,r.parentElement&&r.parentElement.removeChild(r),l.x=e.clientX,l.y=e.clientY;var n=new on.TUj(a,l);y(n),m()},y=function(r){var a=new on.FM8;if(r.getSize(a),!(a.x<5||a.y<5)){var l=new on.FM8((r.max.x+r.min.x)/2,(r.max.y+r.min.y)/2),o=e.domElement.getBoundingClientRect(),u=l.x-o.left,s=l.y-o.top,c=new on.FM8(u/o.width*2-1,-s/o.height*2+1),m=n.children.find((function(e){return"Part"===e.type}));if(m){d.setFromCamera(c,t);var f=d.intersectObject(m);if(f.length){i.target.copy(f[0].point);var p=new on.FM8(a.x/o.width,a.y/o.height),h=1-Math.max(p.x,p.y),v=t.position.distanceTo(i.target)*h,x=i.target.clone().sub(t.position).normalize().multiplyScalar(v);t.position.add(x)}}}};return{dispose:function(){e.domElement.removeEventListener("pointerdown",f),e.domElement.removeEventListener("pointermove",p),e.domElement.removeEventListener("pointerup",h)},end:m,isEnabled:function(){return s},start:function(){s=!0}}}(h.current,l.current,f.current,b.current),w.current=jn(h.current,l.current,f.current,b.current),Z.current=Zn(h.current),Z.current.setVisible(!1),S.current=kn(l.current);var d=function(){b.current.update(),h.current.setViewport(0,0,t,i),h.current.render(l.current,f.current),y.current.update(),x.current.render(),s.render(),c.render(),Z.current.render()},m=function(){t=n.clientWidth,i=n.clientHeight,f.current.aspect=t/i,f.current.updateProjectionMatrix(),h.current.setSize(t,i),x.current.setSize(t,i),s.resize({newOffsetWidth:t-155,newOffsetHeight:i-155,newWidth:150,newHeight:150}),c.resize({newOffsetWidth:t-155,newOffsetHeight:i-155,newWidth:150,newHeight:150}),d()},p=function(){d(),requestAnimationFrame(p)};return window.addEventListener("resize",m),e=requestAnimationFrame(p),function(){e&&cancelAnimationFrame(e),e=void 0,window.removeEventListener("resize",m),n.removeChild(h.current.domElement),l.current.children.forEach((function(e){l.current.remove(e)})),s.dispose(),c.dispose(),y.current.dispose(),w.current.dispose(),j.current.dispose(),S.current.dispose()}}A.push("/webgl")}),[A]),(0,c.useEffect)((function(){var e;l.current&&(l.current.children.find((function(e){return"Part"===e.type&&e.uuid===(null===r||void 0===r?void 0:r.summary.uuid)}))||(l.current.children.forEach((function(e){if("Part"===e.type){var n=e;l.current.remove(n),n.dispose()}})),r?Jn(r,C,l.current,f.current,b.current,{gridHelper:y.current,sectionViewHelper:w.current,colorbarHelper:Z.current,pointHelper:S.current},W).catch((function(e){(0,k.lt)(Vn,e),_n(l.current)})):(_n(l.current),y.current.update(),null===(e=S.current)||void 0===e||e.build())))}),[r,C,W]),(0,c.useEffect)((function(){if(l.current)if(2===(null===r||void 0===r?void 0:r.summary.dimension)){_n(l.current);var e=new on.Pa4(0,0,1),n=new on.Pa4(0,1,0),t=new on.Pa4;l.current.boundingBox.getCenter(t);var i=f.current.position.distanceTo(b.current.target),a=e.clone().multiplyScalar(i),o=t.add(a);f.current.position.copy(o),f.current.up.copy(n),b.current.noRotate=!0}else b.current.noRotate=!1}),[r]),(0,c.useEffect)((function(){l.current&&l.current.children.forEach((function(e){if("Part"===e.type&&e.uuid===(null===G||void 0===G?void 0:G.uuid)){var n=e;V?n.startSelection(h.current,f.current,v.current,Y):n.stopSelection()}}))}),[V,G,Y]),(0,c.useEffect)((function(){l.current&&l.current.children.forEach((function(e){if("Part"===e.type&&e.uuid===(null===G||void 0===G?void 0:G.uuid)){var n=e;n.highlight(null===I||void 0===I?void 0:I.uuid);var t=n.getSelected();_.filter((function(e){return!t.find((function(n){return n.uuid===e.uuid}))})).forEach((function(e){e.uuid&&n.select(e.uuid)})),t.filter((function(e){return!_.find((function(n){return n.uuid===e.uuid}))})).forEach((function(e){n.unselect(e.uuid)}))}}))}),[G,I,_]),(0,c.useEffect)((function(){var e;l.current&&(null===(e=S.current)||void 0===e||e.update(H?new on.Pa4(H.x,H.y,H.z):void 0))}),[H]);var q=(0,c.useCallback)((function(e){E(e),l.current.children.forEach((function(n){"Part"===n.type&&n.setTransparent(e)}))}),[]),K=(0,c.useCallback)((function(){var e=!M;O(e),e?w.current.start():w.current.stop()}),[M]);return(0,u.jsxs)(d.Z,{className:"View no-scroll",children:[(0,u.jsx)(d.Z.Header,{className:"View-header",children:(0,u.jsxs)("div",{className:"View-controls-main",children:[(0,u.jsx)(Be.Z,{title:"Take snasphot",placement:"right",children:(0,u.jsx)(He.Z,{placement:"bottom",overlay:(0,u.jsx)(m.Z,{items:[{key:"project",label:(0,u.jsx)(p.Z,{type:"text",loading:D,onClick:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return U(!0),e.prev=1,e.next=4,$n(t,l.current,f.current,h.current);case 4:return e.prev=4,U(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])}))),children:"Project snapshot"})},{key:"image",label:(0,u.jsx)(p.Z,{type:"text",loading:F,onClick:function(){R(!0);try{!function(e,n,t,i){try{var r=i.domElement.width,a=i.domElement.height;i.clear(),i.setViewport(0,0,r,a),i.render(n,t);var l=i.domElement.toDataURL(),o=document.createElement("a");o.href=l.replace("image/png","image/octet-stream"),o.download=e.title+"_"+(new Date).toLocaleDateString()+".png",o.click()}catch(u){(0,k.lt)(In,u)}}(t,l.current,f.current,h.current)}finally{R(!1)}},children:"Export image"})}]}),children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(Ke.Z,{})})})}),(0,u.jsx)(Ye.Z,{className:"no-margin"}),(0,u.jsx)(Be.Z,{title:"Display grid",placement:"right",children:(0,u.jsx)(We.Z,{defaultChecked:!0,checkedChildren:(0,u.jsx)(Je.Z,{}),unCheckedChildren:(0,u.jsx)(Je.Z,{}),onChange:function(e){return function(e,n){e.setVisible(n)}(y.current,e)}})}),(0,u.jsx)(Be.Z,{title:"Set transparency",placement:"right",children:(0,u.jsx)(We.Z,{className:"transparent",checked:C,checkedChildren:(0,u.jsx)($e.Z,{}),unCheckedChildren:(0,u.jsx)($e.Z,{}),onChange:q})}),(0,u.jsx)(Ye.Z,{className:"no-margin"}),(0,u.jsx)(Be.Z,{title:"Zoom out",placement:"right",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(Xe.Z,{}),onMouseDown:function(){return Wn(f.current,b.current)},onMouseUp:qn,onMouseOut:qn})}),(0,u.jsx)(Be.Z,{title:"Zoom to fit",placement:"right",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(Qe.Z,{}),onClick:function(){return Kn(l.current,f.current,b.current)}})}),(0,u.jsx)(Be.Z,{title:"Zoom in",placement:"right",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(en.Z,{}),onMouseDown:function(){return Yn(f.current,b.current)},onMouseUp:qn,onMouseOut:qn})}),(0,u.jsx)(Be.Z,{title:"Zoom to selection",placement:"right",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(nn.Z,{}),onClick:function(){return j.current.isEnabled()?j.current.end():j.current.start()}})}),(0,u.jsx)(Ye.Z,{className:"no-margin"}),!M&&(0,u.jsx)(Be.Z,{title:"Section view",placement:"right",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(tn.Z,{}),onClick:K})}),M&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Be.Z,{title:"Stop",placement:"left",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(rn.Z,{}),onClick:K})}),(0,u.jsx)(Be.Z,{title:"Hide plane",placement:"left",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(an.Z,{}),onClick:function(){return w.current.toggleVisible()}})}),(0,u.jsx)(Be.Z,{title:"Snap to X",placement:"left",children:(0,u.jsx)(p.Z,{className:"ant-btn-icon-only",onClick:function(){return w.current.toAxis(new on.Pa4(-1,0,0))},children:"X"})}),(0,u.jsx)(Be.Z,{title:"Snap to Y",placement:"left",children:(0,u.jsx)(p.Z,{className:"ant-btn-icon-only",onClick:function(){return w.current.toAxis(new on.Pa4(0,-1,0))},children:"Y"})}),(0,u.jsx)(Be.Z,{title:"Snap to Z",placement:"left",children:(0,u.jsx)(p.Z,{className:"ant-btn-icon-only",onClick:function(){return w.current.toAxis(new on.Pa4(0,0,-1))},children:"Z"})}),(0,u.jsx)(Be.Z,{title:"Flip",placement:"left",children:(0,u.jsx)(p.Z,{onClick:function(){return w.current.flip()},icon:(0,u.jsx)(ln.Z,{})})})]})]})}),(0,u.jsxs)(d.Z.Content,{className:"View-content no-scroll",children:[(0,u.jsx)("div",{style:{display:n?"flex":"none"},className:"View-loading",children:(0,u.jsx)(qe.Z,{indicator:(0,u.jsx)(g.Z,{className:"View-loading-spin",style:{fontSize:80},spin:!0})})}),(0,u.jsx)("div",{ref:a,className:"View-canvas"})]})]})},Qn="Unable to load part",et=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"geometry"!==i){e.next=8;break}return r=t,e.next=5,me.getPart({id:r.id});case 5:case 11:return e.abrupt("return",e.sent);case 8:return a=t,e.next=11,_e.load({id:n.id},{originPath:a.originPath,glb:a.glb});case 12:e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(0),(0,k.lt)(Qn,e.t0),e.t0;case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(n,t,i){return e.apply(this,arguments)}}(),nt=function(e){var n=e.project,t=e.simulation,i=e.geometry,r=e.result,a=e.postprocessing,l=(0,c.useState)(),o=l[0],s=l[1],d=(0,c.useState)(),m=d[0],f=d[1],p=(0,c.useState)(!1),h=p[0],v=p[1];return(0,c.useEffect)((function(){var e;if(t&&a)a.glb!==(null===(e=m)||void 0===e?void 0:e.glb)&&(f(a),v(!0),et(t,a,"result").then((function(e){return s(e)})).catch((function(e){})).finally((function(){return v(!1)})));else if(t&&r){var n;r.glb!==(null===(n=m)||void 0===n?void 0:n.glb)&&(f(r),v(!0),et(t,r,"result").then((function(e){return s(e)})).catch((function(e){})).finally((function(){return v(!1)})))}else if(i){var l;i.id!==(null===(l=m)||void 0===l?void 0:l.id)&&(f(i),v(!0),i.needCleanup?(s(void 0),v(!1)):et(void 0,i,"geometry").then((function(e){return s(e)})).catch((function(e){})).finally((function(){return v(!1)})))}}),[t,i,r,a,m]),(0,u.jsx)(Xn,{loading:h,project:{id:n.id,title:n.title},part:o})},tt=t(14924),it=t(32808),rt=t(62800),at=t(25025),lt=t(56299),ot=t(18870),ut=t(9253),st=t(51584),ct=t(14195),dt=t(3023),mt=t(75358),ft=t(14888),pt=t(44141),ht=t(96486),vt=t(60877),xt="Unable to download CSV",bt=function(e){var n=e.simulation,t=(0,c.useState)(!1),i=t[0],l=t[1],o=(0,c.useState)(),s=o[0],m=o[1],f=(0,c.useState)(),h=f[0],v=f[1],x=(0,c.useState)(),b=x[0],y=x[1],g=(0,c.useState)(),j=g[0],w=g[1],S=(0,c.useState)([!0]),P=S[0],E=S[1],N=(0,c.useState)(),M=N[0],O=N[1],T=(0,c.useState)(!1),D=T[0],U=T[1],z=(0,r.Z)(ae.useSimulation(null===n||void 0===n?void 0:n.id),1)[0];return(0,c.useEffect)((function(){var e=null===z||void 0===z?void 0:z.tasks;if(!e)return m(void 0),v(void 0),void y(void 0);var n=e.map((function(e){return e.datas})).filter((function(e){return e})).flatMap((function(e){return e}));if(!n.length||!n[0].names)return v(void 0),void y(void 0);n.sort((function(e,n){return e.x-n.x}));var t=n.map((function(e){return e.names})).flatMap((function(e){return e})).filter((function(e,n,t){return t.findIndex((function(n){return n===e}))===n})),i=t.map((function(e){return(0,ht.camelCase)(e)})),r=[];n.forEach((function(e,n){e.names.forEach((function(t,i){var a=r.find((function(n){return n.x===e.x}));a?a[(0,ht.camelCase)(t)]=e.ys[i]:r.push((0,tt.Z)({key:n,x:e.x},(0,ht.camelCase)(t),e.ys[i]))}))})),m(r),v(t),y(i)}),[z]),(0,c.useEffect)((function(){if(s&&h&&b){var e=h.map((function(e,n){return{align:"center",className:"Data-column"+(P[n]?" Data-column-selected":""),title:(0,u.jsxs)(C.Z,{children:[e,(0,u.jsx)(it.Z,{checked:P[n],onChange:function(e){return E(function(e,n,t){var i=e.target.checked,r=(0,a.Z)(t);return r[n]=i,r}(e,n,P))},children:(0,u.jsx)(lt.Z,{style:{fontSize:20}})})]}),dataIndex:b[n],key:b[n]}}));e.unshift({title:"",dataIndex:"x",key:"x"}),w(e)}else w(void 0)}),[s,h,b,P]),(0,c.useEffect)((function(){var e,n;if(s&&h&&b){var t=[],i=P.map((function(e,n){if(e){var i=b[n],r=h[n];return t.push(i),(0,u.jsx)(ot.x,{name:r,type:"monotone",dataKey:i,stroke:vt.Z.stringToColor(i),strokeWidth:2},n)}})).filter((function(e){return e})),r=s.map((function(e){var n={x:e.x};return t.forEach((function(t){e[t]&&(n[t]=e[t])})),n})).filter((function(e){return e})),l=(e=Math).min.apply(e,(0,a.Z)(t.flatMap((function(e){return r.map((function(n){return n[e]}))})))),o=(n=Math).max.apply(n,(0,a.Z)(t.flatMap((function(e){return r.map((function(n){return n[e]}))}))));O({data:r,min:l,max:o,lines:i})}else O(void 0)}),[s,h,b,P]),n&&s&&h&&b?(0,u.jsx)(d.Z,{style:{position:"absolute",zIndex:100,right:50,bottom:25,backgroundColor:"rgba(255, 255, 255, 0)"},children:(0,u.jsxs)(d.Z.Content,{children:[(0,u.jsx)(Be.Z,{title:"Data visualization",children:(0,u.jsx)(p.Z,{type:"primary",icon:(0,u.jsx)(lt.Z,{}),onClick:function(){return l(!0)},style:{width:40,height:40,border:"1px solid #5E14FA",borderRadius:20,marginBottom:-20}})}),(0,u.jsx)(rt.Z,{title:"Data visualization",placement:"bottom",closable:!0,onClose:function(){return l(!1)},visible:i,mask:!1,maskClosable:!1,height:"50vh",bodyStyle:{height:"100%",overflow:"hidden"},extra:(0,u.jsx)(Z.o6,{bordered:!0,loading:D,disabled:!s,onDownload:function(){U(!0);try{!function(e,n,t,i){var r="";r="x,"+t.join(",")+"\n",n.forEach((function(e){r+=e.x,null===i||void 0===i||i.forEach((function(n){void 0!==e[n]&&(r+=","+e[n])})),r+="\n"}));var a=e.name+".csv",l=new File([r],a,{type:"text/csv"}),o=window.URL.createObjectURL(l),u=document.createElement("a");u.href=o,u.setAttribute("download",a),u.click(),u.remove()}(n,s,h,b)}catch(e){(0,k.lt)(xt,e)}finally{U(!1)}},children:"Export CSV"}),children:(0,u.jsxs)("div",{style:{display:"flex",height:"100%",padding:"10px"},children:[(0,u.jsx)("div",{style:{display:"flex",height:"100%",width:"50%",overflow:"auto"},children:(0,u.jsx)(at.Z,{size:"small",dataSource:s,columns:j,pagination:!1})}),(0,u.jsx)(ut.h,{width:"50%",height:"100%",children:(0,u.jsxs)(st.w,{data:null===M||void 0===M?void 0:M.data,margin:{top:0,right:40,left:40,bottom:0},children:[(0,u.jsx)(ct.q,{strokeDasharray:"3 3"}),(0,u.jsx)(dt.K,{dataKey:"x"}),(0,u.jsx)(mt.B,{domain:[(null===M||void 0===M?void 0:M.min)||-1,(null===M||void 0===M?void 0:M.max)||1]}),(0,u.jsx)(ft.u,{}),(0,u.jsx)(pt.D,{}),null===M||void 0===M?void 0:M.lines]})})]})})]})}):null},yt=t(34041),gt=t(82071),jt=t(28058),wt=t(23389),Zt=t(93398),kt={category:"Academic",name:"Poisson's equation",algorithm:"poisson",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Poisson\'s equation\n  </h3>\n  <p>\n  Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n  The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n  The Poisson\'s equation reads as follow:\n  \\begin{align}\n    \\Delta u &= f &\\text{on }\\Omega\\\\\n    u &= u_D &\\text{on }\\Gamma_D\\\\\n    \\nabla u &= g_N &\\text{on }\\Gamma_N\n  \\end{align}\n  </p>\n  <figure>\n    <img src="/images/Poisson.png" alt="Poisson" />\n    <figcaption>Poisson\'s equation example on a cube.</figcaption>\n  </figure>\n  <p>\n      See <a target="_blank" href="https://en.wikipedia.org/wiki/Poisson%27s_equation">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},parameters:{index:2,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force",htmlEntity:"formula",default:0}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"u",htmlEntity:"select",options:[{label:"P1",value:"P1"},{label:"P2",value:"P2"}],default:"P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]}},boundaryConditions:{index:3,title:"Boundary conditions",dirichlet:{label:"Dirichlet",children:[{label:"u",htmlEntity:"formula",default:0}]},neumann:{label:"Neumann",children:[{label:"du/dn",htmlEntity:"formula",default:0}]}},run:{index:4,title:"Run",results:[{name:"u"}]}}},St={category:"Mechanics",name:"Linear elasticity",algorithm:"linearElasticity",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Linear elasticity\n  </h3>\n  <p>\n  Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n  The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n    \\(u\\) is the displacement.<br/>\n\n  The linear elasticity equation reads as follow:\n\n  $$\n  \\begin{align}\n    -\\text{div}(\\sigma) &= f &\\text{on }\\Omega\\\\\n    u &= u_D&\\text{on }\\Gamma_D\\\\\n    \\sigma\\cdot n &= u_N&\\text{on }\\Gamma_N\n  \\end{align}\n  $$\n\n  With \\(\\sigma_{ij}(u) = \\lambda\\delta_{ij}\\nabla\\cdot u + 2\\mu\\epsilon_{ij}(u)\\).<br/>\n\n  \\(\\lambda\\) and \\(\\mu\\) are the Lam\xe9 coefficients.\n  </p>\n  <figure>\n    <img src="/images/LinearElasticity.png" alt="Linear Elasticity" />\n    <figcaption>Linear elasticity equation example on a beam.</figcaption>\n  </figure>\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Linear_elasticity">Wikipedia</a>.\n  </p>\n  ',variables:[{name:"Displacement (x)",value:"Ux"},{name:"Displacement (y)",value:"Uy"},{name:"Displacement (z)",value:"Uz"}],configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Density",name:"Rho",htmlEntity:"formula",default:8050,unit:"\\(kg.m^{-3}\\)"},{label:"Young's modulus",name:"E",htmlEntity:"formula",default:1e9,unit:"\\(Pa\\)"},{label:"Poisson's ratio",name:"Nu",htmlEntity:"formula",default:.4,unit:"\\(1\\)"}]},parameters:{index:3,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force (x)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{label:"External force (y)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{only3D:!0,label:"External force (z)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"[Ux, Uy, Uz]",label2D:"[Ux, Uy]",htmlEntity:"select",options:[{label:"P1",value:"P1, P1, P1",value2D:"P1, P1"},{label:"P2",value:"P2, P2, P2",value2D:"P2, P2"}],default:"P1, P1, P1",default2D:"P1, P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]},meshAdaptation:{advanced:!0,label:"Mesh adaptation",children:[{label:"Enabled",htmlEntity:"checkbox",default:!1},{label:"Number of mesh adaptation loops",htmlEntity:"formula",default:1}]}},boundaryConditions:{index:4,title:"Boundary conditions",fixed:{label:"Fixed",refineFactor:2},displacement:{label:"Displacement",children:[{label:"Ux",htmlEntity:"formula",default:0,unit:"\\(m\\)"},{label:"Uy",htmlEntity:"formula",default:0,unit:"\\(m\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:0,unit:"\\(m\\)"}],refineFactor:2},presure:{label:"Surface force",children:[{label:"d(U)/d(N)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-2}\\)"}],refineFactor:2}},run:{index:5,title:"Run",results:[{name:"Displacement"},{name:"vonMises"},{name:"gamma11"},{name:"gamma12"},{name:"gamma13"},{name:"gamma22"},{name:"gamma23"},{name:"gamma33"}],postprocessing:[{key:"warpByVector",parameters:[{key:"Vectors",value:"Displacement"}]},{key:"contour",parameters:[{key:"ContourBy",options:["Displacement","vonMises","gamma11","gamma12","gamma13","gamma22","gamma23","gamma33"]}]}]}}},Pt={category:"Mechanics",name:"Linear elasticity (time depedent)",algorithm:"linearElasticityTime",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Linear elasticity (time dependent)\n  </h3>\n  <p>\n  Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n  The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n    \\(u\\) is the displacement.<br/>\n\n  The linear elasticity equation reads as follow:\n\n  $$\n  \\begin{align}\n    \\frac{\\partial^2u}{\\partial t^2}-\\text{div}(\\sigma) &= f &\\text{on }\\Omega\\\\\n    u &= u_D&\\text{on }\\Gamma_D\\\\\n    \\sigma\\cdot n &= u_N&\\text{on }\\Gamma_N\n  \\end{align}\n  $$\n\n  With \\(\\sigma_{ij}(u) = \\lambda\\delta_{ij}\\nabla\\cdot u + 2\\mu\\epsilon_{ij}(u)\\).<br>\n\n  \\(\\lambda\\) and \\(\\mu\\) are the Lam\xe9 coefficients.\n  </p>\n  <figure>\n    <img src="/images/LinearElasticity.png" alt="Linear Elasticity" />\n    <figcaption>Linear elasticity equation example on a beam.</figcaption>\n  </figure>\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Linear_elasticity">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Density",name:"Rho",htmlEntity:"formula",default:8050,unit:"\\(kg.m^{-3}\\)"},{label:"Young's modulus",name:"E",htmlEntity:"formula",default:1e9,unit:"\\(Pa\\)"},{label:"Poisson's ratio",name:"Nu",htmlEntity:"formula",default:.4,unit:"\\(1\\)"}]},parameters:{index:3,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force (x)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{label:"External force (y)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{only3D:!0,label:"External force (z)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"}]},time:{label:"Time",children:[{label:"Total time",htmlEntity:"formula",default:1,unit:"\\(s\\)"},{label:"Time step",htmlEntity:"formula",default:.1,unit:"\\(s\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"[Ux, Uy, Uz]",label2D:"[Ux, Uy]",htmlEntity:"select",options:[{label:"P1",value:"P1, P1, P1",value2D:"P1, P1"},{label:"P2",value:"P2, P2, P2",value2D:"P2, P2"}],default:"P1, P1, P1",default2D:"P1, P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]},meshAdaptation:{advanced:!0,label:"Mesh adaptation",children:[{label:"Enabled",htmlEntity:"checkbox",default:!1}]}},boundaryConditions:{index:4,title:"Boundary conditions",fixed:{label:"Fixed",refineFactor:2},displacement:{label:"Displacement",children:[{label:"Ux",htmlEntity:"formula",default:0,unit:"\\(m\\)"},{label:"Uy",htmlEntity:"formula",default:0,unit:"\\(m\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:0,unit:"\\(m\\)"}],refineFactor:2},presure:{label:"Surface force",children:[{label:"d(U)/d(N)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-2}\\)"}],refineFactor:2}},run:{index:5,title:"Run",results:[{name:"Displacement"},{name:"vonMises"},{name:"gamma11"},{name:"gamma12"},{name:"gamma13"},{name:"gamma22"},{name:"gamma23"},{name:"gamma33"}],resultsFilter:{name:"Time",prefixPattern:"Result_",suffixPattern:".vtu",pattern:"Result_\\d+.vtu",multiplicator:["parameters","time","children","1"]},postprocessing:[{key:"warpByVector",parameters:[{key:"Vectors",value:"Displacement"}]},{key:"contour",parameters:[{key:"ContourBy",options:["Displacement","vonMises","gamma11","gamma12","gamma13","gamma22","gamma23","gamma33"]}]}]}}},Ct={category:"Fluid",name:"Stokes",algorithm:"stokes",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Stokes\n  </h3>\n  <p>\n    Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n    The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n    \\(u\\) is the velocity and \\(p\\) the pressure.<br/>\n\n    The Stokes equations reads as follow:\n\n    $$\n    \\begin{align}\n      \\mu\\Delta u - \\nabla p &= f&\\text{on }\\Omega\\\\\n      u &= u_D&\\text{on }\\Gamma_D\\\\\n      \\mu\\frac{\\partial u}{\\partial n} - pn &= g_N&\\text{on }\\Gamma_N\n    \\end{align}\n    $$\n\n    With \\(\\mu\\) the viscosity.\n  </p>\n  <figure>\n    <img src="/images/Stokes.png" alt="Stokes" />\n    <figcaption>Stokes equation example on a pipe.</figcaption>\n  </figure>\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Navier%E2%80%93Stokes_equations">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Dynamic viscosity",name:"Mu",htmlEntity:"formula",default:.001,unit:"\\(Pa.s^{-1}\\)"}]},parameters:{index:3,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force (x)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{label:"External force (y)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{only3D:!0,label:"External force (z)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"[Ux, Uy, Uz, p]",label2D:"[Ux, Uy, p]",htmlEntity:"select",options:[{label:"P2/P1",value:"P2, P2, P2, P1",value2D:"P2, P2, P1"},{label:"P1b/P1",value:"P1b, P1b, P1b, P1",value2D:"P1b, P1b, P1"}],default:"P2, P2, P2, P1",default2D:"P2, P2, P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]}},boundaryConditions:{index:5,title:"Boundary conditions",wall:{label:"Wall"},freeOutlet:{label:"Free outlet"},dirichlet:{label:"Velocity",children:[{label:"Ux",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"},{label:"Uy",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"}],refineFactor:2},neumann:{label:"Pressure",children:[{label:"d(U)/d(N)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-2}\\)"}],refineFactor:2}},run:{index:6,title:"Run",results:[{name:"Velocity"},{name:"Presure"}],postprocessing:[{key:"streamTracer",parameters:[{key:"Vectors",value:"Velocity"}]}]}}},Et={category:"Fluid",name:"Navier-Stokes time-dependant",algorithm:"navierStokesTime",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Navier-Stokes\n  </h3>\n  <p>\n    Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n    The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n    \\(u\\) is the velocity and \\(p\\) the pressure.<br/>\n\n    The Navier-Stokes equations reads as follow:\n\n    $$\n    \\begin{align}\n      \\rho\\frac{\\partial u}{\\partial t} + \\rho(u\\cdot\\nabla)u + \\nabla p - \\mu\\Delta u &= f&\\text{on }\\Omega\\\\\n      u &= u_D&\\text{on }\\Gamma_D\\\\\n      \\mu\\frac{\\partial u}{\\partial n} - pn &= g_N&\\text{on }\\Gamma_N\n    \\end{align}\n    $$\n\n    With \\(\\mu\\) the viscosity and \\(\\rho\\) the density.\n  </p>\n  <figure>\n    <img src="/images/Stokes.png" alt="Stokes" />\n    <figcaption>Navier-Stokes equation example on a pipe.</figcaption>\n  </figure>\n  </p>\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Navier%E2%80%93Stokes_equations">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Density",name:"Rho",htmlEntity:"formula",default:1e3,unit:"\\(kg.m^{-3}\\)"},{label:"Dynamic viscosity",name:"Mu",htmlEntity:"formula",default:.001,unit:"\\(Pa.s^{-1}\\)"}]},parameters:{index:3,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force (x)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{label:"External force (y)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{only3D:!0,label:"External force (z)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"}]},time:{label:"Time",children:[{label:"Total time",htmlEntity:"formula",default:1,unit:"\\(s\\)"},{label:"Time step",htmlEntity:"formula",default:.1,unit:"\\(s\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"[Ux, Uy, Uz, p]",label2D:"[Ux, Uy, p]",htmlEntity:"select",options:[{label:"P2/P1",value:"P2, P2, P2, P1",value2D:"P2, P2, P1"},{label:"P1b/P1",value:"P1b, P1b, P1b, P1",value2D:"P1b, P1b, P1"}],default:"P2, P2, P2, P1",default2D:"P2, P2, P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]}},initialization:{index:4,title:"Initialization",done:!0,direct:{label:"Velocity",children:[{label:"Ux",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"},{label:"Uy",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"}]},coupling:{label:"Coupling",compatibility:[{algorithm:"navierStokesTime",filter:{name:"Time step",prefixPattern:"Result_",suffixPattern:".vtu",pattern:"Result_\\d+.vtu",multiplicator:["parameters","time","children","1"]}}]}},boundaryConditions:{index:5,title:"Boundary conditions",wall:{label:"Wall"},freeOutlet:{label:"Free outlet"},dirichlet:{label:"Velocity",children:[{label:"Ux",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"},{label:"Uy",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"}],refineFactor:2},neumann:{label:"Pressure",children:[{label:"d(U)/d(N)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-2}\\)"}],refineFactor:2}},run:{index:6,title:"Run",results:[{name:"Velocity"},{name:"Presure"}],resultsFilter:{name:"Time",prefixPattern:"Result_",suffixPattern:".vtu",pattern:"Result_\\d+.vtu",multiplicator:["parameters","time","children","1"]}}}},Nt={category:"Thermic",name:"Thermal diffusion",algorithm:"thermicDiffusion",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Thermal diffusion\n  </h3>\n  <p>\n    Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n    The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n      \\(T\\) is the temperature.<br/>\n\n    The heat equation reads as follow:\n\n    $$\n    \\begin{align}\n      \\rho C_p \\frac{\\partial T}{\\partial t} - \\lambda\\Delta T &= f&\\text{on }\\Omega\\\\\n      T &= T_D&\\text{on }\\Gamma_D\\\\\n      \\lambda\\frac{\\partial T}{\\partial n} &= g_N&\\text{on }\\Gamma_N\n    \\end{align}\n    $$\n\n    With \\(\\rho\\) the density, \\(C_p\\) the heat capacity and \\(\\lambda\\) the thermal conductivity.\n  </p>\n\n  <figure>\n    <img src="/images/Heat.png" alt="Heat" />\n    <figcaption>Heat equation example on a beam.</figcaption>\n  </figure>\n  </p>\n\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Navier%E2%80%93Stokes_equations">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Density",name:"Rho",htmlEntity:"formula",default:7960,unit:"\\(kg.m^{-3}\\)"},{label:"Thermal conductivity",name:"Lambda",htmlEntity:"formula",default:15,unit:"\\(W.m^{-1}.K^{-1}\\)"},{label:"Heat capacity",name:"Cp",htmlEntity:"formula",default:502,unit:"\\(J.K^{-1}.kg^{-1}\\)"}]},parameters:{index:3,title:"Parameters",time:{label:"Time",children:[{label:"Total time",htmlEntity:"formula",default:1,unit:"\\(s\\)"},{label:"Time step",htmlEntity:"formula",default:.1,unit:"\\(s\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"T",htmlEntity:"select",options:[{label:"P1",value:"P1"},{label:"P2",value:"P2"}],default:"P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]}},boundaryConditions:{index:4,title:"Boundary conditions",temperature:{label:"Temperature",children:[{label:"T",htmlEntity:"formula",default:0,unit:"K"}],refineFactor:2}},run:{index:5,title:"Run",results:[{name:"T"}],resultsFilter:{name:"Time",prefixPattern:"Result_",suffixPattern:".vtu",pattern:"Result_\\d+.vtu",multiplicator:["parameters","time","children","1"]}}}},Mt=[kt,St,Pt,Ct,Et,Nt],Ot=Mt,Tt=t(4687),Dt=t(57132),Ut="Unable to copy simulation",zt=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(r=vt.Z.deepCopy(t.scheme)).configuration.run.done=!1,r.configuration.run.error=void 0,e.next=6,ae.add({id:n.id},{name:t.name+" (copy)",scheme:r});case 6:l=e.sent,i.addOneSimulation(l),i.mutateProject({id:n.id,simulations:(0,a.Z)(n.simulations).concat([l.id])}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),(0,k.lt)(Ut,e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(n,t,i){return e.apply(this,arguments)}}(),Ft=function(e){var n=e.project,t=e.simulation,r=e.swr,a=(0,c.useState)(!1),l=a[0],s=a[1];return(0,u.jsx)(Be.Z,{title:"Copy",children:(0,u.jsx)(p.Z,{className:"no-border",loading:l,icon:(0,u.jsx)(Dt.Z,{}),onClick:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,e.next=4,zt(n,t,r);case 4:return e.prev=4,s(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])})))})})},Rt="Unable to update the simulation",At=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.update({id:n.id},[{key:"name",value:t.name}]);case 3:i.mutateOneSimulation({id:n.id,name:t.name}),e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),(0,k.lt)(Rt,e.t0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n,t,i){return e.apply(this,arguments)}}(),Lt=function(e){var n=e.simulation,t=e.swr,r=(0,c.useState)(!1),a=r[0],l=r[1],s=(0,c.useState)(!1),d=s[0],m=s[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Z.w6,{onEdit:function(){return l(!0)}}),(0,u.jsx)(xe.ZP,{title:"Edit the simulation's name",visible:a,initialValues:{name:n.name},onCancel:function(){return l(!1)},onOk:function(){var e=(0,i.Z)(o().mark((function e(i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.prev=1,e.next=4,At(n,i,t);case 4:m(!1),l(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),m(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),loading:d,children:(0,u.jsx)(ke.Z.Item,{name:"name",label:"Name:",rules:[{required:!0,message:"Name is required"}],children:(0,u.jsx)(Se.Z,{})})})]})},Vt="Unable to delete the simulation",Gt=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.del(t);case 3:r=n.simulations.filter((function(e){return e!==t.id})),i.mutateProject({id:n.id,simulations:r}),i.delOneSimulation({id:t.id}),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),(0,k.lt)(Vt,e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,t,i){return e.apply(this,arguments)}}(),It=function(e){var n=e.project,t=e.simulation,r=e.swr,a=(0,c.useState)(!1),l=a[0],s=a[1];return(0,u.jsx)(Z.m1,{loading:l,text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the simulation"," ",(0,u.jsx)(f.Z.Text,{strong:!0,children:t.name}),"?"]}),onDelete:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,e.next=4,Gt(n,t,r);case 4:return e.prev=4,s(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])})))})},_t=function(e){var n=e.project,t=e.simulation,i=e.swr;return n&&t?(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsx)(P.Z,{size:"small",title:(0,u.jsx)(f.Z.Title,{level:5,ellipsis:!0,children:t.name}),actions:[(0,u.jsx)(Ft,{project:{id:n.id,simulations:n.simulations},simulation:t,swr:{mutateProject:i.mutateProject,addOneSimulation:i.addOneSimulation}},"copy"),(0,u.jsx)(Lt,{simulation:{id:t.id,name:t.name},swr:{mutateOneSimulation:i.mutateOneSimulation}},"edit"),(0,u.jsx)(It,{project:{id:n.id,simulations:n.simulations},simulation:{id:t.id,name:t.name},swr:{mutateProject:i.mutateProject,delOneSimulation:i.delOneSimulation}},"delete")],children:(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Category:"})," ",t.scheme.category]}),(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Algorithm:"})," ",t.scheme.algorithm]}),(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Code:"})," ",t.scheme.code]}),(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Version:"})," ",t.scheme.version]}),(0,u.jsx)("div",{className:"full-wdith scroll",children:(0,u.jsx)(he.Z.Html,{html:t.scheme.description})})]})})})}):(0,u.jsx)(P.Z,{children:(0,u.jsx)(qe.Z,{})})},Bt=function(e){var n=e.label,t=e.className,i=e.defaultValue,r=e.defaultChecked,a=e.onValueChange,l=e.onCheckedChange,o=e.unit,s=(0,c.useState)(String(null!==i&&void 0!==i?i:0)),d=s[0],m=s[1],f=(0,c.useState)(!!r),p=f[0],h=f[1],x=(0,c.useState)(void 0!==r&&!r),b=x[0],y=x[1],j=(0,c.useState)(0),w=j[0],Z=j[1],k=(0,c.useState)(!1),S=k[0],P=k[1];(0,c.useEffect)((function(){m(String(null!==i&&void 0!==i?i:0))}),[i]),(0,c.useEffect)((function(){h(!!r)}),[r]);var E=(0,c.useCallback)((function(e){var n=e.target.checked;h(n),P(!0),null===l||void 0===l||l(n),y(!n)}),[l]),N=(0,c.useCallback)((function(e){w&&clearTimeout(w);var n=setTimeout((function(){a(e),P(!1)}),500);Z(+n)}),[w,a]),M=(0,c.useCallback)((function(e){var n=e.target.value;m(n),P(!0),N(n)}),[N]);return(0,u.jsxs)(C.Z,{className:"full-width space-full-width "+t,align:"start",children:[void 0!==r&&(0,u.jsx)(it.Z,{checked:p,onChange:E}),(0,u.jsx)(ke.Z,{layout:"vertical",children:(0,u.jsx)(ke.Z.Item,{label:n,children:(0,u.jsx)(Se.Z,{disabled:b,value:d,onChange:M,addonAfter:(0,u.jsxs)(C.Z,{className:"full-width",children:[(0,u.jsx)(he.Z.Inline,{text:o}),S?(0,u.jsx)(g.Z,{spin:!0,className:"color-orange"}):(0,u.jsx)(v.Z,{className:"color-green"})]})})})})]})},Ht="Unable to update the simulation",Yt=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(r=vt.Z.deepCopy(n)).scheme.configuration.geometry.meshParameters={type:t,value:"auto"===t?"normal":"1"},a=(0,T.Z)((0,O.Z)({},r.scheme.configuration.geometry),{done:!0}),e.next=6,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","geometry"],value:a}]);case 6:i.mutateOneSimulation(r),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),(0,k.lt)(Ht,e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n,t,i){return e.apply(this,arguments)}}(),Wt=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r){var a,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(a=vt.Z.deepCopy(n)).scheme.configuration.geometry.meshParameters=(0,T.Z)((0,O.Z)({},a.scheme.configuration.geometry.meshParameters),{type:t,value:i}),l=(0,T.Z)((0,O.Z)({},a.scheme.configuration.geometry),{done:!0}),e.next=6,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","geometry"],value:l}]);case 6:r.mutateOneSimulation(a),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),(0,k.lt)(Ht,e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n,t,i,r){return e.apply(this,arguments)}}(),qt=function(e){var n=e.simulation,t=e.swr,r=(0,c.useState)(),a=r[0],l=r[1],s=(0,c.useState)(),d=s[0],m=s[1];(0,c.useEffect)((function(){var e=n.scheme.configuration.geometry.meshParameters;e?(l(e.type),m(e.value)):(l("auto"),m("normal"))}),[n]);var f=(0,c.useCallback)(function(){var e=(0,i.Z)(o().mark((function e(i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Wt(n,a,i,t);case 3:m(i),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n){return e.apply(this,arguments)}}(),[n,a,t]);return(0,u.jsx)(P.Z,{size:"small",title:"Mesh refinement",children:(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(ke.Z,{layout:"vertical",children:(0,u.jsx)(ke.Z.Item,{label:"Type",children:(0,u.jsxs)(yt.Z,{className:"full-width",value:a,onChange:function(){var e=(0,i.Z)(o().mark((function e(i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yt(n,i,t);case 3:l(i),m("auto"===i?"normal":"1"),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n){return e.apply(this,arguments)}}(),children:[(0,u.jsx)(yt.Z.Option,{value:"auto",children:"Automatic"}),(0,u.jsx)(yt.Z.Option,{value:"manual",children:"Manual"})]})})}),"auto"===a&&(0,u.jsx)(ke.Z,{layout:"vertical",children:(0,u.jsx)(ke.Z.Item,{label:"Size",children:(0,u.jsxs)(yt.Z,{className:"full-width",value:d,onChange:f,children:[(0,u.jsx)(yt.Z.Option,{value:"veryfine",children:"Very fine"}),(0,u.jsx)(yt.Z.Option,{value:"fine",children:"Fine"}),(0,u.jsx)(yt.Z.Option,{value:"normal",children:"Normal"}),(0,u.jsx)(yt.Z.Option,{value:"coarse",children:"Coarse"}),(0,u.jsx)(yt.Z.Option,{value:"verycoarse",children:"Very coarse"})]})})}),"manual"===a&&(0,u.jsx)(Bt,{label:"Size",defaultValue:d,onValueChange:f,unit:"m"})]})})},Kt="Unable to update the simulation",Jt=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r,a){var l,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(l=vt.Z.deepCopy(n)).scheme.configuration.geometry.value=i.id,s=(0,T.Z)((0,O.Z)({},l.scheme.configuration),{dimension:null!==(u=i.summary.dimension)&&void 0!==u?u:3,geometry:(0,T.Z)((0,O.Z)({},l.scheme.configuration.geometry),{done:!0})}),e.next=7,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration"],value:s}]);case 7:a.mutateOneSimulation(l),c=t.find((function(e){return e.id===i.id})),r(c),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),(0,k.lt)(Kt,e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(n,t,i,r,a){return e.apply(this,arguments)}}(),$t=function(e){var n=e.geometries,t=e.geometry,i=e.simulation,r=e.setGeometry,a=e.swr;!i.scheme.configuration.geometry.value&&t&&Jt(i,n,t,r,a);var l=n.map((function(e){return(0,u.jsx)("div",{className:"Geometry-list",style:{backgroundColor:e.id===(null===t||void 0===t?void 0:t.id)?"#FFFBE6":"#FAFAFA"},onClick:function(){return Jt(i,n,e,r,a)},children:(0,u.jsx)(f.Z.Text,{children:e.name})},e.id)}));return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(P.Z,{size:"small",children:(0,u.jsx)(f.Z.Text,{children:"When changing the simulation domain, you might lose your topological entity assignments"})}),(0,u.jsx)(P.Z,{size:"small",children:(0,u.jsx)(f.Z.Text,{strong:!0,children:"Select a simulation domain"})}),l,i.scheme.configuration.geometry.meshable&&(0,u.jsx)(qt,{simulation:{id:i.id,scheme:i.scheme},swr:{mutateOneSimulation:a.mutateOneSimulation}})]})},Xt="Unable to delete the material",Qt=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r){var l,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l=vt.Z.deepCopy(n),u=l.scheme.configuration.materials,u.values[t].selected.forEach((function(e){i(Rn(e))})),u.values=(0,a.Z)(u.values.slice(0,t)).concat((0,a.Z)(u.values.slice(t+1))),s=(0,T.Z)((0,O.Z)({},u),{done:!!u.values.length}),e.next=9,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:s}]);case 9:r.mutateOneSimulation(l),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(0),(0,k.lt)(Xt,e.t0),e.t0;case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(n,t,i,r){return e.apply(this,arguments)}}(),ei=function(e){var n=e.simulation,t=e.index,r=e.swr,a=(0,c.useState)(!1),l=a[0],s=a[1],d=(0,c.useContext)(B).dispatch,m=n.scheme.configuration.materials.values[t];return(0,u.jsx)(Z.m1,{loading:l,text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the material"," ",(0,u.jsx)(f.Z.Text,{strong:!0,children:m.material.label})]}),onDelete:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,e.next=4,Qt(n,t,d,r);case 4:return e.prev=4,s(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])})))})},ni=function(e){var n,t=e.simulation,i=e.swr,r=e.onEdit,a=(0,c.useState)(!0),l=a[0],o=a[1],s=t.scheme.configuration.materials,d=(0,c.useContext)(B).dispatch,m=(0,c.useCallback)((function(e){d(Mn());var n=s.values[e].selected;null===n||void 0===n||n.forEach((function(e){d(Fn(e))}))}),[s,d]),p=(0,c.useCallback)((function(){d(On())}),[d]);return(0,u.jsx)(u.Fragment,{children:null===(n=s.values)||void 0===n?void 0:n.map((function(e,n){return(0,u.jsx)(P.Z,{className:"material-item text-center",hoverable:!0,onMouseEnter:function(){return m(n)},onMouseLeave:function(){l&&p()},actions:[(0,u.jsx)(Z.w6,{onEdit:function(){o(!1),r(n),setTimeout((function(){return o(!0)}),500)}},"edit"),(0,u.jsx)(ei,{index:n,simulation:{id:t.id,scheme:t.scheme},swr:{mutateOneSimulation:i.mutateOneSimulation}},"delete")],children:(0,u.jsx)(f.Z.Text,{strong:!0,className:"text-center",children:e.material.label})},n)})).filter((function(e){return e}))})},ti=t(20550),ii=t(13982),ri=t(14618),ai=t(94668),li=t(68795),oi=function(e){var n,t=e.geometry,i=e.alreadySelected,r=e.updateSelected,a=(0,c.useState)([]),l=a[0],o=a[1],s=(0,c.useState)(),d=s[0],m=s[1],h=(0,c.useState)(),v=h[0],x=h[1],b=(0,c.useContext)(B),y=b.type,g=b.highlighted,j=b.selected,w=b.dispatch;(0,c.useEffect)((function(){r(j)}),[r,j]),(0,c.useEffect)((function(){var e,n=[];y&&(null===(e=t.summary[y])||void 0===e||e.forEach((function(e){e.color&&(n.find((function(n){return n.r===e.color.r&&n.g===e.color.g&&n.b===e.color.b}))||n.push(e.color))}))),o(n)}),[t,y]);var Z=function(){w(zn())},k=(0,c.useCallback)((function(e){m(e)}),[]),S=(0,c.useCallback)((function(e){var n=e.target.value;x(n)}),[]),E=(0,c.useCallback)((function(e){var n,t,i;return(!d||d.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&d.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&d.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&!(v&&e.name&&!e.name.includes(v))}),[d,v]);return(0,u.jsxs)(P.Z,{size:"small",className:"no-border-bottom",children:[(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(f.Z.Text,{strong:!0,children:"Filters"}),(0,u.jsxs)(C.Z,{direction:"horizontal",wrap:!0,children:[l.length>1&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Be.Z,{title:"Reset",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(fe.Z,{}),onClick:function(){return k()}})}),l.map((function(e){return(0,u.jsx)(Be.Z,{title:"Color",children:(0,u.jsx)(p.Z,{style:{backgroundColor:vt.Z.rgbToHex(e)},onClick:function(){return k(e)},children:" "})},JSON.stringify(e))}))]}),(0,u.jsx)(Be.Z,{title:"Select all",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(ii.Z,{}),onClick:function(){var e;null===(e=t.summary[y])||void 0===e||e.forEach((function(e){var n,t,i;(!d||d&&d.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&d.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&d.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&w(Fn({uuid:e.uuid,label:e.label}))}))}})}),(0,u.jsx)(Be.Z,{title:"Unselect all",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(ri.Z,{}),onClick:function(){var e;null===(e=t.summary[y])||void 0===e||e.forEach((function(e){var n,t,i;(!d||d&&d.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&d.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&d.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&w(Rn({uuid:e.uuid,label:e.label}))}))}})}),(0,u.jsx)(Be.Z,{title:"Swap",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(ai.Z,{}),onClick:function(){var e;null===(e=t.summary[y])||void 0===e||e.forEach((function(e){var n,t,i;(!d||d&&d.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&d.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&d.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&j.find((function(n){return n.uuid===e.uuid}))?w(Rn({uuid:e.uuid,label:e.label})):w(Fn({uuid:e.uuid,label:e.label}))}))}})})]}),(0,u.jsx)(Se.Z,{placeholder:"Search",value:v,onChange:S,suffix:(0,u.jsx)(li.Z,{className:"text-light"})})]}),(0,u.jsx)("div",{className:"full-width marginTop-20",children:y?null===(n=t.summary[y])||void 0===n?void 0:n.map((function(e,n){if(E(e)){var t="transparent",r="transparent";return j.find((function(n){return n.uuid===e.uuid}))&&(null===g||void 0===g?void 0:g.uuid)!==e.uuid?(t="#FAD114",r="rgba(255, 251, 230, 0.3)"):(null===g||void 0===g?void 0:g.uuid)===e.uuid&&(t="#FAD114",r="#FFFBE6"),(0,u.jsx)(P.Z,{className:"marginBottom-10",bodyStyle:{position:"relative",padding:"10px 10px 10px 40px",borderWidth:"2px",borderStyle:"solid",borderColor:t,backgroundColor:r},onMouseEnter:function(){return n={uuid:e.uuid,label:e.label},void w(Un(n));var n},onMouseLeave:Z,onClick:function(){return n={uuid:e.uuid,label:e.label},void(j.find((function(e){return e.uuid===n.uuid}))?w(Rn(n)):w(Fn(n)));var n},children:(0,u.jsxs)(C.Z,{direction:"vertical",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{position:"absolute",left:"-2px",top:"-2px",bottom:"-2px",width:"30px",backgroundColor:vt.Z.rgbToRgba(e.color,1)}}),e.name]}),null===i||void 0===i?void 0:i.map((function(n){if(n.selected.find((function(n){return n.uuid===e.uuid})))return(0,u.jsx)(ti.Z,{color:vt.Z.stringToColor(n.label),children:n.label},e.uuid)}))]})},n)}})):[]})]})},ui=t(95507),si=t(13520),ci={metal:{label:"Metal",children:[{key:"steel",label:"Generic Steel",children:[{label:"Density",symbol:"Rho",value:7850},{label:"Young's modulus",symbol:"E",value:21e8},{label:"Poisson's ratio",symbol:"Nu",value:.3},{label:"Thermal conductivity",symbol:"Lambda",value:15},{label:"Heat capacity",symbol:"Cp",value:502}]},{key:"S235JR+AR",label:"Steel (S235JR+AR)",children:[{label:"Density",symbol:"Rho",value:7850},{label:"Young's modulus",symbol:"E",value:21e8},{label:"Poisson's ratio",symbol:"Nu",value:.27},{label:"Thermal conductivity",symbol:"Lambda",value:15},{label:"Heat capacity",symbol:"Cp",value:502}]},{key:"304",label:"Stainless Steel 304",children:[{label:"Density",symbol:"Rho",value:8e3},{label:"Young's modulus",symbol:"E",value:193e9},{label:"Poisson's ratio",symbol:"Nu",value:.29},{label:"Thermal conductivity",symbol:"Lambda",value:16.2},{label:"Heat capacity",symbol:"Cp",value:500},{label:"Yield strength",symbol:"SigmaY",value:215e6}]},{key:"316L",label:"Stainless Steel 316L",children:[{label:"Density",symbol:"Rho",value:7990},{label:"Young's modulus",symbol:"E",value:193e9},{label:"Poisson's ratio",symbol:"Nu",value:.25},{label:"Thermal conductivity",symbol:"Lambda",value:16.2},{label:"Heat capacity",symbol:"Cp",value:500},{label:"Yield strength",symbol:"SigmaY",value:29e7}]},{key:"6082-O",label:"Aluminium 6082-O",children:[{label:"Density",symbol:"Rho",value:2700},{label:"Young's modulus",symbol:"E",value:69e9},{label:"Poisson's ratio",symbol:"Nu",value:.33},{label:"Thermal conductivity",symbol:"Lambda",value:170},{label:"Heat capacity",symbol:"Cp",value:960},{label:"Yield strength",symbol:"SigmaY",value:6e7}]},{key:"7075-O",label:"Aluminium 7075-O",children:[{label:"Density",symbol:"Rho",value:2810},{label:"Young's modulus",symbol:"E",value:717e8},{label:"Poisson's ratio",symbol:"Nu",value:.33},{label:"Thermal conductivity",symbol:"Lambda",value:173},{label:"Heat capacity",symbol:"Cp",value:960},{label:"Yield strength",symbol:"SigmaY",value:11e7}]},{key:"2017A",label:"Aluminium 2017A",children:[{label:"Density",symbol:"Rho",value:2790},{label:"Young's modulus",symbol:"E",value:725e8},{label:"Poisson's ratio",symbol:"Nu",value:.33},{label:"Thermal conductivity",symbol:"Lambda",value:134},{label:"Heat capacity",symbol:"Cp",value:873},{label:"Yield strength",symbol:"SigmaY",value:275e6}]}]},polymer:{label:"Polymer",children:[{key:"PMMA",label:"PMMA",children:[{label:"Density",symbol:"Rho",value:1180},{label:"Young's modulus",symbol:"E",value:29e8},{label:"Poisson's ratio",symbol:"Nu",value:.36},{label:"Thermal conductivity",symbol:"Lambda",value:.193},{label:"Heat capacity",symbol:"Cp",value:1480},{label:"Yield strength",symbol:"SigmaY",value:69e6}]}]},fluid:{label:"Fluid",children:[{key:"water",label:"Water",children:[{label:"Density",symbol:"Rho",value:1e3},{label:"Dynamic viscosity",symbol:"Mu",value:.001},{label:"Thermal conductivity",symbol:"Lambda",value:.6},{label:"Heat capacity",symbol:"Cp",value:4185}]}]}},di=function(e){var n=e.onSelect,t=(0,c.useState)(),i=t[0],r=t[1],a=(0,c.useState)(),l=a[0],o=a[1],s=(0,c.useState)(),f=s[0],h=s[1],v=Object.keys(ci),x=(0,c.useCallback)((function(e){var n=e.key;o({key:n,children:ci[n].children}),h(void 0)}),[]),b=(0,c.useCallback)((function(e){var n=e.key,t=ci[l.key].children.find((function(e){return e.key===n}));h(t)}),[l]),y=(0,c.useCallback)((function(e){n(e),r(!1)}),[n]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(p.Z,{icon:(0,u.jsx)(si.Z,{}),onClick:function(){return r(!0)},className:"full-width",children:"Pick a material"}),(0,u.jsx)(gt.Z,{visible:i,title:"Material database",onCancel:function(){return r(!1)},onOk:function(){return y(f)},okText:"Choose",okButtonProps:{disabled:!f},width:"50%",children:(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsxs)(C.Z,{style:{alignItems:"stretch"},children:[(0,u.jsx)(m.Z,{mode:"inline",items:v.map((function(e){return{key:e,label:ci[e].label}})),onClick:x}),(0,u.jsx)(m.Z,{mode:"inline",items:null===l||void 0===l?void 0:l.children.map((function(e){return{key:e.key,label:e.label}})),onClick:b}),f&&(0,u.jsx)(ui.ZP,{itemLayout:"vertical",children:f.children.map((function(e){return(0,u.jsxs)(ui.ZP.Item,{children:[e.label,": ",e.symbol," = ",e.value]},e.label)}))})]})})})})]})},mi="You need to define a material",fi="You need to select a solid",pi="Unable to add the material",hi=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r,l,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(r=vt.Z.deepCopy(t)).uuid=(0,un.Z)(),l=vt.Z.deepCopy(n),(u=l.scheme.configuration.materials).values=(0,a.Z)(u.values||[]).concat([r]),s=(0,T.Z)((0,O.Z)({},u),{done:!0}),e.next=9,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:s}]);case 9:i.mutateOneSimulation(l),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(0),(0,k.lt)(pi,e.t0),e.t0;case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(n,t,i){return e.apply(this,arguments)}}(),vi=function(e){var n=e.simulation,t=e.material,r=e.swr,a=e.onError,l=e.onClose,s=(0,c.useState)(!1),d=s[0],m=s[1];return(0,u.jsx)(Z.HS,{loading:d,needMargin:!0,onAdd:(0,i.Z)(o().mark((function e(){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m(!0),e.prev=1,t.material){e.next=7;break}return a(mi),m(!1),e.abrupt("return");case 7:if(null===(i=t.selected)||void 0===i?void 0:i.length){e.next=11;break}return a(fi),m(!1),e.abrupt("return");case 11:return a(),e.next=14,hi(n,t,r);case 14:m(!1),l(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),m(!1);case 21:case"end":return e.stop()}}),e,null,[[1,18]])}))),children:"Add"})},xi="You need to define a material",bi="You need to select a solid",yi="Unable to edit the material",gi=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r,l,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=vt.Z.deepCopy(n),l=r.scheme.configuration.materials,u=l.values.findIndex((function(e){return e.uuid===t.uuid})),l.values=(0,a.Z)(l.values.slice(0,u)).concat([t],(0,a.Z)(l.values.slice(u+1))),s=(0,O.Z)({},l),e.next=8,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:s}]);case 8:i.mutateOneSimulation(r),e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(0),(0,k.lt)(yi,e.t0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(n,t,i){return e.apply(this,arguments)}}(),ji=function(e){var n=e.simulation,t=e.material,r=e.swr,a=e.onError,l=e.onClose,s=(0,c.useState)(!1),d=s[0],m=s[1];return(0,u.jsx)(Z.w6,{loading:d,primary:!0,needMargin:!0,onEdit:(0,i.Z)(o().mark((function e(){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m(!0),e.prev=1,t.material){e.next=7;break}return a(xi),m(!1),e.abrupt("return");case 7:if(null===(i=t.selected)||void 0===i?void 0:i.length){e.next=11;break}return a(bi),m(!1),e.abrupt("return");case 11:return a(),e.next=14,gi(n,t,r);case 14:m(!1),l(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),m(!1);case 21:case"end":return e.stop()}}),e,null,[[1,18]])}))),children:"Edit"})},wi=function(e){var n,t,i=e.visible,r=e.geometry,l=e.simulation,o=e.material,s=e.swr,d=e.onClose,m=(0,c.useState)(),h=m[0],v=m[1],x=(0,c.useState)(),y=x[0],g=x[1],j=(0,c.useState)(),w=j[0],k=j[1],S=l.scheme.configuration.materials;(0,c.useEffect)((function(){!i&&y&&g(void 0)})),(0,c.useEffect)((function(){i&&!y&&o&&g(o)}),[y,i,o]),(0,c.useEffect)((function(){var e,n=null===S||void 0===S||null===(e=S.values)||void 0===e?void 0:e.map((function(e){if(e.uuid!==(null===o||void 0===o?void 0:o.uuid))return{label:e.material.label,selected:e.selected}})).filter((function(e){return e}));v(n||[])}),[l,o,S]);var E,N,M,D,U=(0,c.useCallback)((function(e){g((function(n){return(0,T.Z)((0,O.Z)({},n),{material:e})}))}),[]),z=(0,c.useCallback)((function(e){g((function(n){return(0,T.Z)((0,O.Z)({},n),{selected:e})}))}),[]),F=(0,c.useCallback)((function(e,n,t){g((function(i){var r,l,o,u;return(0,T.Z)((0,O.Z)({},i),{material:{label:"Custom",children:(0,a.Z)((null===i||void 0===i||null===(r=i.material)||void 0===r||null===(l=r.children)||void 0===l?void 0:l.slice(0,n))||[]).concat([{label:e.label,symbol:e.name,value:t}],(0,a.Z)((null===i||void 0===i||null===(o=i.material)||void 0===o||null===(u=o.children)||void 0===u?void 0:u.slice(n+1))||[]))}})}))}),[]);return(0,u.jsx)(rt.Z,{className:"material",title:"Material",placement:"left",closable:!1,visible:i,mask:!1,maskClosable:!1,width:300,extra:(0,u.jsx)(p.Z,{type:"text",icon:(0,u.jsx)(fe.Z,{}),onClick:function(){g(void 0),d()}}),footer:(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,u.jsx)(Z.Lw,{onCancel:function(){g(void 0),d()}}),o?(0,u.jsx)(ji,{material:{uuid:null!==(E=null===y||void 0===y?void 0:y.uuid)&&void 0!==E?E:o.uuid,material:null!==(N=null===y||void 0===y?void 0:y.material)&&void 0!==N?N:o.material,selected:null!==(M=null===y||void 0===y?void 0:y.selected)&&void 0!==M?M:o.selected},simulation:{id:l.id,scheme:l.scheme},swr:{mutateOneSimulation:s.mutateOneSimulation},onError:function(e){return k(e)},onClose:d}):(0,u.jsx)(vi,{material:{material:null===y||void 0===y?void 0:y.material,selected:null===y||void 0===y?void 0:y.selected},simulation:{id:l.id,scheme:l.scheme},swr:{mutateOneSimulation:s.mutateOneSimulation},onError:function(e){return k(e)},onClose:d})]}),children:(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(P.Z,{size:"small",children:(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(di,{onSelect:U}),(0,u.jsxs)(f.Z.Text,{children:["Material: ",null!==(D=null===y||void 0===y||null===(n=y.material)||void 0===n?void 0:n.label)&&void 0!==D?D:"default"]}),null===S||void 0===S||null===(t=S.children)||void 0===t?void 0:t.map((function(e,n){var t,i,r=null===y||void 0===y||null===(t=y.material)||void 0===t||null===(i=t.children)||void 0===i?void 0:i.find((function(n){return n.symbol===e.name}));return(0,u.jsx)(Bt,{label:e.name,defaultValue:r?r.value:String(e.default),unit:e.unit,onValueChange:function(t){F(e,n,t)}},e.name)}))]})}),(0,u.jsx)(oi,{geometry:r,alreadySelected:h,updateSelected:z}),w&&(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)(b.Z,{style:{color:"red"}})," ",w]})]})})},Zi=function(e){var n=e.geometry,t=e.simulation,i=e.swr,r=e.setVisible,a=(0,c.useState)(),l=a[0],o=a[1],s=(0,c.useState)(!1),m=s[0],f=s[1],p=(0,c.useContext)(B).dispatch,h=t.scheme.configuration.materials;(0,c.useEffect)((function(){(null===n||void 0===n?void 0:n.summary)&&p(Tn(2===n.summary.dimension?"faces":"solids"))}),[n,p]);var v=(0,c.useCallback)((function(){o(void 0),f(!0),r(!1),p(Mn())}),[p,r]),x=(0,c.useCallback)((function(e){var n=h.values[e];o(n),f(!0),r(!1),p(Mn())}),[h,p,r]),b=(0,c.useCallback)((function(){p(On()),f(!1),o(void 0),r(!0)}),[p,r]);return n?(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsxs)(P.Z,{size:"small",children:[(0,u.jsx)(Z.HS,{onAdd:v,fullWidth:!0,primary:!1,children:"Add material"}),(0,u.jsx)(ni,{simulation:{id:t.id,scheme:t.scheme},swr:i,onEdit:x}),(0,u.jsx)(wi,{visible:m,geometry:{summary:n.summary},simulation:{id:t.id,scheme:t.scheme},material:l&&{uuid:l.uuid,material:l.material,selected:l.selected},swr:{mutateOneSimulation:i.mutateOneSimulation},onClose:b})]})})}):(0,u.jsx)(S.Z.Simple,{})},ki=t(54907),Si="Unable to update the simulation",Pi=function(){var e=(0,i.Z)(o().mark((function e(n,t){var i,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=vt.Z.deepCopy(n),r=i.scheme.configuration.parameters,a=(0,T.Z)((0,O.Z)({},r),{done:!0}),e.next=6,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","parameters"],value:a}]);case 6:t.mutateOneSimulation(i),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,k.lt)(Si,e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n,t){return e.apply(this,arguments)}}(),Ci=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r,a){var l,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l=vt.Z.deepCopy(n),u=l.scheme.configuration.parameters,u[t].children[i].value=r,s=(0,T.Z)((0,O.Z)({},u),{done:!0}),e.next=8,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","parameters"],value:s}]);case 8:a.mutateOneSimulation(l),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),(0,k.lt)(Si,e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(n,t,i,r,a){return e.apply(this,arguments)}}(),Ei=function(e){var n=e.simulation,t=e.swr,i=null===n||void 0===n?void 0:n.scheme.configuration.parameters,r=null===n||void 0===n?void 0:n.scheme.configuration.dimension;(0,c.useEffect)((function(){(null===i||void 0===i?void 0:i.done)||Pi(n,t)}),[n,i,t]);var a=[],l=[];return 2===r?Object.keys(i).forEach((function(e){if("index"!==e&&"title"!==e&&"done"!=e){var r=i[e],o=null===r||void 0===r?void 0:r.children.map((function(i,r){if(!i.only3D)return"formula"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(Bt,{label:n.label2D||n.label,defaultValue:null!==(ze=n.value)&&void 0!==ze?ze:n.default,onValueChange:t,unit:n.unit},e)}(e+"&"+r,i,(function(i){return Ci(n,e,r,i,t)})):"select"===i.htmlEntity?function(e,n,t){var i;return(0,u.jsx)(ke.Z,{layout:"vertical",children:(0,u.jsx)(ke.Z.Item,{label:n.label2D||n.label,children:(0,u.jsx)(yt.Z,{options:null===(i=n.options)||void 0===i?void 0:i.map((function(e){return{label:e.label,value:null!==(Fe=e.value2D)&&void 0!==Fe?Fe:e.value}})),defaultValue:n.value||n.default2D||n.default,onChange:t})})},e)}(e+"&"+r,i,(function(i){return Ci(n,e,r,i,t)})):"checkbox"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(ke.Z,{layout:"vertical",children:(0,u.jsx)(ke.Z.Item,{label:n.label2D||n.label,children:(0,u.jsx)(it.Z,{defaultChecked:n.value,onChange:t})})},e)}(e+"&"+r,i,(function(i){return Ci(n,e,r,i.target.checked,t)})):void 0}));(null===r||void 0===r?void 0:r.advanced)?l.push((0,u.jsx)(P.Z,{size:"small",title:null===r||void 0===r?void 0:r.label,children:(0,u.jsx)(C.Z,{direction:"vertical",children:o})},e)):a.push((0,u.jsx)(P.Z,{size:"small",title:null===r||void 0===r?void 0:r.label,children:(0,u.jsx)(C.Z,{direction:"vertical",children:o})},e))}})):Object.keys(i).forEach((function(e){if("index"!==e&&"title"!==e&&"done"!=e){var r=i[e],o=null===r||void 0===r?void 0:r.children.map((function(i,r){return"formula"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(Bt,{label:n.label,defaultValue:null!==(Re=n.value)&&void 0!==Re?Re:n.default,onValueChange:t,unit:n.unit},e)}(e+"&"+r,i,(function(i){return Ci(n,e,r,i,t)})):"select"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(ke.Z,{layout:"vertical",children:(0,u.jsx)(ke.Z.Item,{label:n.label,children:(0,u.jsx)(yt.Z,{options:n.options,defaultValue:n.value||n.default,onChange:t})})},e)}(e+"&"+r,i,(function(i){return Ci(n,e,r,i,t)})):"checkbox"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(ke.Z,{layout:"vertical",children:(0,u.jsx)(ke.Z.Item,{label:n.label,children:(0,u.jsx)(it.Z,{defaultChecked:n.value,onChange:t})})},e)}(e+"&"+r,i,(function(i){return Ci(n,e,r,i.target.checked,t)})):void 0}));(null===r||void 0===r?void 0:r.advanced)?l.push((0,u.jsx)(P.Z,{size:"small",title:null===r||void 0===r?void 0:r.label,children:(0,u.jsx)(C.Z,{direction:"vertical",children:o})},e)):a.push((0,u.jsx)(P.Z,{size:"small",title:null===r||void 0===r?void 0:r.label,children:(0,u.jsx)(C.Z,{direction:"vertical",children:o})},e))}})),(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsxs)(C.Z,{direction:"vertical",children:[a,(0,u.jsx)(ki.Z,{children:(0,u.jsx)(ki.Z.Panel,{header:"Advanced",children:(0,u.jsx)(C.Z,{direction:"vertical",children:l})},"advanced")})]})})})},Ni=function(e,n){return e.map((function(e){var t=e.fileName.replace(new RegExp(n.prefixPattern),"").replace(new RegExp(n.suffixPattern),"");return(0,T.Z)((0,O.Z)({},e),{number:+t})}))},Mi=function(e,n){var t=n.multiplicator;if(t){var i,r=t.reduce((function(e,n){return e[n]}),e);return null!==(i=r.value)&&void 0!==i?i:r.default}},Oi="Unable to update simulation",Ti=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=vt.Z.deepCopy(n),(a=r.scheme.configuration.initialization).value={type:t},e.next=6,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:a}]);case 6:i.mutateOneSimulation(r),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),(0,k.lt)(Oi,e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n,t,i){return e.apply(this,arguments)}}(),Di=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r){var a,l,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,Fi(n,i);case 4:return l=e.sent,u=vt.Z.deepCopy(t),(s=u.scheme.configuration.initialization).value=(0,T.Z)((0,O.Z)({},s.value),{simulation:i,result:null===l||void 0===l||null===(a=l[0])||void 0===a?void 0:a.value}),e.next=10,ae.update({id:t.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:s}]);case 10:r.mutateOneSimulation(u),e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(0),(0,k.lt)(Oi,e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(n,t,i,r){return e.apply(this,arguments)}}(),Ui=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r){var a,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=vt.Z.deepCopy(n),(l=a.scheme.configuration.initialization).value=(0,T.Z)((0,O.Z)({},l.value),{number:+t,result:i.file}),e.next=6,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:l}]);case 6:r.mutateOneSimulation(a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,k.lt)(Oi,e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n,t,i,r){return e.apply(this,arguments)}}(),zi=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r){var a,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=vt.Z.deepCopy(n),(l=a.scheme.configuration.initialization).value.values||(l.value.values=[]),l.value.values[t]=i,e.next=7,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:l}]);case 7:r.mutateOneSimulation(a),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,k.lt)(Oi,e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(n,t,i,r){return e.apply(this,arguments)}}(),Fi=function(){var e=(0,i.Z)(o().mark((function e(n,t){var i,r,l,u,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,ae.tasks({id:t});case 3:return r=e.sent,l=n.find((function(e){return e.id===t})),u=l.scheme.configuration,s=null===u||void 0===u||null===(i=u.run)||void 0===i?void 0:i.resultsFilter,c=[],r.forEach((function(e){if(e.file&&"result"===e.file.type&&c.push({label:e.file.fileName,value:e.file.fileName,file:e.file.fileName}),e.files)if(s){var n,t,i=new RegExp(s.pattern),r=e.files.filter((function(e){return!i.test(e.fileName)})).filter((function(e){return"result"===e.type})),l=e.files.filter((function(e){return i.test(e.fileName)})),o=Ni(l,s).map((function(e){return{number:e.number,fileName:e.fileName.replace(new RegExp(s.suffixPattern),"")}})).filter((function(e,n,t){return t.findIndex((function(n){return n.number===e.number}))===n})).sort((function(e,n){return e.number-n.number})),d=Mi(u,s),m=o.map((function(e,n){var t=d?e.number*d:n,i=Math.round(1e15*t)/1e15;return{label:String(i),value:e.fileName,file:e.fileName}}));(n=c).push.apply(n,(0,a.Z)(r.map((function(e){return{label:e.fileName,value:e.fileName,file:e.fileName}})).filter((function(e){return e})))),(t=c).push.apply(t,(0,a.Z)(m))}else e.files.forEach((function(e){"result"===e.type&&c.push({label:e.fileName,value:e.fileName,file:e.fileName})}))})),e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),Ri=function(e){var n=e.simulations,t=e.simulation,r=e.swr,a=(0,c.useState)(!1),l=a[0],s=a[1],m=(0,c.useState)(),p=m[0],h=m[1],v=(0,c.useState)(),x=v[0],b=v[1],y=(0,c.useState)(),g=y[0],j=y[1],w=null===t||void 0===t?void 0:t.scheme.configuration.initialization,Z=null===t||void 0===t?void 0:t.scheme.configuration.dimension,k=(0,c.useCallback)((function(e){var t=n.find((function(n){return n.id===e}));b(t)}),[n]);(0,c.useEffect)((function(){var e,n;!p&&w.value&&h(w.value.type),!x&&(null===(e=w.value)||void 0===e?void 0:e.simulation)&&k(null===(n=w.value)||void 0===n?void 0:n.simulation)}),[w,p,x,k]),(0,c.useEffect)((function(){x&&Fi(n,x.id).then((function(e){return j(e)}))}),[n,x]);var S=[{label:"None",value:"none"}];w.coupling&&S.push({label:w.coupling.label,value:"coupling"}),w.direct&&S.push({label:w.direct.label,value:"direct"});var E={none:(0,u.jsx)("div",{})},N=w.value,M=w.coupling;if(null===M||void 0===M?void 0:M.compatibility){var O=n.map((function(e){var n=e.id===t.id||!M.compatibility.find((function(n){return n.algorithm===e.scheme.algorithm}));return{label:e.name,value:e.id,disabled:n}})),T=M.compatibility.find((function(e){var n;return e.algorithm===(null===x||void 0===x||null===(n=x.scheme)||void 0===n?void 0:n.algorithm)})),D=null===T||void 0===T?void 0:T.filter;E.coupling=function(e,a){return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(f.Z.Text,{children:"If you use coupling, the selected simulation mesh will be used, at least for the first iteration."}),(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width marginTop-10",children:[(0,u.jsx)(yt.Z,{className:"full-width",options:e,placeholder:"Select a simulation",value:null===N||void 0===N?void 0:N.simulation,onChange:function(){var e=(0,i.Z)(o().mark((function e(i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,e.next=4,Di(n,t,i,r);case 4:k(i),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:return e.prev=9,s(!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[1,7,9,12]])})));return function(n){return e.apply(this,arguments)}}()}),l&&(0,u.jsx)(qe.Z,{}),(null===g||void 0===g?void 0:g.length)?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(f.Z.Text,{children:[null===a||void 0===a?void 0:a.name,":"]},"simulation"),(0,u.jsx)(yt.Z,{className:"full-width",options:g,placeholder:"Select a "+a.name,value:null===N||void 0===N?void 0:N.result,onChange:function(){var e=(0,i.Z)(o().mark((function e(n,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ui(t,n,i,r);case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()})]}):(0,u.jsx)(f.Z.Text,{type:"danger",children:"No results, please select an other simulation."})]})]})}(O,D)}var U=w.direct;return(null===U||void 0===U?void 0:U.children)&&(E.direct=function(e){return(0,u.jsx)(C.Z,{direction:"vertical",className:"full-width",children:e.children.map((function(e,n){var i,a;if(2!==Z||!e.only3D)return(0,u.jsx)(Bt,{label:e.label,defaultValue:(null!==(a=null===N||void 0===N||null===(i=N.values)||void 0===i?void 0:i[n])&&void 0!==a?a:e.default).toString(),unit:e.unit,onValueChange:function(e){return zi(t,n,e,r)}},n)}))})}(U)),(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsxs)(P.Z,{size:"small",children:[(0,u.jsx)(yt.Z,{className:"full-width marginBottom-10",defaultValue:"none",value:p,options:S,onChange:function(){var e=(0,i.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ti(t,n,r);case 3:h(n),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n){return e.apply(this,arguments)}}()}),E[p||"none"]]})})})},Ai="Unable to delete the boundary condition",Li=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r,l){var u,s,c,d,m;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u=vt.Z.deepCopy(n),s=u.scheme.configuration.boundaryConditions,c=s[t],c.values[i].selected.forEach((function(e){r(Rn(e))})),c.values=(0,a.Z)(c.values.slice(0,i)).concat((0,a.Z)(c.values.slice(i+1))),d=!1,Object.keys(s).forEach((function(e){var n;"index"!==e&&"title"!==e&&"done"!==e&&((null===(n=s[e].values)||void 0===n?void 0:n.length)&&(d=!0))})),m=(0,T.Z)((0,O.Z)({},s),{done:d}),e.next=12,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:m}]);case 12:l.mutateOneSimulation(u),e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(0),(0,k.lt)(Ai,e.t0),e.t0;case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(n,t,i,r,a){return e.apply(this,arguments)}}(),Vi=function(e){var n=e.type,t=e.index,r=e.simulation,a=e.swr,l=(0,c.useState)(!1),s=l[0],d=l[1],m=(0,c.useContext)(B).dispatch,p=r.scheme.configuration.boundaryConditions[n].values[t];return(0,u.jsx)(Z.m1,{loading:s,onDelete:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,Li(r,n,t,m,a);case 4:return e.prev=4,d(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])}))),text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the condition"," ",(0,u.jsx)(f.Z.Text,{strong:!0,children:null===p||void 0===p?void 0:p.name}),"?"]})})},Gi=function(e){var n=e.simulation,t=e.swr,i=e.onEdit,r=(0,c.useState)(!0),a=r[0],l=r[1],o=n.scheme.configuration.boundaryConditions,s=(0,c.useContext)(B).dispatch,d=(0,c.useCallback)((function(e,n){s(Mn());var t=o[e].values[n].selected;null===t||void 0===t||t.forEach((function(e){s(Fn(e))}))}),[o,s]),m=(0,c.useCallback)((function(){s(On())}),[s]);return(0,u.jsx)(u.Fragment,{children:Object.keys(o).map((function(e){var r;if("index"!==e&&"title"!==e&&"done"!==e){var s=o[e];return null===(r=s.values)||void 0===r?void 0:r.map((function(r,o){return(0,u.jsxs)(P.Z,{className:"boundaryCondition-item",hoverable:!0,onMouseEnter:function(){return d(e,o)},onMouseLeave:function(){a&&m()},actions:[(0,u.jsx)(Z.w6,{onEdit:function(){l(!1),i(e,o),setTimeout((function(){return l(!0)}),500)}},"edit"),(0,u.jsx)(Vi,{simulation:{id:n.id,scheme:n.scheme},type:e,index:o,swr:{mutateOneSimulation:t.mutateOneSimulation}},"delete")],children:[(0,u.jsx)(f.Z.Text,{strong:!0,children:r.name})," ",(0,u.jsxs)(f.Z.Text,{children:["(",s.label,")"]})]},o)}))}})).filter((function(e){return e}))})},Ii=t(29924),_i="You need to define a name",Bi="You need to select a type",Hi="You need to select a face",Yi="Unable to add the boundary condition",Wi=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r,l,u,s,c,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=(0,O.Z)({},t),l=r.type.key,r.uuid=(0,un.Z)(),u=vt.Z.deepCopy(n),s=u.scheme.configuration.boundaryConditions,(c=s[l]).values=(0,a.Z)(c.values||[]).concat([r]),d=(0,T.Z)((0,O.Z)({},s),{done:!0}),e.next=11,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:d}]);case 11:i.mutateOneSimulation(u),e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(0),(0,k.lt)(Yi,e.t0),e.t0;case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(n,t,i){return e.apply(this,arguments)}}(),qi=function(e){var n=e.simulation,t=e.boundaryCondition,r=e.swr,a=e.onError,l=e.onClose,s=(0,c.useState)(!1),d=s[0],m=s[1];return(0,u.jsx)(Z.HS,{loading:d,onAdd:(0,i.Z)(o().mark((function e(){var i,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m(!0),e.prev=1,t.name){e.next=7;break}return a(_i),m(!1),e.abrupt("return");case 7:if(null===(i=t.type)||void 0===i?void 0:i.key){e.next=11;break}return a(Bi),m(!1),e.abrupt("return");case 11:if(null===(u=t.selected)||void 0===u?void 0:u.length){e.next=15;break}return a(Hi),m(!1),e.abrupt("return");case 15:return a(),e.next=18,Wi(n,t,r);case 18:m(!1),l(),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(1),m(!1);case 25:case"end":return e.stop()}}),e,null,[[1,22]])}))),needMargin:!0,children:"Add"})},Ki="You need to define a name",Ji="You need to select a type",$i="You need to select a face",Xi="Unable to edit the boundary condition",Qi=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r){var l,u,s,c,d,m,f,p,h,v;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l=vt.Z.deepCopy(n),u=l.scheme.configuration.boundaryConditions,s=t.type.key,(c=i.type.key)!==s&&(d=u[c],m=d.values.findIndex((function(e){return e.uuid===i.uuid})),d.values=(0,a.Z)(d.values.slice(0,m)).concat((0,a.Z)(d.values.slice(m+1)))),c!==s?(f=u[s]).values=(0,a.Z)(f.values||[]).concat([t]):(p=u[s],h=p.values.findIndex((function(e){return e.uuid===t.uuid})),p.values=(0,a.Z)(p.values.slice(0,h)).concat([t],(0,a.Z)(p.values.slice(h+1)))),v=(0,O.Z)({},u),e.next=10,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:v}]);case 10:r.mutateOneSimulation(l),e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(0),(0,k.lt)(Xi,e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(n,t,i,r){return e.apply(this,arguments)}}(),er=function(e){var n=e.simulation,t=e.boundaryCondition,r=e.oldBoundaryCondition,a=e.swr,l=e.onError,s=e.onClose,d=(0,c.useState)(!1),m=d[0],f=d[1];return(0,u.jsx)(Z.w6,{loading:m,onEdit:(0,i.Z)(o().mark((function e(){var i,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f(!0),e.prev=1,t.name){e.next=7;break}return l(Ki),f(!1),e.abrupt("return");case 7:if(null===(i=t.type)||void 0===i?void 0:i.key){e.next=11;break}return l(Ji),f(!1),e.abrupt("return");case 11:if(null===(u=t.selected)||void 0===u?void 0:u.length){e.next=15;break}return l($i),f(!1),e.abrupt("return");case 15:return l(),e.next=18,Qi(n,t,r,a);case 18:f(!1),s(),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(1),f(!1);case 25:case"end":return e.stop()}}),e,null,[[1,22]])}))),primary:!0,needMargin:!0,children:"Edit"})},nr=function(e){var n,t,i=e.visible,r=e.geometry,l=e.simulation,o=e.boundaryCondition,s=e.swr,d=e.onClose,m=(0,c.useState)([]),h=m[0],v=m[1],x=(0,c.useState)([]),y=x[0],g=x[1],j=(0,c.useState)(),w=j[0],k=j[1],S=(0,c.useState)(),E=S[0],N=S[1],M=(0,c.useState)(),D=M[0],U=M[1],z=l.scheme.configuration.boundaryConditions,F=l.scheme.configuration.dimension;(0,c.useEffect)((function(){!i&&E&&N(void 0)})),(0,c.useEffect)((function(){i&&!E&&o?N(o):!i||E||o||void 0===w||N((function(e){return(0,T.Z)((0,O.Z)({},e),{name:"Boundary condition "+(w+1)})}))}),[E,w,i,o]),(0,c.useEffect)((function(){var e=Object.keys(z).map((function(e){var n;if("index"!==e&&"title"!==e&&"done"!==e){var t=z[e];return null===t||void 0===t||null===(n=t.values)||void 0===n?void 0:n.map((function(e){if(e.uuid!==(null===o||void 0===o?void 0:o.uuid))return{label:e.name,selected:e.selected}})).filter((function(e){return e}))}})).flat().filter((function(e){return e}));v(e)}),[z,o]),(0,c.useEffect)((function(){var e=Object.keys(z).map((function(e){if("index"!==e&&"title"!==e&&"done"!==e){var n=z[e];return{key:e,label:n.label,children:n.children,values:n.values}}})).filter((function(e){return e}));g(e)}),[z]),(0,c.useEffect)((function(){var e=null===y||void 0===y?void 0:y.map((function(e){var n;return null===(n=e.values)||void 0===n?void 0:n.length})).filter((function(e){return e})).reduce((function(e,n){return e+n}),0);k(e)}),[y]);var R=(0,c.useCallback)((function(e){N((function(n){return(0,T.Z)((0,O.Z)({},n),{selected:e})}))}),[]);return(0,u.jsx)(rt.Z,{className:"boundaryCondition",title:"Boundary condition",placement:"left",closable:!1,visible:i,mask:!1,maskClosable:!1,width:300,extra:(0,u.jsx)(p.Z,{type:"text",icon:(0,u.jsx)(fe.Z,{}),onClick:function(){N(void 0),d()}}),footer:(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,u.jsx)(Z.Lw,{onCancel:function(){N(void 0),d()}}),o?(0,u.jsx)(er,{boundaryCondition:{uuid:(null===E||void 0===E?void 0:E.uuid)||o.uuid,name:(null===E||void 0===E?void 0:E.name)||o.name,type:(null===E||void 0===E?void 0:E.type)||o.type,selected:(null===E||void 0===E?void 0:E.selected)||o.selected,values:(null===E||void 0===E?void 0:E.values)||o.values},oldBoundaryCondition:{uuid:o.uuid,name:o.name,type:o.type,selected:o.selected,values:o.values},simulation:{id:l.id,scheme:l.scheme},swr:{mutateOneSimulation:s.mutateOneSimulation},onError:function(e){return U(e)},onClose:d}):(0,u.jsx)(qi,{boundaryCondition:{name:null===E||void 0===E?void 0:E.name,type:null===E||void 0===E?void 0:E.type,selected:null===E||void 0===E?void 0:E.selected,values:null===E||void 0===E?void 0:E.values},simulation:{id:l.id,scheme:l.scheme},swr:{mutateOneSimulation:s.mutateOneSimulation},onError:function(e){return U(e)},onClose:d})]}),children:(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(P.Z,{size:"small",children:(0,u.jsx)(ke.Z,{layout:"vertical",children:(0,u.jsx)(ke.Z.Item,{label:(0,u.jsx)(f.Z.Text,{strong:!0,children:"Boundary condition name"}),children:(0,u.jsx)(Se.Z,{value:(null===E||void 0===E?void 0:E.name)||"",onChange:function(e){var n=e.target.value;N((function(e){return(0,T.Z)((0,O.Z)({},e),{name:n})}))},maxLength:50})})})}),(0,u.jsx)(P.Z,{size:"small",children:(0,u.jsx)(ke.Z,{layout:"vertical",children:(0,u.jsx)(ke.Z.Item,{label:(0,u.jsx)(f.Z.Text,{strong:!0,children:"Boundary condition type"}),children:(0,u.jsx)(Ii.ZP.Group,{className:"BoundaryCondition-types",optionType:"button",buttonStyle:"solid",value:null===E||void 0===E||null===(n=E.type)||void 0===n?void 0:n.key,onChange:function(e){var n,t=e.target.value,i=y.find((function(e){return e.key===t})),r=null===(n=z[t].children)||void 0===n?void 0:n.map((function(e){return{checked:!0,value:e.default}}));N((function(e){return(0,T.Z)((0,O.Z)({},e),{type:{key:i.key,label:i.label,children:i.children},values:r})}))},children:null===y||void 0===y?void 0:y.map((function(e){return(0,u.jsx)(Ii.ZP.Button,{value:e.key,children:e.label},e.key)}))})})})}),(null===E||void 0===E?void 0:E.type)&&(null===(t=E.type)||void 0===t?void 0:t.children)&&(0,u.jsx)(P.Z,{children:E.type.children.map((function(e,n){if(2!==F||!e.only3D)return(0,u.jsx)(Bt,{className:"marginBottom-10",label:e.label,defaultValue:String(E.values[n].value),defaultChecked:E.type.children.length>1?E.values[n].checked:void 0,onValueChange:function(e){return function(e,n){N((function(t){return(0,T.Z)((0,O.Z)({},t),{values:(0,a.Z)(E.values.slice(0,e)).concat([{checked:E.values[e].checked,value:n}],(0,a.Z)(E.values.slice(e+1)))})}))}(n,e)},onCheckedChange:function(e){return function(e,n){N((function(t){return(0,T.Z)((0,O.Z)({},t),{values:(0,a.Z)(E.values.slice(0,e)).concat([{checked:n,value:E.values[e].value}],(0,a.Z)(E.values.slice(e+1)))})}))}(n,e)},unit:e.unit},n)}))}),(0,u.jsx)(oi,{geometry:r,alreadySelected:h,updateSelected:R}),D&&(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)(b.Z,{style:{color:"red"}})," ",D]})]})})},tr=function(e){var n=e.simulation,t=e.geometry,i=e.swr,r=e.setVisible,a=(0,c.useState)(),l=a[0],o=a[1],s=(0,c.useState)(!1),m=s[0],f=s[1],p=(0,c.useContext)(B).dispatch,h=n.scheme.configuration.boundaryConditions;(0,c.useEffect)((function(){(null===t||void 0===t?void 0:t.summary)&&p(Tn(2===t.summary.dimension?"edges":"faces"))}),[t,p]);var v=(0,c.useCallback)((function(){o(void 0),f(!0),r(!1),p(Mn())}),[p,r]),x=(0,c.useCallback)((function(e,n){var t=h[e].values[n];o(t),f(!0),r(!1),p(Mn())}),[h,p,r]),b=(0,c.useCallback)((function(){p(On()),f(!1),o(void 0),r(!0)}),[p,r]);return t?(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsxs)(P.Z,{size:"small",children:[(0,u.jsx)(Z.HS,{onAdd:v,fullWidth:!0,primary:!1,children:"Add boundary condition"}),(0,u.jsx)(Gi,{simulation:{id:n.id,scheme:n.scheme},swr:{mutateOneSimulation:i.mutateOneSimulation},onEdit:x}),(0,u.jsx)(nr,{visible:m,geometry:{summary:t.summary},simulation:{id:n.id,scheme:n.scheme},boundaryCondition:l&&{uuid:l.uuid,name:l.name,type:l.type,selected:l.selected,values:l.values},swr:{mutateOneSimulation:i.mutateOneSimulation},onClose:b})]})})}):(0,u.jsx)(S.Z.Simple,{})},ir=t(91756),rr=t(67841),ar=t(36027),lr=t(57184),or="You need to define a name",ur="You need to select a point",sr="You need to define a formula",cr="Unable to update simulation",dr=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r,a,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=vt.Z.deepCopy(n),a=r.scheme.configuration.run,l=t.index,a.sensors[l]={name:t.name,point:t.point,formula:t.formula},e.next=7,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:a}]);case 7:i.mutateOneSimulation(r),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),(0,k.lt)(cr,e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(n,t,i){return e.apply(this,arguments)}}(),mr=function(e){var n=e.simulation,t=e.sensor,r=e.onError,a=e.onClose,l=e.swr,s=(0,c.useState)(),d=s[0],m=s[1];return(0,u.jsx)(Z.w6,{loading:d,primary:!0,needMargin:!0,onEdit:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m(!0),e.prev=1,t.name){e.next=6;break}return r(or),m(!1),e.abrupt("return");case 6:if(t.point){e.next=10;break}return r(ur),m(!1),e.abrupt("return");case 10:if(t.formula){e.next=14;break}return r(sr),m(!1),e.abrupt("return");case 14:return r(),e.next=17,dr(n,t,l);case 17:m(!1),a(),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(1),m(!1);case 24:case"end":return e.stop()}}),e,null,[[1,21]])}))),children:"Edit"})},fr="You need to define a name",pr="You need to select a point",hr="You need to define a formula",vr="Unable to update simulation",xr=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r,l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=vt.Z.deepCopy(n),l=r.scheme.configuration.run,u=(0,T.Z)((0,O.Z)({},l),{sensors:(0,a.Z)(l.sensors||[]).concat([t])}),e.next=6,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:u}]);case 6:i.mutateOneSimulation(r),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),(0,k.lt)(vr,e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n,t,i){return e.apply(this,arguments)}}(),br=function(e){var n=e.simulation,t=e.sensor,r=e.onError,a=e.onClose,l=e.swr,s=(0,c.useState)(),d=s[0],m=s[1];return(0,u.jsx)(Z.HS,{loading:d,needMargin:!0,onAdd:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m(!0),e.prev=1,t.name){e.next=6;break}return r(fr),m(!1),e.abrupt("return");case 6:if(t.point){e.next=10;break}return r(pr),m(!1),e.abrupt("return");case 10:if(t.formula){e.next=14;break}return r(hr),m(!1),e.abrupt("return");case 14:return r(),e.next=17,xr(n,t,l);case 17:m(!1),a(),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(1),m(!1);case 24:case"end":return e.stop()}}),e,null,[[1,21]])}))),children:"Add"})},yr=function(e){var n=e.visible,t=e.simulation,i=e.sensor,r=e.onClose,a=e.swr,l=(0,c.useState)(),o=l[0],s=l[1],d=(0,c.useState)(),m=d[0],h=d[1],v=(0,c.useState)(),x=v[0],y=v[1],g=(0,c.useState)(),j=g[0],w=g[1],k=(0,c.useContext)(B),S=k.point,E=k.dispatch;(0,c.useEffect)((function(){E(Tn("point"))}),[E]),(0,c.useEffect)((function(){if(!i){var e=t.scheme.configuration.run;h("Sensor "+(e.sensors?e.sensors.length+1:1))}}),[t,i]),(0,c.useEffect)((function(){i&&(h(i.name),E(An({x:i.point.x,y:i.point.y,z:i.point.z})),y(i.formula))}),[i,E]);var N,M,D,U,z,F,R=(0,c.useCallback)((function(){s(!1),E(On()),window.removeEventListener("click",R)}),[E]),A=(0,c.useCallback)((function(){o?R():(s(!0),E(Mn()),setTimeout((function(){return window.addEventListener("click",R)}),50))}),[o,R,E]),L=(0,c.useCallback)((function(e,n,t){E(An({x:e,y:n,z:t}))}),[E]),V=(0,c.useCallback)((function(e){y(e)}),[]),G=(0,c.useCallback)((function(){h(void 0),y(void 0),w(void 0),E(An()),r()}),[E,r]);return(0,u.jsx)(rt.Z,{className:"sensor",title:"Sensor",placement:"left",closable:!1,visible:n,mask:!1,maskClosable:!1,width:300,extra:(0,u.jsx)(p.Z,{type:"text",icon:(0,u.jsx)(fe.Z,{}),onClick:G}),footer:(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,u.jsx)(Z.Lw,{onCancel:G}),i?(0,u.jsx)(mr,{simulation:t,sensor:(0,T.Z)((0,O.Z)({},i),{name:m,point:S,formula:x}),onError:w,onClose:G,swr:a}):(0,u.jsx)(br,{simulation:t,sensor:{name:m,point:S,formula:x},onError:w,onClose:G,swr:a})]}),children:(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsxs)(P.Z,{size:"small",children:[(0,u.jsx)(f.Z.Text,{children:"Name"}),(0,u.jsx)(Se.Z,{value:m,onChange:function(e){return h(e.target.value)}})]}),(0,u.jsx)(P.Z,{size:"small",children:(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsxs)(C.Z,{className:"full-width",style:{justifyContent:"space-between"},children:[(0,u.jsx)(f.Z.Text,{children:"Point selection"}),(0,u.jsx)(Be.Z,{title:"Pin in the geometry",children:(0,u.jsx)(p.Z,{size:"small",type:o?"primary":"default",icon:(0,u.jsx)(lr.Z,{}),onClick:A})})]}),(0,u.jsx)(Bt,{label:"X",defaultValue:null===S||void 0===S?void 0:S.x,onValueChange:function(e){return L(+e,null!==(N=null===S||void 0===S?void 0:S.y)&&void 0!==N?N:0,null!==(M=null===S||void 0===S?void 0:S.z)&&void 0!==M?M:0)}}),(0,u.jsx)(Bt,{label:"Y",defaultValue:null===S||void 0===S?void 0:S.y,onValueChange:function(e){return L(null!==(D=null===S||void 0===S?void 0:S.x)&&void 0!==D?D:0,+e,null!==(U=null===S||void 0===S?void 0:S.z)&&void 0!==U?U:0)}}),(0,u.jsx)(Bt,{label:"Z",defaultValue:null===S||void 0===S?void 0:S.z,onValueChange:function(e){return L(null!==(z=null===S||void 0===S?void 0:S.x)&&void 0!==z?z:0,null!==(F=null===S||void 0===S?void 0:S.y)&&void 0!==F?F:0,+e)}})]})}),(0,u.jsx)(P.Z,{size:"small",className:"no-border-bottom",children:(0,u.jsx)(Bt,{label:"Formula",defaultValue:x,onValueChange:V})}),j&&(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)(b.Z,{style:{color:"red"}})," ",j]})]})})},gr="Unable to update the simulation",jr=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r){var l,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l=vt.Z.deepCopy(n),u=l.scheme.configuration.run,i(An()),u.sensors=(0,a.Z)(u.sensors.slice(0,t)).concat((0,a.Z)(u.sensors.slice(t+1))),e.next=7,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:u}]);case 7:r.mutateOneSimulation(l),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),(0,k.lt)(gr,e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(n,t,i,r){return e.apply(this,arguments)}}(),wr=function(e){var n=e.simulation,t=e.index,r=e.swr,a=(0,c.useState)(),l=a[0],s=a[1],d=(0,c.useContext)(B).dispatch,m=n.scheme.configuration.run.sensors[t];return(0,u.jsx)(Z.m1,{loading:l,text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the sensor"," ",(0,u.jsx)(f.Z.Text,{strong:!0,children:m.name})]}),onDelete:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,e.next=4,jr(n,t,d,r);case 4:return e.prev=4,s(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])})))})},Zr=function(e){var n,t=e.simulation,i=e.onEdit,r=e.swr,a=(0,c.useState)(!0),l=a[0],o=a[1],s=t.scheme.configuration.run,d=(0,c.useContext)(B).dispatch,m=(0,c.useCallback)((function(e){d(Mn()),d(An(e.point))}),[d]),p=(0,c.useCallback)((function(){l&&d(An()),d(On())}),[l,d]);return(0,u.jsx)(u.Fragment,{children:null===(n=s.sensors)||void 0===n?void 0:n.map((function(e,n){return(0,u.jsx)(P.Z,{className:"sensor-item text-center",hoverable:!0,onMouseEnter:function(){return m(e)},onMouseLeave:p,actions:[(0,u.jsx)(Z.w6,{onEdit:function(){o(!1),i((0,T.Z)((0,O.Z)({},e),{index:n})),setTimeout((function(){return o(!0)}),500)}},"edit"),(0,u.jsx)(wr,{simulation:t,index:n,swr:r},"delete")],children:(0,u.jsx)(f.Z.Text,{strong:!0,className:"text-center",children:e.name})},n)}))})},kr=function(e){var n=e.simulation,t=e.setVisible,i=e.swr,r=(0,c.useState)(),a=r[0],l=r[1],o=(0,c.useState)(),s=o[0],d=o[1],m=(0,c.useCallback)((function(){d(void 0),t(!1),l(!0)}),[t]),f=(0,c.useCallback)((function(e){d(e),t(!1),l(!0)}),[t]),h=(0,c.useCallback)((function(){d(void 0),t(!0),l(!1)}),[t]);return(0,u.jsxs)(P.Z,{size:"small",title:"Sensors",children:[(0,u.jsx)(yr,{visible:a,simulation:n,sensor:s,onClose:h,swr:i}),(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(p.Z,{className:"full-width",disabled:!1,type:"primary",icon:(0,u.jsx)(ar.Z,{}),onClick:m,children:"Add a sensor"}),(0,u.jsx)(Zr,{simulation:n,onEdit:f,swr:i})]})]})},Sr=t(5152),Pr=t.n(Sr),Cr=t(139),Er=t(24443),Nr="Plugins error",Mr="Unable to load plugins",Or=function(e){var n=e.disabled,i=e.cloudServer,a=e.onOk,l=(0,c.useState)(!1),o=l[0],d=l[1],m=(0,c.useState)([]),h=m[0],v=m[1],x=(0,s.useRouter)(),b=(0,r.Z)(Er.Z.usePlugins(),2),y=b[0],g=b[1].errorPlugins;return(0,c.useEffect)((function(){g&&(0,k.lt)(Nr,g)}),[g]),(0,c.useEffect)((function(){Tt.Z.list().then((function(e){v(e)})).catch((function(e){(0,k.lt)(Mr,e)}))}),[]),(0,u.jsxs)(P.Z,{size:"small",title:"Computational resource",children:[(0,u.jsx)(gt.Z,{visible:o,title:"Computational resource",okButtonProps:{disabled:!0,style:{display:"none"}},onCancel:function(){return d(!1)},style:{width:"unset"},children:(0,u.jsxs)(C.Z,{direction:"vertical",children:[(0,u.jsxs)(f.Z.Text,{children:["Your computational resource does not appear in this list? Create one in your",(0,u.jsx)(Z.Qj,{onClick:function(){return x.push({pathname:"/dashboard",query:{page:"account",tab:"hpc"}})},children:"account settings"})]}),(0,u.jsx)(C.Z,{align:"start",direction:"horizontal",wrap:!0,children:null===y||void 0===y?void 0:y.map((function(e){var n=h.find((function(n){return n.key===e.key}));if(n){var i=Pr()((function(){return t(64546)("./".concat(n.key,"/src/components"))}));return(0,u.jsx)(P.Z,{title:e.configuration.name.value,children:(0,u.jsx)(i,{data:e.data,onSelect:function(n){(0,ht.merge)(e,n),a(e),d(!1)}})},e.uuid)}}))})]})}),(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[i&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Plugin:"})," ",i.name]}),(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Name:"})," ",i.configuration.name.value]}),Object.keys(i.inUseConfiguration).map((function(e){var n=i.inUseConfiguration[e],t=n.value;return"boolean"===typeof t&&(t=t?"yes":"no"),(0,u.jsxs)(f.Z.Text,{children:[(0,u.jsxs)("span",{className:"text-light",children:[n.label,":"]})," ",t]},e)}))]}),(0,u.jsx)(p.Z,{className:"full-width",disabled:n,type:i?"link":"primary",icon:(0,u.jsx)(Cr.Z,{}),onClick:function(){return d(!0)},children:i?"Modify the resource":"Select a resource"})]})]})},Tr=t(10197),Dr=t(15360),Ur=t(25935),zr=t(48764).lW,Fr="Unable to get system log",Rr=function(){var e=(0,i.Z)(o().mark((function e(n,t){var i,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.log({id:n.id},t.systemLog);case 3:i=e.sent,r=zr.from(i.log).toString(),gt.Z.info({title:"System log",width:"unset",content:(0,u.jsx)("pre",{children:(0,u.jsx)("code",{children:(0,Ur.ZP)(r.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))})})}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),(0,k.lt)(Fr,e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,t){return e.apply(this,arguments)}}(),Ar=function(e){var n=e.simulation,t=e.steps,r=(0,c.useState)(!1),a=r[0],l=r[1],s=(0,c.useState)(!1),d=s[0],m=s[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(rt.Z,{title:"Log",visible:a,onClose:function(){return l(!1)},width:"50%",children:(0,u.jsx)(Tr.Z,{children:null===t||void 0===t?void 0:t.map((function(e){var t,r;return(0,u.jsxs)(Tr.Z.TabPane,{tab:e.label,children:[e.systemLog&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(p.Z,{loading:d,onClick:(0,i.Z)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return m(!0),t.prev=1,t.next=4,Rr(n,e);case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:return t.prev=8,m(!1),t.finish(8);case 11:case"end":return t.stop()}}),t,null,[[1,6,8,11]])}))),children:"Complete log"}),(0,u.jsx)("br",{})]}),e.link&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("a",{href:"https://"+e.link.href,target:"_blank",rel:"noreferrer",children:(0,u.jsx)(p.Z,{type:"primary",children:e.link.label})}),(0,u.jsx)("br",{})]}),(0,u.jsxs)(ki.Z,{ghost:!0,children:[e.warning&&(0,u.jsx)(ki.Z.Panel,{className:"warning-collapse",header:(0,u.jsx)(f.Z.Text,{type:"warning",children:"Warnings"}),children:(0,Ur.ZP)(e.warning.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))},"warnings"),e.error&&(0,u.jsx)(ki.Z.Panel,{className:"error-collapse",header:(0,u.jsx)(f.Z.Text,{type:"danger",children:"Errors"}),children:(0,Ur.ZP)(e.error.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))},"errors")]}),(0,Ur.ZP)((null===(t=e.pluginLog)||void 0===t?void 0:t.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))||""),(0,Ur.ZP)((null===(r=e.log)||void 0===r?void 0:r.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))||"")]},e.label)}))})}),(0,u.jsx)(Be.Z,{title:"Log",children:(0,u.jsx)(p.Z,{disabled:!t||!t.length,icon:(0,u.jsx)(Dr.Z,{}),onClick:function(){return l(!0)}})})]})},Lr=t(99611),Vr=t(23430),Gr="Unable to download the file",Ir=function(){var e=(0,i.Z)(o().mark((function e(n,t){var i,r,a,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_e.download({id:n.id},{originPath:t.originPath,fileName:t.fileName});case 3:return i=e.sent,e.next=6,i.blob();case 6:r=e.sent,a=window.URL.createObjectURL(new Blob([r])),(l=document.createElement("a")).href=a,l.setAttribute("download",t.name+"."+t.fileName.split(".").pop()),l.click(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,k.lt)(Gr,e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(n,t){return e.apply(this,arguments)}}(),_r=function(e){var n=e.simulation,t=e.file,r=(0,c.useState)(!1),a=r[0],l=r[1];return(0,u.jsx)(Be.Z,{title:"Download",children:(0,u.jsx)(p.Z,{loading:a,icon:(0,u.jsx)(Vr.Z,{}),onClick:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.prev=1,e.next=4,Ir(n,t);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.prev=8,l(!1),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[1,6,8,11]])})))})})},Br="Unable to download the archive",Hr=function(){var e=(0,i.Z)(o().mark((function e(n){var t,i,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_e.archive({id:n.id});case 3:return t=e.sent,e.next=6,t.blob();case 6:i=e.sent,r=window.URL.createObjectURL(new Blob([i])),(a=document.createElement("a")).href=r,a.setAttribute("download",n.scheme.name+".zip"),a.click(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,k.lt)(Br,e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(n){return e.apply(this,arguments)}}(),Yr=function(e){var n=e.simulation,t=(0,c.useState)(!1),r=t[0],a=t[1];return(0,u.jsx)(Z.o6,{loading:r,onDownload:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(!0),e.prev=1,e.next=4,Hr(n);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.prev=8,a(!1),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[1,6,8,11]])})))})},Wr=function(e){var n,t=e.simulation,i=e.result,r=e.setResult,l=(0,c.useState)(),o=l[0],s=l[1],d=(0,c.useState)(),m=d[0],f=d[1],h=(0,c.useState)(),v=h[0],x=h[1],b=null===t||void 0===t||null===(n=t.scheme)||void 0===n?void 0:n.configuration;return(0,c.useEffect)((function(){var e;if(!(null===t||void 0===t?void 0:t.tasks))return s([]),void f(void 0);var n=[],i=null===b||void 0===b||null===(e=b.run)||void 0===e?void 0:e.resultsFilter;t.tasks.forEach((function(e){if(e.file&&n.push(e.file),e.files)if(i){var t,r=new RegExp(i.pattern),l=e.files.filter((function(e){return!r.test(e.fileName)})),o=e.files.filter((function(e){return r.test(e.fileName)})),u=Ni(o,i),s=u.map((function(e){return e.number})).filter((function(e,n,t){return t.indexOf(e)===n})).sort((function(e,n){return e-n})),c=Mi(b,i),d=s.map((function(e,n){var t=c?e*c:n;return{label:Math.round(1e15*t)/1e15,value:e}}));(t=n).push.apply(t,(0,a.Z)(l)),f({filtered:!0,name:i.name,files:u,options:d})}else{var m;(m=n).push.apply(m,(0,a.Z)(e.files))}})),s(n)}),[t,b]),(0,c.useEffect)((function(){!v&&m&&x(null===m||void 0===m?void 0:m.options[0].value)}),[m,v]),o||m?(null===o||void 0===o?void 0:o.length)||m?(0,u.jsx)(P.Z,{size:"small",title:"Results",extra:(0,u.jsx)(Yr,{simulation:t&&{id:t.id,scheme:t.scheme}}),children:(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[null===o||void 0===o?void 0:o.map((function(e){return(0,u.jsxs)(C.Z,{style:{alignItems:"center"},children:[(0,u.jsx)(p.Z,{icon:(null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?(0,u.jsx)(Lr.Z,{style:{color:"#fad114"}}):(0,u.jsx)(an.Z,{}),onClick:function(){return r((null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?void 0:e)}}),(0,u.jsx)(_r,{simulation:t&&{id:t.id},file:e&&{name:e.name,fileName:e.fileName,originPath:e.originPath}}),e.name]},e.name)})),m&&(0,u.jsxs)(u.Fragment,{children:[m.name,(0,u.jsx)(yt.Z,{className:"full-width",options:m.options,value:v,onChange:function(e){var n=m.files.find((function(n){return n.number===e&&n.name===(null===i||void 0===i?void 0:i.name)}));r(n),x(e)}}),m.files.map((function(e){if(e.number===v)return(0,u.jsxs)(C.Z,{style:{alignItems:"center"},children:[(0,u.jsx)(p.Z,{icon:(null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?(0,u.jsx)(Lr.Z,{style:{color:"#fad114"}}):(0,u.jsx)(an.Z,{}),onClick:function(){return r((null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?void 0:e)}}),(0,u.jsx)(_r,{simulation:t&&{id:t.id},file:e&&{name:e.name,fileName:e.fileName,originPath:e.originPath}}),e.name]},e.name)}))]})]})}):(0,u.jsx)(P.Z,{size:"small",children:"No results yet"}):(0,u.jsx)(qe.Z,{})},qr="Unable to run the simulation",Kr="Unable to stop the simulation",Jr="Unable to update the simulation",$r=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=vt.Z.deepCopy(n),(a=n.scheme.configuration).run.cloudServer=t,r.scheme.configuration=a,e.next=7,ae.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:a.run}]);case 7:i.mutateOneSimulation(r),i.mutateSimulation(r),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),(0,k.lt)(Jr,e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(n,t,i){return e.apply(this,arguments)}}(),Xr=function(){var e=(0,i.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.run({id:n.id});case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),(0,k.lt)(qr,e.t0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(n){return e.apply(this,arguments)}}(),Qr=function(){var e=(0,i.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.stop({id:n.id});case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),(0,k.lt)(Kr,e.t0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(n){return e.apply(this,arguments)}}(),ea=function(e){var n,t,a=e.simulation,l=e.result,s=e.setResult,m=e.setVisible,f=e.swr,h=(0,c.useState)(!1),v=h[0],x=h[1],b=(0,c.useState)(!1),y=b[0],g=b[1],j=(0,c.useState)([]),w=j[0],Z=j[1],k=(0,r.Z)(ae.useSimulation(a.id,2e3),2),S=k[0],E=k[1].mutateSimulation,N=a.scheme.configuration,M=null===S||void 0===S||null===(n=S.scheme)||void 0===n?void 0:n.configuration;return(0,c.useEffect)((function(){if(N){var e=!0;Object.keys(N).forEach((function(n){"dimension"!==n&&"run"!==n&&(N[n].done||(e=!1))})),N.run.cloudServer||(e=!1),x(!e)}else x(!0)}),[N]),(0,c.useEffect)((function(){var e,n;(null===S||void 0===S||null===(e=S.tasks)||void 0===e?void 0:e.find((function(e){return"error"===(null===e||void 0===e?void 0:e.status)})))?g(!1):(null===S||void 0===S||null===(n=S.tasks)||void 0===n?void 0:n.find((function(e){return e&&"finish"!==e.status})))?g(!0):g(!1)}),[null===S||void 0===S?void 0:S.tasks]),(0,c.useEffect)((function(){var e,n=[];null===S||void 0===S||null===(e=S.tasks)||void 0===e||e.forEach((function(e){e&&(n[e.index]={index:e.index,label:e.label,status:e.status,log:e.log,pluginLog:e.pluginLog,warning:e.warning,error:e.error,systemLog:e.systemLog,link:e.link})})),Z(n)}),[null===S||void 0===S?void 0:S.tasks]),a&&S&&"0"!==(null===S||void 0===S?void 0:S.id)?(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(kr,{simulation:a,setVisible:m,swr:{mutateOneSimulation:f.mutateOneSimulation}}),(0,u.jsx)(Or,{disabled:y,cloudServer:null===M||void 0===M||null===(t=M.run)||void 0===t?void 0:t.cloudServer,onOk:function(){var e=(0,i.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$r(a,n,(0,T.Z)((0,O.Z)({},f),{mutateSimulation:E})));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}),(0,u.jsx)(P.Z,{size:"small",title:"Run",children:(0,u.jsxs)(C.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,u.jsxs)("div",{className:"full-width",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsxs)(C.Z,{children:[(0,u.jsx)(p.Z,{disabled:v,type:"primary",icon:(0,u.jsx)(rr.Z,{}),loading:y,onClick:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.prev=1,e.next=4,Xr(a);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),g(!1);case 9:case"end":return e.stop()}}),e,null,[[1,6]])}))),children:"Run"}),(0,u.jsx)(p.Z,{disabled:!y,danger:!0,icon:(0,u.jsx)(rn.Z,{}),shape:"circle",onClick:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Qr(a);case 3:g(!1),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))})]}),(0,u.jsx)(Ar,{simulation:{id:a.id},steps:w})]}),(0,u.jsx)(ir.Z,{direction:"vertical",children:w.map((function(e,n){return(0,u.jsx)(ir.Z.Step,{title:e.label,description:"("+(n+1)+"/"+w.length+")",status:e.status},e.label)}))})]})}),(0,u.jsx)(Wr,{simulation:S&&{id:S.id,scheme:S.scheme,tasks:S.tasks},result:l&&{name:l.name,fileName:l.fileName},setResult:s})]})})}):(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsx)(P.Z,{size:"small",children:(0,u.jsx)(qe.Z,{})})})})},na=t(1402),ta=[{key:"warpByVector",label:"Warp by vector",parameters:[{key:"Vectors",label:"Vectors",rules:[{required:!0,message:"Vectors is required"}]},{key:"ScaleFactor",label:"Scale factor",default:"1",rules:[{required:!0,message:"Scale factor is required"}]}]},{key:"contour",label:"Contour",parameters:[{key:"ContourBy",label:"Contour by",rules:[{required:!0,message:"ContourBy by is required"}]},{key:"isosurface",label:"Isosurface",default:"0",rules:[{required:!0,message:"Isosurface is required"}]}]},{key:"streamTracer",label:"Stream tracer",parameters:[{key:"Vectors",label:"Vectors",rules:[{required:!0,message:"Vectors is required"}]}]}],ia=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.R)("/api/postprocessing",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({simulation:n,result:t,filter:i,parameters:r})});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}}),e)})));return function(n,t,i,r){return e.apply(this,arguments)}}(),ra={run:ia},aa="Unable to run filter",la=function(){var e=(0,i.Z)(o().mark((function e(n,t,i,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ra.run(n,t,i,r);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),(0,k.lt)(aa,e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n,t,i,r){return e.apply(this,arguments)}}(),oa=function(e){var n=e.simulation,t=e.result,r=e.postprocessing,a=e.setResult,l=(0,c.useState)(),s=l[0],m=l[1],f=(0,c.useState)(),h=f[0],v=f[1],x=(0,c.useState)(),b=x[0],y=x[1],g=(0,c.useState)(),j=g[0],w=g[1];if((0,c.useEffect)((function(){!t&&s&&m(!1)}),[t,s]),(0,c.useEffect)((function(){n||(v(void 0),w(void 0))}),[n,t]),!n||!t)return null;var Z=n.scheme.configuration.run.postprocessing;if(!Z)return null;var k=ta.map((function(e){if(Z.find((function(n){return n.key===e.key})))return{label:e.label,value:e.key}})).filter((function(e){return e}));if(!k.length)return null;var S=null;if(h){var E=ta.find((function(e){return e.key===h})),N=Z.find((function(e){return e.key===h}));(null===E||void 0===E?void 0:E.parameters)&&(S=E.parameters.map((function(e,n){var t,i=null===N||void 0===N||null===(t=N.parameters)||void 0===t?void 0:t.find((function(n){return n.key===e.key}));return(null===i||void 0===i?void 0:i.value)?(0,u.jsx)(ke.Z.Item,{label:e.label,name:["parameters",n],initialValue:i.value,rules:e.rules,children:(0,u.jsx)(Se.Z,{disabled:!0})},e.key):(null===i||void 0===i?void 0:i.options)?(0,u.jsx)(ke.Z.Item,{label:e.label,name:["parameters",n],rules:e.rules,children:(0,u.jsx)(yt.Z,{options:i.options.map((function(e){return{label:e,value:e}}))})},e.key):(0,u.jsx)(ke.Z.Item,{label:e.label,name:["parameters",n],rules:e.rules,initialValue:e.default,children:(0,u.jsx)(Se.Z,{})},e.key)})))}return(0,u.jsx)(d.Z,{style:{position:"absolute",zIndex:101,right:25,bottom:50,backgroundColor:"rgba(255, 255, 255, 0)"},children:(0,u.jsxs)(d.Z.Content,{children:[(0,u.jsx)(Be.Z,{title:"Post-processing",children:(0,u.jsx)(p.Z,{type:"primary",icon:(0,u.jsx)(na.Z,{}),onClick:function(){return m(!0)},style:{width:40,height:40,border:"1px solid #5E14FA",borderRadius:20,marginBottom:-20}})}),(0,u.jsxs)(rt.Z,{title:"Post-processing",closable:!0,onClose:function(){return m(!1)},visible:s,mask:!1,maskClosable:!1,children:[(0,u.jsx)(ke.Z,{style:{margin:"24px 0"},children:(0,u.jsx)(ke.Z.Item,{name:"filter",label:"Filter",children:(0,u.jsx)(yt.Z,{placeholder:"Select a filter",options:k,onChange:v})})}),(0,u.jsxs)(ke.Z,{layout:"vertical",style:{margin:"24px 0"},onFinish:function(){var e=(0,i.Z)(o().mark((function e(i){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),e.prev=1,e.next=4,la({id:n.id},t,h,i.parameters||[]);case 4:r=e.sent,w(r),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:y(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),children:[S,(0,u.jsx)(ke.Z.Item,{children:(0,u.jsx)(p.Z,{type:"primary",loading:b,htmlType:"submit",icon:(0,u.jsx)(rr.Z,{}),children:"Run"})})]}),j&&(0,u.jsx)(P.Z,{size:"small",title:"Post-processing",extra:h,children:(0,u.jsx)(C.Z,{direction:"vertical",className:"full-width",children:j.length?j.map((function(e){return(0,u.jsxs)(C.Z,{children:[(0,u.jsx)(p.Z,{icon:(null===r||void 0===r?void 0:r.fileName)===e.fileName&&(null===r||void 0===r?void 0:r.name)===e.name?(0,u.jsx)(Lr.Z,{style:{color:"#fad114"}}):(0,u.jsx)(an.Z,{}),onClick:function(){return a((null===r||void 0===r?void 0:r.fileName)===e.fileName&&(null===r||void 0===r?void 0:r.name)===e.name?void 0:(0,O.Z)({type:"postprocessing"},e))}}),(0,u.jsx)(_r,{simulation:{id:n.id},file:{name:e.name,fileName:e.fileName,originPath:e.originPath}}),e.name]},e.glb)})):"No results"})})]})]})})},ua="Unable to load plugins",sa="Unable to update the simulation",ca=function(e,n){Tt.Z.list().then((function(t){var i=da(e,Ot,t);n(i)})).catch((function(e){(0,k.lt)(ua,e)}))},da=function(e,n,t){var i=n;return t.forEach((function(n){var t;(null===e||void 0===e||null===(t=e.authorizedplugins)||void 0===t?void 0:t.includes(n.key))&&"Model"===n.category&&(i=(0,a.Z)(i).concat((0,a.Z)(n.models)))})),i},ma=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.find((function(e){var t;return e.algorithm===(null===n||void 0===n||null===(t=n.scheme)||void 0===t?void 0:t.algorithm)})),a=vt.Z.deepCopy(n),(0,ht.merge)(a.scheme,r),e.next=6,ae.update({id:n.id},[{key:"scheme",value:a.scheme}]);case 6:i.mutateOneSimulation(a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,k.lt)(sa,e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n,t,i){return e.apply(this,arguments)}}(),fa={Selector:function(e){var n=e.visible,t=e.user,r=e.onOk,a=e.onCancel,l=(0,c.useState)(),s=l[0],f=l[1],p=(0,c.useState)(!1),h=p[0],v=p[1],x=(0,c.useState)([]),b=x[0],y=x[1],g=(0,c.useState)(),j=g[0],w=g[1],Z=(0,c.useState)(),k=Z[0],S=Z[1];(0,c.useEffect)((function(){t&&ca(t,y)}),[t]),(0,c.useEffect)((function(){var e=b.map((function(e){return e.category})).filter((function(e,n,t){return t.indexOf(e)===n})).map((function(e){return{key:e,value:e}}));w(e)}),[b]);var P=(0,c.useCallback)((function(e){var n=e.key,t=b.find((function(e){return e.algorithm===n}));f(vt.Z.deepCopy(t))}),[b]),C=[{key:"category",disabled:!0,label:(0,u.jsx)(yt.Z,{className:"full-width",options:j,allowClear:!0,showArrow:!1,placeholder:"Category filter",onChange:function(e){return S(e)}})}];return b.forEach((function(e){k&&e.category!==k||C.push({key:e.algorithm,label:e.name})})),(0,u.jsx)(gt.Z,{visible:n,title:"Create simulation",okText:"Create",okButtonProps:{loading:h},onOk:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v(!0),!s){e.next=9;break}return e.prev=2,e.next=5,r(s);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:v(!1);case 10:case"end":return e.stop()}}),e,null,[[2,7]])}))),onCancel:function(){return a()},width:"80%",children:(0,u.jsxs)(d.Z,{children:[(0,u.jsx)(d.Z.Sider,{theme:"light",children:(0,u.jsx)(m.Z,{mode:"inline",items:C,onSelect:P})}),(0,u.jsx)(d.Z.Content,{style:{padding:"20px",height:"60vh",overflow:"auto"},className:"simulation-selector",children:(0,u.jsx)(he.Z.Html,{html:null===s||void 0===s?void 0:s.description})})]})})},Updater:function(e){var n=e.user,t=e.simulation,r=e.swr,a=(0,c.useState)(!1),l=a[0],s=a[1],d=(0,c.useState)(!1),m=d[0],p=d[1],h=(0,c.useState)([]),v=h[0],x=h[1];return(0,c.useEffect)((function(){n&&ca(n,x)}),[n]),(0,c.useEffect)((function(){var e=v.find((function(e){var n;return e.algorithm===(null===t||void 0===t||null===(n=t.scheme)||void 0===n?void 0:n.algorithm)}));if(e&&(null===t||void 0===t?void 0:t.scheme)){var n=(0,wt.Z)(t.scheme,e),i=(0,Zt.Z)(t.scheme,e);Object.keys(n).length||Object.keys(i).length?s(!0):s(!1)}}),[t,v]),t?(0,u.jsx)(gt.Z,{title:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(jt.Z,{style:{color:"orange",marginRight:"5px"}}),"Update"]}),visible:l,onOk:(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,ma(t,v,r);case 4:return e.prev=4,p(!1),s(!1),e.finish(4);case 8:case"end":return e.stop()}}),e,null,[[1,,4,8]])}))),okText:"OK",confirmLoading:m,onCancel:function(){return s(!1)},cancelButtonProps:{disabled:!0},maskClosable:!1,children:(0,u.jsxs)(C.Z,{direction:"vertical",children:[(0,u.jsx)(f.Z.Text,{children:"Your model needs an update!"}),(0,u.jsx)(f.Z.Text,{strong:!0,children:"Update now?"})]})}):null},About:_t,Geometry:$t,Materials:Zi,Parameters:Ei,Initialization:Ri,BoundaryConditions:tr,Run:ea,Postprocessing:oa},pa=fa,ha={label:"GEOMETRIES",key:"geometries"},va={label:"SIMULATIONS",key:"simulations"},xa="Unable to get user",ba="Unable to get project",ya="Unable to get simulations",ga="Unable to get geometries",ja="Unable to add a simulation",wa=function(){var e=(0,i.Z)(o().mark((function e(n,t,i){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.add({id:n.id},{name:t.name,scheme:t});case 3:r=e.sent,i.addOneSimulation(r),i.mutateProject({id:n.id,simulations:(0,a.Z)(n.simulations||[]).concat([r.id])}),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),(0,k.lt)(ja,e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,t,i){return e.apply(this,arguments)}}(),Za=function(){var e=(0,s.useRouter)(),n=e.query,t=n.page,l=n.workspaceId,P=n.projectId,C=(0,c.useState)(!1),E=C[0],N=C[1],O=(0,c.useState)(),T=O[0],D=O[1],U=(0,c.useState)(!1),z=U[0],F=U[1],R=(0,c.useState)(),A=R[0],L=R[1],V=(0,c.useState)(),G=V[0],I=V[1],_=(0,c.useState)(),B=_[0],H=_[1],K=(0,c.useState)(),J=K[0],$=K[1],X=(0,c.useState)(),Q=X[0],ee=X[1],ne=(0,c.useState)(!0),te=ne[0],ie=ne[1],re=(0,r.Z)(W.Z.useUser(),2),le=re[0],oe=re[1],ue=oe.errorUser,se=oe.loadingUser,ce=(0,r.Z)(q.Z.useProject(P),2),de=ce[0],fe=ce[1],he=fe.mutateProject,ve=fe.errorProject,xe=fe.loadingProject,be=(0,r.Z)(ae.useSimulations(null===de||void 0===de?void 0:de.simulations),2),ye=be[0],ge=be[1],je=ge.addOneSimulation,we=ge.delOneSimulation,Ze=ge.mutateOneSimulation,ke=ge.errorSimulations,Se=ge.loadingSimulations,Pe=(0,r.Z)(me.useGeometries(null===de||void 0===de?void 0:de.geometries),2),Ce=Pe[0],Ee=Pe[1],Ne=Ee.addOneGeometry,Me=Ee.delOneGeometry,Oe=Ee.mutateOneGeometry,Te=Ee.errorGeometries,De=Ee.loadingGeometries,Ue=(0,c.useCallback)((function(){ee(void 0),$(void 0)}),[]);(0,c.useEffect)((function(){se||le||e.replace("/login")}),[le,se,e]),(0,c.useEffect)((function(){ue&&(0,k.lt)(xa,ue),ve&&(0,k.lt)(ba,ve),ke&&(0,k.lt)(ya,ke),Te&&(0,k.lt)(ga,Te)}),[ue,ve,ke,Te]),(0,c.useEffect)((function(){xe||De||Ce.length?N(!1):N(!0)}),[xe,De,Ce]),(0,c.useEffect)((function(){if(!De&&T){var e=Ce.find((function(e){return e.id===(null===T||void 0===T?void 0:T.id)}));e?JSON.stringify(e)!==JSON.stringify(T)&&D(e):D(void 0)}else D(Ce[0])}),[Ce,T,De,D]),(0,c.useEffect)((function(){if(!Se&&A){var e=ye.find((function(e){return e.id===(null===A||void 0===A?void 0:A.id)}));e?JSON.stringify(e)!==JSON.stringify(A)&&L(e):(Ue(),L(void 0))}}),[ye,A,Se,L,Ue]);var ze=(0,c.useCallback)((function(){D({id:"0",needCleanup:!0})}),[]),Fe=(0,c.useCallback)((function(e){var n=Ce.find((function(n){return n.id===e}));n&&(D(n),ee((0,u.jsx)(pe,{visible:!0,title:"Geometry",onClose:Ue,children:(0,u.jsx)(Ae,{project:{id:de.id,geometries:de.geometries},geometry:{id:n.id,name:n.name,summary:n.summary},swr:{mutateProject:he,mutateOneGeometry:Oe,delOneGeometry:Me},close:Ue,onCleanup:ze})})))}),[de,Ce,he,Oe,Me,ze,Ue]),Re=(0,c.useCallback)((function(e){ee((0,u.jsx)(pe,{visible:!0,title:"About",onClose:Ue,children:(0,u.jsx)(pa.About,{project:{id:de.id,simulations:de.simulations},simulation:{id:e.id,name:e.name,scheme:e.scheme},swr:{mutateProject:he,addOneSimulation:je,delOneSimulation:we,mutateOneSimulation:Ze}})}))}),[de,he,je,we,Ze,Ue]),Le=(0,c.useCallback)((function(e){ee((0,u.jsx)(pe,{visible:!0,title:"Geometry",onClose:Ue,children:(0,u.jsx)(pa.Geometry,{geometries:Ce,geometry:T&&{id:T.id,summary:T.summary},simulation:{id:e.id,scheme:e.scheme},setGeometry:D,swr:{mutateOneSimulation:Ze}})}))}),[Ce,T,Ze,Ue]),Ve=(0,c.useCallback)((function(e){ee((0,u.jsx)(pe,{visible:!0,title:"Parameters",onClose:Ue,children:(0,u.jsx)(pa.Parameters,{simulation:{id:e.id,scheme:e.scheme},swr:{mutateOneSimulation:Ze}})}))}),[Ze,Ue]),Ge=(0,c.useCallback)((function(e){ee((0,u.jsx)(pe,{visible:te,title:"Materials",onClose:Ue,children:(0,u.jsx)(pa.Materials,{geometry:T&&{id:T.id,summary:T.summary},simulation:{id:e.id,scheme:e.scheme},swr:{mutateOneSimulation:Ze},setVisible:function(e){return ie(e)}})}))}),[T,te,Ze,Ue]),Ie=(0,c.useCallback)((function(e){ee((0,u.jsx)(pe,{visible:!0,title:"Initialization",onClose:Ue,children:(0,u.jsx)(pa.Initialization,{simulations:ye,simulation:e,swr:{mutateOneSimulation:Ze}})}))}),[ye,Ze,Ue]),_e=(0,c.useCallback)((function(e){ee((0,u.jsx)(pe,{visible:te,title:"Boundary conditions",onClose:Ue,children:(0,u.jsx)(pa.BoundaryConditions,{geometry:T&&{id:T.id,summary:T.summary},simulation:{id:e.id,scheme:e.scheme},swr:{mutateOneSimulation:Ze},setVisible:function(e){return ie(e)}})}))}),[T,te,Ze,Ue]),Be=(0,c.useCallback)((function(e){ee((0,u.jsx)(pe,{visible:te,title:"Run",onClose:Ue,children:(0,u.jsx)(pa.Run,{simulation:{id:e.id,scheme:e.scheme},result:G&&{name:G.name,fileName:G.fileName},setResult:I,setVisible:function(e){return ie(e)},swr:{mutateOneSimulation:Ze}})}))}),[G,te,Ze,Ue]),He=(0,c.useCallback)((function(e,n){var t,i,r,a=ye.find((function(n){return n.id===e}));if(a){L(a);var l=null===(t=a.scheme)||void 0===t||null===(i=t.configuration)||void 0===i||null===(r=i.geometry)||void 0===r?void 0:r.value;if(l&&(null===T||void 0===T?void 0:T.id)!==l){var o=Ce.find((function(e){return e.id===l}));o&&D(o)}switch(n){case"about":Re(a);break;case"geometry":Le(a);break;case"parameters":Ve(a);break;case"materials":Ge(a);break;case"initialization":Ie(a);break;case"boundaryConditions":_e(a);break;case"run":Be(a);break;default:ee(void 0)}}}),[T,Ce,ye,Re,Le,Ve,Ge,Ie,_e,Be]);(0,c.useEffect)((function(){J&&(J.key===ha.key?Fe(J.id):(He(J.id,J.item),"run"!==J.item&&(I(void 0),H(void 0))))}),[J,Fe,He,Ue]),(0,c.useEffect)((function(){!G&&B&&H(void 0)}),[G,B]);var Ye=(0,c.useCallback)((function(e){var n,t=e.keyPath,i=t.pop(),r=t.pop(),a=t.pop();a&&(n=a.split("&").pop()),$({key:i,id:r,item:n})}),[]),We=Ce.map((function(e){return{key:e.id,icon:(0,u.jsx)(h.Z,{}),label:e.name}})),qe=ye.map((function(e){var n=e.scheme.configuration||{},t=[];return Object.keys(n).forEach((function(i){if("dimension"!==i){var r=n[i],a=(0,u.jsx)(v.Z,{style:{color:"green"}});r.error&&(a=(0,u.jsx)(x.Z,{style:{color:"red"}})),r.done||(a=(0,u.jsx)(b.Z,{style:{color:"orange"}})),"geometry"!==i||Ce.filter((function(e){return e.id===r.value})).length||De||(a=(0,u.jsx)(b.Z,{style:{color:"orange"}}),r.done=null),t[r.index]={key:e.id+"&"+i,className:"Project-Menu-SubMenu-Simulations-SubMenu-MenuItem",disabled:!Ce.length,icon:a,label:r.title}}})),{key:e.id,className:"Project-Menu-SubMenu-Simulations-SubMenu",icon:(0,u.jsx)(y.Z,{}),label:e.name,children:[{key:e.id+"&about",className:"Project-Menu-SubMenu-Simulations-SubMenu-MenuItem",disabled:!Ce.length,icon:(0,u.jsx)(v.Z,{style:{color:"green"}}),label:"About"}].concat((0,a.Z)(t))}}));return!le||se||xe?(0,u.jsx)(S.Z.Simple,{}):"0"===de.id?(0,u.jsx)(M,{}):(0,u.jsx)(Y,{children:(0,u.jsxs)(d.Z,{hasSider:!0,children:[(0,u.jsxs)(d.Z.Sider,{theme:"light",className:"Project-Sider",width:256,children:[(0,u.jsx)("div",{className:"logo",children:(0,u.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,u.jsx)(m.Z,{mode:"inline",items:[{key:"menu-go-back",disabled:!0,className:"Project-Menu-GoBack",style:{cursor:"unset",margin:"10px 0",paddingLeft:10},label:(0,u.jsx)(Z.ks,{onClick:function(){return function(e,n,t){e.push({pathname:"/dashboard",query:{page:n,workspaceId:t}})}(e,t,l)},children:"Return to dashboard"})},{type:"divider",className:"Project-Menu-Divider"},{key:"title",disabled:!0,className:"Project-Menu-Title",label:(0,u.jsx)(f.Z.Paragraph,{ellipsis:{tooltip:!0,rows:1},children:de.title})}]}),(0,u.jsx)("div",{className:"Project-Menu-scroll",children:(0,u.jsx)(m.Z,{className:"Project-Menu",mode:"inline",defaultOpenKeys:[ha.key,va.key],items:[{key:ha.key,className:"Project-Menu-SubMenu-Geometries",icon:De?(0,u.jsx)(g.Z,{}):(0,u.jsx)(h.Z,{}),label:(0,u.jsxs)(f.Z.Text,{strong:!0,children:[ha.label," (",Ce.length,")"]}),children:[{key:"new_geometry",className:"Project-Menu-SubMenu-Geometries-New",disabled:!0,label:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(j.Z,{}),onClick:function(){return N(!0)},children:"New Geometry"})},{key:"geometry-needed",className:"text-dark "+(Ce.length?"display-none":""),disabled:!0,icon:(0,u.jsx)(b.Z,{style:{color:"red"}}),label:"A Geometry is needed"}].concat((0,a.Z)(We))},{key:va.key,className:"Project-Menu-SubMenu-Simulations",icon:Se?(0,u.jsx)(g.Z,{}):(0,u.jsx)(y.Z,{}),label:(0,u.jsxs)(f.Z.Text,{strong:!0,children:[va.label," (",ye.length,")"]}),children:[{key:"new_simulation",className:"Project-Menu-SubMenu-Simulations-New",disabled:!0,label:(0,u.jsx)(p.Z,{disabled:!Ce.length,icon:(0,u.jsx)(w.Z,{}),onClick:function(){return F(!0)},children:"New Simulation"})}].concat((0,a.Z)(qe))}],onClick:Ye})})]}),(0,u.jsxs)(d.Z.Content,{className:"no-scroll relative",children:[(0,u.jsx)(Ae.Add,{visible:E,project:{id:de.id,geometries:de.geometries},swr:{mutateProject:he,addOneGeometry:Ne},setVisible:function(e){return N(e)}}),(0,u.jsx)(pa.Selector,{user:{authorizedplugins:le.authorizedplugins},visible:z,onOk:function(){var e=(0,i.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,wa(de,n,{addOneSimulation:je,mutateProject:he});case 3:F(!1),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n){return e.apply(this,arguments)}}(),onCancel:function(){return F(!1)}}),(0,u.jsx)(pa.Updater,{user:{authorizedplugins:le.authorizedplugins},simulation:A&&{id:A.id,scheme:A.scheme},swr:{mutateOneSimulation:Ze}}),Q,(0,u.jsx)(nt,{project:{id:de.id,title:de.title},simulation:A&&{id:A.id},geometry:T&&{id:T.id,needCleanup:T.needCleanup},result:G&&{glb:G.glb,originPath:G.originPath},postprocessing:B&&{glb:B.glb,originPath:B.originPath}}),(0,u.jsx)(bt,{simulation:A&&{id:A.id,name:A.name}}),(0,u.jsx)(pa.Postprocessing,{simulation:A&&{id:A.id,scheme:A.scheme},result:G&&{name:G.name,fileName:G.fileName,originPath:G.originPath},postprocessing:B&&{name:B.name,fileName:B.fileName},setResult:H})]})]})})}},64546:function(e,n,t){var i={"./local/src/components":[17697,697]};function r(e){if(!t.o(i,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=i[e],r=n[0];return t.e(n[1]).then((function(){return t(r)}))}r.keys=function(){return Object.keys(i)},r.id=64546,e.exports=r}}]);