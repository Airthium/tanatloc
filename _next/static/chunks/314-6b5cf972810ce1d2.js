(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[314],{70314:function(e,n,t){"use strict";t.d(n,{ZP:function(){return jr}});var i=t(47568),a=t(828),r=t(29815),l=t(20414),o=t(85893),u=t(11163),s=t(67294),c=t(97183),d=t(66516),m=t(6880),f=t(71577),h=t(48869),v=t(8751),p=t(18429),y=t(11475),b=t(22844),g=t(50888),x=t(88484),j=t(64789),Z=t(41641),w=t(96844),S=t(75107),P=t(81474),C=t(26713),k=t(20280),E="You are not authorized to be there.",_=function(){var e=(0,u.useRouter)();return(0,s.useEffect)((function(){e.prefetch("/")}),[e]),(0,o.jsx)(c.Z,{children:(0,o.jsx)(c.Z.Content,{children:(0,o.jsx)(P.Z,{title:"Not allowed",children:(0,o.jsxs)(C.Z,{direction:"vertical",children:[(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)(k.Z,{style:{color:"red"}})," ",E]}),(0,o.jsxs)(m.Z.Text,{children:["Go back"," ",(0,o.jsx)(f.Z,{type:"link",onClick:function(){return function(e){e.push("/")}(e)},children:"home"})]})]})})})})},N=t(26042),M=t(69396),O={enabled:!1,type:void 0,part:void 0,highlighted:void 0,selected:[],point:void 0,dispatch:function(){}},T="ENABLE",D="DISABLE",U="CLEAR",z="SETTYPE",F="SETPART",R="HIGHLIGHT",A="UNHIGHLIGHT",L="SELECT",V="UNSELECT",G="SETPOINT",I=(0,s.createContext)(O),B=function(e,n){var t;switch(n.type){case T:return(0,M.Z)((0,N.Z)({},e),{enabled:!0});case D:return(0,M.Z)((0,N.Z)({},e),{enabled:!1,highlighted:void 0,selected:[]});case U:return(0,N.Z)({},O);case z:return(0,M.Z)((0,N.Z)({},e),{type:n.value});case F:return(0,M.Z)((0,N.Z)({},e),{part:n.value});case R:return(0,M.Z)((0,N.Z)({},e),{highlighted:n.value});case A:return(0,M.Z)((0,N.Z)({},e),{highlighted:void 0});case L:return-1===(t=e.selected.findIndex((function(e){return e.uuid===n.value.uuid})))?(0,M.Z)((0,N.Z)({},e),{selected:(0,r.Z)(e.selected).concat([n.value])}):e;case V:return-1===(t=e.selected.findIndex((function(e){return e.uuid===n.value.uuid})))?e:(0,M.Z)((0,N.Z)({},e),{selected:(0,r.Z)(e.selected.slice(0,t)).concat((0,r.Z)(e.selected.slice(t+1)))});case G:return(0,M.Z)((0,N.Z)({},e),{point:n.value});default:return e}},H=function(e){var n=e.children,t=(0,s.useReducer)(B,O),i=t[0],a=t[1];return(0,o.jsx)(I.Provider,{value:(0,M.Z)((0,N.Z)({},i),{dispatch:a}),children:n})},Y=t(67169),W=t(94370),q=t(8100),K=t(87492),J=function(){var e=(0,i.Z)((function(e,n){var t;return(0,l.__generator)(this,(function(i){switch(i.label){case 0:return t={},[4,(0,K.R)("/api/simulation",(t.method="POST",t.headers={Accept:"application/json"},t.body=JSON.stringify({project:{id:e.id},simulation:n}),t))];case 1:return[2,i.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),$=function(){var e=(0,i.Z)((function(e,n){var t;return(0,l.__generator)(this,(function(i){switch(i.label){case 0:return t={},[4,(0,K.R)("/api/simulation/"+e.id,(t.method="PUT",t.body=JSON.stringify(n),t))];case 1:return i.sent(),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),X=function(){var e=(0,i.Z)((function(e){var n;return(0,l.__generator)(this,(function(t){switch(t.label){case 0:return n={},[4,(0,K.R)("/api/simulation/"+e.id,(n.method="DELETE",n))];case 1:return t.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Q=function(){var e=(0,i.Z)((function(e){var n;return(0,l.__generator)(this,(function(t){switch(t.label){case 0:return n={},[4,(0,K.R)("/api/simulation/"+e.id+"/run",(n.method="GET",n))];case 1:return t.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),ee=function(){var e=(0,i.Z)((function(e){var n;return(0,l.__generator)(this,(function(t){switch(t.label){case 0:return n={},[4,(0,K.R)("/api/simulation/"+e.id+"/stop",(n.method="GET",n))];case 1:return t.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),ne=function(){var e=(0,i.Z)((function(e){var n;return(0,l.__generator)(this,(function(t){switch(t.label){case 0:return n={},[4,(0,K.R)("/api/simulation/"+e.id+"/tasks",(n.method="GET",n.headers={Accept:"application/json"},n))];case 1:return[2,t.sent().json()]}}))}));return function(n){return e.apply(this,arguments)}}(),te=function(){var e=(0,i.Z)((function(e,n){var t;return(0,l.__generator)(this,(function(i){switch(i.label){case 0:return t={},[4,(0,K.R)("/api/simulation/"+e.id+"/log",(t.method="POST",t.body=JSON.stringify({file:n}),t))];case 1:return[2,i.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),ie={useSimulations:function(e){var n=(0,q.ZP)(["/api/simulations",JSON.stringify({ids:e})],K._),t=n.data,i=n.error,a=n.mutate,l=!t,o=(null===t||void 0===t?void 0:t.simulations)||[],u=(0,s.useCallback)((function(e){var n=(0,r.Z)(o).concat([e]);a({simulations:n})}),[o,a]),c=(0,s.useCallback)((function(e){var n=o.filter((function(n){return n.id!==e.id}));a({simulations:n})}),[o,a]),d=(0,s.useCallback)((function(e,n){var t=o.map((function(n){return n.id===e.id&&(n=(0,N.Z)({},n,e)),n}));a({simulations:t},n)}),[o,a]);return[o,{addOneSimulation:u,delOneSimulation:c,mutateOneSimulation:d,errorSimulations:i,loadingSimulations:l}]},useSimulation:function(e,n){var t=(0,q.ZP)("/api/simulation"+(e?"/"+e:""),K._,{refreshInterval:n||0}),i=t.data,a=t.error,r=t.mutate,l=!i,o=(null===i||void 0===i?void 0:i.simulation)||{id:"0"},u=(0,s.useCallback)((function(e){r({simulation:(0,N.Z)({},o,e)})}),[o,r]);return[o,{mutateSimulation:u,errorSimulation:a,loadingSimulation:l}]},add:J,update:$,del:X,run:Q,stop:ee,tasks:ne,log:te},ae=ie,re=function(){var e=(0,i.Z)((function(e,n){var t;return(0,l.__generator)(this,(function(i){switch(i.label){case 0:return t={},[4,(0,K.R)("/api/geometry",(t.method="POST",t.body=JSON.stringify({project:e,geometry:n}),t))];case 1:return[2,i.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),le=function(){var e=(0,i.Z)((function(e,n){var t;return(0,l.__generator)(this,(function(i){switch(i.label){case 0:return t={},[4,(0,K.R)("/api/geometry/"+e.id,(t.method="PUT",t.body=JSON.stringify(n),t))];case 1:return i.sent(),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),oe=function(){var e=(0,i.Z)((function(e){var n;return(0,l.__generator)(this,(function(t){switch(t.label){case 0:return n={},[4,(0,K.R)("/api/geometry/"+e.id,(n.method="DELETE",n))];case 1:return t.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),ue=function(){var e=(0,i.Z)((function(e){return(0,l.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,K.R)("/api/geometry/"+e.id+"/download")];case 1:return[2,n.sent().json()]}}))}));return function(n){return e.apply(this,arguments)}}(),se=function(){var e=(0,i.Z)((function(e){return(0,l.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,K.R)("/api/geometry/"+e.id+"/part")];case 1:return[2,n.sent().json()]}}))}));return function(n){return e.apply(this,arguments)}}(),ce={useGeometries:function(e){var n=(0,q.ZP)(["/api/geometries",JSON.stringify({ids:e})],K._),t=n.data,i=n.error,a=n.mutate,l=!t,o=(null===t||void 0===t?void 0:t.geometries)||[],u=(0,s.useCallback)((function(e){var n=(0,r.Z)(o).concat([e]);a({geometries:n})}),[o,a]),c=(0,s.useCallback)((function(e){var n=o.filter((function(n){return n.id!==e.id}));a({geometries:n})}),[o,a]),d=(0,s.useCallback)((function(e){var n=o.map((function(n){return n.id===e.id&&(n=(0,N.Z)({},n,e)),n}));a({geometries:n})}),[o,a]);return[o,{addOneGeometry:u,delOneGeometry:c,mutateOneGeometry:d,errorGeometries:i,loadingGeometries:l}]},add:re,update:le,del:oe,download:ue,getPart:se},de=ce,me=t(97937),fe=function(e){var n=e.visible,t=e.title,i=e.children,a=e.onClose;return(0,o.jsx)(P.Z,{className:"panel",bodyStyle:{maxHeight:"calc(100vh - 65px)",overflow:"auto",padding:0},title:t,extra:(0,o.jsx)(f.Z,{type:"text",icon:(0,o.jsx)(me.Z,{}),onClick:function(){return a()}}),style:{display:n?"block":"none"},children:i})},he=t(42473),ve=t(78116),pe=t(32834),ye=t(48764).lW,be="Unable to add geometry",ge=function(e){return e.name.toLowerCase().includes(".stp")||e.name.toLowerCase().includes(".step")||e.name.toLowerCase().includes(".dxf")},xe=function(){var e=(0,i.Z)((function(e){var n;return(0,l.__generator)(this,(function(t){return n=new FileReader,[2,new Promise((function(t){n.addEventListener("load",(function(){t(n.result)})),n.readAsArrayBuffer(e)}))]}))}));return function(n){return e.apply(this,arguments)}}(),je=function(){var e=(0,i.Z)((function(e,n,t){var i,a,o,u,s,c;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return"uploading"===n.file.status?[2,!0]:"done"!==n.file.status?[3,5]:[4,xe(n.file.originFileObj)];case 1:i=l.sent(),l.label=2;case 2:return l.trys.push([2,4,,5]),o={},u={},[4,de.add((o.id=e.id,o),(u.name=n.file.name,u.uid=n.file.uid,u.buffer=ye.from(i),u))];case 3:return a=l.sent(),t.addOneGeometry(a),s={},t.mutateProject((s.id=e.id,s.geometries=(0,r.Z)(e.geometries).concat([a.id]),s)),[3,5];case 4:throw c=l.sent(),(0,w.lt)(be,c),c;case 5:return[2,!1]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Ze=function(e){var n=e.visible,t=e.project,a=e.swr,r=e.setVisible,u=(0,s.useState)(!1),c=u[0],d=u[1];return(0,o.jsx)(pe.ZP,{title:"Upload geometry",visible:n,onCancel:function(){return r(!1)},cancelButtonProps:{loading:c},children:(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,o.jsx)(ve.Z,{className:"upload",action:"/api/noop",accept:".stp,.step,.dxf",showUploadList:!1,listType:"picture-card",beforeUpload:ge,onChange:function(){var e=(0,i.Z)((function(e){var n;return(0,l.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,je(t,e,a)];case 1:return n=i.sent(),d(n),r(n),[3,3];case 2:return i.sent(),d(!1),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:(0,o.jsx)("div",{children:c?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g.Z,{style:{fontSize:25}}),(0,o.jsxs)("div",{style:{marginTop:8},children:[(0,o.jsx)("b",{children:"Loading"}),", converting, ..."]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(x.Z,{style:{fontSize:25}}),(0,o.jsxs)("div",{style:{marginTop:8},children:[(0,o.jsx)("b",{children:"Choose a file"})," or drop it here"]})]})})}),(0,o.jsx)(m.Z.Text,{children:(0,o.jsx)("p",{style:{color:"rgba(0, 0, 0, 0.45)",textAlign:"center"},children:"Native file format preferred: STEP (3D) or DXF (2D) file"})})]})})},we=t(81579),Se=t(69677),Pe=function(e){var n=e.visible,t=e.geometry,a=e.setVisible,r=e.onEdit,u=(0,s.useState)(!1),c=u[0],d=u[1];return(0,o.jsx)(pe.ZP,{title:"Edit the geometry's name",visible:n,initialValues:{name:t.name},onCancel:function(){return a(!1)},onOk:function(){var e=(0,i.Z)((function(e){var n;return(0,l.__generator)(this,(function(t){switch(t.label){case 0:d(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r(e)];case 2:return t.sent(),d(!1),a(!1),[3,4];case 3:throw n=t.sent(),d(!1),n;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),loading:c,children:(0,o.jsx)(we.Z.Item,{name:"name",label:"Name:",rules:[{required:!0,message:"Name is required"}],children:(0,o.jsx)(Se.Z,{})})})},Ce=t(48764).lW,ke="Unable to download geometry",Ee="Unable to update geometry",_e="Unable to delete geometry",Ne=function(){var e=(0,i.Z)((function(e){var n,t,i,a,r,o;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),t={},[4,de.download((t.id=e.id,t))];case 1:return n=l.sent(),i=new File([Ce.from(n.buffer).toString()],e.name+"."+n.extension),a=window.URL.createObjectURL(i),(r=document.createElement("a")).href=a,r.setAttribute("download",e.name+"."+n.extension),r.click(),r.remove(),[3,3];case 2:return o=l.sent(),(0,w.lt)(ke,o),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Me=function(){var e=(0,i.Z)((function(e,n,t){var i,a,r;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),i={},a={},[4,de.update((i.id=e.id,i),[(a.key="name",a.value=n.name,a)])];case 1:return l.sent(),e.name=n.name,t.mutateOneGeometry(e),[3,3];case 2:throw r=l.sent(),(0,w.lt)(Ee,r),r;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Oe=function(){var e=(0,i.Z)((function(e,n,t,i){var a,r,o,u;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),a={},[4,de.del((a.id=e.id,a))];case 1:return l.sent(),r=n.geometries.filter((function(n){return n!==e.id})),o={},i.mutateProject((o.id=n.id,o.geometries=r,o)),i.delOneGeometry(e),t(),[3,3];case 2:throw u=l.sent(),(0,w.lt)(_e,u),u;case 3:return[2]}}))}));return function(n,t,i,a){return e.apply(this,arguments)}}(),Te=function(e){var n,t,a,r,u,d,f=e.project,h=e.geometry,v=e.swr,p=e.close,y=e.onCleanup,b=(0,s.useState)(!1),g=b[0],x=b[1],j=(0,s.useState)(!1),w=j[0],k=j[1],E=(0,s.useState)(!1),_=E[0],N=E[1];return h?(0,o.jsx)(c.Z,{children:(0,o.jsx)(c.Z.Content,{children:(0,o.jsx)(P.Z,{size:"small",title:"Informations",actions:[(0,o.jsx)(Z.o6,{loading:g,onDownload:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:x(!0),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,Ne(h)];case 2:return e.sent(),[3,5];case 3:return e.sent(),[3,5];case 4:return x(!1),[7];case 5:return[2]}}))}))},"download"),(0,o.jsxs)("div",{children:[(0,o.jsx)(Pe,{visible:w,geometry:{id:null===h||void 0===h?void 0:h.id,name:null===h||void 0===h?void 0:h.name},setVisible:k,onEdit:function(){var e=(0,i.Z)((function(e){return(0,l.__generator)(this,(function(n){return[2,Me(h,e,v)]}))}));return function(n){return e.apply(this,arguments)}}()}),(0,o.jsx)(Z.w6,{onEdit:function(){return k(!0)}})]},"edit"),(0,o.jsx)(Z.m1,{loading:_,text:(0,o.jsxs)(o.Fragment,{children:["Are you sure you want to delete the geometry"," ",(0,o.jsx)(m.Z.Text,{strong:!0,children:h.name}),"?"]}),onDelete:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:N(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Oe(h,f,p,v)];case 2:return e.sent(),y(),[3,4];case 3:return N(!1),[7];case 4:return[2]}}))}))},"delete")],children:(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)("span",{className:"text-light",children:"File:"})," ",h.name," "]}),(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)("span",{className:"text-light",children:"Unit:"})," ",(0,o.jsx)(he.Z.Inline,{text:"m"})]}),(0,o.jsxs)(o.Fragment,{children:[3===h.summary.dimension&&(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)("span",{className:"text-light",children:"Number of solids:"})," ",null!==(r=null===(n=h.summary.solids)||void 0===n?void 0:n.length)&&void 0!==r?r:0]}),(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)("span",{className:"text-light",children:"Number of faces:"})," ",null!==(u=null===(t=h.summary.faces)||void 0===t?void 0:t.length)&&void 0!==u?u:0]}),2===h.summary.dimension&&(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)("span",{className:"text-light",children:"Number of edges:"})," ",null!==(d=null===(a=h.summary.edges)||void 0===a?void 0:a.length)&&void 0!==d?d:0]})]})]})})})}):(0,o.jsx)(S.Z.Simple,{})};Te.Add=Ze;var De,Ue,ze,Fe=Te,Re=function(){var e=(0,i.Z)((function(e,n){var t;return(0,l.__generator)(this,(function(i){switch(i.label){case 0:return t={},[4,(0,K.R)("/api/result",(t.method="POST",t.headers={Accept:"application/json"},t.body=JSON.stringify({simulation:e,result:n}),t))];case 1:return[2,i.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),Ae=function(){var e=(0,i.Z)((function(e,n){var t;return(0,l.__generator)(this,(function(i){return t={},[2,(0,K.R)("/api/result/download",(t.method="POST",t.body=JSON.stringify({simulation:e,result:n}),t))]}))}));return function(n,t){return e.apply(this,arguments)}}(),Le=function(){var e=(0,i.Z)((function(e){var n;return(0,l.__generator)(this,(function(t){return n={},[2,(0,K.R)("/api/result/archive",(n.method="POST",n.body=JSON.stringify({simulation:e}),n))]}))}));return function(n){return e.apply(this,arguments)}}(),Ve={load:Re,download:Ae,archive:Le},Ge=Ve,Ie=t(84908),Be=t(13013),He=t(27049),Ye=t(94594),We=t(11382),qe=t(41428),Ke=t(38095),Je=t(86350),$e=t(15668),Xe=t(74317),Qe=t(35598),en=t(49591),nn=t(19478),tn=t(87784),an=t(90420),rn=t(75843),ln=t(99477),on=t(57632),un=t(79753),sn=t(54458),cn=t(58939),dn=t(24065),mn=t(54327),fn=function(e){var n=new ln.fHI(.025,.025,.8,50);n.translate(0,.4,0);var t=new ln.vBJ({color:e}),i=new ln.Kj0(n,t),a=new ln.b_z(.05,.2,50);a.translate(0,.9,0);var r=new ln.vBJ({color:e}),l=new ln.Kj0(a,r),o=new ln.ZAu;o.type="ArrowHelper",o.add(i),o.add(l);return o.dispose=function(){n.dispose(),t.dispose(),a.dispose(),r.dispose()},o},hn=function(e,n,t){var i=document.createElement("canvas");i.width=(null===t||void 0===t?void 0:t.width)||256,i.height=256;var a=i.getContext("2d");a.fillStyle="grey",a.font="50px sans-serif",a.textAlign=(null===t||void 0===t?void 0:t.align)||"center",a.textBaseline="middle",a.fillText(n,i.width/2,i.height/2);var r=new ln.xEZ(i);r.flipY=!0,r.needsUpdate=!0;var l=new ln.xeV({map:r,transparent:!0,depthWrite:!1});l.map.anisotropy=e.capabilities.getMaxAnisotropy();var o=new ln.jyi(l);o.type="LabelHelper",(null===t||void 0===t?void 0:t.position)&&o.position.copy(t.position),(null===t||void 0===t?void 0:t.scale)&&o.scale.setScalar(t.scale);return o.dispose=function(){r.dispose(),l.dispose()},o},vn=function(e){return Math.abs(e)<1e-12?"0":Math.abs(e)>1e3||Math.abs(e)<.001?e.toExponential(2):e.toFixed(3)},pn=function(e,n,t,i){var a,r,l,o=function(e,n,t,i,a){for(var r=new ln.ZAu,l=new ln.nls({color:8947848}),o=new ln.Pa4(-e/2,0,-n/2),u=e/(t-1),s=n/(i-1),c=0;c<i;++c){var d=(new ln.u9r).setFromPoints([new ln.Pa4(o.x,0,o.z+c*s),new ln.Pa4(o.x+e,0,o.z+c*s)]);r.add(new ln.x12(d,l))}for(var m=0;m<t;++m){var f=(new ln.u9r).setFromPoints([new ln.Pa4(o.x+m*u,0,o.z),new ln.Pa4(o.x+m*u,0,o.z+n)]);r.add(new ln.x12(f,l))}return null===a||void 0===a||a(r),r},u=function(n,t,i,a){for(var r=new ln.ZAu,l=Math.abs(t-n),o=l/(a-1),u=(new ln.Pa4).copy(i).multiplyScalar(-l/2),s=(new ln.Pa4).copy(i).multiplyScalar(o),c=n,d=0;d<a;++d){var m=hn(e,vn(c));m.position.copy(u),r.add(m),u.add(s),c+=o}return r},s=function(){var e=n.boundingBox,t=n.boundingSphere.center,i=new ln.Pa4(e.max.x-e.min.x,e.max.y-e.min.y,e.max.z-e.min.z),l=function(e){var n=Math.max(e.x,e.y,e.z),t=Math.max(Math.ceil(e.x/n*5),2),i=Math.max(Math.ceil(e.y/n*5),2),a=Math.max(Math.ceil(e.z/n*5),2);return new ln.Pa4(t,i,a)}(i);a=.1*Math.max(i.x,i.y,i.z),r=1*a;var s=new ln.ZAu,c=o(i.x,i.z,l.x,l.z),d=o(i.x,i.y,l.x,l.y,(function(e){e.rotateX(Math.PI/2)})),f=o(i.y,i.z,l.y,l.z,(function(e){e.rotateZ(-Math.PI/2)}));s.add(c,d,f);var h=u(e.min.x,e.max.x,new ln.Pa4(1,0,0),l.x),v=u(e.min.y,e.max.y,new ln.Pa4(0,1,0),l.y),p=u(e.min.z,e.max.z,new ln.Pa4(0,0,1),l.z);return s.add(h,v,p),s.position.set(t.x,t.y,t.z),s.type="GridHelper",s.dispose=m,s},c=function(e){return e<=0?-1:1},d=function(e){return Math.abs(e)<=.5?1:-1},m=function(){null===l||void 0===l||l.children.forEach((function(e){e.children.forEach((function(e){if("Line"===e.type){var n=e;n.geometry.dispose(),n.material.dispose()}else{e.dispose()}}))}))};return{dispose:m,setVisible:function(e){l.visible=e},update:function(){var e=n.boundingBox,o=new ln.Pa4(e.max.x-e.min.x,e.max.y-e.min.y,e.max.z-e.min.z),u=!1;n.children.forEach((function(e){if("GridHelper"===e.type){var t=e;u=t.visible,n.remove(t),t.dispose()}})),l=s();var m=i.object.position.distanceTo(i.target);l.traverse((function(e){"LabelHelper"===e.type&&e.scale.setScalar(.05*m)}));var f=new ln.Pa4;t.getWorldDirection(f);var h=m/10/(i.minDistance+.001),v=l.children[0],p=l.children[1],y=l.children[2];v.position.set(0,c(f.y)*(o.y/2+a),0),p.position.set(0,0,c(f.z)*(o.z/2+a)),y.position.set(c(f.x)*(o.x/2+a),0,0);var b=l.children[3],g=l.children[4],x=l.children[5];b.position.set(0,c(f.y)*d(f.y)*(o.y/2+r),c(f.z)*d(f.y)*-(o.z/2+r)),g.position.set(c(f.x)*d(f.x)*(o.x/2+r),0,c(f.z)*d(f.x)*-(o.z/2+r)),x.position.set(c(f.x)*d(f.x)*(o.x/2+r),c(f.y)*d(f.x)*-(o.y/2+r),0);var j=.2*h,Z=.3*h;b.visible=Math.abs(f.y)>j||Math.abs(f.z)>Z,g.visible=Math.abs(f.x)>Z||Math.abs(f.z)>Z,x.visible=Math.abs(f.x)>Z||Math.abs(f.y)>j,l.visible=u,n.add(l)}}},yn=t(51438),bn=t(28668),gn=t(91224),xn=function(e,n,t,i){var a,r,l,o=new ln.Ilk("#fad114"),u=new ln.Ilk("#E98A15"),s=new ln.Pa4(-1,0,0),c=new ln.JOQ(s),d={up:new ln.Pa4,forward:new ln.Pa4,right:new ln.Pa4},m=new ln.Pa4,f=new ln.Pa4,h=new ln.USm,v=new ln.Pa4,p=new ln.FM8,y=new ln.JOQ,b=new ln.Pa4,g=new ln.Pa4,x=new ln.Zzh,j={up:new ln.Pa4,forward:new ln.Pa4,right:new ln.Pa4},Z=new ln.iMs,w=s,S=new ln.ZAu;S.type="SectionViewHelper",S.visible=!1,n.add(S);!function(){var e=new ln._12(1,1),n=new ln.vBJ({color:o,side:ln.ehD,transparent:!0,opacity:.5}),t=new ln.Kj0(e,n);t.type="Plane",S.add(t)}();!function(){var e=new ln.xo$(.2,32,32,Math.PI,-Math.PI),n=new ln.vBJ({color:o,side:ln.ehD,transparent:!0,opacity:.5}),t=new ln.Kj0(e,n);t.type="Dome",S.add(t)}();!function(){var e=new(function(e){(0,bn.Z)(t,e);var n=(0,gn.Z)(t);function t(e){var i;return(0,yn.Z)(this,t),(i=n.call(this)).radius=e,i}return t.prototype.getPoint=function(e){return(new ln.Pa4).set(this.radius*Math.cos(Math.PI*e),this.radius*Math.sin(Math.PI*e),0)},t}(ln.Hyl))(.2),n=new ln.WXh(e,32,.2*.1,32),t=new ln.vBJ({color:o,side:ln.ehD,transparent:!0,opacity:.5}),i=new ln.Kj0(n,t);i.rotateX(Math.PI/2),i.type="ArcX",S.add(i);var a=new ln.WXh(e,32,.2*.1,32),r=new ln.vBJ({color:o,side:ln.ehD,transparent:!0,opacity:.5}),l=new ln.Kj0(a,r);l.rotateX(Math.PI/2),l.rotateY(Math.PI/2),l.type="ArcY",S.add(l)}();var P=function(){var e=new ln.Pa4;n.boundingBox.getCenter(e),S.position.copy(e)},C=function(){S.rotateX(Math.PI);var e=c.normal.multiplyScalar(-1);c.setFromNormalAndCoplanarPoint(e,S.position)},k=function(e){var n=e.target.getBoundingClientRect(),t=e.clientX-n.left,i=e.clientY-n.top,a=new ln.FM8;return a.x=t/n.width*2-1,a.y=-i/n.height*2+1,a},E=function(e){a&&a.material.color.set(o),a=e,e&&e.material.color.set(u)},_=function(e){if(S.visible){var n=k(e);if(Z.setFromCamera(n,t),r){var a=new ln.Pa4;Z.ray.intersectPlane(y,a),"Plane"===(null===l||void 0===l?void 0:l.type)?N(a):"Dome"===(null===l||void 0===l?void 0:l.type)?M(n):T(a),function(){var e=new ln.Pa4(0,0,1).applyQuaternion(S.quaternion).multiplyScalar(-1);c.setFromNormalAndCoplanarPoint(e,S.position)}()}else{var o=Z.intersectObject(S);o.length?(i.enabled=!1,l=o[0].object,E(l),f.copy(o[0].point),t.getWorldDirection(d.forward),d.forward.normalize(),d.up.copy(t.up).normalize(),d.right.crossVectors(d.up,d.forward).normalize()):(l=null,E(),i.enabled=!0)}}},N=function(e){e.sub(b);var n=new ln.Pa4;x.closestPointToPoint(e,!1,n),S.position.copy(n)},M=function(e){S.rotation.copy(h),S.rotateOnWorldAxis(d.up,5*-(p.x-e.x)),S.rotateOnWorldAxis(d.right,5*-(p.y-e.y))},O=function(){l.getWorldDirection(v),h.copy(S.rotation),b.copy(f).sub(S.position),g.copy(b).normalize(),j.up.copy(g),j.right.copy(v),j.forward.crossVectors(j.right,j.up),x.set(f,(new ln.Pa4).copy(f).add(j.forward)),y.setFromNormalAndCoplanarPoint(d.forward,f)},T=function(e){var n=i.object.position.distanceTo(i.target),t=new ln.Pa4;x.closestPointToPoint(e,!1,t);var a=f.distanceTo(t);t.sub(f);var r=(new ln.Pa4).copy(g).cross(t).normalize(),l=Math.sign(v.dot(r))*a*1/(n/100);S.rotation.copy(h),S.rotateOnWorldAxis(v,l)},D=function(e){switch(null===l||void 0===l?void 0:l.type){case"Plane":!function(){y.setFromNormalAndCoplanarPoint(d.forward,f),m.copy(S.position);var e=new ln.Pa4;Z.ray.intersectPlane(y,e),b.copy(e).sub(m),g.copy(b).normalize(),x.set(m,(new ln.Pa4).copy(m).add(c.normal))}();break;case"Dome":!function(e){h.copy(S.rotation),p.copy(e)}(e);break;case"ArcX":case"ArcY":O()}},U=function(e){if(S.visible&&l){r=!0;var n=k(e);D(n)}},z=function(){S.visible&&(r=!1,E())};return e.domElement.addEventListener("pointermove",_),e.domElement.addEventListener("pointerdown",U),e.domElement.addEventListener("pointerup",z),{getClippingPlane:function(){return c},toggleVisible:function(){var e=S.visible;S.visible=!e},start:function(){e.localClippingEnabled=!0,S.visible=!0,function(){var e=new ln.Pa4;n.boundingBox.getSize(e),e.multiplyScalar(1.2);var t=Math.max(Math.max(e.x,e.y),e.z);S.scale.setScalar(t)}(),P();var t=(new ln.Pa4).copy(S.position).sub(s);S.lookAt(t),c.setFromNormalAndCoplanarPoint(s,S.position)},stop:function(){e.localClippingEnabled=!1,S.visible=!1},toAxis:function(e){if(P(),w.equals(e))C();else{var n=(new ln.Pa4).copy(S.position).sub(e);S.lookAt(n),c.setFromNormalAndCoplanarPoint(e,S.position),w.copy(e)}},flip:C,dispose:function(){S.traverse((function(e){if("Plane"===e.type||"Dome"===e.type||"ArcX"===e.type||"ArcY"===e.type){var n=e;n.geometry.dispose(),n.material.dispose()}})),e.domElement.removeEventListener("pointermove",_),e.domElement.removeEventListener("pointerdown",U),e.domElement.removeEventListener("pointerup",z)}}},jn=t(54104),Zn=function(e){var n,t=new ln.xsS,i=new ln.iKG(-1,1,1,-1,2,1);i.position.set(0,0,1);var a=function(n){var i=vn(n.minV),a=vn(n.maxV),r=hn(e,String(i),{position:new ln.Pa4(-.62,0,0),width:512,align:"right"});r.scale.x=.4,r.scale.y=2.8;var l=hn(e,String(a),{position:new ln.Pa4(.62,0,0),width:512,align:"left"});l.scale.x=.4,l.scale.y=2.8,t.add(r),t.add(l)};return{render:function(){var n=e.domElement.getBoundingClientRect();e.setViewport(n.width/2-350,n.height-50,700,50),e.render(t,i)},setLUT:function(e){t.children.forEach((function(e){return e.dispose()})),t.clear();var i=new jn.A("rainbow",e.n);i.setMin(e.minV),i.setMax(e.maxV);var r=new ln.ROQ(i.createCanvas()),l=new ln.xeV({map:r});(n=new ln.jyi(l)).material.rotation=-Math.PI/2,n.scale.x=.2,n.scale.y=1.2,n.dispose=n.material.dispose,t.add(n),a(i)},setVisible:function(e){t.children.forEach((function(n){n.visible=e}))}}},wn=function(e){var n=new ln.ZAu;n.type="PointHelper",n.visible=!1,e.add(n);var t=function(e,n){var t=(new ln.u9r).setFromPoints([e,n]),i=new ln.nls({color:16711680});return new ln.x12(t,i)},i=function(){n.children.forEach((function(e){n.remove(e);var t=e;t.geometry.dispose(),t.material.dispose()}))};return{build:function(){var a;i();var l=function(){var n,t,i=(null!==(t=null===(n=e.boundingSphere)||void 0===n?void 0:n.radius)&&void 0!==t?t:1)/100,a=new ln.xo$(i),r=new ln.Wid({color:16711680});return new ln.Kj0(a,r)}(),o=function(){var n=[],i=e.boundingBox.max.x-e.boundingBox.min.x,a=e.boundingBox.max.y-e.boundingBox.min.y,r=e.boundingBox.max.z-e.boundingBox.min.z,l=Math.max(i,a,r),o=t(new ln.Pa4(-l/2,0,0),new ln.Pa4(l/2,0,0));n.push(o);var u=t(new ln.Pa4(0,-l/2,0),new ln.Pa4(0,l/2,0));n.push(u);var s=t(new ln.Pa4(0,0,-l/2),new ln.Pa4(0,0,l/2));return n.push(s),n}();n.add(l),(a=n).add.apply(a,(0,r.Z)(o))},dispose:i,update:function(e){e?(n.position.set(e.x,e.y,e.z),n.visible=!0):n.visible=!1}}},Sn=t(1217),Pn=t(82854),Cn=t(6648),kn=t(48764).lW,En=function(e,n){var t=new ln.Ilk("#FAD114"),a=new ln.Ilk("#EE9817"),o=function(){var e=(0,i.Z)((function(e,n,t){var i,a,r,o,d,m,f,h;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return i=new Blob([kn.from(e.buffer)]),a=URL.createObjectURL(i),r=new Sn.E,(o=new Pn._).setDecoderPath("/three/libs/draco/"),r.setDRACOLoader(o),(d=new Cn.a).setTranscoderPath("node_modules/three//examples/js/libs/basis/"),r.setKTX2Loader(d),[4,new Promise((function(e,n){r.load(a,(function(n){e(n)}),(function(){}),(function(e){return n(e)}))}))];case 1:return m=l.sent(),f=m.scene,(h=new ln.Tme).type="Part",h.uuid=e.summary.uuid,h.children=f.children,h.userData=f.userData,"mesh"===e.summary.type?h.traverse((function(e){if("Mesh"===e.type){var n=e,i=new ln.Uk6(n.geometry),a=new ln.nls({color:n.material.color,linewidth:1}),r=new ln.ejS(i,a);n.add(r),n.material.visible=!1,n.material.clippingPlanes=[t]}})):"result"===e.summary.type?h.traverse((function(e){if("Mesh"===e.type||"Line"===e.type){var n=e,i=n.geometry.getAttribute("data");if(i){var a=i.array.reduce((function(e,n){return Math.min(e,n)}),i.array[0]),r=i.array.reduce((function(e,n){return Math.max(e,n)}),i.array[0]);a===r&&(a-=1,r+=1);var l=new jn.A;l.setMin(a),l.setMax(r);for(var o=new Float32Array(3*i.count),u=0;u<i.count;u++){var s=l.getColor(i.array[u]);o[3*u+0]=s.r,o[3*u+1]=s.g,o[3*u+2]=s.b}n.geometry.setAttribute("color",new ln.a$l(o,3)),n.userData=(0,M.Z)((0,N.Z)({},n.userData),{lut:l})}if("Mesh"===e.type){var c=new ln.Uk6(n.geometry),d=new ln.nls({linewidth:1}),m=new ln.ejS(c,d);n.add(m)}n.material.vertexColors=!0,n.material.clippingPlanes=[t]}})):"geometry3D"!==e.summary.type&&"geometry2D"!==e.summary.type||h.traverse((function(e){if("Mesh"===e.type){var n=e;n.material.clippingPlanes=[t],n.material.originalColor=n.material.color}})),c(h,n),h.boundingBox=u(h),h.dispose=function(){return s(h)},h.setTransparent=function(e){return c(h,e)},h.startSelection=function(e,n,t,i){return g(h,e,n,t,i)},h.stopSelection=function(){return x()},h.getHighlighted=function(){return y},h.getSelected=function(){return b},h.highlight=P,h.unhighlight=C,h.select=E,h.unselect=_,[2,h]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),u=function(e){var n=new ln.ZzF;return e.traverse((function(e){n.expandByObject(e)})),n},s=function(e){e.traverse((function(e){if("Mesh"===e.type){var n=e;n.geometry.dispose(),n.material.dispose()}}))},c=function(e,n){e.traverse((function(e){if("Mesh"===e.type){var t=e;t.material.transparent=n,t.material.opacity=n?.5:1,t.material.depthWrite=!n}}))},d=new ln.iMs,m=null,f=null,h=null,v=null,p=null,y=null,b=[],g=function(e,n,t,i,a){m=e,f=a,h=n,v=t,(p=i).selectedObjects=[],y=null,b.length=0,h.domElement.addEventListener("pointermove",Z),h.domElement.addEventListener("pointerdown",k)},x=function(){h&&h.domElement.removeEventListener("pointermove",Z),h&&h.domElement.removeEventListener("pointerdown",k),C(),y=null,b.forEach((function(e){_(e.uuid)})),b.length=0,f=null,m=null,h=null,v=null,p=null},j=function(e,n){var t;if(e&&n)return e.traverse((function(e){e.userData.uuid===n&&(t=e)})),t},Z=function(n){var t=function(e){var n=e.target.getBoundingClientRect(),t=e.clientX-n.left,i=e.clientY-n.top,a=new ln.FM8;return a.x=t/n.width*2-1,a.y=-i/n.height*2+1,a}(n);d.setFromCamera(t,v);var i,a=m.userData;switch(f){case"solids":if((i=d.intersectObject(m,!0)).length){var r=i[0].object.parent;r&&e(m,r.userData.uuid,r.userData.label)}else e(m);break;case"faces":if(2===a.dimension)if((i=d.intersectObject(m,!0)).length){var l=i[0].object,o=l.parent;"Mesh"===(null===o||void 0===o?void 0:o.type)?e(m,o.userData.uuid,o.userData.label):e(m,l.userData.uuid,l.userData.label)}else e(m);else if((i=d.intersectObject(m,!0)).length){var u=i[0].object;e(m,u.userData.uuid,u.userData.label)}else e(m);break;case"edges":var s=a.edges;if((i=d.intersectObject(m,!0)).length){var c=i[0].object;(null===s||void 0===s?void 0:s.find((function(e){return e.uuid===c.userData.uuid})))?e(m,c.userData.uuid,c.userData.label):e(m)}else e(m);break;case"point":if((i=d.intersectObject(m,!0)).length){var h=i[0];e(m,void 0,void 0,h.point)}else e(m)}},w=function(e,n){n?p.selectedObjects.find((function(n){return n.userData.uuid===e.userData.uuid}))||p.selectedObjects.push(e):b.find((function(n){return n.uuid===e.userData.uuid}))||p.selectedObjects.push(e)},S=function(e,n){if(n){var t=p.selectedObjects.findIndex((function(n){return n.userData.uuid===e.userData.uuid}));p.selectedObjects=(0,r.Z)(p.selectedObjects.slice(0,t)).concat((0,r.Z)(p.selectedObjects.slice(t+1)))}else{if(!b.find((function(n){return n.uuid===e.userData.uuid}))){var i=p.selectedObjects.findIndex((function(n){return n.userData.uuid===e.userData.uuid}));p.selectedObjects=(0,r.Z)(p.selectedObjects.slice(0,i)).concat((0,r.Z)(p.selectedObjects.slice(i+1)))}}},P=function(e){if(e!==(null===y||void 0===y?void 0:y.uuid)){C();var n=j(m,e);if(n)if(y={uuid:n.userData.uuid,label:n.userData.label},w(n),"Mesh"===n.type)n.material.color=t;else n.traverse((function(e){"Mesh"===e.type&&(e.material.color=t)}))}},C=function(){var e=j(m,null===y||void 0===y?void 0:y.uuid);if(e){S(e);var n=b.findIndex((function(n){return n.uuid===e.userData.uuid}));if("Mesh"===e.type){var t=e;t.material.color=-1===n?t.material.originalColor:a}else{e.traverse((function(e){if("Mesh"===e.type){var t=e;t.material.color=-1===n?t.material.originalColor:a}}))}}y=null},k=function(){y&&n(m,y.uuid,y.label)},E=function(e){var n=j(m,e);n&&(b.push({uuid:e,label:n.userData.label}),w(n,!0),"Mesh"===n.type?n.material.color=a:n.traverse((function(e){"Mesh"===e.type&&(e.material.color=a)})))},_=function(e){var n=j(m,e),t=b.findIndex((function(n){return n.uuid===e}));if(-1!==t&&(b=(0,r.Z)(b.slice(0,t)).concat((0,r.Z)(b.slice(t+1)))),n){if(S(n,!0),"Mesh"===n.type){var i=n;i.material.color=i.material.originalColor}else{n.traverse((function(e){if("Mesh"===e.type){var n=e;n.material.color=n.material.originalColor}}))}n.visible=!0}};return{load:o}},_n=function(){return{type:T}},Nn=function(){return{type:D}},Mn=function(e){return{type:z,value:e}},On=function(e){var n=e.uuid,t=e.label;return{type:R,value:{uuid:n,label:t}}},Tn=function(){return{type:A}},Dn=function(e){var n=e.uuid,t=e.label;return{type:L,value:{uuid:n,label:t}}},Un=function(e){var n=e.uuid,t=e.label;return{type:V,value:{uuid:n,label:t}}},zn=function(e){return{type:G,value:e}},Fn=t(41686),Rn="Load part error",An="Snapshot error",Ln="Unable to save screenshot",Vn=function(e){var n=new ln.ZzF;e.children.forEach((function(e){if(e.visible&&"Part"===e.type){var t=e.boundingBox,i=new ln.Pa4(Math.min(n.min.x,t.min.x),Math.min(n.min.y,t.min.y),Math.min(n.min.z,t.min.z)),a=new ln.Pa4(Math.max(n.max.x,t.max.x),Math.max(n.max.y,t.max.y),Math.max(n.max.z,t.max.z));n.set(i,a)}}));var t=new ln.aLr;n.getBoundingSphere(t),e.boundingBox=n,e.boundingSphere=t},Gn=function(e,n,t){var i=n.object.position.distanceTo(n.target)*t*.01,a=n.target.clone().sub(e.position).normalize().multiplyScalar(i);e.position.add(a)},In=void 0,Bn=function(e,n){Gn(e,n,1);In=requestAnimationFrame((function(){return Bn(e,n)}))},Hn=function(e,n){Gn(e,n,-1);In=requestAnimationFrame((function(){return Hn(e,n)}))},Yn=function(){In&&cancelAnimationFrame(In),In=void 0},Wn=function(e,n,t){var i=e.boundingSphere,a=i.center,r=2*i.radius/(2*Math.atan(Math.PI*n.fov/360)),l=r/n.aspect,o=1.1*Math.max(r,l),u=t.target.clone().sub(n.position).normalize().multiplyScalar(o);t.target.copy(a),t.minDistance=o/10,t.maxDistance=10*o,n.position.copy(a).sub(u),n.near=o/100,n.far=100*o,n.updateProjectionMatrix()},qn=function(){var e=(0,i.Z)((function(e,n,t,i,a,r,o){var u;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return[4,En((function(e,n,t,i){n?(e.highlight(n),setTimeout((function(){return o(On({uuid:n,label:t}))}),1)):i?o(zn({x:i.x,y:i.y,z:i.z})):(e.unhighlight(),setTimeout((function(){return o(Tn())}),1))}),(function(e,n,t){e.getSelected().find((function(e){return e.uuid===n}))?(e.unselect(n),setTimeout((function(){return o(Un({uuid:n,label:t}))}),1)):(e.select(n),setTimeout((function(){return o(Dn({uuid:n,label:t}))}),1))})).load(e,n,r.sectionViewHelper.getClippingPlane())];case 1:return u=l.sent(),o(function(e){return{type:F,value:e}}(u)),t.add(u),Vn(t),Wn(t,i,a),r.gridHelper.update(),r.gridHelper.update(),r.gridHelper.setVisible(!0),u.children[0].userData.lut?(r.colorbarHelper.setLUT(u.children[0].userData.lut),r.colorbarHelper.setVisible(!0)):r.colorbarHelper.setVisible(!1),r.pointHelper.build(),[2]}}))}));return function(n,t,i,a,r,l,o){return e.apply(this,arguments)}}(),Kn=function(){var e=(0,i.Z)((function(e,n,t,i){var a,r,o,u,s,c,d;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),a=i.domElement.width,r=i.domElement.height,o=t.aspect,520,312,i.domElement.width=520,i.domElement.height=312,t.aspect=520/312,t.updateProjectionMatrix(),i.clear(),i.setViewport(0,0,520,312),i.render(n,t),u=i.domElement.toDataURL(),i.domElement.width=a,i.domElement.height=r,t.aspect=o,t.updateProjectionMatrix(),s={},c={},[4,Fn.Z.add((s.name="snapshot",s.uid="snapshot_"+(0,on.Z)(),s.data=u,s),(c.id=e.id,c))];case 1:return l.sent(),[3,3];case 2:return d=l.sent(),(0,w.lt)(An,d),[3,3];case 3:return[2]}}))}));return function(n,t,i,a){return e.apply(this,arguments)}}(),Jn=function(e){var n=e.loading,t=e.project,a=e.part,r=(0,s.useRef)(null),m=(0,s.useRef)(),h=(0,s.useRef)(),v=(0,s.useRef)(),p=(0,s.useRef)(),y=(0,s.useRef)(),b=(0,s.useRef)(),x=(0,s.useRef)(),j=(0,s.useRef)(),Z=(0,s.useRef)(),S=(0,s.useRef)(),P=(0,s.useRef)(),C=(0,s.useState)(!1),k=C[0],E=C[1],_=(0,s.useState)(!1),N=_[0],M=_[1],O=(0,s.useState)(!1),T=O[0],D=O[1],U=(0,s.useState)(!1),z=U[0],F=U[1],R=(0,u.useRouter)(),A=(0,s.useContext)(I),L=A.enabled,V=A.part,G=A.highlighted,B=A.selected,H=A.point,Y=A.type,W=A.dispatch;(0,s.useEffect)((function(){if(mn.Z.isWebGLAvailable()){var e,n=r.current,t=n.clientWidth,i=n.clientHeight;m.current=new ln.xsS,h.current=new ln.cPb(50,t/i,.1,1e3),h.current.position.z=10;var a=new ln.Mig("#aaa",.75);m.current.add(a);var l=new ln.cek("#fff",.5);l.decay=2,h.current.add(l),m.current.add(h.current),v.current=new ln.CP7({antialias:!0,alpha:!0}),v.current.setClearColor("#ffffff"),v.current.setSize(t,i),v.current.setPixelRatio(window.devicePixelRatio||1),v.current.shadowMap.enabled=!0,v.current.autoClear=!1,n.appendChild(v.current.domElement);var o=new sn.C(m.current,h.current);p.current=new cn.f(new ln.FM8(t,i),m.current,h.current),p.current.visibleEdgeColor.set("#FAD114"),p.current.hiddenEdgeColor.set("#FAD114"),y.current=new dn.xC(v.current),y.current.addPass(o),y.current.addPass(p.current),b.current=new un.$(h.current,n),b.current.rotateSpeed=3,b.current.panSpeed=.1;var u=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{offsetWidth:0,offsetHeight:0,width:150,height:150},i=t.offsetWidth,a=t.offsetHeight,r=t.width,l=t.height,o="green",u="blue",s="black",c=i,d=a,m=r,f=l,h=fn("red");h.rotateZ(-Math.PI/2);var v=hn(e,"X",{position:new ln.Pa4(1.1,0,0)}),p=fn(o),y=hn(e,"Y",{position:new ln.Pa4(0,1.1,0)}),b=fn(u);b.rotateX(Math.PI/2);var g=hn(e,"Z",{position:new ln.Pa4(0,0,1.1)}),x=new ln.xo$(.05,50,50),j=new ln.vBJ({color:s}),Z=new ln.Kj0(x,j),w=new ln.ZAu;w.type="AxisHelper",w.add(h),w.add(v),w.add(p),w.add(y),w.add(b),w.add(g),w.add(Z);var S=new ln.xsS;S.add(w);var P=new ln.iKG(-1.2,1.2,1.2,-1.2,-2,2),C=function(e){var n=e.newOffsetWidth,t=e.newOffsetHeight,i=e.newWidth,a=e.newHeight;c=n,d=t,m=i,f=a};return{dispose:function(){x.dispose(),j.dispose(),w.children.forEach((function(e){"ArrowHelper"!==e.type&&"LabelHelper"!==e.type||e.dispose()})),S.remove(w)},render:function(){e.setViewport(c,d,m,f),P.rotation.copy(n.rotation),e.render(S,P)},resize:C}}(v.current,h.current,{offsetWidth:t-155,offsetHeight:i-155,width:150,height:150}),s=function(e,n,t,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{offsetWidth:0,offsetHeight:0,width:150,height:150},r=a.offsetWidth,l=a.offsetHeight,o=a.width,u=a.height,s="#d3d3d3",c="#ffffff",d="#000000",m="#FAD114",f=100,h=.25,v=null,p=null,y=[{text:"FRONT",normal:new ln.Pa4(0,0,1),up:new ln.Pa4(0,1,0)},{text:"BACK",normal:new ln.Pa4(0,0,-1),up:new ln.Pa4(0,1,0)},{text:"RIGHT",normal:new ln.Pa4(1,0,0),up:new ln.Pa4(0,1,0)},{text:"LEFT",normal:new ln.Pa4(-1,0,0),up:new ln.Pa4(0,1,0)},{text:"UP",normal:new ln.Pa4(0,1,0),up:new ln.Pa4(0,0,-1)},{text:"DOWN",normal:new ln.Pa4(0,-1,0),up:new ln.Pa4(0,0,1)}],b=new ln._12(f*(1-h),f*(1-h)),g=new ln.TOt(b),x=new ln.xo$(f*(1-h)/2,10,10,0,Math.PI,0),j=new ln.ZAu;y.forEach((function(e){var n=document.createElement("canvas"),t=n.getContext("2d");n.width=n.height=256,t.fillStyle=s,t.fillRect(0,0,n.width,n.height),t.font="bold 50pt sans-serif",t.fillStyle=d,t.textAlign="center",t.textBaseline="middle",t.fillText(e.text,n.width/2,n.height/2);var i=new ln.ROQ(n);i.needsUpdate=!0;var a=new ln.vBJ({map:i}),r=new ln.vBJ({color:s}),l=new ln.Kj0(b,a),o=new ln.Kj0(b,r);o.rotateY(Math.PI);var u=new ln.nls({color:c}),m=new ln.ejS(g,u),h=new ln.vBJ({color:s,transparent:!0,opacity:.2}),v=new ln.Kj0(x,h),p=new ln.ZAu;p.add(l,o,m,v),p.lookAt(e.normal),p.translateZ(f/2),p.normal=e.normal,p.up=e.up,j.add(p)}));var Z=new ln.Mig("#ffffff",1),w=new ln.xsS;w.add(j),w.add(Z);var S=new ln.iKG(-f,f,f,-f,-f,f);S.position.z=2;var P=new ln.iMs,C=function(e){var n=k(e);E(n)?(v=_(n),N(),(null===v||void 0===v?void 0:v.uuid)!==(null===p||void 0===p?void 0:p.uuid)&&(M(),p=v)):(v=null,M())},k=function(e){var n=e.target.getBoundingClientRect(),t=e.clientX-n.left,i=e.clientY-n.top,a=new ln.FM8;return a.x=(t-r)/o*2-1,a.y=-(i+u-n.height+l)/u*2+1,a},E=function(e){return e.x>-1&&e.x<1&&e.y>-1&&e.y<1},_=function(e){var n=new ln.Pa4(e.x,e.y,-1);n.unproject(S);var t=new ln.Pa4;S.getWorldDirection(t),P.set(n,t);var i=P.intersectObjects(w.children,!0);return i.length?i[0].object.parent:null},N=function(){v&&v.children&&v.children.forEach((function(e){var n=e;n.material&&n.material.color&&(n.material.previousColor=n.material.color,n.material.color=new ln.Ilk(m))}))},M=function(){p&&p.children&&p.children.forEach((function(e){var n=e;n.material&&n.material.color&&(n.material.color=new ln.Ilk(s))}))},O=function(e){if(v){var a=v.normal,r=v.up,l=new ln.Pa4;n.boundingBox&&n.boundingBox.getCenter(l);var o=t.position.distanceTo(i.target),u=a.clone().multiplyScalar(o),s=l.add(u);t.position.copy(s),t.up.copy(r),v=null,M(),C(e)}};e.domElement.addEventListener("pointermove",C),e.domElement.addEventListener("pointerdown",O);var T=function(e){var n=e.newOffsetWidth,t=e.newOffsetHeight,i=e.newWidth,a=e.newHeight;r=n,l=t,o=i,u=a},D=function(){e.domElement.removeEventListener("pointermove",C),e.domElement.removeEventListener("pointerdown",O),j.children.forEach((function(e){e.children.forEach((function(e){var n=e;n.geometry.dispose(),n.material.dispose()}))})),w.remove(j)};return{resize:T,render:function(){e.setViewport(r,l,o,u),S.rotation.copy(t.rotation),e.render(w,S)},dispose:D}}(v.current,m.current,h.current,b.current,{offsetWidth:t-155,offsetHeight:i-155,width:150,height:150});x.current=pn(v.current,m.current,h.current,b.current),j.current=function(e,n,t,i){var a=document.createElement("div");a.style.pointerEvents="none",a.style.border="1px solid #55aaff",a.style.backgroundColor="rgba(75, 160, 255, 0.3)",a.style.position="fixed";var r=new ln.FM8,l=new ln.FM8,o=new ln.FM8,u=new ln.FM8,s=!1,c=!1,d=new ln.iMs,m=function(){s=!1},f=function(e){s&&0===e.button&&(c=!0,p(e))},h=function(e){s&&c&&y(e)},v=function(e){c=!1,s&&b(e)};e.domElement.addEventListener("pointerdown",f),e.domElement.addEventListener("pointermove",h),e.domElement.addEventListener("pointerup",v);var p=function(n){i.enabled=!1,e.domElement.parentElement.appendChild(a),a.style.left=n.clientX+"px",a.style.top=n.clientY+"px",a.style.width="0px",a.style.height="0px",r.x=n.clientX,r.y=n.clientY},y=function(e){u.x=Math.max(r.x,e.clientX),u.y=Math.max(r.y,e.clientY),o.x=Math.min(r.x,e.clientX),o.y=Math.min(r.y,e.clientY),a.style.left=o.x+"px",a.style.top=o.y+"px",a.style.width=u.x-o.x+"px",a.style.height=u.y-o.y+"px"},b=function(e){i.enabled=!0,a.parentElement&&a.parentElement.removeChild(a),l.x=e.clientX,l.y=e.clientY;var n=new ln.TUj(r,l);g(n),m()},g=function(a){var r=new ln.FM8;if(a.getSize(r),!(r.x<5||r.y<5)){var l=new ln.FM8((a.max.x+a.min.x)/2,(a.max.y+a.min.y)/2),o=e.domElement.getBoundingClientRect(),u=l.x-o.left,s=l.y-o.top,c=new ln.FM8(u/o.width*2-1,-s/o.height*2+1),m=n.children.find((function(e){return"Part"===e.type}));if(m){d.setFromCamera(c,t);var f=d.intersectObject(m);if(f.length){i.target.copy(f[0].point);var h=new ln.FM8(r.x/o.width,r.y/o.height),v=1-Math.max(h.x,h.y),p=t.position.distanceTo(i.target)*v,y=i.target.clone().sub(t.position).normalize().multiplyScalar(p);t.position.add(y)}}}};return{dispose:function(){e.domElement.removeEventListener("pointerdown",f),e.domElement.removeEventListener("pointermove",h),e.domElement.removeEventListener("pointerup",v)},end:m,isEnabled:function(){return s},start:function(){s=!0}}}(v.current,m.current,h.current,b.current),Z.current=xn(v.current,m.current,h.current,b.current),S.current=Zn(v.current),S.current.setVisible(!1),P.current=wn(m.current);var c=function(){b.current.update(),v.current.setViewport(0,0,t,i),v.current.render(m.current,h.current),x.current.update(),y.current.render(),u.render(),s.render(),S.current.render()},d=function(){t=n.clientWidth,i=n.clientHeight,h.current.aspect=t/i,h.current.updateProjectionMatrix(),v.current.setSize(t,i),y.current.setSize(t,i),u.resize({newOffsetWidth:t-155,newOffsetHeight:i-155,newWidth:150,newHeight:150}),s.resize({newOffsetWidth:t-155,newOffsetHeight:i-155,newWidth:150,newHeight:150}),c()},f=function(){c(),requestAnimationFrame(f)};return window.addEventListener("resize",d),e=requestAnimationFrame(f),function(){e&&cancelAnimationFrame(e),e=void 0,window.removeEventListener("resize",d),n.removeChild(v.current.domElement),m.current.children.forEach((function(e){m.current.remove(e)})),u.dispose(),s.dispose(),x.current.dispose(),Z.current.dispose(),j.current.dispose(),P.current.dispose()}}R.push("/webgl")}),[R]),(0,s.useEffect)((function(){var e;m.current&&(m.current.children.find((function(e){return"Part"===e.type&&e.uuid===(null===a||void 0===a?void 0:a.summary.uuid)}))||(m.current.children.forEach((function(e){if("Part"===e.type){var n=e;m.current.remove(n),n.dispose()}})),a?qn(a,k,m.current,h.current,b.current,{gridHelper:x.current,sectionViewHelper:Z.current,colorbarHelper:S.current,pointHelper:P.current},W).catch((function(e){(0,w.lt)(Rn,e),Vn(m.current)})):(Vn(m.current),x.current.update(),null===(e=P.current)||void 0===e||e.build())))}),[a,k,W]),(0,s.useEffect)((function(){if(m.current)if(2===(null===a||void 0===a?void 0:a.summary.dimension)){Vn(m.current);var e=new ln.Pa4(0,0,1),n=new ln.Pa4(0,1,0),t=new ln.Pa4;m.current.boundingBox.getCenter(t);var i=h.current.position.distanceTo(b.current.target),r=e.clone().multiplyScalar(i),l=t.add(r);h.current.position.copy(l),h.current.up.copy(n),b.current.noRotate=!0}else b.current.noRotate=!1}),[a]),(0,s.useEffect)((function(){m.current&&m.current.children.forEach((function(e){if("Part"===e.type&&e.uuid===(null===V||void 0===V?void 0:V.uuid)){var n=e;L?n.startSelection(v.current,h.current,p.current,Y):n.stopSelection()}}))}),[L,V,Y]),(0,s.useEffect)((function(){m.current&&m.current.children.forEach((function(e){if("Part"===e.type&&e.uuid===(null===V||void 0===V?void 0:V.uuid)){var n=e;n.highlight(null===G||void 0===G?void 0:G.uuid);var t=n.getSelected();B.filter((function(e){return!t.find((function(n){return n.uuid===e.uuid}))})).forEach((function(e){e.uuid&&n.select(e.uuid)})),t.filter((function(e){return!B.find((function(n){return n.uuid===e.uuid}))})).forEach((function(e){n.unselect(e.uuid)}))}}))}),[V,G,B]),(0,s.useEffect)((function(){var e;m.current&&(null===(e=P.current)||void 0===e||e.update(H?new ln.Pa4(H.x,H.y,H.z):void 0))}),[H]);var q=(0,s.useCallback)((function(e){E(e),m.current.children.forEach((function(n){"Part"===n.type&&n.setTransparent(e)}))}),[]),K=(0,s.useCallback)((function(){var e=!N;M(e),e?Z.current.start():Z.current.stop()}),[N]);return(0,o.jsxs)(c.Z,{className:"View no-scroll",children:[(0,o.jsx)(c.Z.Header,{className:"View-header",children:(0,o.jsxs)("div",{className:"View-controls-main",children:[(0,o.jsx)(Ie.Z,{title:"Take snasphot",placement:"right",children:(0,o.jsx)(Be.Z,{placement:"bottom",overlay:(0,o.jsx)(d.Z,{items:[{key:"project",label:(0,o.jsx)(f.Z,{type:"text",loading:T,onClick:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:D(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Kn(t,m.current,h.current,v.current)];case 2:return e.sent(),[3,4];case 3:return D(!1),[7];case 4:return[2]}}))})),children:"Project snapshot"})},{key:"image",label:(0,o.jsx)(f.Z,{type:"text",loading:z,onClick:function(){F(!0);try{!function(e,n,t,i){try{var a=i.domElement.width,r=i.domElement.height;i.clear(),i.setViewport(0,0,a,r),i.render(n,t);var l=i.domElement.toDataURL(),o=document.createElement("a");o.href=l.replace("image/png","image/octet-stream"),o.download=e.title+"_"+(new Date).toLocaleDateString()+".png",o.click()}catch(u){(0,w.lt)(Ln,u)}}(t,m.current,h.current,v.current)}finally{F(!1)}},children:"Export image"})}]}),children:(0,o.jsx)(f.Z,{icon:(0,o.jsx)(qe.Z,{})})})}),(0,o.jsx)(He.Z,{className:"no-margin"}),(0,o.jsx)(Ie.Z,{title:"Display grid",placement:"right",children:(0,o.jsx)(Ye.Z,{defaultChecked:!0,checkedChildren:(0,o.jsx)(Ke.Z,{}),unCheckedChildren:(0,o.jsx)(Ke.Z,{}),onChange:function(e){return function(e,n){e.setVisible(n)}(x.current,e)}})}),(0,o.jsx)(Ie.Z,{title:"Set transparency",placement:"right",children:(0,o.jsx)(Ye.Z,{className:"transparent",checked:k,checkedChildren:(0,o.jsx)(Je.Z,{}),unCheckedChildren:(0,o.jsx)(Je.Z,{}),onChange:q})}),(0,o.jsx)(He.Z,{className:"no-margin"}),(0,o.jsx)(Ie.Z,{title:"Zoom out",placement:"right",children:(0,o.jsx)(f.Z,{icon:(0,o.jsx)($e.Z,{}),onMouseDown:function(){return Hn(h.current,b.current)},onMouseUp:Yn,onMouseOut:Yn})}),(0,o.jsx)(Ie.Z,{title:"Zoom to fit",placement:"right",children:(0,o.jsx)(f.Z,{icon:(0,o.jsx)(Xe.Z,{}),onClick:function(){return Wn(m.current,h.current,b.current)}})}),(0,o.jsx)(Ie.Z,{title:"Zoom in",placement:"right",children:(0,o.jsx)(f.Z,{icon:(0,o.jsx)(Qe.Z,{}),onMouseDown:function(){return Bn(h.current,b.current)},onMouseUp:Yn,onMouseOut:Yn})}),(0,o.jsx)(Ie.Z,{title:"Zoom to selection",placement:"right",children:(0,o.jsx)(f.Z,{icon:(0,o.jsx)(en.Z,{}),onClick:function(){return j.current.isEnabled()?j.current.end():j.current.start()}})}),(0,o.jsx)(He.Z,{className:"no-margin"}),!N&&(0,o.jsx)(Ie.Z,{title:"Section view",placement:"right",children:(0,o.jsx)(f.Z,{icon:(0,o.jsx)(nn.Z,{}),onClick:K})}),N&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Ie.Z,{title:"Stop",placement:"left",children:(0,o.jsx)(f.Z,{icon:(0,o.jsx)(tn.Z,{}),onClick:K})}),(0,o.jsx)(Ie.Z,{title:"Hide plane",placement:"left",children:(0,o.jsx)(f.Z,{icon:(0,o.jsx)(an.Z,{}),onClick:function(){return Z.current.toggleVisible()}})}),(0,o.jsx)(Ie.Z,{title:"Snap to X",placement:"left",children:(0,o.jsx)(f.Z,{className:"ant-btn-icon-only",onClick:function(){return Z.current.toAxis(new ln.Pa4(-1,0,0))},children:"X"})}),(0,o.jsx)(Ie.Z,{title:"Snap to Y",placement:"left",children:(0,o.jsx)(f.Z,{className:"ant-btn-icon-only",onClick:function(){return Z.current.toAxis(new ln.Pa4(0,-1,0))},children:"Y"})}),(0,o.jsx)(Ie.Z,{title:"Snap to Z",placement:"left",children:(0,o.jsx)(f.Z,{className:"ant-btn-icon-only",onClick:function(){return Z.current.toAxis(new ln.Pa4(0,0,-1))},children:"Z"})}),(0,o.jsx)(Ie.Z,{title:"Flip",placement:"left",children:(0,o.jsx)(f.Z,{onClick:function(){return Z.current.flip()},icon:(0,o.jsx)(rn.Z,{})})})]})]})}),(0,o.jsxs)(c.Z.Content,{className:"View-content no-scroll",children:[(0,o.jsx)("div",{style:{display:n?"flex":"none"},className:"View-loading",children:(0,o.jsx)(We.Z,{indicator:(0,o.jsx)(g.Z,{className:"View-loading-spin",style:{fontSize:80},spin:!0})})}),(0,o.jsx)("div",{ref:r,className:"View-canvas"})]})]})},$n="Unable to load part",Xn=function(){var e=(0,i.Z)((function(e,n,t){var i,a,r,o,u,s;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,5,,6]),"geometry"!==t?[3,2]:(i=n,a={},[4,de.getPart((a.id=i.id,a))]);case 1:case 3:return[2,l.sent()];case 2:return r=n,o={},u={},[4,Ge.load((o.id=e.id,o),(u.originPath=r.originPath,u.glb=r.glb,u))];case 4:return[3,6];case 5:throw s=l.sent(),(0,w.lt)($n,s),s;case 6:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Qn=function(e){var n=e.project,t=e.simulation,i=e.geometry,a=e.result,r=e.postprocessing,l=(0,s.useState)(),u=l[0],c=l[1],d=(0,s.useState)(),m=d[0],f=d[1],h=(0,s.useState)(!1),v=h[0],p=h[1];return(0,s.useEffect)((function(){var e;if(t&&r)r.glb!==(null===(e=m)||void 0===e?void 0:e.glb)&&(f(r),p(!0),Xn(t,r,"result").then((function(e){return c(e)})).catch((function(e){})).finally((function(){return p(!1)})));else if(t&&a){var n;a.glb!==(null===(n=m)||void 0===n?void 0:n.glb)&&(f(a),p(!0),Xn(t,a,"result").then((function(e){return c(e)})).catch((function(e){})).finally((function(){return p(!1)})))}else if(i){var l;i.id!==(null===(l=m)||void 0===l?void 0:l.id)&&(f(i),p(!0),i.needCleanup?(c(void 0),p(!1)):Xn(void 0,i,"geometry").then((function(e){return c(e)})).catch((function(e){})).finally((function(){return p(!1)})))}}),[t,i,a,r,m]),(0,o.jsx)(Jn,{loading:v,project:{id:n.id,title:n.title},part:u})},et=t(14924),nt=t(32808),tt=t(63463),it=t(25025),at=t(56299),rt=t(18870),lt=t(9253),ot=t(51584),ut=t(14195),st=t(3023),ct=t(75358),dt=t(14888),mt=t(44141),ft=t(96486),ht=t(60877),vt="Unable to download CSV",pt=function(e){var n=e.simulation,t=(0,s.useState)(!1),i=t[0],l=t[1],u=(0,s.useState)(),d=u[0],m=u[1],h=(0,s.useState)(),v=h[0],p=h[1],y=(0,s.useState)(),b=y[0],g=y[1],x=(0,s.useState)(),j=x[0],S=x[1],P=(0,s.useState)([!0]),k=P[0],E=P[1],_=(0,s.useState)(),N=_[0],M=_[1],O=(0,s.useState)(!1),T=O[0],D=O[1],U=(0,a.Z)(ae.useSimulation(null===n||void 0===n?void 0:n.id),1)[0];return(0,s.useEffect)((function(){var e=null===U||void 0===U?void 0:U.tasks;if(!e)return m(void 0),p(void 0),void g(void 0);var n=e.map((function(e){return e.datas})).filter((function(e){return e})).flatMap((function(e){return e}));if(!n.length||!n[0].names)return p(void 0),void g(void 0);n.sort((function(e,n){return e.x-n.x}));var t=n.map((function(e){return e.names})).flatMap((function(e){return e})).filter((function(e,n,t){return t.findIndex((function(n){return n===e}))===n})),i=t.map((function(e){return(0,ft.camelCase)(e)})),a=[];n.forEach((function(e,n){e.names.forEach((function(t,i){var r=a.find((function(n){return n.x===e.x}));r?r[(0,ft.camelCase)(t)]=e.ys[i]:a.push((0,et.Z)({key:n,x:e.x},(0,ft.camelCase)(t),e.ys[i]))}))})),m(a),p(t),g(i)}),[U]),(0,s.useEffect)((function(){if(d&&v&&b){var e=v.map((function(e,n){return{align:"center",className:"Data-column"+(k[n]?" Data-column-selected":""),title:(0,o.jsxs)(C.Z,{children:[e,(0,o.jsx)(nt.Z,{checked:k[n],onChange:function(e){return E(function(e,n,t){var i=e.target.checked,a=(0,r.Z)(t);return a[n]=i,a}(e,n,k))},children:(0,o.jsx)(at.Z,{style:{fontSize:20}})})]}),dataIndex:b[n],key:b[n]}}));e.unshift({title:"",dataIndex:"x",key:"x"}),S(e)}else S(void 0)}),[d,v,b,k]),(0,s.useEffect)((function(){var e,n;if(d&&v&&b){var t=[],i=k.map((function(e,n){if(e){var i=b[n],a=v[n];return t.push(i),(0,o.jsx)(rt.x,{name:a,type:"monotone",dataKey:i,stroke:ht.Z.stringToColor(i),strokeWidth:2},n)}})).filter((function(e){return e})),a=d.map((function(e){var n={x:e.x};return t.forEach((function(t){e[t]&&(n[t]=e[t])})),n})).filter((function(e){return e})),l=(e=Math).min.apply(e,(0,r.Z)(t.flatMap((function(e){return a.map((function(n){return n[e]}))})))),u=(n=Math).max.apply(n,(0,r.Z)(t.flatMap((function(e){return a.map((function(n){return n[e]}))}))));M({data:a,min:l,max:u,lines:i})}else M(void 0)}),[d,v,b,k]),n&&d&&v&&b?(0,o.jsx)(c.Z,{style:{position:"absolute",zIndex:100,right:50,bottom:25,backgroundColor:"rgba(255, 255, 255, 0)"},children:(0,o.jsxs)(c.Z.Content,{children:[(0,o.jsx)(Ie.Z,{title:"Data visualization",children:(0,o.jsx)(f.Z,{type:"primary",icon:(0,o.jsx)(at.Z,{}),onClick:function(){return l(!0)},style:{width:40,height:40,border:"1px solid #5E14FA",borderRadius:20,marginBottom:-20}})}),(0,o.jsx)(tt.Z,{title:"Data visualization",placement:"bottom",closable:!0,onClose:function(){return l(!1)},visible:i,mask:!1,maskClosable:!1,height:"50vh",bodyStyle:{height:"100%",overflow:"hidden"},extra:(0,o.jsx)(Z.o6,{bordered:!0,loading:T,disabled:!d,onDownload:function(){D(!0);try{!function(e,n,t,i){var a="";a="x,"+t.join(",")+"\n",n.forEach((function(e){a+=e.x,null===i||void 0===i||i.forEach((function(n){void 0!==e[n]&&(a+=","+e[n])})),a+="\n"}));var r=e.name+".csv",l=new File([a],r,{type:"text/csv"}),o=window.URL.createObjectURL(l),u=document.createElement("a");u.href=o,u.setAttribute("download",r),u.click(),u.remove()}(n,d,v,b)}catch(e){(0,w.lt)(vt,e)}finally{D(!1)}},children:"Export CSV"}),children:(0,o.jsxs)("div",{style:{display:"flex",height:"100%",padding:"10px"},children:[(0,o.jsx)("div",{style:{display:"flex",height:"100%",width:"50%",overflow:"auto"},children:(0,o.jsx)(it.Z,{size:"small",dataSource:d,columns:j,pagination:!1})}),(0,o.jsx)(lt.h,{width:"50%",height:"100%",children:(0,o.jsxs)(ot.w,{data:null===N||void 0===N?void 0:N.data,margin:{top:0,right:40,left:40,bottom:0},children:[(0,o.jsx)(ut.q,{strokeDasharray:"3 3"}),(0,o.jsx)(st.K,{dataKey:"x"}),(0,o.jsx)(ct.B,{domain:[(null===N||void 0===N?void 0:N.min)||-1,(null===N||void 0===N?void 0:N.max)||1]}),(0,o.jsx)(dt.u,{}),(0,o.jsx)(mt.D,{}),null===N||void 0===N?void 0:N.lines]})})]})})]})}):null},yt=t(34041),bt=t(67040),gt=t(28058),xt=t(23389),jt=t(93398),Zt={category:"Academic",name:"Poisson's equation",algorithm:"poisson",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Poisson\'s equation\n  </h3>\n  <p>\n  Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n  The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n  The Poisson\'s equation reads as follow:\n  \\begin{align}\n    \\Delta u &= f &\\text{on }\\Omega\\\\\n    u &= u_D &\\text{on }\\Gamma_D\\\\\n    \\nabla u &= g_N &\\text{on }\\Gamma_N\n  \\end{align}\n  </p>\n  <figure>\n    <img src="/images/Poisson.png" alt="Poisson" />\n    <figcaption>Poisson\'s equation example on a cube.</figcaption>\n  </figure>\n  <p>\n      See <a target="_blank" href="https://en.wikipedia.org/wiki/Poisson%27s_equation">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},parameters:{index:2,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force",htmlEntity:"formula",default:0}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"u",htmlEntity:"select",options:[{label:"P1",value:"P1"},{label:"P2",value:"P2"}],default:"P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]}},boundaryConditions:{index:3,title:"Boundary conditions",dirichlet:{label:"Dirichlet",children:[{label:"u",htmlEntity:"formula",default:0}]},neumann:{label:"Neumann",children:[{label:"du/dn",htmlEntity:"formula",default:0}]}},run:{index:4,title:"Run",results:[{name:"u"}]}}},wt={category:"Mechanics",name:"Linear elasticity",algorithm:"linearElasticity",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Linear elasticity\n  </h3>\n  <p>\n  Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n  The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n    \\(u\\) is the displacement.<br/>\n\n  The linear elasticity equation reads as follow:\n\n  $$\n  \\begin{align}\n    -\\text{div}(\\sigma) &= f &\\text{on }\\Omega\\\\\n    u &= u_D&\\text{on }\\Gamma_D\\\\\n    \\sigma\\cdot n &= u_N&\\text{on }\\Gamma_N\n  \\end{align}\n  $$\n\n  With \\(\\sigma_{ij}(u) = \\lambda\\delta_{ij}\\nabla\\cdot u + 2\\mu\\epsilon_{ij}(u)\\).<br/>\n\n  \\(\\lambda\\) and \\(\\mu\\) are the Lam\xe9 coefficients.\n  </p>\n  <figure>\n    <img src="/images/LinearElasticity.png" alt="Linear Elasticity" />\n    <figcaption>Linear elasticity equation example on a beam.</figcaption>\n  </figure>\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Linear_elasticity">Wikipedia</a>.\n  </p>\n  ',variables:[{name:"Displacement (x)",value:"Ux"},{name:"Displacement (y)",value:"Uy"},{name:"Displacement (z)",value:"Uz"}],configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Density",name:"Rho",htmlEntity:"formula",default:8050,unit:"\\(kg.m^{-3}\\)"},{label:"Young's modulus",name:"E",htmlEntity:"formula",default:1e9,unit:"\\(Pa\\)"},{label:"Poisson's ratio",name:"Nu",htmlEntity:"formula",default:.4,unit:"\\(1\\)"}]},parameters:{index:3,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force (x)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{label:"External force (y)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{only3D:!0,label:"External force (z)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"[Ux, Uy, Uz]",label2D:"[Ux, Uy]",htmlEntity:"select",options:[{label:"P1",value:"P1, P1, P1",value2D:"P1, P1"},{label:"P2",value:"P2, P2, P2",value2D:"P2, P2"}],default:"P1, P1, P1",default2D:"P1, P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]},meshAdaptation:{advanced:!0,label:"Mesh adaptation",children:[{label:"Enabled",htmlEntity:"checkbox",default:!1},{label:"Number of mesh adaptation loops",htmlEntity:"formula",default:1}]}},boundaryConditions:{index:4,title:"Boundary conditions",fixed:{label:"Fixed",refineFactor:2},displacement:{label:"Displacement",children:[{label:"Ux",htmlEntity:"formula",default:0,unit:"\\(m\\)"},{label:"Uy",htmlEntity:"formula",default:0,unit:"\\(m\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:0,unit:"\\(m\\)"}],refineFactor:2},presure:{label:"Surface force",children:[{label:"d(U)/d(N)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-2}\\)"}],refineFactor:2}},run:{index:5,title:"Run",results:[{name:"Displacement"},{name:"vonMises"},{name:"gamma11"},{name:"gamma12"},{name:"gamma13"},{name:"gamma22"},{name:"gamma23"},{name:"gamma33"}],postprocessing:[{key:"warpByVector",parameters:[{key:"Vectors",value:"Displacement"}]},{key:"contour",parameters:[{key:"ContourBy",options:["Displacement","vonMises","gamma11","gamma12","gamma13","gamma22","gamma23","gamma33"]}]}]}}},St={category:"Mechanics",name:"Linear elasticity (time depedent)",algorithm:"linearElasticityTime",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Linear elasticity (time dependent)\n  </h3>\n  <p>\n  Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n  The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n    \\(u\\) is the displacement.<br/>\n\n  The linear elasticity equation reads as follow:\n\n  $$\n  \\begin{align}\n    \\frac{\\partial^2u}{\\partial t^2}-\\text{div}(\\sigma) &= f &\\text{on }\\Omega\\\\\n    u &= u_D&\\text{on }\\Gamma_D\\\\\n    \\sigma\\cdot n &= u_N&\\text{on }\\Gamma_N\n  \\end{align}\n  $$\n\n  With \\(\\sigma_{ij}(u) = \\lambda\\delta_{ij}\\nabla\\cdot u + 2\\mu\\epsilon_{ij}(u)\\).<br>\n\n  \\(\\lambda\\) and \\(\\mu\\) are the Lam\xe9 coefficients.\n  </p>\n  <figure>\n    <img src="/images/LinearElasticity.png" alt="Linear Elasticity" />\n    <figcaption>Linear elasticity equation example on a beam.</figcaption>\n  </figure>\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Linear_elasticity">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Density",name:"Rho",htmlEntity:"formula",default:8050,unit:"\\(kg.m^{-3}\\)"},{label:"Young's modulus",name:"E",htmlEntity:"formula",default:1e9,unit:"\\(Pa\\)"},{label:"Poisson's ratio",name:"Nu",htmlEntity:"formula",default:.4,unit:"\\(1\\)"}]},parameters:{index:3,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force (x)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{label:"External force (y)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{only3D:!0,label:"External force (z)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"}]},time:{label:"Time",children:[{label:"Total time",htmlEntity:"formula",default:1,unit:"\\(s\\)"},{label:"Time step",htmlEntity:"formula",default:.1,unit:"\\(s\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"[Ux, Uy, Uz]",label2D:"[Ux, Uy]",htmlEntity:"select",options:[{label:"P1",value:"P1, P1, P1",value2D:"P1, P1"},{label:"P2",value:"P2, P2, P2",value2D:"P2, P2"}],default:"P1, P1, P1",default2D:"P1, P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]},meshAdaptation:{advanced:!0,label:"Mesh adaptation",children:[{label:"Enabled",htmlEntity:"checkbox",default:!1}]}},boundaryConditions:{index:4,title:"Boundary conditions",fixed:{label:"Fixed",refineFactor:2},displacement:{label:"Displacement",children:[{label:"Ux",htmlEntity:"formula",default:0,unit:"\\(m\\)"},{label:"Uy",htmlEntity:"formula",default:0,unit:"\\(m\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:0,unit:"\\(m\\)"}],refineFactor:2},presure:{label:"Surface force",children:[{label:"d(U)/d(N)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-2}\\)"}],refineFactor:2}},run:{index:5,title:"Run",results:[{name:"Displacement"},{name:"vonMises"},{name:"gamma11"},{name:"gamma12"},{name:"gamma13"},{name:"gamma22"},{name:"gamma23"},{name:"gamma33"}],resultsFilter:{name:"Time",prefixPattern:"Result_",suffixPattern:".vtu",pattern:"Result_\\d+.vtu",multiplicator:["parameters","time","children","1"]},postprocessing:[{key:"warpByVector",parameters:[{key:"Vectors",value:"Displacement"}]},{key:"contour",parameters:[{key:"ContourBy",options:["Displacement","vonMises","gamma11","gamma12","gamma13","gamma22","gamma23","gamma33"]}]}]}}},Pt={category:"Fluid",name:"Stokes",algorithm:"stokes",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Stokes\n  </h3>\n  <p>\n    Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n    The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n    \\(u\\) is the velocity and \\(p\\) the pressure.<br/>\n\n    The Stokes equations reads as follow:\n\n    $$\n    \\begin{align}\n      \\mu\\Delta u - \\nabla p &= f&\\text{on }\\Omega\\\\\n      u &= u_D&\\text{on }\\Gamma_D\\\\\n      \\mu\\frac{\\partial u}{\\partial n} - pn &= g_N&\\text{on }\\Gamma_N\n    \\end{align}\n    $$\n\n    With \\(\\mu\\) the viscosity.\n  </p>\n  <figure>\n    <img src="/images/Stokes.png" alt="Stokes" />\n    <figcaption>Stokes equation example on a pipe.</figcaption>\n  </figure>\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Navier%E2%80%93Stokes_equations">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Dynamic viscosity",name:"Mu",htmlEntity:"formula",default:.001,unit:"\\(Pa.s^{-1}\\)"}]},parameters:{index:3,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force (x)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{label:"External force (y)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{only3D:!0,label:"External force (z)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"[Ux, Uy, Uz, p]",label2D:"[Ux, Uy, p]",htmlEntity:"select",options:[{label:"P2/P1",value:"P2, P2, P2, P1",value2D:"P2, P2, P1"},{label:"P1b/P1",value:"P1b, P1b, P1b, P1",value2D:"P1b, P1b, P1"}],default:"P2, P2, P2, P1",default2D:"P2, P2, P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]}},boundaryConditions:{index:5,title:"Boundary conditions",wall:{label:"Wall"},freeOutlet:{label:"Free outlet"},dirichlet:{label:"Velocity",children:[{label:"Ux",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"},{label:"Uy",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"}],refineFactor:2},neumann:{label:"Pressure",children:[{label:"d(U)/d(N)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-2}\\)"}],refineFactor:2}},run:{index:6,title:"Run",results:[{name:"Velocity"},{name:"Presure"}],postprocessing:[{key:"streamTracer",parameters:[{key:"Vectors",value:"Velocity"}]}]}}},Ct={category:"Fluid",name:"Navier-Stokes time-dependant",algorithm:"navierStokesTime",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Navier-Stokes\n  </h3>\n  <p>\n    Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n    The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n    \\(u\\) is the velocity and \\(p\\) the pressure.<br/>\n\n    The Navier-Stokes equations reads as follow:\n\n    $$\n    \\begin{align}\n      \\rho\\frac{\\partial u}{\\partial t} + \\rho(u\\cdot\\nabla)u + \\nabla p - \\mu\\Delta u &= f&\\text{on }\\Omega\\\\\n      u &= u_D&\\text{on }\\Gamma_D\\\\\n      \\mu\\frac{\\partial u}{\\partial n} - pn &= g_N&\\text{on }\\Gamma_N\n    \\end{align}\n    $$\n\n    With \\(\\mu\\) the viscosity and \\(\\rho\\) the density.\n  </p>\n  <figure>\n    <img src="/images/Stokes.png" alt="Stokes" />\n    <figcaption>Navier-Stokes equation example on a pipe.</figcaption>\n  </figure>\n  </p>\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Navier%E2%80%93Stokes_equations">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Density",name:"Rho",htmlEntity:"formula",default:1e3,unit:"\\(kg.m^{-3}\\)"},{label:"Dynamic viscosity",name:"Mu",htmlEntity:"formula",default:.001,unit:"\\(Pa.s^{-1}\\)"}]},parameters:{index:3,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force (x)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{label:"External force (y)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"},{only3D:!0,label:"External force (z)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-3}\\)"}]},time:{label:"Time",children:[{label:"Total time",htmlEntity:"formula",default:1,unit:"\\(s\\)"},{label:"Time step",htmlEntity:"formula",default:.1,unit:"\\(s\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"[Ux, Uy, Uz, p]",label2D:"[Ux, Uy, p]",htmlEntity:"select",options:[{label:"P2/P1",value:"P2, P2, P2, P1",value2D:"P2, P2, P1"},{label:"P1b/P1",value:"P1b, P1b, P1b, P1",value2D:"P1b, P1b, P1"}],default:"P2, P2, P2, P1",default2D:"P2, P2, P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]}},initialization:{index:4,title:"Initialization",done:!0,direct:{label:"Velocity",children:[{label:"Ux",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"},{label:"Uy",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"}]},coupling:{label:"Coupling",compatibility:[{algorithm:"navierStokesTime",filter:{name:"Time step",prefixPattern:"Result_",suffixPattern:".vtu",pattern:"Result_\\d+.vtu",multiplicator:["parameters","time","children","1"]}}]}},boundaryConditions:{index:5,title:"Boundary conditions",wall:{label:"Wall"},freeOutlet:{label:"Free outlet"},dirichlet:{label:"Velocity",children:[{label:"Ux",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"},{label:"Uy",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:0,unit:"\\(m.s^{-1}\\)"}],refineFactor:2},neumann:{label:"Pressure",children:[{label:"d(U)/d(N)",htmlEntity:"formula",default:0,unit:"\\(N.m^{-2}\\)"}],refineFactor:2}},run:{index:6,title:"Run",results:[{name:"Velocity"},{name:"Presure"}],resultsFilter:{name:"Time",prefixPattern:"Result_",suffixPattern:".vtu",pattern:"Result_\\d+.vtu",multiplicator:["parameters","time","children","1"]}}}},kt={category:"Thermic",name:"Thermal diffusion",algorithm:"thermicDiffusion",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Thermal diffusion\n  </h3>\n  <p>\n    Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n    The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n      \\(T\\) is the temperature.<br/>\n\n    The heat equation reads as follow:\n\n    $$\n    \\begin{align}\n      \\rho C_p \\frac{\\partial T}{\\partial t} - \\lambda\\Delta T &= f&\\text{on }\\Omega\\\\\n      T &= T_D&\\text{on }\\Gamma_D\\\\\n      \\lambda\\frac{\\partial T}{\\partial n} &= g_N&\\text{on }\\Gamma_N\n    \\end{align}\n    $$\n\n    With \\(\\rho\\) the density, \\(C_p\\) the heat capacity and \\(\\lambda\\) the thermal conductivity.\n  </p>\n\n  <figure>\n    <img src="/images/Heat.png" alt="Heat" />\n    <figcaption>Heat equation example on a beam.</figcaption>\n  </figure>\n  </p>\n\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Navier%E2%80%93Stokes_equations">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Density",name:"Rho",htmlEntity:"formula",default:7960,unit:"\\(kg.m^{-3}\\)"},{label:"Thermal conductivity",name:"Lambda",htmlEntity:"formula",default:15,unit:"\\(W.m^{-1}.K^{-1}\\)"},{label:"Heat capacity",name:"Cp",htmlEntity:"formula",default:502,unit:"\\(J.K^{-1}.kg^{-1}\\)"}]},parameters:{index:3,title:"Parameters",time:{label:"Time",children:[{label:"Total time",htmlEntity:"formula",default:1,unit:"\\(s\\)"},{label:"Time step",htmlEntity:"formula",default:.1,unit:"\\(s\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"T",htmlEntity:"select",options:[{label:"P1",value:"P1"},{label:"P2",value:"P2"}],default:"P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]}},boundaryConditions:{index:4,title:"Boundary conditions",temperature:{label:"Temperature",children:[{label:"T",htmlEntity:"formula",default:0,unit:"K"}],refineFactor:2}},run:{index:5,title:"Run",results:[{name:"T"}],resultsFilter:{name:"Time",prefixPattern:"Result_",suffixPattern:".vtu",pattern:"Result_\\d+.vtu",multiplicator:["parameters","time","children","1"]}}}},Et=[Zt,wt,St,Pt,Ct,kt],_t=Et,Nt=t(4687),Mt=t(57132),Ot="Unable to copy simulation",Tt=function(){var e=(0,i.Z)((function(e,n,t){var i,a,o,u,s,c;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),(i=ht.Z.deepCopy(n.scheme)).configuration.run.done=!1,i.configuration.run.error=void 0,o={},u={},[4,ae.add((o.id=e.id,o),(u.name=n.name+" (copy)",u.scheme=i,u))];case 1:return a=l.sent(),t.addOneSimulation(a),s={},t.mutateProject((s.id=e.id,s.simulations=(0,r.Z)(e.simulations).concat([a.id]),s)),[3,3];case 2:return c=l.sent(),(0,w.lt)(Ot,c),[3,3];case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Dt=function(e){var n=e.project,t=e.simulation,a=e.swr,r=(0,s.useState)(!1),u=r[0],c=r[1];return(0,o.jsx)(Ie.Z,{title:"Copy",children:(0,o.jsx)(f.Z,{className:"no-border",loading:u,icon:(0,o.jsx)(Mt.Z,{}),onClick:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:c(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Tt(n,t,a)];case 2:return e.sent(),[3,4];case 3:return c(!1),[7];case 4:return[2]}}))}))})})},Ut="Unable to update the simulation",zt=function(){var e=(0,i.Z)((function(e,n,t){var i,a,r,o;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),i={},a={},[4,ae.update((i.id=e.id,i),[(a.key="name",a.value=n.name,a)])];case 1:return l.sent(),r={},t.mutateOneSimulation((r.id=e.id,r.name=n.name,r)),[3,3];case 2:throw o=l.sent(),(0,w.lt)(Ut,o),o;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Ft=function(e){var n=e.simulation,t=e.swr,a=(0,s.useState)(!1),r=a[0],u=a[1],c=(0,s.useState)(!1),d=c[0],m=c[1];return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Z.w6,{onEdit:function(){return u(!0)}}),(0,o.jsx)(pe.ZP,{title:"Edit the simulation's name",visible:r,initialValues:{name:n.name},onCancel:function(){return u(!1)},onOk:function(){var e=(0,i.Z)((function(e){var i;return(0,l.__generator)(this,(function(a){switch(a.label){case 0:m(!0),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,zt(n,e,t)];case 2:return a.sent(),m(!1),u(!1),[3,4];case 3:throw i=a.sent(),m(!1),i;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),loading:d,children:(0,o.jsx)(we.Z.Item,{name:"name",label:"Name:",rules:[{required:!0,message:"Name is required"}],children:(0,o.jsx)(Se.Z,{})})})]})},Rt="Unable to delete the simulation",At=function(){var e=(0,i.Z)((function(e,n,t){var i,a,r,o;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,ae.del(n)];case 1:return l.sent(),i=e.simulations.filter((function(e){return e!==n.id})),a={},t.mutateProject((a.id=e.id,a.simulations=i,a)),r={},t.delOneSimulation((r.id=n.id,r)),[3,3];case 2:throw o=l.sent(),(0,w.lt)(Rt,o),o;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Lt=function(e){var n=e.project,t=e.simulation,a=e.swr,r=(0,s.useState)(!1),u=r[0],c=r[1];return(0,o.jsx)(Z.m1,{loading:u,text:(0,o.jsxs)(o.Fragment,{children:["Are you sure you want to delete the simulation"," ",(0,o.jsx)(m.Z.Text,{strong:!0,children:t.name}),"?"]}),onDelete:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:c(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,At(n,t,a)];case 2:return e.sent(),[3,4];case 3:return c(!1),[7];case 4:return[2]}}))}))})},Vt=function(e){var n=e.project,t=e.simulation,i=e.swr;return n&&t?(0,o.jsx)(c.Z,{children:(0,o.jsx)(c.Z.Content,{children:(0,o.jsx)(P.Z,{size:"small",title:(0,o.jsx)(m.Z.Title,{level:5,ellipsis:!0,children:t.name}),actions:[(0,o.jsx)(Dt,{project:{id:n.id,simulations:n.simulations},simulation:t,swr:{mutateProject:i.mutateProject,addOneSimulation:i.addOneSimulation}},"copy"),(0,o.jsx)(Ft,{simulation:{id:t.id,name:t.name},swr:{mutateOneSimulation:i.mutateOneSimulation}},"edit"),(0,o.jsx)(Lt,{project:{id:n.id,simulations:n.simulations},simulation:{id:t.id,name:t.name},swr:{mutateProject:i.mutateProject,delOneSimulation:i.delOneSimulation}},"delete")],children:(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)("span",{className:"text-light",children:"Category:"})," ",t.scheme.category]}),(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)("span",{className:"text-light",children:"Algorithm:"})," ",t.scheme.algorithm]}),(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)("span",{className:"text-light",children:"Code:"})," ",t.scheme.code]}),(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)("span",{className:"text-light",children:"Version:"})," ",t.scheme.version]}),(0,o.jsx)("div",{className:"full-wdith scroll",children:(0,o.jsx)(he.Z.Html,{html:t.scheme.description})})]})})})}):(0,o.jsx)(P.Z,{children:(0,o.jsx)(We.Z,{})})},Gt=function(e){var n=e.label,t=e.className,i=e.defaultValue,a=e.defaultChecked,r=e.onValueChange,l=e.onCheckedChange,u=e.unit,c=(0,s.useState)(String(null!==i&&void 0!==i?i:0)),d=c[0],m=c[1],f=(0,s.useState)(!!a),h=f[0],p=f[1],y=(0,s.useState)(void 0!==a&&!a),b=y[0],x=y[1],j=(0,s.useState)(0),Z=j[0],w=j[1],S=(0,s.useState)(!1),P=S[0],k=S[1];(0,s.useEffect)((function(){m(String(null!==i&&void 0!==i?i:0))}),[i]),(0,s.useEffect)((function(){p(!!a)}),[a]);var E=(0,s.useCallback)((function(e){var n=e.target.checked;p(n),k(!0),null===l||void 0===l||l(n),x(!n)}),[l]),_=(0,s.useCallback)((function(e){Z&&clearTimeout(Z);var n=setTimeout((function(){r(e),k(!1)}),500);w(+n)}),[Z,r]),N=(0,s.useCallback)((function(e){var n=e.target.value;m(n),k(!0),_(n)}),[_]);return(0,o.jsxs)(C.Z,{className:"full-width space-full-width "+t,align:"start",children:[void 0!==a&&(0,o.jsx)(nt.Z,{checked:h,onChange:E}),(0,o.jsx)(we.Z,{layout:"vertical",children:(0,o.jsx)(we.Z.Item,{label:n,children:(0,o.jsx)(Se.Z,{disabled:b,value:d,onChange:N,addonAfter:(0,o.jsxs)(C.Z,{className:"full-width",children:[(0,o.jsx)(he.Z.Inline,{text:u}),P?(0,o.jsx)(g.Z,{spin:!0,className:"color-orange"}):(0,o.jsx)(v.Z,{className:"color-green"})]})})})})]})},It="Unable to update the simulation",Bt=function(){var e=(0,i.Z)((function(e,n,t){var i,a,r,o,u,s,c;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),(i=ht.Z.deepCopy(e)).scheme.configuration.geometry.meshParameters={type:n,value:"auto"===n?"normal":"1"},r={},o={},a=(0,M.Z)((0,N.Z)(r,i.scheme.configuration.geometry),(o.done=!0,o)),u={},s={},[4,ae.update((u.id=e.id,u),[(s.key="scheme",s.type="json",s.method="set",s.path=["configuration","geometry"],s.value=a,s)])];case 1:return l.sent(),t.mutateOneSimulation(i),[3,3];case 2:throw c=l.sent(),(0,w.lt)(It,c),c;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Ht=function(){var e=(0,i.Z)((function(e,n,t,i){var a,r,o,u,s,c,d;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),(a=ht.Z.deepCopy(e)).scheme.configuration.geometry.meshParameters=(0,M.Z)((0,N.Z)({},a.scheme.configuration.geometry.meshParameters),{type:n,value:t}),o={},u={},r=(0,M.Z)((0,N.Z)(o,a.scheme.configuration.geometry),(u.done=!0,u)),s={},c={},[4,ae.update((s.id=e.id,s),[(c.key="scheme",c.type="json",c.method="set",c.path=["configuration","geometry"],c.value=r,c)])];case 1:return l.sent(),i.mutateOneSimulation(a),[3,3];case 2:throw d=l.sent(),(0,w.lt)(It,d),d;case 3:return[2]}}))}));return function(n,t,i,a){return e.apply(this,arguments)}}(),Yt=function(e){var n=e.simulation,t=e.swr,a=(0,s.useState)(),r=a[0],u=a[1],c=(0,s.useState)(),d=c[0],m=c[1];(0,s.useEffect)((function(){var e=n.scheme.configuration.geometry.meshParameters;e?(u(e.type),m(e.value)):(u("auto"),m("normal"))}),[n]);var f=(0,s.useCallback)(function(){var e=(0,i.Z)((function(e){return(0,l.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Ht(n,r,e,t)];case 1:return i.sent(),m(e),[3,3];case 2:return i.sent(),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),[n,r,t]);return(0,o.jsx)(P.Z,{size:"small",title:"Mesh refinement",children:(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,o.jsx)(we.Z,{layout:"vertical",children:(0,o.jsx)(we.Z.Item,{label:"Type",children:(0,o.jsxs)(yt.Z,{className:"full-width",value:r,onChange:function(){var e=(0,i.Z)((function(e){return(0,l.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Bt(n,e,t)];case 1:return i.sent(),u(e),m("auto"===e?"normal":"1"),[3,3];case 2:return i.sent(),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:[(0,o.jsx)(yt.Z.Option,{value:"auto",children:"Automatic"}),(0,o.jsx)(yt.Z.Option,{value:"manual",children:"Manual"})]})})}),"auto"===r&&(0,o.jsx)(we.Z,{layout:"vertical",children:(0,o.jsx)(we.Z.Item,{label:"Size",children:(0,o.jsxs)(yt.Z,{className:"full-width",value:d,onChange:f,children:[(0,o.jsx)(yt.Z.Option,{value:"veryfine",children:"Very fine"}),(0,o.jsx)(yt.Z.Option,{value:"fine",children:"Fine"}),(0,o.jsx)(yt.Z.Option,{value:"normal",children:"Normal"}),(0,o.jsx)(yt.Z.Option,{value:"coarse",children:"Coarse"}),(0,o.jsx)(yt.Z.Option,{value:"verycoarse",children:"Very coarse"})]})})}),"manual"===r&&(0,o.jsx)(Gt,{label:"Size",defaultValue:d,onValueChange:f,unit:"m"})]})})},Wt="Unable to update the simulation",qt=function(){var e=(0,i.Z)((function(e,n,t,i,a){var r,o,u,s,c,d,m,f,h;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),(r=ht.Z.deepCopy(e)).scheme.configuration.geometry.value=t.id,s={},c={},u=(0,M.Z)((0,N.Z)(s,r.scheme.configuration),(c.dimension=null!==(o=t.summary.dimension)&&void 0!==o?o:3,c.geometry=(0,M.Z)((0,N.Z)({},r.scheme.configuration.geometry),{done:!0}),c)),d={},m={},[4,ae.update((d.id=e.id,d),[(m.key="scheme",m.type="json",m.method="set",m.path=["configuration"],m.value=u,m)])];case 1:return l.sent(),a.mutateOneSimulation(r),f=n.find((function(e){return e.id===t.id})),i(f),[3,3];case 2:return h=l.sent(),(0,w.lt)(Wt,h),[3,3];case 3:return[2]}}))}));return function(n,t,i,a,r){return e.apply(this,arguments)}}(),Kt=function(e){var n=e.geometries,t=e.geometry,i=e.simulation,a=e.setGeometry,r=e.swr;!i.scheme.configuration.geometry.value&&t&&qt(i,n,t,a,r);var l=n.map((function(e){return(0,o.jsx)("div",{className:"Geometry-list",style:{backgroundColor:e.id===(null===t||void 0===t?void 0:t.id)?"#FFFBE6":"#FAFAFA"},onClick:function(){return qt(i,n,e,a,r)},children:(0,o.jsx)(m.Z.Text,{children:e.name})},e.id)}));return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(P.Z,{size:"small",children:(0,o.jsx)(m.Z.Text,{children:"When changing the simulation domain, you might lose your topological entity assignments"})}),(0,o.jsx)(P.Z,{size:"small",children:(0,o.jsx)(m.Z.Text,{strong:!0,children:"Select a simulation domain"})}),l,i.scheme.configuration.geometry.meshable&&(0,o.jsx)(Yt,{simulation:{id:i.id,scheme:i.scheme},swr:{mutateOneSimulation:r.mutateOneSimulation}})]})},Jt="Unable to delete the material",$t=function(){var e=(0,i.Z)((function(e,n,t,i){var a,o,u,s,c,d,m,f;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),a=ht.Z.deepCopy(e),o=a.scheme.configuration.materials,o.values[n].selected.forEach((function(e){t(Un(e))})),o.values=(0,r.Z)(o.values.slice(0,n)).concat((0,r.Z)(o.values.slice(n+1))),s={},c={},u=(0,M.Z)((0,N.Z)(s,o),(c.done=!!o.values.length,c)),d={},m={},[4,ae.update((d.id=e.id,d),[(m.key="scheme",m.type="json",m.method="set",m.path=["configuration","materials"],m.value=u,m)])];case 1:return l.sent(),i.mutateOneSimulation(a),[3,3];case 2:throw f=l.sent(),(0,w.lt)(Jt,f),f;case 3:return[2]}}))}));return function(n,t,i,a){return e.apply(this,arguments)}}(),Xt=function(e){var n=e.simulation,t=e.index,a=e.swr,r=(0,s.useState)(!1),u=r[0],c=r[1],d=(0,s.useContext)(I).dispatch,f=n.scheme.configuration.materials.values[t];return(0,o.jsx)(Z.m1,{loading:u,text:(0,o.jsxs)(o.Fragment,{children:["Are you sure you want to delete the material"," ",(0,o.jsx)(m.Z.Text,{strong:!0,children:f.material.label})]}),onDelete:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:c(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,$t(n,t,d,a)];case 2:return e.sent(),[3,4];case 3:return c(!1),[7];case 4:return[2]}}))}))})},Qt=function(e){var n,t=e.simulation,i=e.swr,a=e.onEdit,r=(0,s.useState)(!0),l=r[0],u=r[1],c=t.scheme.configuration.materials,d=(0,s.useContext)(I).dispatch,f=(0,s.useCallback)((function(e){d(_n());var n=c.values[e].selected;null===n||void 0===n||n.forEach((function(e){d(Dn(e))}))}),[c,d]),h=(0,s.useCallback)((function(){d(Nn())}),[d]);return(0,o.jsx)(o.Fragment,{children:null===(n=c.values)||void 0===n?void 0:n.map((function(e,n){return(0,o.jsx)(P.Z,{className:"material-item text-center",hoverable:!0,onMouseEnter:function(){return f(n)},onMouseLeave:function(){l&&h()},actions:[(0,o.jsx)(Z.w6,{onEdit:function(){u(!1),a(n),setTimeout((function(){return u(!0)}),500)}},"edit"),(0,o.jsx)(Xt,{index:n,simulation:{id:t.id,scheme:t.scheme},swr:{mutateOneSimulation:i.mutateOneSimulation}},"delete")],children:(0,o.jsx)(m.Z.Text,{strong:!0,className:"text-center",children:e.material.label})},n)})).filter((function(e){return e}))})},ei=t(20550),ni=t(13982),ti=t(14618),ii=t(94668),ai=t(68795),ri=function(e){var n,t=e.geometry,i=e.alreadySelected,a=e.updateSelected,r=(0,s.useState)([]),l=r[0],u=r[1],c=(0,s.useState)(),d=c[0],h=c[1],v=(0,s.useState)(),p=v[0],y=v[1],b=(0,s.useContext)(I),g=b.type,x=b.highlighted,j=b.selected,Z=b.dispatch;(0,s.useEffect)((function(){a(j)}),[a,j]),(0,s.useEffect)((function(){var e,n=[];g&&(null===(e=t.summary[g])||void 0===e||e.forEach((function(e){e.color&&(n.find((function(n){return n.r===e.color.r&&n.g===e.color.g&&n.b===e.color.b}))||n.push(e.color))}))),u(n)}),[t,g]);var w=function(){Z(Tn())},S=(0,s.useCallback)((function(e){h(e)}),[]),k=(0,s.useCallback)((function(e){var n=e.target.value;y(n)}),[]),E=(0,s.useCallback)((function(e){var n,t,i;return(!d||d.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&d.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&d.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&!(p&&e.name&&!e.name.includes(p))}),[d,p]);return(0,o.jsxs)(P.Z,{size:"small",className:"no-border-bottom",children:[(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,o.jsx)(m.Z.Text,{strong:!0,children:"Filters"}),(0,o.jsxs)(C.Z,{direction:"horizontal",wrap:!0,children:[l.length>1&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Ie.Z,{title:"Reset",children:(0,o.jsx)(f.Z,{icon:(0,o.jsx)(me.Z,{}),onClick:function(){return S()}})}),l.map((function(e){return(0,o.jsx)(Ie.Z,{title:"Color",children:(0,o.jsx)(f.Z,{style:{backgroundColor:ht.Z.rgbToHex(e)},onClick:function(){return S(e)},children:" "})},JSON.stringify(e))}))]}),(0,o.jsx)(Ie.Z,{title:"Select all",children:(0,o.jsx)(f.Z,{icon:(0,o.jsx)(ni.Z,{}),onClick:function(){var e;null===(e=t.summary[g])||void 0===e||e.forEach((function(e){var n,t,i;(!d||d&&d.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&d.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&d.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&Z(Dn({uuid:e.uuid,label:e.label}))}))}})}),(0,o.jsx)(Ie.Z,{title:"Unselect all",children:(0,o.jsx)(f.Z,{icon:(0,o.jsx)(ti.Z,{}),onClick:function(){var e;null===(e=t.summary[g])||void 0===e||e.forEach((function(e){var n,t,i;(!d||d&&d.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&d.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&d.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&Z(Un({uuid:e.uuid,label:e.label}))}))}})}),(0,o.jsx)(Ie.Z,{title:"Swap",children:(0,o.jsx)(f.Z,{icon:(0,o.jsx)(ii.Z,{}),onClick:function(){var e;null===(e=t.summary[g])||void 0===e||e.forEach((function(e){var n,t,i;(!d||d&&d.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&d.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&d.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&j.find((function(n){return n.uuid===e.uuid}))?Z(Un({uuid:e.uuid,label:e.label})):Z(Dn({uuid:e.uuid,label:e.label}))}))}})})]}),(0,o.jsx)(Se.Z,{placeholder:"Search",value:p,onChange:k,suffix:(0,o.jsx)(ai.Z,{className:"text-light"})})]}),(0,o.jsx)("div",{className:"full-width marginTop-20",children:g?null===(n=t.summary[g])||void 0===n?void 0:n.map((function(e,n){if(E(e)){var t="transparent",a="transparent";return j.find((function(n){return n.uuid===e.uuid}))&&(null===x||void 0===x?void 0:x.uuid)!==e.uuid?(t="#FAD114",a="rgba(255, 251, 230, 0.3)"):(null===x||void 0===x?void 0:x.uuid)===e.uuid&&(t="#FAD114",a="#FFFBE6"),(0,o.jsx)(P.Z,{className:"marginBottom-10",bodyStyle:{position:"relative",padding:"10px 10px 10px 40px",borderWidth:"2px",borderStyle:"solid",borderColor:t,backgroundColor:a},onMouseEnter:function(){return n={uuid:e.uuid,label:e.label},void Z(On(n));var n},onMouseLeave:w,onClick:function(){return n={uuid:e.uuid,label:e.label},void(j.find((function(e){return e.uuid===n.uuid}))?Z(Un(n)):Z(Dn(n)));var n},children:(0,o.jsxs)(C.Z,{direction:"vertical",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{position:"absolute",left:"-2px",top:"-2px",bottom:"-2px",width:"30px",backgroundColor:ht.Z.rgbToRgba(e.color,1)}}),e.name]}),null===i||void 0===i?void 0:i.map((function(n){if(n.selected.find((function(n){return n.uuid===e.uuid})))return(0,o.jsx)(ei.Z,{color:ht.Z.stringToColor(n.label),children:n.label},e.uuid)}))]})},n)}})):[]})]})},li=t(95507),oi=t(13520),ui={metal:{label:"Metal",children:[{key:"steel",label:"Generic Steel",children:[{label:"Density",symbol:"Rho",value:7850},{label:"Young's modulus",symbol:"E",value:21e8},{label:"Poisson's ratio",symbol:"Nu",value:.3},{label:"Thermal conductivity",symbol:"Lambda",value:15},{label:"Heat capacity",symbol:"Cp",value:502}]},{key:"S235JR+AR",label:"Steel (S235JR+AR)",children:[{label:"Density",symbol:"Rho",value:7850},{label:"Young's modulus",symbol:"E",value:21e8},{label:"Poisson's ratio",symbol:"Nu",value:.27},{label:"Thermal conductivity",symbol:"Lambda",value:15},{label:"Heat capacity",symbol:"Cp",value:502}]},{key:"304",label:"Stainless Steel 304",children:[{label:"Density",symbol:"Rho",value:8e3},{label:"Young's modulus",symbol:"E",value:193e9},{label:"Poisson's ratio",symbol:"Nu",value:.29},{label:"Thermal conductivity",symbol:"Lambda",value:16.2},{label:"Heat capacity",symbol:"Cp",value:500},{label:"Yield strength",symbol:"SigmaY",value:215e6}]},{key:"316L",label:"Stainless Steel 316L",children:[{label:"Density",symbol:"Rho",value:7990},{label:"Young's modulus",symbol:"E",value:193e9},{label:"Poisson's ratio",symbol:"Nu",value:.25},{label:"Thermal conductivity",symbol:"Lambda",value:16.2},{label:"Heat capacity",symbol:"Cp",value:500},{label:"Yield strength",symbol:"SigmaY",value:29e7}]},{key:"6082-O",label:"Aluminium 6082-O",children:[{label:"Density",symbol:"Rho",value:2700},{label:"Young's modulus",symbol:"E",value:69e9},{label:"Poisson's ratio",symbol:"Nu",value:.33},{label:"Thermal conductivity",symbol:"Lambda",value:170},{label:"Heat capacity",symbol:"Cp",value:960},{label:"Yield strength",symbol:"SigmaY",value:6e7}]},{key:"7075-O",label:"Aluminium 7075-O",children:[{label:"Density",symbol:"Rho",value:2810},{label:"Young's modulus",symbol:"E",value:717e8},{label:"Poisson's ratio",symbol:"Nu",value:.33},{label:"Thermal conductivity",symbol:"Lambda",value:173},{label:"Heat capacity",symbol:"Cp",value:960},{label:"Yield strength",symbol:"SigmaY",value:11e7}]},{key:"2017A",label:"Aluminium 2017A",children:[{label:"Density",symbol:"Rho",value:2790},{label:"Young's modulus",symbol:"E",value:725e8},{label:"Poisson's ratio",symbol:"Nu",value:.33},{label:"Thermal conductivity",symbol:"Lambda",value:134},{label:"Heat capacity",symbol:"Cp",value:873},{label:"Yield strength",symbol:"SigmaY",value:275e6}]}]},polymer:{label:"Polymer",children:[{key:"PMMA",label:"PMMA",children:[{label:"Density",symbol:"Rho",value:1180},{label:"Young's modulus",symbol:"E",value:29e8},{label:"Poisson's ratio",symbol:"Nu",value:.36},{label:"Thermal conductivity",symbol:"Lambda",value:.193},{label:"Heat capacity",symbol:"Cp",value:1480},{label:"Yield strength",symbol:"SigmaY",value:69e6}]}]},fluid:{label:"Fluid",children:[{key:"water",label:"Water",children:[{label:"Density",symbol:"Rho",value:1e3},{label:"Dynamic viscosity",symbol:"Mu",value:.001},{label:"Thermal conductivity",symbol:"Lambda",value:.6},{label:"Heat capacity",symbol:"Cp",value:4185}]}]}},si=function(e){var n=e.onSelect,t=(0,s.useState)(),i=t[0],a=t[1],r=(0,s.useState)(),l=r[0],u=r[1],m=(0,s.useState)(),h=m[0],v=m[1],p=Object.keys(ui),y=(0,s.useCallback)((function(e){var n=e.key;u({key:n,children:ui[n].children}),v(void 0)}),[]),b=(0,s.useCallback)((function(e){var n=e.key,t=ui[l.key].children.find((function(e){return e.key===n}));v(t)}),[l]),g=(0,s.useCallback)((function(e){n(e),a(!1)}),[n]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(f.Z,{icon:(0,o.jsx)(oi.Z,{}),onClick:function(){return a(!0)},className:"full-width",children:"Pick a material"}),(0,o.jsx)(bt.Z,{visible:i,title:"Material database",onCancel:function(){return a(!1)},onOk:function(){return g(h)},okText:"Choose",okButtonProps:{disabled:!h},width:"50%",children:(0,o.jsx)(c.Z,{children:(0,o.jsx)(c.Z.Content,{children:(0,o.jsxs)(C.Z,{style:{alignItems:"stretch"},children:[(0,o.jsx)(d.Z,{mode:"inline",items:p.map((function(e){return{key:e,label:ui[e].label}})),onClick:y}),(0,o.jsx)(d.Z,{mode:"inline",items:null===l||void 0===l?void 0:l.children.map((function(e){return{key:e.key,label:e.label}})),onClick:b}),h&&(0,o.jsx)(li.ZP,{itemLayout:"vertical",children:h.children.map((function(e){return(0,o.jsxs)(li.ZP.Item,{children:[e.label,": ",e.symbol," = ",e.value]},e.label)}))})]})})})})]})},ci="You need to define a material",di="You need to select a solid",mi="Unable to add the material",fi=function(){var e=(0,i.Z)((function(e,n,t){var i,a,o,u,s,c,d,m,f;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),(i=ht.Z.deepCopy(n)).uuid=(0,on.Z)(),a=ht.Z.deepCopy(e),(o=a.scheme.configuration.materials).values=(0,r.Z)(o.values||[]).concat([i]),s={},c={},u=(0,M.Z)((0,N.Z)(s,o),(c.done=!0,c)),d={},m={},[4,ae.update((d.id=e.id,d),[(m.key="scheme",m.type="json",m.method="set",m.path=["configuration","materials"],m.value=u,m)])];case 1:return l.sent(),t.mutateOneSimulation(a),[3,3];case 2:throw f=l.sent(),(0,w.lt)(mi,f),f;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),hi=function(e){var n=e.simulation,t=e.material,a=e.swr,r=e.onError,u=e.onClose,c=(0,s.useState)(!1),d=c[0],m=c[1];return(0,o.jsx)(Z.HS,{loading:d,needMargin:!0,onAdd:(0,i.Z)((function(){var e;return(0,l.__generator)(this,(function(i){switch(i.label){case 0:m(!0),i.label=1;case 1:return i.trys.push([1,3,,4]),t.material?(null===(e=t.selected)||void 0===e?void 0:e.length)?(r(),[4,fi(n,t,a)]):(r(di),m(!1),[2]):(r(ci),m(!1),[2]);case 2:return i.sent(),m(!1),u(),[3,4];case 3:return i.sent(),m(!1),[3,4];case 4:return[2]}}))})),children:"Add"})},vi="You need to define a material",pi="You need to select a solid",yi="Unable to edit the material",bi=function(){var e=(0,i.Z)((function(e,n,t){var i,a,o,u,s,c,d,m;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),i=ht.Z.deepCopy(e),a=i.scheme.configuration.materials,o=a.values.findIndex((function(e){return e.uuid===n.uuid})),a.values=(0,r.Z)(a.values.slice(0,o)).concat([n],(0,r.Z)(a.values.slice(o+1))),s={},u=(0,N.Z)(s,a),c={},d={},[4,ae.update((c.id=e.id,c),[(d.key="scheme",d.type="json",d.method="set",d.path=["configuration","materials"],d.value=u,d)])];case 1:return l.sent(),t.mutateOneSimulation(i),[3,3];case 2:throw m=l.sent(),(0,w.lt)(yi,m),m;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),gi=function(e){var n=e.simulation,t=e.material,a=e.swr,r=e.onError,u=e.onClose,c=(0,s.useState)(!1),d=c[0],m=c[1];return(0,o.jsx)(Z.w6,{loading:d,primary:!0,needMargin:!0,onEdit:(0,i.Z)((function(){var e;return(0,l.__generator)(this,(function(i){switch(i.label){case 0:m(!0),i.label=1;case 1:return i.trys.push([1,3,,4]),t.material?(null===(e=t.selected)||void 0===e?void 0:e.length)?(r(),[4,bi(n,t,a)]):(r(pi),m(!1),[2]):(r(vi),m(!1),[2]);case 2:return i.sent(),m(!1),u(),[3,4];case 3:return i.sent(),m(!1),[3,4];case 4:return[2]}}))})),children:"Edit"})},xi=function(e){var n,t,i=e.visible,a=e.geometry,l=e.simulation,u=e.material,c=e.swr,d=e.onClose,h=(0,s.useState)(),v=h[0],p=h[1],b=(0,s.useState)(),g=b[0],x=b[1],j=(0,s.useState)(),w=j[0],S=j[1],k=l.scheme.configuration.materials;(0,s.useEffect)((function(){!i&&g&&x(void 0)})),(0,s.useEffect)((function(){i&&!g&&u&&x(u)}),[g,i,u]),(0,s.useEffect)((function(){var e,n=null===k||void 0===k||null===(e=k.values)||void 0===e?void 0:e.map((function(e){if(e.uuid!==(null===u||void 0===u?void 0:u.uuid))return{label:e.material.label,selected:e.selected}})).filter((function(e){return e}));p(n||[])}),[l,u,k]);var E,_,O,T,D=(0,s.useCallback)((function(e){x((function(n){return(0,M.Z)((0,N.Z)({},n),{material:e})}))}),[]),U=(0,s.useCallback)((function(e){x((function(n){return(0,M.Z)((0,N.Z)({},n),{selected:e})}))}),[]),z=(0,s.useCallback)((function(e,n,t){x((function(i){var a,l,o,u;return(0,M.Z)((0,N.Z)({},i),{material:{label:"Custom",children:(0,r.Z)((null===i||void 0===i||null===(a=i.material)||void 0===a||null===(l=a.children)||void 0===l?void 0:l.slice(0,n))||[]).concat([{label:e.label,symbol:e.name,value:t}],(0,r.Z)((null===i||void 0===i||null===(o=i.material)||void 0===o||null===(u=o.children)||void 0===u?void 0:u.slice(n+1))||[]))}})}))}),[]);return(0,o.jsx)(tt.Z,{className:"material",title:"Material",placement:"left",closable:!1,visible:i,mask:!1,maskClosable:!1,width:300,extra:(0,o.jsx)(f.Z,{type:"text",icon:(0,o.jsx)(me.Z,{}),onClick:function(){x(void 0),d()}}),footer:(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,o.jsx)(Z.Lw,{onCancel:function(){x(void 0),d()}}),u?(0,o.jsx)(gi,{material:{uuid:null!==(E=null===g||void 0===g?void 0:g.uuid)&&void 0!==E?E:u.uuid,material:null!==(_=null===g||void 0===g?void 0:g.material)&&void 0!==_?_:u.material,selected:null!==(O=null===g||void 0===g?void 0:g.selected)&&void 0!==O?O:u.selected},simulation:{id:l.id,scheme:l.scheme},swr:{mutateOneSimulation:c.mutateOneSimulation},onError:function(e){return S(e)},onClose:d}):(0,o.jsx)(hi,{material:{material:null===g||void 0===g?void 0:g.material,selected:null===g||void 0===g?void 0:g.selected},simulation:{id:l.id,scheme:l.scheme},swr:{mutateOneSimulation:c.mutateOneSimulation},onError:function(e){return S(e)},onClose:d})]}),children:(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,o.jsx)(P.Z,{size:"small",children:(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,o.jsx)(si,{onSelect:D}),(0,o.jsxs)(m.Z.Text,{children:["Material: ",null!==(T=null===g||void 0===g||null===(n=g.material)||void 0===n?void 0:n.label)&&void 0!==T?T:"default"]}),null===k||void 0===k||null===(t=k.children)||void 0===t?void 0:t.map((function(e,n){var t,i,a=null===g||void 0===g||null===(t=g.material)||void 0===t||null===(i=t.children)||void 0===i?void 0:i.find((function(n){return n.symbol===e.name}));return(0,o.jsx)(Gt,{label:e.name,defaultValue:a?a.value:String(e.default),unit:e.unit,onValueChange:function(t){z(e,n,t)}},e.name)}))]})}),(0,o.jsx)(ri,{geometry:a,alreadySelected:v,updateSelected:U}),w&&(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)(y.Z,{style:{color:"red"}})," ",w]})]})})},ji=function(e){var n=e.geometry,t=e.simulation,i=e.swr,a=e.setVisible,r=(0,s.useState)(),l=r[0],u=r[1],d=(0,s.useState)(!1),m=d[0],f=d[1],h=(0,s.useContext)(I).dispatch,v=t.scheme.configuration.materials;(0,s.useEffect)((function(){(null===n||void 0===n?void 0:n.summary)&&h(Mn(2===n.summary.dimension?"faces":"solids"))}),[n,h]);var p=(0,s.useCallback)((function(){u(void 0),f(!0),a(!1),h(_n())}),[h,a]),y=(0,s.useCallback)((function(e){var n=v.values[e];u(n),f(!0),a(!1),h(_n())}),[v,h,a]),b=(0,s.useCallback)((function(){h(Nn()),f(!1),u(void 0),a(!0)}),[h,a]);return n?(0,o.jsx)(c.Z,{children:(0,o.jsx)(c.Z.Content,{children:(0,o.jsxs)(P.Z,{size:"small",children:[(0,o.jsx)(Z.HS,{onAdd:p,fullWidth:!0,primary:!1,children:"Add material"}),(0,o.jsx)(Qt,{simulation:{id:t.id,scheme:t.scheme},swr:i,onEdit:y}),(0,o.jsx)(xi,{visible:m,geometry:{summary:n.summary},simulation:{id:t.id,scheme:t.scheme},material:l&&{uuid:l.uuid,material:l.material,selected:l.selected},swr:{mutateOneSimulation:i.mutateOneSimulation},onClose:b})]})})}):(0,o.jsx)(S.Z.Simple,{})},Zi=t(54907),wi="Unable to update the simulation",Si=function(){var e=(0,i.Z)((function(e,n){var t,i,a,r,o,u,s,c;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),t=ht.Z.deepCopy(e),i=t.scheme.configuration.parameters,r={},o={},a=(0,M.Z)((0,N.Z)(r,i),(o.done=!0,o)),u={},s={},[4,ae.update((u.id=e.id,u),[(s.key="scheme",s.type="json",s.method="set",s.path=["configuration","parameters"],s.value=a,s)])];case 1:return l.sent(),n.mutateOneSimulation(t),[3,3];case 2:return c=l.sent(),(0,w.lt)(wi,c),[3,3];case 3:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),Pi=function(){var e=(0,i.Z)((function(e,n,t,i,a){var r,o,u,s,c,d,m,f;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),r=ht.Z.deepCopy(e),o=r.scheme.configuration.parameters,o[n].children[t].value=i,s={},c={},u=(0,M.Z)((0,N.Z)(s,o),(c.done=!0,c)),d={},m={},[4,ae.update((d.id=e.id,d),[(m.key="scheme",m.type="json",m.method="set",m.path=["configuration","parameters"],m.value=u,m)])];case 1:return l.sent(),a.mutateOneSimulation(r),[3,3];case 2:return f=l.sent(),(0,w.lt)(wi,f),[3,3];case 3:return[2]}}))}));return function(n,t,i,a,r){return e.apply(this,arguments)}}(),Ci=function(e){var n=e.simulation,t=e.swr,i=null===n||void 0===n?void 0:n.scheme.configuration.parameters,a=null===n||void 0===n?void 0:n.scheme.configuration.dimension;(0,s.useEffect)((function(){(null===i||void 0===i?void 0:i.done)||Si(n,t)}),[n,i,t]);var r=[],l=[];return 2===a?Object.keys(i).forEach((function(e){if("index"!==e&&"title"!==e&&"done"!=e){var a=i[e],u=null===a||void 0===a?void 0:a.children.map((function(i,a){if(!i.only3D)return"formula"===i.htmlEntity?function(e,n,t){return(0,o.jsx)(Gt,{label:n.label2D||n.label,defaultValue:null!==(De=n.value)&&void 0!==De?De:n.default,onValueChange:t,unit:n.unit},e)}(e+"&"+a,i,(function(i){return Pi(n,e,a,i,t)})):"select"===i.htmlEntity?function(e,n,t){var i;return(0,o.jsx)(we.Z,{layout:"vertical",children:(0,o.jsx)(we.Z.Item,{label:n.label2D||n.label,children:(0,o.jsx)(yt.Z,{options:null===(i=n.options)||void 0===i?void 0:i.map((function(e){return{label:e.label,value:null!==(Ue=e.value2D)&&void 0!==Ue?Ue:e.value}})),defaultValue:n.value||n.default2D||n.default,onChange:t})})},e)}(e+"&"+a,i,(function(i){return Pi(n,e,a,i,t)})):"checkbox"===i.htmlEntity?function(e,n,t){return(0,o.jsx)(we.Z,{layout:"vertical",children:(0,o.jsx)(we.Z.Item,{label:n.label2D||n.label,children:(0,o.jsx)(nt.Z,{defaultChecked:n.value,onChange:t})})},e)}(e+"&"+a,i,(function(i){return Pi(n,e,a,i.target.checked,t)})):void 0}));(null===a||void 0===a?void 0:a.advanced)?l.push((0,o.jsx)(P.Z,{size:"small",title:null===a||void 0===a?void 0:a.label,children:(0,o.jsx)(C.Z,{direction:"vertical",children:u})},e)):r.push((0,o.jsx)(P.Z,{size:"small",title:null===a||void 0===a?void 0:a.label,children:(0,o.jsx)(C.Z,{direction:"vertical",children:u})},e))}})):Object.keys(i).forEach((function(e){if("index"!==e&&"title"!==e&&"done"!=e){var a=i[e],u=null===a||void 0===a?void 0:a.children.map((function(i,a){return"formula"===i.htmlEntity?function(e,n,t){return(0,o.jsx)(Gt,{label:n.label,defaultValue:null!==(ze=n.value)&&void 0!==ze?ze:n.default,onValueChange:t,unit:n.unit},e)}(e+"&"+a,i,(function(i){return Pi(n,e,a,i,t)})):"select"===i.htmlEntity?function(e,n,t){return(0,o.jsx)(we.Z,{layout:"vertical",children:(0,o.jsx)(we.Z.Item,{label:n.label,children:(0,o.jsx)(yt.Z,{options:n.options,defaultValue:n.value||n.default,onChange:t})})},e)}(e+"&"+a,i,(function(i){return Pi(n,e,a,i,t)})):"checkbox"===i.htmlEntity?function(e,n,t){return(0,o.jsx)(we.Z,{layout:"vertical",children:(0,o.jsx)(we.Z.Item,{label:n.label,children:(0,o.jsx)(nt.Z,{defaultChecked:n.value,onChange:t})})},e)}(e+"&"+a,i,(function(i){return Pi(n,e,a,i.target.checked,t)})):void 0}));(null===a||void 0===a?void 0:a.advanced)?l.push((0,o.jsx)(P.Z,{size:"small",title:null===a||void 0===a?void 0:a.label,children:(0,o.jsx)(C.Z,{direction:"vertical",children:u})},e)):r.push((0,o.jsx)(P.Z,{size:"small",title:null===a||void 0===a?void 0:a.label,children:(0,o.jsx)(C.Z,{direction:"vertical",children:u})},e))}})),(0,o.jsx)(c.Z,{children:(0,o.jsx)(c.Z.Content,{children:(0,o.jsxs)(C.Z,{direction:"vertical",children:[r,(0,o.jsx)(Zi.Z,{children:(0,o.jsx)(Zi.Z.Panel,{header:"Advanced",children:(0,o.jsx)(C.Z,{direction:"vertical",children:l})},"advanced")})]})})})},ki=function(e,n){return e.map((function(e){var t=e.fileName.replace(new RegExp(n.prefixPattern),"").replace(new RegExp(n.suffixPattern),"");return(0,M.Z)((0,N.Z)({},e),{number:+t})}))},Ei=function(e,n){var t=n.multiplicator;if(t){var i,a=t.reduce((function(e,n){return e[n]}),e);return null!==(i=a.value)&&void 0!==i?i:a.default}},_i="Unable to update simulation",Ni=function(){var e=(0,i.Z)((function(e,n,t){var i,a,r,o,u;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),i=ht.Z.deepCopy(e),(a=i.scheme.configuration.initialization).value={type:n},r={},o={},[4,ae.update((r.id=e.id,r),[(o.key="scheme",o.type="json",o.method="set",o.path=["configuration","initialization"],o.value=a,o)])];case 1:return l.sent(),t.mutateOneSimulation(i),[3,3];case 2:throw u=l.sent(),(0,w.lt)(_i,u),u;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Mi=function(){var e=(0,i.Z)((function(e,n,t,i){var a,r,o,u,s,c,d;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,3,,4]),[4,Di(e,t)];case 1:return r=l.sent(),o=ht.Z.deepCopy(n),(u=o.scheme.configuration.initialization).value=(0,M.Z)((0,N.Z)({},u.value),{simulation:t,result:null===r||void 0===r||null===(a=r[0])||void 0===a?void 0:a.value}),s={},c={},[4,ae.update((s.id=n.id,s),[(c.key="scheme",c.type="json",c.method="set",c.path=["configuration","initialization"],c.value=u,c)])];case 2:return l.sent(),i.mutateOneSimulation(o),[3,4];case 3:throw d=l.sent(),(0,w.lt)(_i,d),d;case 4:return[2]}}))}));return function(n,t,i,a){return e.apply(this,arguments)}}(),Oi=function(){var e=(0,i.Z)((function(e,n,t,i){var a,r,o,u,s;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),a=ht.Z.deepCopy(e),(r=a.scheme.configuration.initialization).value=(0,M.Z)((0,N.Z)({},r.value),{number:+n,result:t.file}),o={},u={},[4,ae.update((o.id=e.id,o),[(u.key="scheme",u.type="json",u.method="set",u.path=["configuration","initialization"],u.value=r,u)])];case 1:return l.sent(),i.mutateOneSimulation(a),[3,3];case 2:return s=l.sent(),(0,w.lt)(_i,s),[3,3];case 3:return[2]}}))}));return function(n,t,i,a){return e.apply(this,arguments)}}(),Ti=function(){var e=(0,i.Z)((function(e,n,t,i){var a,r,o,u,s;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),a=ht.Z.deepCopy(e),(r=a.scheme.configuration.initialization).value.values||(r.value.values=[]),r.value.values[n]=t,o={},u={},[4,ae.update((o.id=e.id,o),[(u.key="scheme",u.type="json",u.method="set",u.path=["configuration","initialization"],u.value=r,u)])];case 1:return l.sent(),i.mutateOneSimulation(a),[3,3];case 2:return s=l.sent(),(0,w.lt)(_i,s),[3,3];case 3:return[2]}}))}));return function(n,t,i,a){return e.apply(this,arguments)}}(),Di=function(){var e=(0,i.Z)((function(e,n){var t,i,a,o,u,s,c;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return a={},[4,ae.tasks((a.id=n,a))];case 1:return i=l.sent(),o=e.find((function(e){return e.id===n})),u=o.scheme.configuration,s=null===u||void 0===u||null===(t=u.run)||void 0===t?void 0:t.resultsFilter,c=[],i.forEach((function(e){if(e.file&&"result"===e.file.type&&c.push({label:e.file.fileName,value:e.file.fileName,file:e.file.fileName}),e.files)if(s){var n,t,i=new RegExp(s.pattern),a=e.files.filter((function(e){return!i.test(e.fileName)})).filter((function(e){return"result"===e.type})),l=e.files.filter((function(e){return i.test(e.fileName)})),o=ki(l,s).map((function(e){return{number:e.number,fileName:e.fileName.replace(new RegExp(s.suffixPattern),"")}})).filter((function(e,n,t){return t.findIndex((function(n){return n.number===e.number}))===n})).sort((function(e,n){return e.number-n.number})),d=Ei(u,s),m=o.map((function(e,n){var t=d?e.number*d:n,i=Math.round(1e15*t)/1e15;return{label:String(i),value:e.fileName,file:e.fileName}}));(n=c).push.apply(n,(0,r.Z)(a.map((function(e){return{label:e.fileName,value:e.fileName,file:e.fileName}})).filter((function(e){return e})))),(t=c).push.apply(t,(0,r.Z)(m))}else e.files.forEach((function(e){"result"===e.type&&c.push({label:e.fileName,value:e.fileName,file:e.fileName})}))})),[2,c]}}))}));return function(n,t){return e.apply(this,arguments)}}(),Ui=function(e){var n=e.simulations,t=e.simulation,a=e.swr,r=(0,s.useState)(!1),u=r[0],d=r[1],f=(0,s.useState)(),h=f[0],v=f[1],p=(0,s.useState)(),y=p[0],b=p[1],g=(0,s.useState)(),x=g[0],j=g[1],Z=null===t||void 0===t?void 0:t.scheme.configuration.initialization,w=null===t||void 0===t?void 0:t.scheme.configuration.dimension,S=(0,s.useCallback)((function(e){var t=n.find((function(n){return n.id===e}));b(t)}),[n]);(0,s.useEffect)((function(){var e,n;!h&&Z.value&&v(Z.value.type),!y&&(null===(e=Z.value)||void 0===e?void 0:e.simulation)&&S(null===(n=Z.value)||void 0===n?void 0:n.simulation)}),[Z,h,y,S]),(0,s.useEffect)((function(){y&&Di(n,y.id).then((function(e){return j(e)}))}),[n,y]);var k=[{label:"None",value:"none"}];Z.coupling&&k.push({label:Z.coupling.label,value:"coupling"}),Z.direct&&k.push({label:Z.direct.label,value:"direct"});var E={none:(0,o.jsx)("div",{})},_=Z.value,N=Z.coupling;if(null===N||void 0===N?void 0:N.compatibility){var M=n.map((function(e){var n=e.id===t.id||!N.compatibility.find((function(n){return n.algorithm===e.scheme.algorithm}));return{label:e.name,value:e.id,disabled:n}})),O=N.compatibility.find((function(e){var n;return e.algorithm===(null===y||void 0===y||null===(n=y.scheme)||void 0===n?void 0:n.algorithm)})),T=null===O||void 0===O?void 0:O.filter;E.coupling=function(e,r){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(m.Z.Text,{children:"If you use coupling, the selected simulation mesh will be used, at least for the first iteration."}),(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width marginTop-10",children:[(0,o.jsx)(yt.Z,{className:"full-width",options:e,placeholder:"Select a simulation",value:null===_||void 0===_?void 0:_.simulation,onChange:function(){var e=(0,i.Z)((function(e){return(0,l.__generator)(this,(function(i){switch(i.label){case 0:d(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,Mi(n,t,e,a)];case 2:return i.sent(),S(e),[3,5];case 3:return i.sent(),[3,5];case 4:return d(!1),[7];case 5:return[2]}}))}));return function(n){return e.apply(this,arguments)}}()}),u&&(0,o.jsx)(We.Z,{}),(null===x||void 0===x?void 0:x.length)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(m.Z.Text,{children:[null===r||void 0===r?void 0:r.name,":"]},"simulation"),(0,o.jsx)(yt.Z,{className:"full-width",options:x,placeholder:"Select a "+r.name,value:null===_||void 0===_?void 0:_.result,onChange:function(){var e=(0,i.Z)((function(e,n){return(0,l.__generator)(this,(function(i){return Oi(t,e,n,a),[2]}))}));return function(n,t){return e.apply(this,arguments)}}()})]}):(0,o.jsx)(m.Z.Text,{type:"danger",children:"No results, please select an other simulation."})]})]})}(M,T)}var D=Z.direct;return(null===D||void 0===D?void 0:D.children)&&(E.direct=function(e){return(0,o.jsx)(C.Z,{direction:"vertical",className:"full-width",children:e.children.map((function(e,n){var i,r;if(2!==w||!e.only3D)return(0,o.jsx)(Gt,{label:e.label,defaultValue:(null!==(r=null===_||void 0===_||null===(i=_.values)||void 0===i?void 0:i[n])&&void 0!==r?r:e.default).toString(),unit:e.unit,onValueChange:function(e){return Ti(t,n,e,a)}},n)}))})}(D)),(0,o.jsx)(c.Z,{children:(0,o.jsx)(c.Z.Content,{children:(0,o.jsxs)(P.Z,{size:"small",children:[(0,o.jsx)(yt.Z,{className:"full-width marginBottom-10",defaultValue:"none",value:h,options:k,onChange:function(){var e=(0,i.Z)((function(e){return(0,l.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Ni(t,e,a)];case 1:return n.sent(),v(e),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}()}),E[h||"none"]]})})})},zi="Unable to delete the boundary condition",Fi=function(){var e=(0,i.Z)((function(e,n,t,i,a){var o,u,s,c,d,m,f,h,v,p;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),o=ht.Z.deepCopy(e),u=o.scheme.configuration.boundaryConditions,s=u[n],s.values[t].selected.forEach((function(e){i(Un(e))})),s.values=(0,r.Z)(s.values.slice(0,t)).concat((0,r.Z)(s.values.slice(t+1))),c=!1,Object.keys(u).forEach((function(e){var n;"index"!==e&&"title"!==e&&"done"!==e&&((null===(n=u[e].values)||void 0===n?void 0:n.length)&&(c=!0))})),m={},f={},d=(0,M.Z)((0,N.Z)(m,u),(f.done=c,f)),h={},v={},[4,ae.update((h.id=e.id,h),[(v.key="scheme",v.type="json",v.method="set",v.path=["configuration","boundaryConditions"],v.value=d,v)])];case 1:return l.sent(),a.mutateOneSimulation(o),[3,3];case 2:throw p=l.sent(),(0,w.lt)(zi,p),p;case 3:return[2]}}))}));return function(n,t,i,a,r){return e.apply(this,arguments)}}(),Ri=function(e){var n=e.type,t=e.index,a=e.simulation,r=e.swr,u=(0,s.useState)(!1),c=u[0],d=u[1],f=(0,s.useContext)(I).dispatch,h=a.scheme.configuration.boundaryConditions[n].values[t];return(0,o.jsx)(Z.m1,{loading:c,onDelete:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:d(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Fi(a,n,t,f,r)];case 2:return e.sent(),[3,4];case 3:return d(!1),[7];case 4:return[2]}}))})),text:(0,o.jsxs)(o.Fragment,{children:["Are you sure you want to delete the condition"," ",(0,o.jsx)(m.Z.Text,{strong:!0,children:null===h||void 0===h?void 0:h.name}),"?"]})})},Ai=function(e){var n=e.simulation,t=e.swr,i=e.onEdit,a=(0,s.useState)(!0),r=a[0],l=a[1],u=n.scheme.configuration.boundaryConditions,c=(0,s.useContext)(I).dispatch,d=(0,s.useCallback)((function(e,n){c(_n());var t=u[e].values[n].selected;null===t||void 0===t||t.forEach((function(e){c(Dn(e))}))}),[u,c]),f=(0,s.useCallback)((function(){c(Nn())}),[c]);return(0,o.jsx)(o.Fragment,{children:Object.keys(u).map((function(e){var a;if("index"!==e&&"title"!==e&&"done"!==e){var s=u[e];return null===(a=s.values)||void 0===a?void 0:a.map((function(a,u){return(0,o.jsxs)(P.Z,{className:"boundaryCondition-item",hoverable:!0,onMouseEnter:function(){return d(e,u)},onMouseLeave:function(){r&&f()},actions:[(0,o.jsx)(Z.w6,{onEdit:function(){l(!1),i(e,u),setTimeout((function(){return l(!0)}),500)}},"edit"),(0,o.jsx)(Ri,{simulation:{id:n.id,scheme:n.scheme},type:e,index:u,swr:{mutateOneSimulation:t.mutateOneSimulation}},"delete")],children:[(0,o.jsx)(m.Z.Text,{strong:!0,children:a.name})," ",(0,o.jsxs)(m.Z.Text,{children:["(",s.label,")"]})]},u)}))}})).filter((function(e){return e}))})},Li=t(29924),Vi="You need to define a name",Gi="You need to select a type",Ii="You need to select a face",Bi="Unable to add the boundary condition",Hi=function(){var e=(0,i.Z)((function(e,n,t){var i,a,o,u,s,c,d,m,f,h,v,p;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),a={},i=(0,N.Z)(a,n),o=i.type.key,i.uuid=(0,on.Z)(),u=ht.Z.deepCopy(e),s=u.scheme.configuration.boundaryConditions,(c=s[o]).values=(0,r.Z)(c.values||[]).concat([i]),m={},f={},d=(0,M.Z)((0,N.Z)(m,s),(f.done=!0,f)),h={},v={},[4,ae.update((h.id=e.id,h),[(v.key="scheme",v.type="json",v.method="set",v.path=["configuration","boundaryConditions"],v.value=d,v)])];case 1:return l.sent(),t.mutateOneSimulation(u),[3,3];case 2:throw p=l.sent(),(0,w.lt)(Bi,p),p;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Yi=function(e){var n=e.simulation,t=e.boundaryCondition,a=e.swr,r=e.onError,u=e.onClose,c=(0,s.useState)(!1),d=c[0],m=c[1];return(0,o.jsx)(Z.HS,{loading:d,onAdd:(0,i.Z)((function(){var e,i;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:m(!0),l.label=1;case 1:return l.trys.push([1,3,,4]),t.name?(null===(e=t.type)||void 0===e?void 0:e.key)?(null===(i=t.selected)||void 0===i?void 0:i.length)?(r(),[4,Hi(n,t,a)]):(r(Ii),m(!1),[2]):(r(Gi),m(!1),[2]):(r(Vi),m(!1),[2]);case 2:return l.sent(),m(!1),u(),[3,4];case 3:return l.sent(),m(!1),[3,4];case 4:return[2]}}))})),needMargin:!0,children:"Add"})},Wi="You need to define a name",qi="You need to select a type",Ki="You need to select a face",Ji="Unable to edit the boundary condition",$i=function(){var e=(0,i.Z)((function(e,n,t,i){var a,o,u,s,c,d,m,f,h,v,p,y,b,g;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),a=ht.Z.deepCopy(e),o=a.scheme.configuration.boundaryConditions,u=n.type.key,(s=t.type.key)!==u&&(c=o[s],d=c.values.findIndex((function(e){return e.uuid===t.uuid})),c.values=(0,r.Z)(c.values.slice(0,d)).concat((0,r.Z)(c.values.slice(d+1)))),s!==u?(m=o[u]).values=(0,r.Z)(m.values||[]).concat([n]):(f=o[u],h=f.values.findIndex((function(e){return e.uuid===n.uuid})),f.values=(0,r.Z)(f.values.slice(0,h)).concat([n],(0,r.Z)(f.values.slice(h+1)))),p={},v=(0,N.Z)(p,o),y={},b={},[4,ae.update((y.id=e.id,y),[(b.key="scheme",b.type="json",b.method="set",b.path=["configuration","boundaryConditions"],b.value=v,b)])];case 1:return l.sent(),i.mutateOneSimulation(a),[3,3];case 2:throw g=l.sent(),(0,w.lt)(Ji,g),g;case 3:return[2]}}))}));return function(n,t,i,a){return e.apply(this,arguments)}}(),Xi=function(e){var n=e.simulation,t=e.boundaryCondition,a=e.oldBoundaryCondition,r=e.swr,u=e.onError,c=e.onClose,d=(0,s.useState)(!1),m=d[0],f=d[1];return(0,o.jsx)(Z.w6,{loading:m,onEdit:(0,i.Z)((function(){var e,i;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:f(!0),l.label=1;case 1:return l.trys.push([1,3,,4]),t.name?(null===(e=t.type)||void 0===e?void 0:e.key)?(null===(i=t.selected)||void 0===i?void 0:i.length)?(u(),[4,$i(n,t,a,r)]):(u(Ki),f(!1),[2]):(u(qi),f(!1),[2]):(u(Wi),f(!1),[2]);case 2:return l.sent(),f(!1),c(),[3,4];case 3:return l.sent(),f(!1),[3,4];case 4:return[2]}}))})),primary:!0,needMargin:!0,children:"Edit"})},Qi=function(e){var n,t,i=e.visible,a=e.geometry,l=e.simulation,u=e.boundaryCondition,c=e.swr,d=e.onClose,h=(0,s.useState)([]),v=h[0],p=h[1],b=(0,s.useState)([]),g=b[0],x=b[1],j=(0,s.useState)(),w=j[0],S=j[1],k=(0,s.useState)(),E=k[0],_=k[1],O=(0,s.useState)(),T=O[0],D=O[1],U=l.scheme.configuration.boundaryConditions,z=l.scheme.configuration.dimension;(0,s.useEffect)((function(){!i&&E&&_(void 0)})),(0,s.useEffect)((function(){i&&!E&&u?_(u):!i||E||u||void 0===w||_((function(e){return(0,M.Z)((0,N.Z)({},e),{name:"Boundary condition "+(w+1)})}))}),[E,w,i,u]),(0,s.useEffect)((function(){var e=Object.keys(U).map((function(e){var n;if("index"!==e&&"title"!==e&&"done"!==e){var t=U[e];return null===t||void 0===t||null===(n=t.values)||void 0===n?void 0:n.map((function(e){if(e.uuid!==(null===u||void 0===u?void 0:u.uuid))return{label:e.name,selected:e.selected}})).filter((function(e){return e}))}})).flat().filter((function(e){return e}));p(e)}),[U,u]),(0,s.useEffect)((function(){var e=Object.keys(U).map((function(e){if("index"!==e&&"title"!==e&&"done"!==e){var n=U[e];return{key:e,label:n.label,children:n.children,values:n.values}}})).filter((function(e){return e}));x(e)}),[U]),(0,s.useEffect)((function(){var e=null===g||void 0===g?void 0:g.map((function(e){var n;return null===(n=e.values)||void 0===n?void 0:n.length})).filter((function(e){return e})).reduce((function(e,n){return e+n}),0);S(e)}),[g]);var F=(0,s.useCallback)((function(e){_((function(n){return(0,M.Z)((0,N.Z)({},n),{selected:e})}))}),[]);return(0,o.jsx)(tt.Z,{className:"boundaryCondition",title:"Boundary condition",placement:"left",closable:!1,visible:i,mask:!1,maskClosable:!1,width:300,extra:(0,o.jsx)(f.Z,{type:"text",icon:(0,o.jsx)(me.Z,{}),onClick:function(){_(void 0),d()}}),footer:(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,o.jsx)(Z.Lw,{onCancel:function(){_(void 0),d()}}),u?(0,o.jsx)(Xi,{boundaryCondition:{uuid:(null===E||void 0===E?void 0:E.uuid)||u.uuid,name:(null===E||void 0===E?void 0:E.name)||u.name,type:(null===E||void 0===E?void 0:E.type)||u.type,selected:(null===E||void 0===E?void 0:E.selected)||u.selected,values:(null===E||void 0===E?void 0:E.values)||u.values},oldBoundaryCondition:{uuid:u.uuid,name:u.name,type:u.type,selected:u.selected,values:u.values},simulation:{id:l.id,scheme:l.scheme},swr:{mutateOneSimulation:c.mutateOneSimulation},onError:function(e){return D(e)},onClose:d}):(0,o.jsx)(Yi,{boundaryCondition:{name:null===E||void 0===E?void 0:E.name,type:null===E||void 0===E?void 0:E.type,selected:null===E||void 0===E?void 0:E.selected,values:null===E||void 0===E?void 0:E.values},simulation:{id:l.id,scheme:l.scheme},swr:{mutateOneSimulation:c.mutateOneSimulation},onError:function(e){return D(e)},onClose:d})]}),children:(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,o.jsx)(P.Z,{size:"small",children:(0,o.jsx)(we.Z,{layout:"vertical",children:(0,o.jsx)(we.Z.Item,{label:(0,o.jsx)(m.Z.Text,{strong:!0,children:"Boundary condition name"}),children:(0,o.jsx)(Se.Z,{value:(null===E||void 0===E?void 0:E.name)||"",onChange:function(e){var n=e.target.value;_((function(e){return(0,M.Z)((0,N.Z)({},e),{name:n})}))},maxLength:50})})})}),(0,o.jsx)(P.Z,{size:"small",children:(0,o.jsx)(we.Z,{layout:"vertical",children:(0,o.jsx)(we.Z.Item,{label:(0,o.jsx)(m.Z.Text,{strong:!0,children:"Boundary condition type"}),children:(0,o.jsx)(Li.ZP.Group,{className:"BoundaryCondition-types",optionType:"button",buttonStyle:"solid",value:null===E||void 0===E||null===(n=E.type)||void 0===n?void 0:n.key,onChange:function(e){var n,t=e.target.value,i=g.find((function(e){return e.key===t})),a=null===(n=U[t].children)||void 0===n?void 0:n.map((function(e){return{checked:!0,value:e.default}}));_((function(e){return(0,M.Z)((0,N.Z)({},e),{type:{key:i.key,label:i.label,children:i.children},values:a})}))},children:null===g||void 0===g?void 0:g.map((function(e){return(0,o.jsx)(Li.ZP.Button,{value:e.key,children:e.label},e.key)}))})})})}),(null===E||void 0===E?void 0:E.type)&&(null===(t=E.type)||void 0===t?void 0:t.children)&&(0,o.jsx)(P.Z,{children:E.type.children.map((function(e,n){if(2!==z||!e.only3D)return(0,o.jsx)(Gt,{className:"marginBottom-10",label:e.label,defaultValue:String(E.values[n].value),defaultChecked:E.type.children.length>1?E.values[n].checked:void 0,onValueChange:function(e){return function(e,n){_((function(t){return(0,M.Z)((0,N.Z)({},t),{values:(0,r.Z)(E.values.slice(0,e)).concat([{checked:E.values[e].checked,value:n}],(0,r.Z)(E.values.slice(e+1)))})}))}(n,e)},onCheckedChange:function(e){return function(e,n){_((function(t){return(0,M.Z)((0,N.Z)({},t),{values:(0,r.Z)(E.values.slice(0,e)).concat([{checked:n,value:E.values[e].value}],(0,r.Z)(E.values.slice(e+1)))})}))}(n,e)},unit:e.unit},n)}))}),(0,o.jsx)(ri,{geometry:a,alreadySelected:v,updateSelected:F}),T&&(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)(y.Z,{style:{color:"red"}})," ",T]})]})})},ea=function(e){var n=e.simulation,t=e.geometry,i=e.swr,a=e.setVisible,r=(0,s.useState)(),l=r[0],u=r[1],d=(0,s.useState)(!1),m=d[0],f=d[1],h=(0,s.useContext)(I).dispatch,v=n.scheme.configuration.boundaryConditions;(0,s.useEffect)((function(){(null===t||void 0===t?void 0:t.summary)&&h(Mn(2===t.summary.dimension?"edges":"faces"))}),[t,h]);var p=(0,s.useCallback)((function(){u(void 0),f(!0),a(!1),h(_n())}),[h,a]),y=(0,s.useCallback)((function(e,n){var t=v[e].values[n];u(t),f(!0),a(!1),h(_n())}),[v,h,a]),b=(0,s.useCallback)((function(){h(Nn()),f(!1),u(void 0),a(!0)}),[h,a]);return t?(0,o.jsx)(c.Z,{children:(0,o.jsx)(c.Z.Content,{children:(0,o.jsxs)(P.Z,{size:"small",children:[(0,o.jsx)(Z.HS,{onAdd:p,fullWidth:!0,primary:!1,children:"Add boundary condition"}),(0,o.jsx)(Ai,{simulation:{id:n.id,scheme:n.scheme},swr:{mutateOneSimulation:i.mutateOneSimulation},onEdit:y}),(0,o.jsx)(Qi,{visible:m,geometry:{summary:t.summary},simulation:{id:n.id,scheme:n.scheme},boundaryCondition:l&&{uuid:l.uuid,name:l.name,type:l.type,selected:l.selected,values:l.values},swr:{mutateOneSimulation:i.mutateOneSimulation},onClose:b})]})})}):(0,o.jsx)(S.Z.Simple,{})},na=t(91756),ta=t(67841),ia=t(36027),aa=t(57184),ra="You need to define a name",la="You need to select a point",oa="You need to define a formula",ua="Unable to update simulation",sa=function(){var e=(0,i.Z)((function(e,n,t){var i,a,r,o,u,s;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),i=ht.Z.deepCopy(e),a=i.scheme.configuration.run,r=n.index,a.sensors[r]={name:n.name,point:n.point,formula:n.formula},o={},u={},[4,ae.update((o.id=e.id,o),[(u.key="scheme",u.type="json",u.method="set",u.path=["configuration","run"],u.value=a,u)])];case 1:return l.sent(),t.mutateOneSimulation(i),[3,3];case 2:throw s=l.sent(),(0,w.lt)(ua,s),s;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),ca=function(e){var n=e.simulation,t=e.sensor,a=e.onError,r=e.onClose,u=e.swr,c=(0,s.useState)(),d=c[0],m=c[1];return(0,o.jsx)(Z.w6,{loading:d,primary:!0,needMargin:!0,onEdit:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:m(!0),e.label=1;case 1:return e.trys.push([1,3,,4]),t.name?t.point?t.formula?(a(),[4,sa(n,t,u)]):(a(oa),m(!1),[2]):(a(la),m(!1),[2]):(a(ra),m(!1),[2]);case 2:return e.sent(),m(!1),r(),[3,4];case 3:return e.sent(),m(!1),[3,4];case 4:return[2]}}))})),children:"Edit"})},da="You need to define a name",ma="You need to select a point",fa="You need to define a formula",ha="Unable to update simulation",va=function(){var e=(0,i.Z)((function(e,n,t){var i,a,o,u,s,c,d,m;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),i=ht.Z.deepCopy(e),a=i.scheme.configuration.run,u={},s={},o=(0,M.Z)((0,N.Z)(u,a),(s.sensors=(0,r.Z)(a.sensors||[]).concat([n]),s)),c={},d={},[4,ae.update((c.id=e.id,c),[(d.key="scheme",d.type="json",d.method="set",d.path=["configuration","run"],d.value=o,d)])];case 1:return l.sent(),t.mutateOneSimulation(i),[3,3];case 2:throw m=l.sent(),(0,w.lt)(ha,m),m;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),pa=function(e){var n=e.simulation,t=e.sensor,a=e.onError,r=e.onClose,u=e.swr,c=(0,s.useState)(),d=c[0],m=c[1];return(0,o.jsx)(Z.HS,{loading:d,needMargin:!0,onAdd:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:m(!0),e.label=1;case 1:return e.trys.push([1,3,,4]),t.name?t.point?t.formula?(a(),[4,va(n,t,u)]):(a(fa),m(!1),[2]):(a(ma),m(!1),[2]):(a(da),m(!1),[2]);case 2:return e.sent(),m(!1),r(),[3,4];case 3:return e.sent(),m(!1),[3,4];case 4:return[2]}}))})),children:"Add"})},ya=function(e){var n=e.visible,t=e.simulation,i=e.sensor,a=e.onClose,r=e.swr,l=(0,s.useState)(),u=l[0],c=l[1],d=(0,s.useState)(),h=d[0],v=d[1],p=(0,s.useState)(),b=p[0],g=p[1],x=(0,s.useState)(),j=x[0],w=x[1],S=(0,s.useContext)(I),k=S.point,E=S.dispatch;(0,s.useEffect)((function(){E(Mn("point"))}),[E]),(0,s.useEffect)((function(){if(!i){var e=t.scheme.configuration.run;v("Sensor "+(e.sensors?e.sensors.length+1:1))}}),[t,i]),(0,s.useEffect)((function(){i&&(v(i.name),E(zn({x:i.point.x,y:i.point.y,z:i.point.z})),g(i.formula))}),[i,E]);var _,O,T,D,U,z,F=(0,s.useCallback)((function(){c(!1),E(Nn()),window.removeEventListener("click",F)}),[E]),R=(0,s.useCallback)((function(){u?F():(c(!0),E(_n()),setTimeout((function(){return window.addEventListener("click",F)}),50))}),[u,F,E]),A=(0,s.useCallback)((function(e,n,t){E(zn({x:e,y:n,z:t}))}),[E]),L=(0,s.useCallback)((function(e){g(e)}),[]),V=(0,s.useCallback)((function(){v(void 0),g(void 0),w(void 0),E(zn()),a()}),[E,a]);return(0,o.jsx)(tt.Z,{className:"sensor",title:"Sensor",placement:"left",closable:!1,visible:n,mask:!1,maskClosable:!1,width:300,extra:(0,o.jsx)(f.Z,{type:"text",icon:(0,o.jsx)(me.Z,{}),onClick:V}),footer:(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,o.jsx)(Z.Lw,{onCancel:V}),i?(0,o.jsx)(ca,{simulation:t,sensor:(0,M.Z)((0,N.Z)({},i),{name:h,point:k,formula:b}),onError:w,onClose:V,swr:r}):(0,o.jsx)(pa,{simulation:t,sensor:{name:h,point:k,formula:b},onError:w,onClose:V,swr:r})]}),children:(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,o.jsxs)(P.Z,{size:"small",children:[(0,o.jsx)(m.Z.Text,{children:"Name"}),(0,o.jsx)(Se.Z,{value:h,onChange:function(e){return v(e.target.value)}})]}),(0,o.jsx)(P.Z,{size:"small",children:(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,o.jsxs)(C.Z,{className:"full-width",style:{justifyContent:"space-between"},children:[(0,o.jsx)(m.Z.Text,{children:"Point selection"}),(0,o.jsx)(Ie.Z,{title:"Pin in the geometry",children:(0,o.jsx)(f.Z,{size:"small",type:u?"primary":"default",icon:(0,o.jsx)(aa.Z,{}),onClick:R})})]}),(0,o.jsx)(Gt,{label:"X",defaultValue:null===k||void 0===k?void 0:k.x,onValueChange:function(e){return A(+e,null!==(_=null===k||void 0===k?void 0:k.y)&&void 0!==_?_:0,null!==(O=null===k||void 0===k?void 0:k.z)&&void 0!==O?O:0)}}),(0,o.jsx)(Gt,{label:"Y",defaultValue:null===k||void 0===k?void 0:k.y,onValueChange:function(e){return A(null!==(T=null===k||void 0===k?void 0:k.x)&&void 0!==T?T:0,+e,null!==(D=null===k||void 0===k?void 0:k.z)&&void 0!==D?D:0)}}),(0,o.jsx)(Gt,{label:"Z",defaultValue:null===k||void 0===k?void 0:k.z,onValueChange:function(e){return A(null!==(U=null===k||void 0===k?void 0:k.x)&&void 0!==U?U:0,null!==(z=null===k||void 0===k?void 0:k.y)&&void 0!==z?z:0,+e)}})]})}),(0,o.jsx)(P.Z,{size:"small",className:"no-border-bottom",children:(0,o.jsx)(Gt,{label:"Formula",defaultValue:b,onValueChange:L})}),j&&(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)(y.Z,{style:{color:"red"}})," ",j]})]})})},ba="Unable to update the simulation",ga=function(){var e=(0,i.Z)((function(e,n,t,i){var a,o,u,s,c;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),a=ht.Z.deepCopy(e),o=a.scheme.configuration.run,t(zn()),o.sensors=(0,r.Z)(o.sensors.slice(0,n)).concat((0,r.Z)(o.sensors.slice(n+1))),u={},s={},[4,ae.update((u.id=e.id,u),[(s.key="scheme",s.type="json",s.method="set",s.path=["configuration","run"],s.value=o,s)])];case 1:return l.sent(),i.mutateOneSimulation(a),[3,3];case 2:throw c=l.sent(),(0,w.lt)(ba,c),c;case 3:return[2]}}))}));return function(n,t,i,a){return e.apply(this,arguments)}}(),xa=function(e){var n=e.simulation,t=e.index,a=e.swr,r=(0,s.useState)(),u=r[0],c=r[1],d=(0,s.useContext)(I).dispatch,f=n.scheme.configuration.run.sensors[t];return(0,o.jsx)(Z.m1,{loading:u,text:(0,o.jsxs)(o.Fragment,{children:["Are you sure you want to delete the sensor"," ",(0,o.jsx)(m.Z.Text,{strong:!0,children:f.name})]}),onDelete:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:c(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,ga(n,t,d,a)];case 2:return e.sent(),[3,4];case 3:return c(!1),[7];case 4:return[2]}}))}))})},ja=function(e){var n,t=e.simulation,i=e.onEdit,a=e.swr,r=(0,s.useState)(!0),l=r[0],u=r[1],c=t.scheme.configuration.run,d=(0,s.useContext)(I).dispatch,f=(0,s.useCallback)((function(e){d(_n()),d(zn(e.point))}),[d]),h=(0,s.useCallback)((function(){l&&d(zn()),d(Nn())}),[l,d]);return(0,o.jsx)(o.Fragment,{children:null===(n=c.sensors)||void 0===n?void 0:n.map((function(e,n){return(0,o.jsx)(P.Z,{className:"sensor-item text-center",hoverable:!0,onMouseEnter:function(){return f(e)},onMouseLeave:h,actions:[(0,o.jsx)(Z.w6,{onEdit:function(){u(!1),i((0,M.Z)((0,N.Z)({},e),{index:n})),setTimeout((function(){return u(!0)}),500)}},"edit"),(0,o.jsx)(xa,{simulation:t,index:n,swr:a},"delete")],children:(0,o.jsx)(m.Z.Text,{strong:!0,className:"text-center",children:e.name})},n)}))})},Za=function(e){var n=e.simulation,t=e.setVisible,i=e.swr,a=(0,s.useState)(),r=a[0],l=a[1],u=(0,s.useState)(),c=u[0],d=u[1],m=(0,s.useCallback)((function(){d(void 0),t(!1),l(!0)}),[t]),h=(0,s.useCallback)((function(e){d(e),t(!1),l(!0)}),[t]),v=(0,s.useCallback)((function(){d(void 0),t(!0),l(!1)}),[t]);return(0,o.jsxs)(P.Z,{size:"small",title:"Sensors",children:[(0,o.jsx)(ya,{visible:r,simulation:n,sensor:c,onClose:v,swr:i}),(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,o.jsx)(f.Z,{className:"full-width",disabled:!1,type:"primary",icon:(0,o.jsx)(ia.Z,{}),onClick:m,children:"Add a sensor"}),(0,o.jsx)(ja,{simulation:n,onEdit:h,swr:i})]})]})},wa=t(5152),Sa=t.n(wa),Pa=t(139),Ca=t(24443),ka="Plugins error",Ea="Unable to load plugins",_a=function(e){var n=e.disabled,i=e.cloudServer,r=e.onOk,l=(0,s.useState)(!1),c=l[0],d=l[1],h=(0,s.useState)([]),v=h[0],p=h[1],y=(0,u.useRouter)(),b=(0,a.Z)(Ca.Z.usePlugins(),2),g=b[0],x=b[1].errorPlugins;return(0,s.useEffect)((function(){x&&(0,w.lt)(ka,x)}),[x]),(0,s.useEffect)((function(){Nt.Z.list().then((function(e){p(e)})).catch((function(e){(0,w.lt)(Ea,e)}))}),[]),(0,o.jsxs)(P.Z,{size:"small",title:"Computational resource",children:[(0,o.jsx)(bt.Z,{visible:c,title:"Computational resource",okButtonProps:{disabled:!0,style:{display:"none"}},onCancel:function(){return d(!1)},style:{width:"unset"},children:(0,o.jsxs)(C.Z,{direction:"vertical",children:[(0,o.jsxs)(m.Z.Text,{children:["Your computational resource does not appear in this list? Create one in your",(0,o.jsx)(Z.Qj,{onClick:function(){return y.push({pathname:"/dashboard",query:{page:"account",tab:"hpc"}})},children:"account settings"})]}),(0,o.jsx)(C.Z,{align:"start",direction:"horizontal",wrap:!0,children:null===g||void 0===g?void 0:g.map((function(e){var n=v.find((function(n){return n.key===e.key}));if(n){var i=Sa()((function(){return t(64546)("./".concat(n.key,"/src/components"))}));return(0,o.jsx)(P.Z,{title:e.configuration.name.value,children:(0,o.jsx)(i,{data:e.data,onSelect:function(n){(0,ft.merge)(e,n),r(e),d(!1)}})},e.uuid)}}))})]})}),(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[i&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)("span",{className:"text-light",children:"Plugin:"})," ",i.name]}),(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsx)("span",{className:"text-light",children:"Name:"})," ",i.configuration.name.value]}),Object.keys(i.inUseConfiguration).map((function(e){var n=i.inUseConfiguration[e],t=n.value;return"boolean"===typeof t&&(t=t?"yes":"no"),(0,o.jsxs)(m.Z.Text,{children:[(0,o.jsxs)("span",{className:"text-light",children:[n.label,":"]})," ",t]},e)}))]}),(0,o.jsx)(f.Z,{className:"full-width",disabled:n,type:i?"link":"primary",icon:(0,o.jsx)(Pa.Z,{}),onClick:function(){return d(!0)},children:i?"Modify the resource":"Select a resource"})]})]})},Na=t(2944),Ma=t(15360),Oa=t(25935),Ta=t(48764).lW,Da="Unable to get system log",Ua=function(){var e=(0,i.Z)((function(e,n){var t,i,a,r,u;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),i={},[4,ae.log((i.id=e.id,i),n.systemLog)];case 1:return t=l.sent(),a=Ta.from(t.log).toString(),r={},bt.Z.info((r.title="System log",r.width="unset",r.content=(0,o.jsx)("pre",{children:(0,o.jsx)("code",{children:(0,Oa.ZP)(a.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))})}),r)),[3,3];case 2:return u=l.sent(),(0,w.lt)(Da,u),[3,3];case 3:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),za=function(e){var n=e.simulation,t=e.steps,a=(0,s.useState)(!1),r=a[0],u=a[1],c=(0,s.useState)(!1),d=c[0],h=c[1];return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tt.Z,{title:"Log",visible:r,onClose:function(){return u(!1)},width:"50%",children:(0,o.jsx)(Na.Z,{children:null===t||void 0===t?void 0:t.map((function(e){var t,a;return(0,o.jsxs)(Na.Z.TabPane,{tab:e.label,children:[e.systemLog&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(f.Z,{loading:d,onClick:(0,i.Z)((function(){return(0,l.__generator)(this,(function(t){switch(t.label){case 0:h(!0),t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,Ua(n,e)];case 2:return t.sent(),[3,5];case 3:return t.sent(),[3,5];case 4:return h(!1),[7];case 5:return[2]}}))})),children:"Complete log"}),(0,o.jsx)("br",{})]}),e.link&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("a",{href:"https://"+e.link.href,target:"_blank",rel:"noreferrer",children:(0,o.jsx)(f.Z,{type:"primary",children:e.link.label})}),(0,o.jsx)("br",{})]}),(0,o.jsxs)(Zi.Z,{ghost:!0,children:[e.warning&&(0,o.jsx)(Zi.Z.Panel,{className:"warning-collapse",header:(0,o.jsx)(m.Z.Text,{type:"warning",children:"Warnings"}),children:(0,Oa.ZP)(e.warning.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))},"warnings"),e.error&&(0,o.jsx)(Zi.Z.Panel,{className:"error-collapse",header:(0,o.jsx)(m.Z.Text,{type:"danger",children:"Errors"}),children:(0,Oa.ZP)(e.error.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))},"errors")]}),(0,Oa.ZP)((null===(t=e.pluginLog)||void 0===t?void 0:t.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))||""),(0,Oa.ZP)((null===(a=e.log)||void 0===a?void 0:a.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))||"")]},e.label)}))})}),(0,o.jsx)(Ie.Z,{title:"Log",children:(0,o.jsx)(f.Z,{disabled:!t||!t.length,icon:(0,o.jsx)(Ma.Z,{}),onClick:function(){return u(!0)}})})]})},Fa=t(99611),Ra=t(23430),Aa="Unable to download the file",La=function(){var e=(0,i.Z)((function(e,n){var t,i,a,r,o,u;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,3,,4]),t={},i={},[4,Ge.download((t.id=e.id,t),(i.originPath=n.originPath,i.fileName=n.fileName,i))];case 1:return[4,l.sent().blob()];case 2:return a=l.sent(),r=window.URL.createObjectURL(new Blob([a])),(o=document.createElement("a")).href=r,o.setAttribute("download",n.name+"."+n.fileName.split(".").pop()),o.click(),[3,4];case 3:return u=l.sent(),(0,w.lt)(Aa,u),[3,4];case 4:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),Va=function(e){var n=e.simulation,t=e.file,a=(0,s.useState)(!1),r=a[0],u=a[1];return(0,o.jsx)(Ie.Z,{title:"Download",children:(0,o.jsx)(f.Z,{loading:r,icon:(0,o.jsx)(Ra.Z,{}),onClick:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:u(!0),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,La(n,t)];case 2:return e.sent(),[3,5];case 3:return e.sent(),[3,5];case 4:return u(!1),[7];case 5:return[2]}}))}))})})},Ga="Unable to download the archive",Ia=function(){var e=(0,i.Z)((function(e){var n,t,i,a,r;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,3,,4]),n={},[4,Ge.archive((n.id=e.id,n))];case 1:return[4,l.sent().blob()];case 2:return t=l.sent(),i=window.URL.createObjectURL(new Blob([t])),(a=document.createElement("a")).href=i,a.setAttribute("download",e.scheme.name+".zip"),a.click(),[3,4];case 3:return r=l.sent(),(0,w.lt)(Ga,r),[3,4];case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Ba=function(e){var n=e.simulation,t=(0,s.useState)(!1),a=t[0],r=t[1];return(0,o.jsx)(Z.o6,{loading:a,onDownload:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:r(!0),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,Ia(n)];case 2:return e.sent(),[3,5];case 3:return e.sent(),[3,5];case 4:return r(!1),[7];case 5:return[2]}}))}))})},Ha=function(e){var n,t=e.simulation,i=e.result,a=e.setResult,l=(0,s.useState)(),u=l[0],c=l[1],d=(0,s.useState)(),m=d[0],h=d[1],v=(0,s.useState)(),p=v[0],y=v[1],b=null===t||void 0===t||null===(n=t.scheme)||void 0===n?void 0:n.configuration;return(0,s.useEffect)((function(){var e;if(!(null===t||void 0===t?void 0:t.tasks))return c([]),void h(void 0);var n=[],i=null===b||void 0===b||null===(e=b.run)||void 0===e?void 0:e.resultsFilter;t.tasks.forEach((function(e){if(e.file&&n.push(e.file),e.files)if(i){var t,a=new RegExp(i.pattern),l=e.files.filter((function(e){return!a.test(e.fileName)})),o=e.files.filter((function(e){return a.test(e.fileName)})),u=ki(o,i),s=u.map((function(e){return e.number})).filter((function(e,n,t){return t.indexOf(e)===n})).sort((function(e,n){return e-n})),c=Ei(b,i),d=s.map((function(e,n){var t=c?e*c:n;return{label:Math.round(1e15*t)/1e15,value:e}}));(t=n).push.apply(t,(0,r.Z)(l)),h({filtered:!0,name:i.name,files:u,options:d})}else{var m;(m=n).push.apply(m,(0,r.Z)(e.files))}})),c(n)}),[t,b]),(0,s.useEffect)((function(){!p&&m&&y(null===m||void 0===m?void 0:m.options[0].value)}),[m,p]),u||m?(null===u||void 0===u?void 0:u.length)||m?(0,o.jsx)(P.Z,{size:"small",title:"Results",extra:(0,o.jsx)(Ba,{simulation:t&&{id:t.id,scheme:t.scheme}}),children:(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[null===u||void 0===u?void 0:u.map((function(e){return(0,o.jsxs)(C.Z,{style:{alignItems:"center"},children:[(0,o.jsx)(f.Z,{icon:(null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?(0,o.jsx)(Fa.Z,{style:{color:"#fad114"}}):(0,o.jsx)(an.Z,{}),onClick:function(){return a((null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?void 0:e)}}),(0,o.jsx)(Va,{simulation:t&&{id:t.id},file:e&&{name:e.name,fileName:e.fileName,originPath:e.originPath}}),e.name]},e.name)})),m&&(0,o.jsxs)(o.Fragment,{children:[m.name,(0,o.jsx)(yt.Z,{className:"full-width",options:m.options,value:p,onChange:function(e){var n=m.files.find((function(n){return n.number===e&&n.name===(null===i||void 0===i?void 0:i.name)}));a(n),y(e)}}),m.files.map((function(e){if(e.number===p)return(0,o.jsxs)(C.Z,{style:{alignItems:"center"},children:[(0,o.jsx)(f.Z,{icon:(null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?(0,o.jsx)(Fa.Z,{style:{color:"#fad114"}}):(0,o.jsx)(an.Z,{}),onClick:function(){return a((null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?void 0:e)}}),(0,o.jsx)(Va,{simulation:t&&{id:t.id},file:e&&{name:e.name,fileName:e.fileName,originPath:e.originPath}}),e.name]},e.name)}))]})]})}):(0,o.jsx)(P.Z,{size:"small",children:"No results yet"}):(0,o.jsx)(We.Z,{})},Ya="Unable to run the simulation",Wa="Unable to stop the simulation",qa="Unable to update the simulation",Ka=function(){var e=(0,i.Z)((function(e,n,t){var i,a,r,o,u;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),i=ht.Z.deepCopy(e),(a=e.scheme.configuration).run.cloudServer=n,i.scheme.configuration=a,r={},o={},[4,ae.update((r.id=e.id,r),[(o.key="scheme",o.type="json",o.method="set",o.path=["configuration","run"],o.value=a.run,o)])];case 1:return l.sent(),t.mutateOneSimulation(i),t.mutateSimulation(i),[3,3];case 2:return u=l.sent(),(0,w.lt)(qa,u),[3,3];case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Ja=function(){var e=(0,i.Z)((function(e){var n,t;return(0,l.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),n={},[4,ae.run((n.id=e.id,n))];case 1:return i.sent(),[3,3];case 2:throw t=i.sent(),(0,w.lt)(Ya,t),t;case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),$a=function(){var e=(0,i.Z)((function(e){var n,t;return(0,l.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),n={},[4,ae.stop((n.id=e.id,n))];case 1:return i.sent(),[3,3];case 2:throw t=i.sent(),(0,w.lt)(Wa,t),t;case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Xa=function(e){var n,t,r=e.simulation,u=e.result,d=e.setResult,m=e.setVisible,h=e.swr,v=(0,s.useState)(!1),p=v[0],y=v[1],b=(0,s.useState)(!1),g=b[0],x=b[1],j=(0,s.useState)([]),Z=j[0],w=j[1],S=(0,a.Z)(ae.useSimulation(r.id,2e3),2),k=S[0],E=S[1].mutateSimulation,_=r.scheme.configuration,O=null===k||void 0===k||null===(n=k.scheme)||void 0===n?void 0:n.configuration;return(0,s.useEffect)((function(){if(_){var e=!0;Object.keys(_).forEach((function(n){"dimension"!==n&&"run"!==n&&(_[n].done||(e=!1))})),_.run.cloudServer||(e=!1),y(!e)}else y(!0)}),[_]),(0,s.useEffect)((function(){var e,n;(null===k||void 0===k||null===(e=k.tasks)||void 0===e?void 0:e.find((function(e){return"error"===(null===e||void 0===e?void 0:e.status)})))?x(!1):(null===k||void 0===k||null===(n=k.tasks)||void 0===n?void 0:n.find((function(e){return e&&"finish"!==e.status})))?x(!0):x(!1)}),[null===k||void 0===k?void 0:k.tasks]),(0,s.useEffect)((function(){var e,n=[];null===k||void 0===k||null===(e=k.tasks)||void 0===e||e.forEach((function(e){e&&(n[e.index]={index:e.index,label:e.label,status:e.status,log:e.log,pluginLog:e.pluginLog,warning:e.warning,error:e.error,systemLog:e.systemLog,link:e.link})})),w(n)}),[null===k||void 0===k?void 0:k.tasks]),r&&k&&"0"!==(null===k||void 0===k?void 0:k.id)?(0,o.jsx)(c.Z,{children:(0,o.jsx)(c.Z.Content,{children:(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",children:[(0,o.jsx)(Za,{simulation:r,setVisible:m,swr:{mutateOneSimulation:h.mutateOneSimulation}}),(0,o.jsx)(_a,{disabled:g,cloudServer:null===O||void 0===O||null===(t=O.run)||void 0===t?void 0:t.cloudServer,onOk:function(){var e=(0,i.Z)((function(e){var n,t;return(0,l.__generator)(this,(function(i){return n={},t={},[2,Ka(r,e,(0,M.Z)((0,N.Z)(n,h),(t.mutateSimulation=E,t)))]}))}));return function(n){return e.apply(this,arguments)}}()}),(0,o.jsx)(P.Z,{size:"small",title:"Run",children:(0,o.jsxs)(C.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,o.jsxs)("div",{className:"full-width",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)(C.Z,{children:[(0,o.jsx)(f.Z,{disabled:p,type:"primary",icon:(0,o.jsx)(ta.Z,{}),loading:g,onClick:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:x(!0),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Ja(r)];case 2:return e.sent(),[3,4];case 3:return e.sent(),x(!1),[3,4];case 4:return[2]}}))})),children:"Run"}),(0,o.jsx)(f.Z,{disabled:!g,danger:!0,icon:(0,o.jsx)(tn.Z,{}),shape:"circle",onClick:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,$a(r)];case 1:return e.sent(),x(!1),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}}))}))})]}),(0,o.jsx)(za,{simulation:{id:r.id},steps:Z})]}),(0,o.jsx)(na.Z,{direction:"vertical",children:Z.map((function(e,n){return(0,o.jsx)(na.Z.Step,{title:e.label,description:"("+(n+1)+"/"+Z.length+")",status:e.status},e.label)}))})]})}),(0,o.jsx)(Ha,{simulation:k&&{id:k.id,scheme:k.scheme,tasks:k.tasks},result:u&&{name:u.name,fileName:u.fileName},setResult:d})]})})}):(0,o.jsx)(c.Z,{children:(0,o.jsx)(c.Z.Content,{children:(0,o.jsx)(P.Z,{size:"small",children:(0,o.jsx)(We.Z,{})})})})},Qa=t(1402),er=[{key:"warpByVector",label:"Warp by vector",parameters:[{key:"Vectors",label:"Vectors",rules:[{required:!0,message:"Vectors is required"}]},{key:"ScaleFactor",label:"Scale factor",default:"1",rules:[{required:!0,message:"Scale factor is required"}]}]},{key:"contour",label:"Contour",parameters:[{key:"ContourBy",label:"Contour by",rules:[{required:!0,message:"ContourBy by is required"}]},{key:"isosurface",label:"Isosurface",default:"0",rules:[{required:!0,message:"Isosurface is required"}]}]},{key:"streamTracer",label:"Stream tracer",parameters:[{key:"Vectors",label:"Vectors",rules:[{required:!0,message:"Vectors is required"}]}]}],nr=function(){var e=(0,i.Z)((function(e,n,t,i){var a;return(0,l.__generator)(this,(function(r){switch(r.label){case 0:return a={},[4,(0,K.R)("/api/postprocessing",(a.method="POST",a.headers={Accept:"application/json"},a.body=JSON.stringify({simulation:e,result:n,filter:t,parameters:i}),a))];case 1:return[2,r.sent().json()]}}))}));return function(n,t,i,a){return e.apply(this,arguments)}}(),tr={run:nr},ir="Unable to run filter",ar=function(){var e=(0,i.Z)((function(e,n,t,i){var a;return(0,l.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,tr.run(e,n,t,i)];case 1:return[2,r.sent()];case 2:return a=r.sent(),(0,w.lt)(ir,a),[3,3];case 3:return[2]}}))}));return function(n,t,i,a){return e.apply(this,arguments)}}(),rr=function(e){var n=e.simulation,t=e.result,a=e.postprocessing,r=e.setResult,u=(0,s.useState)(),d=u[0],m=u[1],h=(0,s.useState)(),v=h[0],p=h[1],y=(0,s.useState)(),b=y[0],g=y[1],x=(0,s.useState)(),j=x[0],Z=x[1];if((0,s.useEffect)((function(){!t&&d&&m(!1)}),[t,d]),(0,s.useEffect)((function(){n||(p(void 0),Z(void 0))}),[n,t]),!n||!t)return null;var w=n.scheme.configuration.run.postprocessing;if(!w)return null;var S=er.map((function(e){if(w.find((function(n){return n.key===e.key})))return{label:e.label,value:e.key}})).filter((function(e){return e}));if(!S.length)return null;var k=null;if(v){var E=er.find((function(e){return e.key===v})),_=w.find((function(e){return e.key===v}));(null===E||void 0===E?void 0:E.parameters)&&(k=E.parameters.map((function(e,n){var t,i=null===_||void 0===_||null===(t=_.parameters)||void 0===t?void 0:t.find((function(n){return n.key===e.key}));return(null===i||void 0===i?void 0:i.value)?(0,o.jsx)(we.Z.Item,{label:e.label,name:["parameters",n],initialValue:i.value,rules:e.rules,children:(0,o.jsx)(Se.Z,{disabled:!0})},e.key):(null===i||void 0===i?void 0:i.options)?(0,o.jsx)(we.Z.Item,{label:e.label,name:["parameters",n],rules:e.rules,children:(0,o.jsx)(yt.Z,{options:i.options.map((function(e){return{label:e,value:e}}))})},e.key):(0,o.jsx)(we.Z.Item,{label:e.label,name:["parameters",n],rules:e.rules,initialValue:e.default,children:(0,o.jsx)(Se.Z,{})},e.key)})))}return(0,o.jsx)(c.Z,{style:{position:"absolute",zIndex:101,right:25,bottom:50,backgroundColor:"rgba(255, 255, 255, 0)"},children:(0,o.jsxs)(c.Z.Content,{children:[(0,o.jsx)(Ie.Z,{title:"Post-processing",children:(0,o.jsx)(f.Z,{type:"primary",icon:(0,o.jsx)(Qa.Z,{}),onClick:function(){return m(!0)},style:{width:40,height:40,border:"1px solid #5E14FA",borderRadius:20,marginBottom:-20}})}),(0,o.jsxs)(tt.Z,{title:"Post-processing",closable:!0,onClose:function(){return m(!1)},visible:d,mask:!1,maskClosable:!1,children:[(0,o.jsx)(we.Z,{style:{margin:"24px 0"},children:(0,o.jsx)(we.Z.Item,{name:"filter",label:"Filter",children:(0,o.jsx)(yt.Z,{placeholder:"Select a filter",options:S,onChange:p})})}),(0,o.jsxs)(we.Z,{layout:"vertical",style:{margin:"24px 0"},onFinish:function(){var e=(0,i.Z)((function(e){var i,a;return(0,l.__generator)(this,(function(r){switch(r.label){case 0:g(!0),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,ar(((a={}).id=n.id,a),t,v,e.parameters||[])];case 2:return i=r.sent(),Z(i),[3,4];case 3:return r.sent(),[3,4];case 4:return g(!1),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:[k,(0,o.jsx)(we.Z.Item,{children:(0,o.jsx)(f.Z,{type:"primary",loading:b,htmlType:"submit",icon:(0,o.jsx)(ta.Z,{}),children:"Run"})})]}),j&&(0,o.jsx)(P.Z,{size:"small",title:"Post-processing",extra:v,children:(0,o.jsx)(C.Z,{direction:"vertical",className:"full-width",children:j.length?j.map((function(e){return(0,o.jsxs)(C.Z,{children:[(0,o.jsx)(f.Z,{icon:(null===a||void 0===a?void 0:a.fileName)===e.fileName&&(null===a||void 0===a?void 0:a.name)===e.name?(0,o.jsx)(Fa.Z,{style:{color:"#fad114"}}):(0,o.jsx)(an.Z,{}),onClick:function(){return r((null===a||void 0===a?void 0:a.fileName)===e.fileName&&(null===a||void 0===a?void 0:a.name)===e.name?void 0:(0,N.Z)({type:"postprocessing"},e))}}),(0,o.jsx)(Va,{simulation:{id:n.id},file:{name:e.name,fileName:e.fileName,originPath:e.originPath}}),e.name]},e.glb)})):"No results"})})]})]})})},lr="Unable to load plugins",or="Unable to update the simulation",ur=function(e,n){Nt.Z.list().then((function(t){var i=sr(e,_t,t);n(i)})).catch((function(e){(0,w.lt)(lr,e)}))},sr=function(e,n,t){var i=n;return t.forEach((function(n){var t;(null===e||void 0===e||null===(t=e.authorizedplugins)||void 0===t?void 0:t.includes(n.key))&&"Model"===n.category&&(i=(0,r.Z)(i).concat((0,r.Z)(n.models)))})),i},cr=function(){var e=(0,i.Z)((function(e,n,t){var i,a,r,o,u;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),i=n.find((function(n){var t;return n.algorithm===(null===e||void 0===e||null===(t=e.scheme)||void 0===t?void 0:t.algorithm)})),a=ht.Z.deepCopy(e),(0,ft.merge)(a.scheme,i),r={},o={},[4,ae.update((r.id=e.id,r),[(o.key="scheme",o.value=a.scheme,o)])];case 1:return l.sent(),t.mutateOneSimulation(a),[3,3];case 2:return u=l.sent(),(0,w.lt)(or,u),[3,3];case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),dr={Selector:function(e){var n=e.visible,t=e.user,a=e.onOk,r=e.onCancel,u=(0,s.useState)(),m=u[0],f=u[1],h=(0,s.useState)(!1),v=h[0],p=h[1],y=(0,s.useState)([]),b=y[0],g=y[1],x=(0,s.useState)(),j=x[0],Z=x[1],w=(0,s.useState)(),S=w[0],P=w[1];(0,s.useEffect)((function(){t&&ur(t,g)}),[t]),(0,s.useEffect)((function(){var e=b.map((function(e){return e.category})).filter((function(e,n,t){return t.indexOf(e)===n})).map((function(e){return{key:e,value:e}}));Z(e)}),[b]);var C=(0,s.useCallback)((function(e){var n=e.key,t=b.find((function(e){return e.algorithm===n}));f(ht.Z.deepCopy(t))}),[b]),k=[{key:"category",disabled:!0,label:(0,o.jsx)(yt.Z,{className:"full-width",options:j,allowClear:!0,showArrow:!1,placeholder:"Category filter",onChange:function(e){return P(e)}})}];return b.forEach((function(e){S&&e.category!==S||k.push({key:e.algorithm,label:e.name})})),(0,o.jsx)(bt.Z,{visible:n,title:"Create simulation",okText:"Create",okButtonProps:{loading:v},onOk:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:if(p(!0),!m)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,a(m)];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return p(!1),[2]}}))})),onCancel:function(){return r()},width:"80%",children:(0,o.jsxs)(c.Z,{children:[(0,o.jsx)(c.Z.Sider,{theme:"light",children:(0,o.jsx)(d.Z,{mode:"inline",items:k,onSelect:C})}),(0,o.jsx)(c.Z.Content,{style:{padding:"20px",height:"60vh",overflow:"auto"},className:"simulation-selector",children:(0,o.jsx)(he.Z.Html,{html:null===m||void 0===m?void 0:m.description})})]})})},Updater:function(e){var n=e.user,t=e.simulation,a=e.swr,r=(0,s.useState)(!1),u=r[0],c=r[1],d=(0,s.useState)(!1),f=d[0],h=d[1],v=(0,s.useState)([]),p=v[0],y=v[1];return(0,s.useEffect)((function(){n&&ur(n,y)}),[n]),(0,s.useEffect)((function(){var e=p.find((function(e){var n;return e.algorithm===(null===t||void 0===t||null===(n=t.scheme)||void 0===n?void 0:n.algorithm)}));if(e&&(null===t||void 0===t?void 0:t.scheme)){var n=(0,xt.Z)(t.scheme,e),i=(0,jt.Z)(t.scheme,e);Object.keys(n).length||Object.keys(i).length?c(!0):c(!1)}}),[t,p]),t?(0,o.jsx)(bt.Z,{title:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(gt.Z,{style:{color:"orange",marginRight:"5px"}}),"Update"]}),visible:u,onOk:(0,i.Z)((function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:h(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,cr(t,p,a)];case 2:return e.sent(),[3,4];case 3:return h(!1),c(!1),[7];case 4:return[2]}}))})),okText:"OK",confirmLoading:f,onCancel:function(){return c(!1)},cancelButtonProps:{disabled:!0},maskClosable:!1,children:(0,o.jsxs)(C.Z,{direction:"vertical",children:[(0,o.jsx)(m.Z.Text,{children:"Your model needs an update!"}),(0,o.jsx)(m.Z.Text,{strong:!0,children:"Update now?"})]})}):null},About:Vt,Geometry:Kt,Materials:ji,Parameters:Ci,Initialization:Ui,BoundaryConditions:ea,Run:Xa,Postprocessing:rr},mr=dr,fr={label:"GEOMETRIES",key:"geometries"},hr={label:"SIMULATIONS",key:"simulations"},vr="Unable to get user",pr="Unable to get project",yr="Unable to get simulations",br="Unable to get geometries",gr="Unable to add a simulation",xr=function(){var e=(0,i.Z)((function(e,n,t){var i,a,o,u,s;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),a={},o={},[4,ae.add((a.id=e.id,a),(o.name=n.name,o.scheme=n,o))];case 1:return i=l.sent(),t.addOneSimulation(i),u={},t.mutateProject((u.id=e.id,u.simulations=(0,r.Z)(e.simulations||[]).concat([i.id]),u)),[3,3];case 2:throw s=l.sent(),(0,w.lt)(gr,s),s;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),jr=function(){var e=(0,u.useRouter)(),n=e.query,t=n.page,P=n.workspaceId,C=n.projectId,k=(0,s.useState)(!1),E=k[0],N=k[1],M=(0,s.useState)(),O=M[0],T=M[1],D=(0,s.useState)(!1),U=D[0],z=D[1],F=(0,s.useState)(),R=F[0],A=F[1],L=(0,s.useState)(),V=L[0],G=L[1],I=(0,s.useState)(),B=I[0],q=I[1],K=(0,s.useState)(),J=K[0],$=K[1],X=(0,s.useState)(),Q=X[0],ee=X[1],ne=(0,s.useState)(!0),te=ne[0],ie=ne[1],re=(0,a.Z)(Y.Z.useUser(),2),le=re[0],oe=re[1],ue=oe.errorUser,se=oe.loadingUser,ce=(0,a.Z)(W.Z.useProject(C),2),me=ce[0],he=ce[1],ve=he.mutateProject,pe=he.errorProject,ye=he.loadingProject,be=(0,a.Z)(ae.useSimulations(null===me||void 0===me?void 0:me.simulations),2),ge=be[0],xe=be[1],je=xe.addOneSimulation,Ze=xe.delOneSimulation,we=xe.mutateOneSimulation,Se=xe.errorSimulations,Pe=xe.loadingSimulations,Ce=(0,a.Z)(de.useGeometries(null===me||void 0===me?void 0:me.geometries),2),ke=Ce[0],Ee=Ce[1],_e=Ee.addOneGeometry,Ne=Ee.delOneGeometry,Me=Ee.mutateOneGeometry,Oe=Ee.errorGeometries,Te=Ee.loadingGeometries,De=(0,s.useCallback)((function(){ee(void 0),$(void 0)}),[]);(0,s.useEffect)((function(){se||le||e.replace("/login")}),[le,se,e]),(0,s.useEffect)((function(){ue&&(0,w.lt)(vr,ue),pe&&(0,w.lt)(pr,pe),Se&&(0,w.lt)(yr,Se),Oe&&(0,w.lt)(br,Oe)}),[ue,pe,Se,Oe]),(0,s.useEffect)((function(){ye||Te||ke.length?N(!1):N(!0)}),[ye,Te,ke]),(0,s.useEffect)((function(){if(!Te&&O){var e=ke.find((function(e){return e.id===(null===O||void 0===O?void 0:O.id)}));e?JSON.stringify(e)!==JSON.stringify(O)&&T(e):T(void 0)}else T(ke[0])}),[ke,O,Te,T]),(0,s.useEffect)((function(){if(!Pe&&R){var e=ge.find((function(e){return e.id===(null===R||void 0===R?void 0:R.id)}));e?JSON.stringify(e)!==JSON.stringify(R)&&A(e):(De(),A(void 0))}}),[ge,R,Pe,A,De]);var Ue=(0,s.useCallback)((function(){T({id:"0",needCleanup:!0})}),[]),ze=(0,s.useCallback)((function(e){var n=ke.find((function(n){return n.id===e}));n&&(T(n),ee((0,o.jsx)(fe,{visible:!0,title:"Geometry",onClose:De,children:(0,o.jsx)(Fe,{project:{id:me.id,geometries:me.geometries},geometry:{id:n.id,name:n.name,summary:n.summary},swr:{mutateProject:ve,mutateOneGeometry:Me,delOneGeometry:Ne},close:De,onCleanup:Ue})})))}),[me,ke,ve,Me,Ne,Ue,De]),Re=(0,s.useCallback)((function(e){ee((0,o.jsx)(fe,{visible:!0,title:"About",onClose:De,children:(0,o.jsx)(mr.About,{project:{id:me.id,simulations:me.simulations},simulation:{id:e.id,name:e.name,scheme:e.scheme},swr:{mutateProject:ve,addOneSimulation:je,delOneSimulation:Ze,mutateOneSimulation:we}})}))}),[me,ve,je,Ze,we,De]),Ae=(0,s.useCallback)((function(e){ee((0,o.jsx)(fe,{visible:!0,title:"Geometry",onClose:De,children:(0,o.jsx)(mr.Geometry,{geometries:ke,geometry:O&&{id:O.id,summary:O.summary},simulation:{id:e.id,scheme:e.scheme},setGeometry:T,swr:{mutateOneSimulation:we}})}))}),[ke,O,we,De]),Le=(0,s.useCallback)((function(e){ee((0,o.jsx)(fe,{visible:!0,title:"Parameters",onClose:De,children:(0,o.jsx)(mr.Parameters,{simulation:{id:e.id,scheme:e.scheme},swr:{mutateOneSimulation:we}})}))}),[we,De]),Ve=(0,s.useCallback)((function(e){ee((0,o.jsx)(fe,{visible:te,title:"Materials",onClose:De,children:(0,o.jsx)(mr.Materials,{geometry:O&&{id:O.id,summary:O.summary},simulation:{id:e.id,scheme:e.scheme},swr:{mutateOneSimulation:we},setVisible:function(e){return ie(e)}})}))}),[O,te,we,De]),Ge=(0,s.useCallback)((function(e){ee((0,o.jsx)(fe,{visible:!0,title:"Initialization",onClose:De,children:(0,o.jsx)(mr.Initialization,{simulations:ge,simulation:e,swr:{mutateOneSimulation:we}})}))}),[ge,we,De]),Ie=(0,s.useCallback)((function(e){ee((0,o.jsx)(fe,{visible:te,title:"Boundary conditions",onClose:De,children:(0,o.jsx)(mr.BoundaryConditions,{geometry:O&&{id:O.id,summary:O.summary},simulation:{id:e.id,scheme:e.scheme},swr:{mutateOneSimulation:we},setVisible:function(e){return ie(e)}})}))}),[O,te,we,De]),Be=(0,s.useCallback)((function(e){ee((0,o.jsx)(fe,{visible:te,title:"Run",onClose:De,children:(0,o.jsx)(mr.Run,{simulation:{id:e.id,scheme:e.scheme},result:V&&{name:V.name,fileName:V.fileName},setResult:G,setVisible:function(e){return ie(e)},swr:{mutateOneSimulation:we}})}))}),[V,te,we,De]),He=(0,s.useCallback)((function(e,n){var t,i,a,r=ge.find((function(n){return n.id===e}));if(r){A(r);var l=null===(t=r.scheme)||void 0===t||null===(i=t.configuration)||void 0===i||null===(a=i.geometry)||void 0===a?void 0:a.value;if(l&&(null===O||void 0===O?void 0:O.id)!==l){var o=ke.find((function(e){return e.id===l}));o&&T(o)}switch(n){case"about":Re(r);break;case"geometry":Ae(r);break;case"parameters":Le(r);break;case"materials":Ve(r);break;case"initialization":Ge(r);break;case"boundaryConditions":Ie(r);break;case"run":Be(r);break;default:ee(void 0)}}}),[O,ke,ge,Re,Ae,Le,Ve,Ge,Ie,Be]);(0,s.useEffect)((function(){J&&(J.key===fr.key?ze(J.id):(He(J.id,J.item),"run"!==J.item&&(G(void 0),q(void 0))))}),[J,ze,He,De]),(0,s.useEffect)((function(){!V&&B&&q(void 0)}),[V,B]);var Ye=(0,s.useCallback)((function(e){var n,t=e.keyPath,i=t.pop(),a=t.pop(),r=t.pop();r&&(n=r.split("&").pop()),$({key:i,id:a,item:n})}),[]),We=ke.map((function(e){return{key:e.id,icon:(0,o.jsx)(h.Z,{}),label:e.name}})),qe=ge.map((function(e){var n=e.scheme.configuration||{},t=[];return Object.keys(n).forEach((function(i){if("dimension"!==i){var a=n[i],r=(0,o.jsx)(v.Z,{style:{color:"green"}});a.error&&(r=(0,o.jsx)(p.Z,{style:{color:"red"}})),a.done||(r=(0,o.jsx)(y.Z,{style:{color:"orange"}})),"geometry"!==i||ke.filter((function(e){return e.id===a.value})).length||Te||(r=(0,o.jsx)(y.Z,{style:{color:"orange"}}),a.done=null),t[a.index]={key:e.id+"&"+i,className:"Project-Menu-SubMenu-Simulations-SubMenu-MenuItem",disabled:!ke.length,icon:r,label:a.title}}})),{key:e.id,className:"Project-Menu-SubMenu-Simulations-SubMenu",icon:(0,o.jsx)(b.Z,{}),label:e.name,children:[{key:e.id+"&about",className:"Project-Menu-SubMenu-Simulations-SubMenu-MenuItem",disabled:!ke.length,icon:(0,o.jsx)(v.Z,{style:{color:"green"}}),label:"About"}].concat((0,r.Z)(t))}}));return!le||se||ye?(0,o.jsx)(S.Z.Simple,{}):"0"===me.id?(0,o.jsx)(_,{}):(0,o.jsx)(H,{children:(0,o.jsxs)(c.Z,{hasSider:!0,children:[(0,o.jsxs)(c.Z.Sider,{theme:"light",className:"Project-Sider",width:256,children:[(0,o.jsx)("div",{className:"logo",children:(0,o.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,o.jsx)(d.Z,{mode:"inline",items:[{key:"menu-go-back",disabled:!0,className:"Project-Menu-GoBack",style:{cursor:"unset",margin:"10px 0",paddingLeft:10},label:(0,o.jsx)(Z.ks,{onClick:function(){return function(e,n,t){e.push({pathname:"/dashboard",query:{page:n,workspaceId:t}})}(e,t,P)},children:"Return to dashboard"})},{type:"divider",className:"Project-Menu-Divider"},{key:"title",disabled:!0,className:"Project-Menu-Title",label:(0,o.jsx)(m.Z.Paragraph,{ellipsis:{tooltip:!0,rows:1},children:me.title})}]}),(0,o.jsx)("div",{className:"Project-Menu-scroll",children:(0,o.jsx)(d.Z,{className:"Project-Menu",mode:"inline",defaultOpenKeys:[fr.key,hr.key],items:[{key:fr.key,className:"Project-Menu-SubMenu-Geometries",icon:Te?(0,o.jsx)(g.Z,{}):(0,o.jsx)(h.Z,{}),label:(0,o.jsxs)(m.Z.Text,{strong:!0,children:[fr.label," (",ke.length,")"]}),children:[{key:"new_geometry",className:"Project-Menu-SubMenu-Geometries-New",disabled:!0,label:(0,o.jsx)(f.Z,{icon:(0,o.jsx)(x.Z,{}),onClick:function(){return N(!0)},children:"New Geometry"})},{key:"geometry-needed",className:"text-dark "+(ke.length?"display-none":""),disabled:!0,icon:(0,o.jsx)(y.Z,{style:{color:"red"}}),label:"A Geometry is needed"}].concat((0,r.Z)(We))},{key:hr.key,className:"Project-Menu-SubMenu-Simulations",icon:Pe?(0,o.jsx)(g.Z,{}):(0,o.jsx)(b.Z,{}),label:(0,o.jsxs)(m.Z.Text,{strong:!0,children:[hr.label," (",ge.length,")"]}),children:[{key:"new_simulation",className:"Project-Menu-SubMenu-Simulations-New",disabled:!0,label:(0,o.jsx)(f.Z,{disabled:!ke.length,icon:(0,o.jsx)(j.Z,{}),onClick:function(){return z(!0)},children:"New Simulation"})}].concat((0,r.Z)(qe))}],onClick:Ye})})]}),(0,o.jsxs)(c.Z.Content,{className:"no-scroll relative",children:[(0,o.jsx)(Fe.Add,{visible:E,project:{id:me.id,geometries:me.geometries},swr:{mutateProject:ve,addOneGeometry:_e},setVisible:function(e){return N(e)}}),(0,o.jsx)(mr.Selector,{user:{authorizedplugins:le.authorizedplugins},visible:U,onOk:function(){var e=(0,i.Z)((function(e){var n;return(0,l.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,xr(me,e,((n={}).addOneSimulation=je,n.mutateProject=ve,n))];case 1:return t.sent(),z(!1),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),onCancel:function(){return z(!1)}}),(0,o.jsx)(mr.Updater,{user:{authorizedplugins:le.authorizedplugins},simulation:R&&{id:R.id,scheme:R.scheme},swr:{mutateOneSimulation:we}}),Q,(0,o.jsx)(Qn,{project:{id:me.id,title:me.title},simulation:R&&{id:R.id},geometry:O&&{id:O.id,needCleanup:O.needCleanup},result:V&&{glb:V.glb,originPath:V.originPath},postprocessing:B&&{glb:B.glb,originPath:B.originPath}}),(0,o.jsx)(pt,{simulation:R&&{id:R.id,name:R.name}}),(0,o.jsx)(mr.Postprocessing,{simulation:R&&{id:R.id,scheme:R.scheme},result:V&&{name:V.name,fileName:V.fileName,originPath:V.originPath},postprocessing:B&&{name:B.name,fileName:B.fileName},setResult:q})]})]})})}},64546:function(e,n,t){var i={"./local/src/components":[17697,697]};function a(e){if(!t.o(i,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=i[e],a=n[0];return t.e(n[1]).then((function(){return t(a)}))}a.keys=function(){return Object.keys(i)},a.id=64546,e.exports=a}}]);