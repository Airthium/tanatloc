"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3407],{11425:function(e,s,t){t.d(s,{R:function(){return c},_:function(){return o}});var n=t(59134),r=t.n(n),i=t(83454);let l=i.env.PORT?parseInt(i.env.PORT):3e3,a=r()()?"http://localhost:"+l:"",o=async(e,s)=>{let t=await fetch(a+e,{method:s?"POST":"GET",headers:{accept:"application/json","Content-Type":"application/json"},...s&&{body:s}}),n=t.headers.get("Content-Type");if(!t.ok){let r=Error("An error occured while fetching data.");throw r.info=(null==n?void 0:n.includes("application/json"))&&await t.json(),r.status=t.status,r}return t.json()},c=async(e,s)=>{let t=await fetch(a+e,{...s,method:s&&s.method||"GET",headers:{...s&&s.headers,"Content-Type":"application/json"}}),n=t.headers.get("Content-Type");if(!t.ok){let r=Error("An error occured while fetching data.");throw r.info=(null==n?void 0:n.includes("application/json"))&&await t.json(),r.status=t.status,r}return t}},55734:function(e,s,t){t.d(s,{Z:function(){return g}});var n=t(8100),r=t(67294),i=t(11425);let l=()=>{let{data:e,error:s,mutate:t}=(0,n.ZP)("/api/user",i._),l=null==e?void 0:e.user,a=(0,r.useCallback)(e=>{t({user:{...l,...e}})},[l,t]),o=(0,r.useCallback)(()=>{t({user:void 0})},[t]);return[l,{mutateUser:a,clearUser:o,errorUser:(null==s?void 0:s.status)===401?void 0:s,loadingUser:(null==s?void 0:s.status)!==401&&!e}]},a=()=>{let{data:e,error:s,mutate:t}=(0,n.ZP)("/api/users",i._),l=(null==e?void 0:e.users)||[],a=(0,r.useCallback)(e=>{let s=[...l,{...e,authorizedplugins:[]}];t({users:s})},[l,t]),o=(0,r.useCallback)(e=>{let s=l.filter(s=>s.id!==e.id);t({users:s})},[l,t]),c=(0,r.useCallback)(e=>{let s=l.map(s=>(s.id===e.id&&(s={...s,...e}),s));t({users:s})},[l,t]);return[l,{addOneUser:a,delOneUser:o,mutateOneUser:c,errorUsers:s,loadingUsers:!e}]},o=async e=>{let s=await (0,i.R)("/api/user",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(e)});return s.json()},c=async e=>{await (0,i.R)("/api/user",{method:"PUT",body:JSON.stringify(e)})},d=async(e,s)=>{await (0,i.R)("/api/user/"+e,{method:"PUT",body:JSON.stringify(s)})},u=async()=>{await (0,i.R)("/api/user",{method:"DELETE"})},h=async e=>{await (0,i.R)("/api/user/"+e,{method:"DELETE"})},p=async e=>{let s=await (0,i.R)("/api/user/check",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(e)});return s.json()};var g={useUser:l,useUsers:a,add:o,update:c,updateById:d,del:u,delById:h,check:p}},28345:function(e,s,t){t.d(s,{AN:function(){return p},ZP:function(){return x}});var n=t(85893),r=t(67294),i=t(227),l=t(67040),a=t(80284),o=t(67582),c=t(26713),d=t(40262);let u={onOk:"Error while submitting deletion"},h=e=>{let{visible:s,loading:t,title:r,children:i,onCancel:h,onOk:p}=e;return(0,n.jsx)(l.Z,{className:"Dialog",title:(0,n.jsx)(a.Z.Text,{ellipsis:{tooltip:!0},children:r}),okText:"Delete",closable:!1,maskClosable:!1,open:s,cancelButtonProps:{disabled:t},onCancel:()=>h(),async onOk(){try{await p()}catch(e){(0,o.lt)(u.onOk,e,!1)}},okButtonProps:{danger:!0,loading:t},children:(0,n.jsxs)(c.Z,{align:"start",children:[(0,n.jsx)(d.Z,{twoToneColor:"#ff4d4f"}),(0,n.jsx)("span",{style:{wordBreak:"break-word"},children:i})]})})};var p=h;let g={onOk:"Error while submitting data"},j=e=>{let{visible:s,loading:t,title:c,initialValues:d,cancelButtonText:u,cancelButtonProps:h,okButtonProps:p,okButtonText:j,children:x,onCancel:f,onOk:m}=e,[v]=i.Z.useForm();return(0,r.useEffect)(()=>{s&&d&&v.setFieldsValue(d)},[s,d,v]),(0,n.jsx)(l.Z,{className:"Dialog",title:(0,n.jsx)(a.Z.Text,{ellipsis:{tooltip:!0},children:c}),open:s,closable:!1,maskClosable:!1,onCancel:f&&(()=>{v.resetFields(),f()}),cancelButtonProps:{...h,disabled:t,style:{display:f?"inline-block":"none"}},cancelText:u,onOk:m&&(async()=>{try{let e=await v.validateFields();await m(e),v.resetFields()}catch(s){(0,o.lt)(g.onOk,s,!1)}}),okText:j,okButtonProps:{...p,loading:t,style:{display:m?"inline-block":"none"}},children:(0,n.jsx)(i.Z,{form:v,layout:"vertical",initialValues:d,children:x})})};var x=j},67582:function(e,s,t){let n,r;t.d(s,{lt:function(){return f},Xq:function(){return Z},Ur:function(){return a}});var i=t(13448);let l=(e,s)=>{i.Z.success({message:e,description:s,duration:10})};var a=l,o=t(85893),c=t(80284),d=t(54907),u=t(26713),h=t(71577),p=t(79074),g=t(60274);p.S1({dsn:"https://3bb27cb32e55433696022ba93cb32430@o394613.ingest.sentry.io/5428383"});let j=[],x=()=>{n&&(i.Z.close(n),n=void 0),j.forEach(e=>i.Z.close(e)),j.length=0,i.Z.close(r),r=void 0};var f=function(e,s){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if((null==s?void 0:s.message)==="Failed to fetch"){if(!n){let l="server_error";j.push(l),i.Z.error({key:l,message:"Server error",description:"Server is disconnected, please check your internet connection.",duration:0,onClose(){n=void 0}}),n=l}return}if(t){var a,p;let f="error_"+j.length;j.push(f),i.Z.error({key:f,message:e,description:s&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c.Z.Text,{code:!0,children:s.message}),(s.status||s.info)&&(0,o.jsx)(d.Z,{children:(0,o.jsx)(d.Z.Panel,{header:"More information",children:(0,o.jsxs)(u.Z,{direction:"vertical",children:[s.status&&(0,o.jsxs)(c.Z.Text,{children:["Status: ",s.status]}),(null===(a=s.info)||void 0===a?void 0:a.message)&&(0,o.jsxs)(c.Z.Text,{children:["Description: ",null===(p=s.info)||void 0===p?void 0:p.message]})]})},"information")})]}),duration:0})}if(s&&console.error(s),s&&g.captureException(s),j.length>1&&!r){let m="close_all";i.Z.info({key:m,message:(0,o.jsx)(h.Z,{type:"primary",onClick:x,children:"Close all"}),description:"Close all error notifications",duration:0,placement:"top"}),r=m}},m=t(227),v=t(14670);let y=e=>{var s,t;let{error:n}=e;return n?(0,o.jsx)(m.Z.Item,{children:(0,o.jsx)(v.Z,{message:n.render||n.title,type:n.type,showIcon:!0,description:n.err&&(0,o.jsxs)(o.Fragment,{children:[n.err.message&&(0,o.jsxs)(c.Z.Text,{type:"danger",children:["Message: ",(0,o.jsx)("code",{children:n.err.message})]}),n.err.status&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("br",{}),(0,o.jsxs)(c.Z.Text,{type:"danger",children:["Status: ",(0,o.jsx)("code",{children:n.err.status})]})]}),(null===(s=n.err.info)||void 0===s?void 0:s.message)&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("br",{}),(0,o.jsxs)(c.Z.Text,{type:"danger",children:["Information: ",(0,o.jsx)("code",{children:null===(t=n.err.info)||void 0===t?void 0:t.message})]})]})]})})}):null};var Z=y},54666:function(e,s,t){var n=t(85893),r=t(67294),i=t(26713),l=t(47987),a=t(11382),o=t(1485),c=t(80284),d=t(97183),u=t(79090),h=t(28058);let p=()=>(0,n.jsx)(i.Z,{style:{height:"100%",width:"100%",justifyContent:"center",alignItems:"center"},children:(0,n.jsx)(l.Z,{children:(0,n.jsxs)(i.Z,{children:[(0,n.jsx)(a.Z,{}),"Loading, please wait..."]})})}),g=e=>{let{text:s,status:t,errors:p}=e,g=(0,r.useRef)(null),[j,x]=(0,r.useState)(),[f,m]=(0,r.useState)();(0,r.useEffect)(()=>{if(!(null==t?void 0:t.length)){x(void 0);return}x((0,n.jsx)("div",{className:"Loading-status",children:(0,n.jsx)(o.Z,{direction:"vertical",items:t.map((e,s)=>({key:s,status:"finish",icon:s===t.length-1?(0,n.jsx)(u.Z,{}):void 0,title:e})).reverse()})}))},[t,p]),(0,r.useEffect)(()=>{if(!(null==p?void 0:p.length)){m(void 0);return}m((0,n.jsxs)("div",{className:"Loading-errors",children:[p.map((e,s)=>{let t=null;return e.includes("docker: command not found")||e.includes("Is the docker daemon running")?t=(0,n.jsxs)(l.Z,{children:["There is an error with your Docker installation.",(0,n.jsx)("br",{}),"Please verify that Docker is correctly installed and running."]}):(e.includes("EHOSTUNREACH")||e.includes("ENETUNREACH")||e.includes("ETIMEOUT"))&&(t=(0,n.jsxs)(l.Z,{children:["There is an error with your PostgreSQL installation.",(0,n.jsx)("br",{}),'Please verify that postgres Docker container "tanatloc-postgres" is correctly installed and running.']})),(0,n.jsxs)("div",{children:[e,t]},s)}),(0,n.jsx)(c.Z.Title,{level:5,style:{color:"red"},children:"Please restart the application"})]}))},[p]);let v=!!(null==t?void 0:t.length)||!!(null==p?void 0:p.length);return(0,n.jsxs)(d.Z,{className:"tanatloc-gradient",children:[(0,n.jsx)("div",{className:"logo",children:(0,n.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,n.jsx)(l.Z,{className:"Loading",bodyStyle:{padding:0},title:(0,n.jsx)(i.Z,{children:(null==p?void 0:p.length)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.Z,{style:{fontSize:"32px",color:"red"}}),(0,n.jsx)(c.Z.Title,{level:3,className:"no-margin",children:"An error occurs"}),(0,n.jsx)("a",{href:"https://github.com/Airthium/tanatloc/issues/new/choose",target:"_blank",rel:"noreferrer",children:"Open an issue"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Z,{size:"large"}),null!=s?s:"Loading, please wait..."]})}),children:v?(0,n.jsxs)("div",{ref:g,className:"Loading-content",children:[f,j]}):null})]})};g.Simple=p,s.Z=g}}]);