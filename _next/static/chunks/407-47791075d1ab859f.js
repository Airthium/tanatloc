"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[407],{11425:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{R:function(){return call},_:function(){return fetcher}});var is_electron__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(59134),is_electron__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(is_electron__WEBPACK_IMPORTED_MODULE_0__),process=__webpack_require__(83454);let port=process.env.PORT?parseInt(process.env.PORT):3e3,base=is_electron__WEBPACK_IMPORTED_MODULE_0___default()()?"http://localhost:"+port:"",fetcher=async(url,payload)=>{let response=await fetch(base+url,{method:payload?"POST":"GET",headers:{accept:"application/json","Content-Type":"application/json"},...payload&&{body:payload}}),contentType=response.headers.get("Content-Type");if(!response.ok){let error=Error("An error occured while fetching data.");throw error.info=(null==contentType?void 0:contentType.includes("application/json"))&&await response.json(),error.status=response.status,error}return response.json()},call=async(route,param)=>{let response=await fetch(base+route,{...param,method:param&&param.method||"GET",headers:{...param&&param.headers,"Content-Type":"application/json"}}),contentType=response.headers.get("Content-Type");if(!response.ok){let error=Error("An error occured while fetching data.");throw error.info=(null==contentType?void 0:contentType.includes("application/json"))&&await response.json(),error.status=response.status,error}return response}},55734:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return user}});var dist=__webpack_require__(8100),react=__webpack_require__(67294),call=__webpack_require__(11425);let useUser=()=>{let{data,error,mutate}=(0,dist.ZP)("/api/user",call._),user=null==data?void 0:data.user,localMutate=(0,react.useCallback)(update=>{mutate({user:{...user,...update}})},[user,mutate]),clear=(0,react.useCallback)(()=>{mutate({user:void 0})},[mutate]);return[user,{mutateUser:localMutate,clearUser:clear,errorUser:(null==error?void 0:error.status)===401?void 0:error,loadingUser:(null==error?void 0:error.status)!==401&&!data}]},useUsers=()=>{let{data,error,mutate}=(0,dist.ZP)("/api/users",call._),users=(null==data?void 0:data.users)||[],addOne=(0,react.useCallback)(user=>{let newUsers=[...users,{...user,authorizedplugins:[]}];mutate({users:newUsers})},[users,mutate]),delOne=(0,react.useCallback)(user=>{let filteredUsers=users.filter(u=>u.id!==user.id);mutate({users:filteredUsers})},[users,mutate]),mutateOne=(0,react.useCallback)(user=>{let mutatedUsers=users.map(u=>(u.id===user.id&&(u={...u,...user}),u));mutate({users:mutatedUsers})},[users,mutate]);return[users,{addOneUser:addOne,delOneUser:delOne,mutateOneUser:mutateOne,errorUsers:error,loadingUsers:!data}]},add=async user=>{let response=await (0,call.R)("/api/user",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(user)});return response.json()},update=async data=>{await (0,call.R)("/api/user",{method:"PUT",body:JSON.stringify(data)})},updateById=async(id,data)=>{await (0,call.R)("/api/user/"+id,{method:"PUT",body:JSON.stringify(data)})},del=async()=>{await (0,call.R)("/api/user",{method:"DELETE"})},delById=async id=>{await (0,call.R)("/api/user/"+id,{method:"DELETE"})},check=async user=>{let response=await (0,call.R)("/api/user/check",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(user)});return response.json()};var user={useUser:useUser,useUsers:useUsers,add:add,update:update,updateById:updateById,del:del,delById:delById,check:check}},28345:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{AN:function(){return dialog_delete},ZP:function(){return dialog}});var jsx_runtime=__webpack_require__(85893),react=__webpack_require__(67294),es_form=__webpack_require__(81579),modal=__webpack_require__(67040),typography=__webpack_require__(6880),notification=__webpack_require__(67582),space=__webpack_require__(26713),ExclamationCircleTwoTone=__webpack_require__(40262);let errors={onOk:"Error while submitting deletion"},DeleteDialog=param=>{let{visible,loading,title,children,onCancel,onOk}=param;return(0,jsx_runtime.jsx)(modal.Z,{className:"Dialog",title:(0,jsx_runtime.jsx)(typography.Z.Text,{ellipsis:{tooltip:!0},children:title}),okText:"Delete",closable:!1,maskClosable:!1,open:visible,cancelButtonProps:{disabled:loading},onCancel:()=>onCancel(),async onOk(){try{await onOk()}catch(err){(0,notification.lt)(errors.onOk,err,!1)}},okButtonProps:{danger:!0,loading:loading},children:(0,jsx_runtime.jsxs)(space.Z,{align:"start",children:[(0,jsx_runtime.jsx)(ExclamationCircleTwoTone.Z,{twoToneColor:"#ff4d4f"}),(0,jsx_runtime.jsx)("span",{style:{wordBreak:"break-word"},children:children})]})})};var dialog_delete=DeleteDialog;let dialog_errors={onOk:"Error while submitting data"},Dialog=param=>{let{visible,loading,title,initialValues,cancelButtonText,cancelButtonProps,okButtonProps,okButtonText,children,onCancel,onOk}=param,[form]=es_form.Z.useForm();return(0,react.useEffect)(()=>{visible&&initialValues&&form.setFieldsValue(initialValues)},[visible,initialValues,form]),(0,jsx_runtime.jsx)(modal.Z,{className:"Dialog",title:(0,jsx_runtime.jsx)(typography.Z.Text,{ellipsis:{tooltip:!0},children:title}),open:visible,closable:!1,maskClosable:!1,onCancel:onCancel&&(()=>{form.resetFields(),onCancel()}),cancelButtonProps:{...cancelButtonProps,disabled:loading,style:{display:onCancel?"inline-block":"none"}},cancelText:cancelButtonText,onOk:onOk&&(async()=>{try{let values=await form.validateFields();await onOk(values),form.resetFields()}catch(err){(0,notification.lt)(dialog_errors.onOk,err,!1)}}),okText:okButtonText,okButtonProps:{...okButtonProps,loading:loading,style:{display:onOk?"inline-block":"none"}},children:(0,jsx_runtime.jsx)(es_form.Z,{form:form,layout:"vertical",initialValues:initialValues,children:children})})};var dialog=Dialog},67582:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){let serverNotification,closeNotification;__webpack_require__.d(__webpack_exports__,{lt:function(){return error},Xq:function(){return form_error},Ur:function(){return success}});var notification=__webpack_require__(13448);let SuccessNotification=(title,subTitle)=>{notification.Z.success({message:title,description:subTitle,duration:10})};var success=SuccessNotification,jsx_runtime=__webpack_require__(85893),typography=__webpack_require__(6880),collapse=__webpack_require__(54907),space=__webpack_require__(26713),es_button=__webpack_require__(71577),sdk=__webpack_require__(79074),esm=__webpack_require__(60274);sdk.S1({dsn:"https://3bb27cb32e55433696022ba93cb32430@o394613.ingest.sentry.io/5428383"});let opened=[],closeAll=()=>{serverNotification&&(notification.Z.close(serverNotification),serverNotification=void 0),opened.forEach(notif=>notification.Z.close(notif)),opened.length=0,notification.Z.close(closeNotification),closeNotification=void 0};var error=function(title,err){let display=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if((null==err?void 0:err.message)==="Failed to fetch"){if(!serverNotification){let key="server_error";opened.push(key),notification.Z.error({key,message:"Server error",description:"Server is disconnected, please check your internet connection.",duration:0,onClose(){serverNotification=void 0}}),serverNotification=key}return}if(display){var ref,ref1;let key1="error_"+opened.length;opened.push(key1),notification.Z.error({key:key1,message:title,description:err&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(typography.Z.Text,{code:!0,children:err.message}),(err.status||err.info)&&(0,jsx_runtime.jsx)(collapse.Z,{children:(0,jsx_runtime.jsx)(collapse.Z.Panel,{header:"More information",children:(0,jsx_runtime.jsxs)(space.Z,{direction:"vertical",children:[err.status&&(0,jsx_runtime.jsxs)(typography.Z.Text,{children:["Status: ",err.status]}),(null===(ref=err.info)||void 0===ref?void 0:ref.message)&&(0,jsx_runtime.jsxs)(typography.Z.Text,{children:["Description: ",null===(ref1=err.info)||void 0===ref1?void 0:ref1.message]})]})},"information")})]}),duration:0})}if(err&&console.error(err),err&&esm.captureException(err),opened.length>1&&!closeNotification){let key2="close_all";notification.Z.info({key:key2,message:(0,jsx_runtime.jsx)(es_button.Z,{type:"primary",onClick:closeAll,children:"Close all"}),description:"Close all error notifications",duration:0,placement:"top"}),closeNotification=key2}},es_form=__webpack_require__(81579),es_alert=__webpack_require__(14670);let FormError=param=>{var ref,ref1;let{error}=param;return error?(0,jsx_runtime.jsx)(es_form.Z.Item,{children:(0,jsx_runtime.jsx)(es_alert.Z,{message:error.render||error.title,type:error.type,showIcon:!0,description:error.err&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[error.err.message&&(0,jsx_runtime.jsxs)(typography.Z.Text,{type:"danger",children:["Message: ",(0,jsx_runtime.jsx)("code",{children:error.err.message})]}),error.err.status&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsxs)(typography.Z.Text,{type:"danger",children:["Status: ",(0,jsx_runtime.jsx)("code",{children:error.err.status})]})]}),(null===(ref=error.err.info)||void 0===ref?void 0:ref.message)&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsxs)(typography.Z.Text,{type:"danger",children:["Information: ",(0,jsx_runtime.jsx)("code",{children:null===(ref1=error.err.info)||void 0===ref1?void 0:ref1.message})]})]})]})})}):null};var form_error=FormError},54666:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(85893),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(67294),antd__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(26713),antd__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(81474),antd__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(11382),antd__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1485),antd__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(6880),antd__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(97183),_ant_design_icons__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(50888),_ant_design_icons__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(28058);let Simple=()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(antd__WEBPACK_IMPORTED_MODULE_2__.Z,{style:{height:"100%",width:"100%",justifyContent:"center",alignItems:"center"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(antd__WEBPACK_IMPORTED_MODULE_3__.Z,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(antd__WEBPACK_IMPORTED_MODULE_2__.Z,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(antd__WEBPACK_IMPORTED_MODULE_4__.Z,{}),"Loading, please wait..."]})})}),Loading=param=>{let{text,status,errors}=param,contentRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null),[statusDisplay,setStatusDisplay]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(),[errorsDisplay,setErrorsDisplay]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)();(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{if(!(null==status?void 0:status.length)){setStatusDisplay(void 0);return}setStatusDisplay((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"Loading-status",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(antd__WEBPACK_IMPORTED_MODULE_5__.Z,{direction:"vertical",items:status.map((desc,index)=>({key:index,status:"finish",icon:index===status.length-1?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_ant_design_icons__WEBPACK_IMPORTED_MODULE_6__.Z,{}):void 0,title:desc})).reverse()})}))},[status,errors]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{if(!(null==errors?void 0:errors.length)){setErrorsDisplay(void 0);return}setErrorsDisplay((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"Loading-errors",children:[errors.map((err,index)=>{let child=null;return err.includes("docker: command not found")||err.includes("Is the docker daemon running")?child=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(antd__WEBPACK_IMPORTED_MODULE_3__.Z,{children:["There is an error with your Docker installation.",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("br",{}),"Please verify that Docker is correctly installed and running."]}):(err.includes("EHOSTUNREACH")||err.includes("ENETUNREACH")||err.includes("ETIMEOUT"))&&(child=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(antd__WEBPACK_IMPORTED_MODULE_3__.Z,{children:["There is an error with your PostgreSQL installation.",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("br",{}),'Please verify that postgres Docker container "tanatloc-postgres" is correctly installed and running.']})),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:[err,child]},index)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(antd__WEBPACK_IMPORTED_MODULE_7__.Z.Title,{level:5,style:{color:"red"},children:"Please restart the application"})]}))},[errors]);let display=!!(null==status?void 0:status.length)||!!(null==errors?void 0:errors.length);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(antd__WEBPACK_IMPORTED_MODULE_8__.Z,{className:"tanatloc-gradient",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"logo",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(antd__WEBPACK_IMPORTED_MODULE_3__.Z,{className:"Loading",bodyStyle:{padding:0},title:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(antd__WEBPACK_IMPORTED_MODULE_2__.Z,{children:(null==errors?void 0:errors.length)?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_ant_design_icons__WEBPACK_IMPORTED_MODULE_9__.Z,{style:{fontSize:"32px",color:"red"}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(antd__WEBPACK_IMPORTED_MODULE_7__.Z.Title,{level:3,className:"no-margin",children:"An error occurs"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("a",{href:"https://github.com/Airthium/tanatloc/issues/new/choose",target:"_blank",rel:"noreferrer",children:"Open an issue"})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(antd__WEBPACK_IMPORTED_MODULE_4__.Z,{size:"large"}),null!=text?text:"Loading, please wait..."]})}),children:display?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{ref:contentRef,className:"Loading-content",children:[errorsDisplay,statusDisplay]}):null})]})};Loading.Simple=Simple,__webpack_exports__.Z=Loading}}]);