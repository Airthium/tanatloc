(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[429],{41686:function(e,n,t){"use strict";t.d(n,{Z:function(){return u}});var i=t(47568),r=t(20414),a=t(87492),o=function(){var e=(0,i.Z)((function(e,n){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,a.R)("/api/avatar",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({file:e,project:n})})];case 1:return[2,t.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),u={add:o}},24443:function(e,n,t){"use strict";t.d(n,{Z:function(){return m}});var i=t(47568),r=t(20414),a=t(87492),o=function(){var e=(0,i.Z)((function(e){return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,a.R)("/api/plugin",{method:"POST",body:JSON.stringify(e)})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),u=function(){var e=(0,i.Z)((function(e){return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,a.R)("/api/plugin",{method:"PUT",body:JSON.stringify(e)})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),l=function(){var e=(0,i.Z)((function(e){return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,a.R)("/api/plugin",{method:"DELETE",body:JSON.stringify(e)})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),s=t(26042),c=t(29815),d=t(8100),f=t(67294),m={add:o,update:u,del:l,usePlugins:function(){var e=(0,d.ZP)("/api/plugin",a._),n=e.data,t=e.error,i=e.mutate,r=!n,o=(null===n||void 0===n?void 0:n.plugins)||[],u=(0,f.useCallback)((function(e){var n=(0,c.Z)(o).concat([e]);i({plugins:n})}),[o,i]),l=(0,f.useCallback)((function(e){var n=o.filter((function(n){return n.key!==e.key}));i({plugins:n})}),[o,i]),m=(0,f.useCallback)((function(e){var n=o.map((function(n){return n.key===e.key&&(n=(0,s.Z)({},n,e)),n}));i({plugins:n})}),[o,i]);return[o,{mutatePlugins:i,addOnePlugin:u,delOnePlugin:l,mutateOnePlugin:m,errorPlugins:t,loadingPlugins:r}]}}},4687:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var i=t(47568),r=t(20414),a=t(87492),o=function(){var e=(0,i.Z)((function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,a.R)("/api/plugins",{method:"GET",headers:{Accept:"application/json"}})];case 1:return[2,e.sent().json()]}}))}));return function(){return e.apply(this,arguments)}}(),u=function(){var e=(0,i.Z)((function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,a.R)("/api/plugins",{method:"POST",headers:{Accept:"application/json"}})];case 1:return[2,e.sent().json()]}}))}));return function(){return e.apply(this,arguments)}}(),l={list:o,completeList:u}},94370:function(e,n,t){"use strict";t.d(n,{Z:function(){return x}});var i=t(26042),r=t(69396),a=t(29815),o=t(8100),u=t(67294),l=t(87492),s=t(47568),c=t(20414),d=function(){var e=(0,s.Z)((function(e,n){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,l.R)("/api/project",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({workspace:{id:e.id},project:n})})];case 1:return[2,t.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),f=function(){var e=(0,s.Z)((function(e,n){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,l.R)("/api/project/"+e.id,{method:"PUT",body:JSON.stringify(n)})];case 1:return t.sent(),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),m=function(){var e=(0,s.Z)((function(e,n){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,l.R)("/api/project/"+n.id,{method:"DELETE",body:JSON.stringify({id:e.id})})];case 1:return t.sent(),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),h=function(){var e=(0,s.Z)((function(e){return(0,c.__generator)(this,(function(n){return[2,(0,l.R)("/api/project/"+e.id+"/archive",{method:"GET",headers:{Accept:"application/json"}})]}))}));return function(n){return e.apply(this,arguments)}}(),v=function(){var e=(0,s.Z)((function(e){return(0,c.__generator)(this,(function(n){return[2,(0,l.R)("/api/project/"+e.id+"/archive",{method:"PUT"})]}))}));return function(n){return e.apply(this,arguments)}}(),p=function(){var e=(0,s.Z)((function(e){return(0,c.__generator)(this,(function(n){return[2,(0,l.R)("/api/project/"+e.id+"/archive",{method:"DELETE"})]}))}));return function(n){return e.apply(this,arguments)}}(),y=function(){var e=(0,s.Z)((function(e,n){return(0,c.__generator)(this,(function(t){return[2,(0,l.R)("/api/project/"+e.id+"/archive",{method:"POST",body:JSON.stringify({archive:n})})]}))}));return function(n,t){return e.apply(this,arguments)}}(),g={useProjects:function(e){var n=(0,o.ZP)(["/api/projects",JSON.stringify({ids:e})],l._),t=n.data,s=n.error,c=n.mutate,d=!t,f=(null===t||void 0===t?void 0:t.projects)||[],m=(0,u.useCallback)((function(e){var n=(0,a.Z)(f).concat([(0,r.Z)((0,i.Z)({},e),{users:[],geometries:[],simulations:[],groups:[]})]);c({projects:n})}),[f,c]),h=(0,u.useCallback)((function(e){var n=f.filter((function(n){return n.id!==e.id}));c({projects:n})}),[f,c]),v=(0,u.useCallback)((function(e){var n=f.map((function(n){return n.id===e.id&&(n=(0,i.Z)({},n,e)),n}));c({projects:n})}),[f,c]);return[f,{addOneProject:m,delOneProject:h,mutateOneProject:v,errorProjects:s,loadingProjects:d}]},useProject:function(e){var n=(0,o.ZP)("/api/project"+(e?"/"+e:""),l._),t=n.data,r=n.error,a=n.mutate,s=!t,c=(null===t||void 0===t?void 0:t.project)||{id:"0"},d=(0,u.useCallback)((function(e){var n=(0,i.Z)({},c,e);a({project:n})}),[c,a]);return[c,{mutateProject:d,errorProject:r,loadingProject:s}]},add:d,update:f,del:m,archive:h,unarchiveFromServer:v,deleteArchiveFile:p,unarchiveFromFile:y},x=g},83283:function(e,n,t){"use strict";t.d(n,{Z:function(){return g}});var i=t(26042),r=t(29815),a=t(8100),o=t(67294),u=t(87492),l=t(47568),s=t(20414),c=function(){var e=(0,l.Z)((function(e,n){return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,u.R)("/api/simulation",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({project:{id:e.id},simulation:n})})];case 1:return[2,t.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),d=function(){var e=(0,l.Z)((function(e,n){return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,u.R)("/api/simulation/"+e.id,{method:"PUT",body:JSON.stringify(n)})];case 1:return t.sent(),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),f=function(){var e=(0,l.Z)((function(e){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,u.R)("/api/simulation/"+e.id,{method:"DELETE"})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),m=function(){var e=(0,l.Z)((function(e){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,u.R)("/api/simulation/"+e.id+"/run",{method:"GET"})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),h=function(){var e=(0,l.Z)((function(e){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,u.R)("/api/simulation/"+e.id+"/stop",{method:"GET"})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),v=function(){var e=(0,l.Z)((function(e){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,u.R)("/api/simulation/"+e.id+"/tasks",{method:"GET",headers:{Accept:"application/json"}})];case 1:return[2,n.sent().json()]}}))}));return function(n){return e.apply(this,arguments)}}(),p=function(){var e=(0,l.Z)((function(e,n){return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,u.R)("/api/simulation/"+e.id+"/log",{method:"POST",body:JSON.stringify({file:n})})];case 1:return[2,t.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),y={useSimulations:function(e){var n=(0,a.ZP)(["/api/simulations",JSON.stringify({ids:e})],u._),t=n.data,l=n.error,s=n.mutate,c=!t,d=(null===t||void 0===t?void 0:t.simulations)||[],f=(0,o.useCallback)((function(e){var n=(0,r.Z)(d).concat([e]);s({simulations:n})}),[d,s]),m=(0,o.useCallback)((function(e){var n=d.filter((function(n){return n.id!==e.id}));s({simulations:n})}),[d,s]),h=(0,o.useCallback)((function(e,n){var t=d.map((function(n){return n.id===e.id&&(n=(0,i.Z)({},n,e)),n}));s({simulations:t},n)}),[d,s]);return[d,{addOneSimulation:f,delOneSimulation:m,mutateOneSimulation:h,errorSimulations:l,loadingSimulations:c}]},useSimulation:function(e,n){var t=(0,a.ZP)("/api/simulation"+(e?"/"+e:""),u._,{refreshInterval:n||0}),r=t.data,l=t.error,s=t.mutate,c=!r,d=(null===r||void 0===r?void 0:r.simulation)||{id:"0"},f=(0,o.useCallback)((function(e){s({simulation:(0,i.Z)({},d,e)})}),[d,s]);return[d,{mutateSimulation:f,errorSimulation:l,loadingSimulation:c}]},add:c,update:d,del:f,run:m,stop:h,tasks:v,log:p},g=y},70429:function(e,n,t){"use strict";t.d(n,{ZP:function(){return Jr}});var i=t(47568),r=t(828),a=t(29815),o=t(20414),u=t(85893),l=t(5152),s=t.n(l),c=t(11163),d=t(67294),f=t(84908),m=t(97183),h=t(66516),v=t(6880),p=t(71577),y=t(48869),g=t(8751),x=t(18429),b=t(11475),Z=t(73480),j=t(22844),w=t(50888),C=t(88484),S=t(64789),k=t(41641),P=t(96844),E=t(75107),_=t(81474),N=t(26713),O=t(20280),M="You are not allowed to be here.",T=function(){var e=(0,c.useRouter)();return(0,d.useEffect)((function(){e.prefetch("/")}),[e]),(0,u.jsx)(m.Z,{children:(0,u.jsx)(m.Z.Content,{children:(0,u.jsx)(_.Z,{title:"Not allowed",children:(0,u.jsxs)(N.Z,{direction:"vertical",children:[(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)(O.Z,{style:{color:"red"}})," ",M]}),(0,u.jsxs)(v.Z.Text,{children:["Go back"," ",(0,u.jsx)(p.Z,{type:"link",onClick:function(){return function(e){e.push("/")}(e)},children:"home"})]})]})})})})},z=t(26042),A=t(69396),F={enabled:!1,type:void 0,part:void 0,highlighted:void 0,selected:[],point:void 0,dispatch:function(){}},R="ENABLE",D="DISABLE",L="CLEAR",U="SETTYPE",V="SETPART",I="HIGHLIGHT",B="UNHIGHLIGHT",H="SELECT",G="UNSELECT",W="SETPOINT",Y=(0,d.createContext)(F),J=function(e,n){var t;switch(n.type){case R:return(0,A.Z)((0,z.Z)({},e),{enabled:!0});case D:return(0,A.Z)((0,z.Z)({},e),{enabled:!1,highlighted:void 0,selected:[]});case L:return(0,z.Z)({},F);case U:return(0,A.Z)((0,z.Z)({},e),{type:n.value});case V:return(0,A.Z)((0,z.Z)({},e),{part:n.value});case I:return(0,A.Z)((0,z.Z)({},e),{highlighted:n.value});case B:return(0,A.Z)((0,z.Z)({},e),{highlighted:void 0});case H:return-1===(t=e.selected.findIndex((function(e){return e.uuid===n.value.uuid})))?(0,A.Z)((0,z.Z)({},e),{selected:(0,a.Z)(e.selected).concat([n.value])}):e;case G:return-1===(t=e.selected.findIndex((function(e){return e.uuid===n.value.uuid})))?e:(0,A.Z)((0,z.Z)({},e),{selected:(0,a.Z)(e.selected.slice(0,t)).concat((0,a.Z)(e.selected.slice(t+1)))});case W:return(0,A.Z)((0,z.Z)({},e),{point:n.value});default:return e}},X=function(e){var n=e.children,t=(0,d.useReducer)(J,F),i=t[0],r=t[1];return(0,u.jsx)(Y.Provider,{value:(0,A.Z)((0,z.Z)({},i),{dispatch:r}),children:n})},q=t(67169),K=t(94370),Q=t(83283),$=t(8100),ee=t(87492),ne=function(){var e=(0,i.Z)((function(e,n){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,ee.R)("/api/geometry",{method:"POST",body:JSON.stringify({project:e,geometry:n})})];case 1:return[2,t.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),te=function(){var e=(0,i.Z)((function(e,n){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,ee.R)("/api/geometry/"+e.id,{method:"PUT",body:JSON.stringify(n)})];case 1:return t.sent(),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),ie=function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,ee.R)("/api/geometry/"+e.id,{method:"DELETE"})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),re=function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,ee.R)("/api/geometry/"+e.id+"/download")];case 1:return[2,n.sent().json()]}}))}));return function(n){return e.apply(this,arguments)}}(),ae=function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,ee.R)("/api/geometry/"+e.id+"/part")];case 1:return[2,n.sent().json()]}}))}));return function(n){return e.apply(this,arguments)}}(),oe={useGeometries:function(e){var n=(0,$.ZP)(["/api/geometries",JSON.stringify({ids:e})],ee._),t=n.data,i=n.error,r=n.mutate,o=!t,u=(null===t||void 0===t?void 0:t.geometries)||[],l=(0,d.useCallback)((function(e){var n=(0,a.Z)(u).concat([e]);r({geometries:n})}),[u,r]),s=(0,d.useCallback)((function(e){var n=u.filter((function(n){return n.id!==e.id}));r({geometries:n})}),[u,r]),c=(0,d.useCallback)((function(e){var n=u.map((function(n){return n.id===e.id&&(n=(0,z.Z)({},n,e)),n}));r({geometries:n})}),[u,r]);return[u,{addOneGeometry:l,delOneGeometry:s,mutateOneGeometry:c,errorGeometries:i,loadingGeometries:o}]},add:ne,update:te,del:ie,download:re,getPart:ae},ue=oe,le=t(97937),se=function(e){var n=e.visible,t=e.title,i=e.children,r=e.onClose;return(0,u.jsx)(_.Z,{className:"panel",bodyStyle:{maxHeight:"calc(100vh - 65px)",overflow:"auto",padding:0},title:t,extra:(0,u.jsx)(p.Z,{type:"text",icon:(0,u.jsx)(le.Z,{}),onClick:function(){return r()}}),style:{display:n?"block":"none"},children:i})},ce=t(42473),de=t(78116),fe=t(32834),me=t(48764).lW,he="Unable to add geometry",ve=function(e){return e.name.toLowerCase().includes(".stp")||e.name.toLowerCase().includes(".step")||e.name.toLowerCase().includes(".dxf")},pe=function(){var e=(0,i.Z)((function(e){var n;return(0,o.__generator)(this,(function(t){return n=new FileReader,[2,new Promise((function(t){n.addEventListener("load",(function(){t(n.result)})),n.readAsArrayBuffer(e)}))]}))}));return function(n){return e.apply(this,arguments)}}(),ye=function(){var e=(0,i.Z)((function(e,n,t){var i,r,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return"uploading"===n.file.status?[2,!0]:"done"!==n.file.status?[3,5]:[4,pe(n.file.originFileObj)];case 1:i=o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,ue.add({id:e.id},{name:n.file.name,uid:n.file.uid,buffer:me.from(i)})];case 3:return r=o.sent(),t.addOneGeometry(r),t.mutateProject({id:e.id,geometries:(0,a.Z)(e.geometries).concat([r.id])}),[3,5];case 4:throw u=o.sent(),(0,P.lt)(he,u),u;case 5:return[2,!1]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),ge=function(e){var n=e.visible,t=e.project,r=e.swr,a=e.setVisible,l=(0,d.useState)(!1),s=l[0],c=l[1];return(0,u.jsx)(fe.ZP,{title:"Upload geometry",visible:n,onCancel:function(){return a(!1)},cancelButtonProps:{loading:s},children:(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(de.Z,{className:"upload",action:"/api/noop",accept:".stp,.step,.dxf",showUploadList:!1,listType:"picture-card",beforeUpload:ve,onChange:function(){var e=(0,i.Z)((function(e){var n;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,ye(t,e,r)];case 1:return n=i.sent(),c(n),a(n),[3,3];case 2:return i.sent(),c(!1),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:(0,u.jsx)("div",{children:s?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(w.Z,{style:{fontSize:25}}),(0,u.jsxs)("div",{style:{marginTop:8},children:[(0,u.jsx)("b",{children:"Loading"}),", converting, ..."]})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(C.Z,{style:{fontSize:25}}),(0,u.jsxs)("div",{style:{marginTop:8},children:[(0,u.jsx)("b",{children:"Choose a file"})," or drop it here"]})]})})}),(0,u.jsx)(v.Z.Text,{children:(0,u.jsx)("p",{style:{color:"rgba(0, 0, 0, 0.45)",textAlign:"center"},children:"Native file format preferred: STEP (3D) or DXF (2D) file"})})]})})},xe=t(81579),be=t(69677),Ze=function(e){var n=e.visible,t=e.geometry,r=e.setVisible,a=e.onEdit,l=(0,d.useState)(!1),s=l[0],c=l[1];return(0,u.jsx)(fe.ZP,{title:"Edit the geometry's name",visible:n,initialValues:{name:t.name},onCancel:function(){return r(!1)},onOk:function(){var e=(0,i.Z)((function(e){var n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:c(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,a(e)];case 2:return t.sent(),c(!1),r(!1),[3,4];case 3:throw n=t.sent(),c(!1),n;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),loading:s,children:(0,u.jsx)(xe.Z.Item,{name:"name",label:"Name:",rules:[{required:!0,message:"Name is required"}],children:(0,u.jsx)(be.Z,{})})})},je=t(48764).lW,we="Unable to download geometry",Ce="Unable to update geometry",Se="Unable to delete geometry",ke=function(){var e=(0,i.Z)((function(e){var n,t,i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,ue.download({id:e.id})];case 1:return n=o.sent(),t=new File([je.from(n.buffer).toString()],e.name+"."+n.extension),i=window.URL.createObjectURL(t),(r=document.createElement("a")).href=i,r.setAttribute("download",e.name+"."+n.extension),r.click(),r.remove(),[3,3];case 2:return a=o.sent(),(0,P.lt)(we,a),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Pe=function(){var e=(0,i.Z)((function(e,n,t){var i;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,ue.update({id:e.id},[{key:"name",value:n.name}])];case 1:return r.sent(),e.name=n.name,t.mutateOneGeometry(e),[3,3];case 2:throw i=r.sent(),(0,P.lt)(Ce,i),i;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Ee=function(){var e=(0,i.Z)((function(e,n,t,i){var r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,ue.del({id:e.id})];case 1:return o.sent(),r=n.geometries.filter((function(n){return n!==e.id})),i.mutateProject({id:n.id,geometries:r}),i.delOneGeometry(e),t(),[3,3];case 2:throw a=o.sent(),(0,P.lt)(Se,a),a;case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),_e=function(e){var n,t,r,a,l,s,c=e.project,f=e.geometry,h=e.swr,p=e.close,y=e.onCleanup,g=(0,d.useState)(!1),x=g[0],b=g[1],Z=(0,d.useState)(!1),j=Z[0],w=Z[1],C=(0,d.useState)(!1),S=C[0],P=C[1];return f?(0,u.jsx)(m.Z,{children:(0,u.jsx)(m.Z.Content,{children:(0,u.jsx)(_.Z,{size:"small",title:"Informations",actions:[(0,u.jsx)(k.o6,{loading:x,onDownload:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:b(!0),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,ke(f)];case 2:return e.sent(),[3,5];case 3:return e.sent(),[3,5];case 4:return b(!1),[7];case 5:return[2]}}))}))},"download"),(0,u.jsxs)("div",{children:[(0,u.jsx)(Ze,{visible:j,geometry:{id:null===f||void 0===f?void 0:f.id,name:null===f||void 0===f?void 0:f.name},setVisible:w,onEdit:function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){return[2,Pe(f,e,h)]}))}));return function(n){return e.apply(this,arguments)}}()}),(0,u.jsx)(k.w6,{onEdit:function(){return w(!0)}})]},"edit"),(0,u.jsx)(k.m1,{loading:S,text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the geometry"," ",(0,u.jsx)(v.Z.Text,{strong:!0,children:f.name}),"?"]}),onDelete:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:P(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Ee(f,c,p,h)];case 2:return e.sent(),y(),[3,4];case 3:return P(!1),[7];case 4:return[2]}}))}))},"delete")],children:(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"File:"})," ",f.name," "]}),(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Unit:"})," ",(0,u.jsx)(ce.Z.Inline,{text:"m"})]}),(0,u.jsxs)(u.Fragment,{children:[3===f.summary.dimension&&(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Number of solids:"})," ",null!==(a=null===(n=f.summary.solids)||void 0===n?void 0:n.length)&&void 0!==a?a:0]}),(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Number of faces:"})," ",null!==(l=null===(t=f.summary.faces)||void 0===t?void 0:t.length)&&void 0!==l?l:0]}),2===f.summary.dimension&&(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Number of edges:"})," ",null!==(s=null===(r=f.summary.edges)||void 0===r?void 0:r.length)&&void 0!==s?s:0]})]})]})})})}):(0,u.jsx)(E.Z.Simple,{})};_e.Add=ge;var Ne,Oe,Me,Te=_e,ze=function(){var e=(0,i.Z)((function(e,n){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,ee.R)("/api/result",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({simulation:e,result:n})})];case 1:return[2,t.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),Ae=function(){var e=(0,i.Z)((function(e,n){return(0,o.__generator)(this,(function(t){return[2,(0,ee.R)("/api/result/download",{method:"POST",body:JSON.stringify({simulation:e,result:n})})]}))}));return function(n,t){return e.apply(this,arguments)}}(),Fe=function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){return[2,(0,ee.R)("/api/result/archive",{method:"POST",body:JSON.stringify({simulation:e})})]}))}));return function(n){return e.apply(this,arguments)}}(),Re={load:ze,download:Ae,archive:Fe},De=Re,Le=t(13013),Ue=t(27049),Ve=t(94594),Ie=t(11382),Be=t(41428),He=t(38095),Ge=t(86350),We=t(15668),Ye=t(74317),Je=t(35598),Xe=t(49591),qe=t(19478),Ke=t(87784),Qe=t(90420),$e=t(75843),en=t(99477),nn=t(57632),tn=t(79753),rn=t(54458),an=t(58939),on=t(24065),un=t(54327),ln=function(e){var n=new en.fHI(.025,.025,.8,50);n.translate(0,.4,0);var t=new en.vBJ({color:e}),i=new en.Kj0(n,t),r=new en.b_z(.05,.2,50);r.translate(0,.9,0);var a=new en.vBJ({color:e}),o=new en.Kj0(r,a),u=new en.ZAu;u.type="ArrowHelper",u.add(i),u.add(o);return u.dispose=function(){n.dispose(),t.dispose(),r.dispose(),a.dispose()},u},sn=function(e,n,t){var i=document.createElement("canvas");i.width=(null===t||void 0===t?void 0:t.width)||256,i.height=256;var r=i.getContext("2d");r.fillStyle="grey",r.font="50px sans-serif",r.textAlign=(null===t||void 0===t?void 0:t.align)||"center",r.textBaseline="middle",r.fillText(n,i.width/2,i.height/2);var a=new en.xEZ(i);a.flipY=!0,a.needsUpdate=!0;var o=new en.xeV({map:a,transparent:!0,depthWrite:!1});o.map.anisotropy=e.capabilities.getMaxAnisotropy();var u=new en.jyi(o);u.type="LabelHelper",(null===t||void 0===t?void 0:t.position)&&u.position.copy(t.position),(null===t||void 0===t?void 0:t.scale)&&u.scale.setScalar(t.scale);return u.dispose=function(){a.dispose(),o.dispose()},u},cn=function(e){return Math.abs(e)<1e-12?"0":Math.abs(e)>1e3||Math.abs(e)<.001?e.toExponential(2):e.toFixed(3)},dn=function(e,n,t,i){var r,a,o,u=function(e,n,t,i,r){for(var a=new en.ZAu,o=new en.nls({color:8947848}),u=new en.Pa4(-e/2,0,-n/2),l=e/(t-1),s=n/(i-1),c=0;c<i;++c){var d=(new en.u9r).setFromPoints([new en.Pa4(u.x,0,u.z+c*s),new en.Pa4(u.x+e,0,u.z+c*s)]);a.add(new en.x12(d,o))}for(var f=0;f<t;++f){var m=(new en.u9r).setFromPoints([new en.Pa4(u.x+f*l,0,u.z),new en.Pa4(u.x+f*l,0,u.z+n)]);a.add(new en.x12(m,o))}return null===r||void 0===r||r(a),a},l=function(n,t,i,r){for(var a=new en.ZAu,o=Math.abs(t-n),u=o/(r-1),l=(new en.Pa4).copy(i).multiplyScalar(-o/2),s=(new en.Pa4).copy(i).multiplyScalar(u),c=n,d=0;d<r;++d){var f=sn(e,cn(c));f.position.copy(l),a.add(f),l.add(s),c+=u}return a},s=function(){var e=n.boundingBox,t=n.boundingSphere.center,i=new en.Pa4(e.max.x-e.min.x,e.max.y-e.min.y,e.max.z-e.min.z),o=function(e){var n=Math.max(e.x,e.y,e.z),t=Math.max(Math.ceil(e.x/n*5),2),i=Math.max(Math.ceil(e.y/n*5),2),r=Math.max(Math.ceil(e.z/n*5),2);return new en.Pa4(t,i,r)}(i);r=.1*Math.max(i.x,i.y,i.z),a=1*r;var s=new en.ZAu,c=u(i.x,i.z,o.x,o.z),d=u(i.x,i.y,o.x,o.y,(function(e){e.rotateX(Math.PI/2)})),m=u(i.y,i.z,o.y,o.z,(function(e){e.rotateZ(-Math.PI/2)}));s.add(c,d,m);var h=l(e.min.x,e.max.x,new en.Pa4(1,0,0),o.x),v=l(e.min.y,e.max.y,new en.Pa4(0,1,0),o.y),p=l(e.min.z,e.max.z,new en.Pa4(0,0,1),o.z);return s.add(h,v,p),s.position.set(t.x,t.y,t.z),s.type="GridHelper",s.dispose=f,s},c=function(e){return e<=0?-1:1},d=function(e){return Math.abs(e)<=.5?1:-1},f=function(){null===o||void 0===o||o.children.forEach((function(e){e.children.forEach((function(e){if("Line"===e.type){var n=e;n.geometry.dispose(),n.material.dispose()}else{e.dispose()}}))}))};return{dispose:f,setVisible:function(e){o.visible=e},update:function(){var e=n.boundingBox,u=new en.Pa4(e.max.x-e.min.x,e.max.y-e.min.y,e.max.z-e.min.z),l=!1;n.children.forEach((function(e){if("GridHelper"===e.type){var t=e;l=t.visible,n.remove(t),t.dispose()}})),o=s();var f=i.object.position.distanceTo(i.target);o.traverse((function(e){"LabelHelper"===e.type&&e.scale.setScalar(.05*f)}));var m=new en.Pa4;t.getWorldDirection(m);var h=f/10/(i.minDistance+.001),v=o.children[0],p=o.children[1],y=o.children[2];v.position.set(0,c(m.y)*(u.y/2+r),0),p.position.set(0,0,c(m.z)*(u.z/2+r)),y.position.set(c(m.x)*(u.x/2+r),0,0);var g=o.children[3],x=o.children[4],b=o.children[5];g.position.set(0,c(m.y)*d(m.y)*(u.y/2+a),c(m.z)*d(m.y)*-(u.z/2+a)),x.position.set(c(m.x)*d(m.x)*(u.x/2+a),0,c(m.z)*d(m.x)*-(u.z/2+a)),b.position.set(c(m.x)*d(m.x)*(u.x/2+a),c(m.y)*d(m.x)*-(u.y/2+a),0);var Z=.2*h,j=.3*h;g.visible=Math.abs(m.y)>Z||Math.abs(m.z)>j,x.visible=Math.abs(m.x)>j||Math.abs(m.z)>j,b.visible=Math.abs(m.x)>j||Math.abs(m.y)>Z,o.visible=l,n.add(o)}}},fn=t(51438),mn=t(28668),hn=t(91224),vn=function(e,n,t,i){var r,a,o,u=new en.Ilk("#fad114"),l=new en.Ilk("#E98A15"),s=new en.Pa4(-1,0,0),c=new en.JOQ(s),d={up:new en.Pa4,forward:new en.Pa4,right:new en.Pa4},f=new en.Pa4,m=new en.Pa4,h=new en.USm,v=new en.Pa4,p=new en.FM8,y=new en.JOQ,g=new en.Pa4,x=new en.Pa4,b=new en.Zzh,Z={up:new en.Pa4,forward:new en.Pa4,right:new en.Pa4},j=new en.iMs,w=s,C=new en.ZAu;C.type="SectionViewHelper",C.visible=!1,n.add(C);!function(){var e=new en._12(1,1),n=new en.vBJ({color:u,side:en.ehD,transparent:!0,opacity:.5}),t=new en.Kj0(e,n);t.type="Plane",C.add(t)}();!function(){var e=new en.xo$(.2,32,32,Math.PI,-Math.PI),n=new en.vBJ({color:u,side:en.ehD,transparent:!0,opacity:.5}),t=new en.Kj0(e,n);t.type="Dome",C.add(t)}();!function(){var e=new(function(e){(0,mn.Z)(t,e);var n=(0,hn.Z)(t);function t(e){var i;return(0,fn.Z)(this,t),(i=n.call(this)).radius=e,i}return t.prototype.getPoint=function(e){return(new en.Pa4).set(this.radius*Math.cos(Math.PI*e),this.radius*Math.sin(Math.PI*e),0)},t}(en.Hyl))(.2),n=new en.WXh(e,32,.2*.1,32),t=new en.vBJ({color:u,side:en.ehD,transparent:!0,opacity:.5}),i=new en.Kj0(n,t);i.rotateX(Math.PI/2),i.type="ArcX",C.add(i);var r=new en.WXh(e,32,.2*.1,32),a=new en.vBJ({color:u,side:en.ehD,transparent:!0,opacity:.5}),o=new en.Kj0(r,a);o.rotateX(Math.PI/2),o.rotateY(Math.PI/2),o.type="ArcY",C.add(o)}();var S=function(){var e=new en.Pa4;n.boundingBox.getCenter(e),C.position.copy(e)},k=function(){C.rotateX(Math.PI);var e=c.normal.multiplyScalar(-1);c.setFromNormalAndCoplanarPoint(e,C.position)},P=function(e){var n=e.target.getBoundingClientRect(),t=e.clientX-n.left,i=e.clientY-n.top,r=new en.FM8;return r.x=t/n.width*2-1,r.y=-i/n.height*2+1,r},E=function(e){r&&r.material.color.set(u),r=e,e&&e.material.color.set(l)},_=function(e){if(C.visible){var n=P(e);if(j.setFromCamera(n,t),a){var r=new en.Pa4;j.ray.intersectPlane(y,r),"Plane"===(null===o||void 0===o?void 0:o.type)?N(r):"Dome"===(null===o||void 0===o?void 0:o.type)?O(n):T(r),function(){var e=new en.Pa4(0,0,1).applyQuaternion(C.quaternion).multiplyScalar(-1);c.setFromNormalAndCoplanarPoint(e,C.position)}()}else{var u=j.intersectObject(C);u.length?(i.enabled=!1,o=u[0].object,E(o),m.copy(u[0].point),t.getWorldDirection(d.forward),d.forward.normalize(),d.up.copy(t.up).normalize(),d.right.crossVectors(d.up,d.forward).normalize()):(o=null,E(),i.enabled=!0)}}},N=function(e){e.sub(g);var n=new en.Pa4;b.closestPointToPoint(e,!1,n),C.position.copy(n)},O=function(e){C.rotation.copy(h),C.rotateOnWorldAxis(d.up,5*-(p.x-e.x)),C.rotateOnWorldAxis(d.right,5*-(p.y-e.y))},M=function(){o.getWorldDirection(v),h.copy(C.rotation),g.copy(m).sub(C.position),x.copy(g).normalize(),Z.up.copy(x),Z.right.copy(v),Z.forward.crossVectors(Z.right,Z.up),b.set(m,(new en.Pa4).copy(m).add(Z.forward)),y.setFromNormalAndCoplanarPoint(d.forward,m)},T=function(e){var n=i.object.position.distanceTo(i.target),t=new en.Pa4;b.closestPointToPoint(e,!1,t);var r=m.distanceTo(t);t.sub(m);var a=(new en.Pa4).copy(x).cross(t).normalize(),o=Math.sign(v.dot(a))*r*1/(n/100);C.rotation.copy(h),C.rotateOnWorldAxis(v,o)},z=function(e){switch(null===o||void 0===o?void 0:o.type){case"Plane":!function(){y.setFromNormalAndCoplanarPoint(d.forward,m),f.copy(C.position);var e=new en.Pa4;j.ray.intersectPlane(y,e),g.copy(e).sub(f),x.copy(g).normalize(),b.set(f,(new en.Pa4).copy(f).add(c.normal))}();break;case"Dome":!function(e){h.copy(C.rotation),p.copy(e)}(e);break;case"ArcX":case"ArcY":M()}},A=function(e){if(C.visible&&o){a=!0;var n=P(e);z(n)}},F=function(){C.visible&&(a=!1,E())};return e.domElement.addEventListener("pointermove",_),e.domElement.addEventListener("pointerdown",A),e.domElement.addEventListener("pointerup",F),{getClippingPlane:function(){return c},toggleVisible:function(){var e=C.visible;C.visible=!e},start:function(){e.localClippingEnabled=!0,C.visible=!0,function(){var e=new en.Pa4;n.boundingBox.getSize(e),e.multiplyScalar(1.2);var t=Math.max(Math.max(e.x,e.y),e.z);C.scale.setScalar(t)}(),S();var t=(new en.Pa4).copy(C.position).sub(s);C.lookAt(t),c.setFromNormalAndCoplanarPoint(s,C.position)},stop:function(){e.localClippingEnabled=!1,C.visible=!1},toAxis:function(e){if(S(),w.equals(e))k();else{var n=(new en.Pa4).copy(C.position).sub(e);C.lookAt(n),c.setFromNormalAndCoplanarPoint(e,C.position),w.copy(e)}},flip:k,dispose:function(){C.traverse((function(e){if("Plane"===e.type||"Dome"===e.type||"ArcX"===e.type||"ArcY"===e.type){var n=e;n.geometry.dispose(),n.material.dispose()}})),e.domElement.removeEventListener("pointermove",_),e.domElement.removeEventListener("pointerdown",A),e.domElement.removeEventListener("pointerup",F)}}},pn=t(54104),yn=function(e){var n=new en.ZAu;n.type="PointHelper",n.visible=!1,e.add(n);var t=function(e,n){var t=(new en.u9r).setFromPoints([e,n]),i=new en.nls({color:16711680});return new en.x12(t,i)},i=function(){n.children.forEach((function(e){n.remove(e);var t=e;t.geometry.dispose(),t.material.dispose()}))};return{build:function(){var r;i();var o=function(){var n,t,i=(null!==(t=null===(n=e.boundingSphere)||void 0===n?void 0:n.radius)&&void 0!==t?t:1)/100,r=new en.xo$(i),a=new en.Wid({color:16711680});return new en.Kj0(r,a)}(),u=function(){var n=[],i=e.boundingBox.max.x-e.boundingBox.min.x,r=e.boundingBox.max.y-e.boundingBox.min.y,a=e.boundingBox.max.z-e.boundingBox.min.z,o=Math.max(i,r,a),u=t(new en.Pa4(-o/2,0,0),new en.Pa4(o/2,0,0));n.push(u);var l=t(new en.Pa4(0,-o/2,0),new en.Pa4(0,o/2,0));n.push(l);var s=t(new en.Pa4(0,0,-o/2),new en.Pa4(0,0,o/2));return n.push(s),n}();n.add(o),(r=n).add.apply(r,(0,a.Z)(u))},dispose:i,update:function(e){e?(n.position.set(e.x,e.y,e.z),n.visible=!0):n.visible=!1}}},gn=t(1217),xn=t(82854),bn=t(6648),Zn=t(48764).lW,jn=function(e,n){var t=new en.Ilk("#FAD114"),r=new en.Ilk("#EE9817"),u=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a,u,d,f,m,h;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return i=new Blob([Zn.from(e.buffer)]),r=URL.createObjectURL(i),a=new gn.E,(u=new xn._).setDecoderPath("/three/libs/draco/"),a.setDRACOLoader(u),(d=new bn.a).setTranscoderPath("node_modules/three//examples/js/libs/basis/"),a.setKTX2Loader(d),[4,new Promise((function(e,n){a.load(r,(function(n){e(n)}),(function(){}),(function(e){return n(e)}))}))];case 1:return f=o.sent(),m=f.scene,(h=new en.Tme).type="Part",h.uuid=e.summary.uuid,h.children=m.children,h.userData=m.userData,"mesh"===e.summary.type?function(e,n){e.traverse((function(e){if("Mesh"===e.type){var t=e,i=new en.Uk6(t.geometry),r=new en.nls({color:t.material.color,linewidth:1}),a=new en.ejS(i,r);t.add(a),t.material.visible=!1,t.material.clippingPlanes=[n]}}))}(h,t):"result"===e.summary.type?function(e,n){e.traverse((function(e){if("Mesh"===e.type||"Line"===e.type){var t=e,i=t.geometry.getAttribute("data");if(i){var r=i.array.reduce((function(e,n){return Math.min(e,n)}),i.array[0]),a=i.array.reduce((function(e,n){return Math.max(e,n)}),i.array[0]);r===a&&(r-=1,a+=1);var o=new pn.A;o.setMin(r),o.setMax(a);for(var u=new Float32Array(3*i.count),l=0;l<i.count;l++){var s=o.getColor(i.array[l]);u[3*l+0]=s.r,u[3*l+1]=s.g,u[3*l+2]=s.b}t.geometry.setAttribute("color",new en.a$l(u,3)),t.userData=(0,A.Z)((0,z.Z)({},t.userData),{lut:o})}if("Mesh"===e.type){var c=new en.Uk6(t.geometry),d=new en.nls({linewidth:1}),f=new en.ejS(c,d);t.add(f)}t.material.vertexColors=!0,t.material.clippingPlanes=[n]}}))}(h,t):"geometry3D"!==e.summary.type&&"geometry2D"!==e.summary.type||function(e,n){e.traverse((function(e){if("Mesh"===e.type){var t=e;t.material.clippingPlanes=[n],t.material.originalColor=t.material.color}}))}(h,t),c(h,n),h.boundingBox=l(h),h.dispose=function(){return s(h)},h.setTransparent=function(e){return c(h,e)},h.startSelection=function(e,n,t,i){return x(h,e,n,t,i)},h.stopSelection=function(){return b()},h.getHighlighted=function(){return y},h.getSelected=function(){return g},h.highlight=S,h.unhighlight=k,h.select=E,h.unselect=_,[2,h]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),l=function(e){var n=new en.ZzF;return e.traverse((function(e){n.expandByObject(e)})),n},s=function(e){e.traverse((function(e){if("Mesh"===e.type){var n=e;n.geometry.dispose(),n.material.dispose()}}))},c=function(e,n){e.traverse((function(e){if("Mesh"===e.type){var t=e;t.material.transparent=n,t.material.opacity=n?.5:1,t.material.depthWrite=!n}}))},d=new en.iMs,f=null,m=null,h=null,v=null,p=null,y=null,g=[],x=function(e,n,t,i,r){f=e,m=r,h=n,v=t,(p=i).selectedObjects=[],y=null,g.length=0,h.domElement.addEventListener("pointermove",j),h.domElement.addEventListener("pointerdown",P)},b=function(){h&&h.domElement.removeEventListener("pointermove",j),h&&h.domElement.removeEventListener("pointerdown",P),k(),y=null,g.forEach((function(e){_(e.uuid)})),g.length=0,m=null,f=null,h=null,v=null,p=null},Z=function(e,n){var t;if(e&&n)return e.traverse((function(e){e.userData.uuid===n&&(t=e)})),t},j=function(n){var t=function(e){var n=e.target.getBoundingClientRect(),t=e.clientX-n.left,i=e.clientY-n.top,r=new en.FM8;return r.x=t/n.width*2-1,r.y=-i/n.height*2+1,r}(n);switch(d.setFromCamera(t,v),m){case"solids":!function(){var n=d.intersectObject(f,!0);if(n.length){var t=n[0].object.parent;t&&e(f,t.userData.uuid,t.userData.label)}else e(f)}();break;case"faces":!function(){var n;if(2===f.userData.dimension)if((n=d.intersectObject(f,!0)).length){var t=n[0].object,i=t.parent;"Mesh"===(null===i||void 0===i?void 0:i.type)?e(f,i.userData.uuid,i.userData.label):e(f,t.userData.uuid,t.userData.label)}else e(f);else if((n=d.intersectObject(f,!0)).length){var r=n[0].object;e(f,r.userData.uuid,r.userData.label)}else e(f)}();break;case"edges":!function(){var n,t=f.userData.edges;if((n=d.intersectObject(f,!0)).length){var i=n[0].object;(null===t||void 0===t?void 0:t.find((function(e){return e.uuid===i.userData.uuid})))?e(f,i.userData.uuid,i.userData.label):e(f)}else e(f)}();break;case"point":!function(){var n=d.intersectObject(f,!0);if(n.length){var t=n[0];e(f,void 0,void 0,t.point)}else e(f)}()}},w=function(e,n){n?p.selectedObjects.find((function(n){return n.userData.uuid===e.userData.uuid}))||p.selectedObjects.push(e):g.find((function(n){return n.uuid===e.userData.uuid}))||p.selectedObjects.push(e)},C=function(e,n){if(n){var t=p.selectedObjects.findIndex((function(n){return n.userData.uuid===e.userData.uuid}));p.selectedObjects=(0,a.Z)(p.selectedObjects.slice(0,t)).concat((0,a.Z)(p.selectedObjects.slice(t+1)))}else{if(!g.find((function(n){return n.uuid===e.userData.uuid}))){var i=p.selectedObjects.findIndex((function(n){return n.userData.uuid===e.userData.uuid}));p.selectedObjects=(0,a.Z)(p.selectedObjects.slice(0,i)).concat((0,a.Z)(p.selectedObjects.slice(i+1)))}}},S=function(e){if(e!==(null===y||void 0===y?void 0:y.uuid)){k();var n=Z(f,e);if(n)if(y={uuid:n.userData.uuid,label:n.userData.label},w(n),"Mesh"===n.type)n.material.color=t;else n.traverse((function(e){"Mesh"===e.type&&(e.material.color=t)}))}},k=function(){var e=Z(f,null===y||void 0===y?void 0:y.uuid);if(y=null,e){C(e);var n=g.findIndex((function(n){return n.uuid===e.userData.uuid}));if("Mesh"===e.type){var t=e;t.material.color=-1===n?t.material.originalColor:r}else{e.traverse((function(e){if("Mesh"===e.type){var t=e;t.material.color=-1===n?t.material.originalColor:r}}))}}},P=function(){y&&n(f,y.uuid,y.label)},E=function(e){var n=Z(f,e);n&&(g.push({uuid:e,label:n.userData.label}),w(n,!0),"Mesh"===n.type?n.material.color=r:n.traverse((function(e){"Mesh"===e.type&&(e.material.color=r)})))},_=function(e){var n=Z(f,e),t=g.findIndex((function(n){return n.uuid===e}));if(-1!==t&&(g=(0,a.Z)(g.slice(0,t)).concat((0,a.Z)(g.slice(t+1)))),n){if(C(n,!0),"Mesh"===n.type){var i=n;i.material.color=i.material.originalColor}else{n.traverse((function(e){if("Mesh"===e.type){var n=e;n.material.color=n.material.originalColor}}))}n.visible=!0}};return{load:u}},wn=function(){return{type:R}},Cn=function(){return{type:D}},Sn=function(e){return{type:U,value:e}},kn=function(e){var n=e.uuid,t=e.label;return{type:I,value:{uuid:n,label:t}}},Pn=function(){return{type:B}},En=function(e){var n=e.uuid,t=e.label;return{type:H,value:{uuid:n,label:t}}},_n=function(e){var n=e.uuid,t=e.label;return{type:G,value:{uuid:n,label:t}}},Nn=function(e){return{type:W,value:e}},On=t(41686),Mn="Error while loading part",Tn="Error while taking snapshot",zn="Unable to save screenshot",An=function(e){var n=new en.ZzF;e.children.forEach((function(e){if(e.visible&&"Part"===e.type){var t=e.boundingBox,i=new en.Pa4(Math.min(n.min.x,t.min.x),Math.min(n.min.y,t.min.y),Math.min(n.min.z,t.min.z)),r=new en.Pa4(Math.max(n.max.x,t.max.x),Math.max(n.max.y,t.max.y),Math.max(n.max.z,t.max.z));n.set(i,r)}}));var t=new en.aLr;n.getBoundingSphere(t),e.boundingBox=n,e.boundingSphere=t},Fn=function(e,n,t){var i=n.object.position.distanceTo(n.target)*t*.01,r=n.target.clone().sub(e.position).normalize().multiplyScalar(i);e.position.add(r)},Rn=void 0,Dn=function(e,n){Fn(e,n,1);Rn=requestAnimationFrame((function(){return Dn(e,n)}))},Ln=function(e,n){Fn(e,n,-1);Rn=requestAnimationFrame((function(){return Ln(e,n)}))},Un=function(){Rn&&cancelAnimationFrame(Rn),Rn=void 0},Vn=function(e,n,t){var i=e.boundingSphere,r=i.center,a=2*i.radius/(2*Math.atan(Math.PI*n.fov/360)),o=a/n.aspect,u=1.1*Math.max(a,o),l=t.target.clone().sub(n.position).normalize().multiplyScalar(u);t.target.copy(r),t.minDistance=u/10,t.maxDistance=10*u,n.position.copy(r).sub(l),n.near=u/100,n.far=100*u,n.updateProjectionMatrix()},In=function(){var e=(0,i.Z)((function(e,n,t,i,r,a,u){var l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,jn((function(e,n,t,i){n?(e.highlight(n),setTimeout((function(){return u(kn({uuid:n,label:t}))}),1)):i?u(Nn({x:i.x,y:i.y,z:i.z})):(e.unhighlight(),setTimeout((function(){return u(Pn())}),1))}),(function(e,n,t){e.getSelected().find((function(e){return e.uuid===n}))?(e.unselect(n),setTimeout((function(){return u(_n({uuid:n,label:t}))}),1)):(e.select(n),setTimeout((function(){return u(En({uuid:n,label:t}))}),1))})).load(e,n,a.sectionViewHelper.getClippingPlane())];case 1:return l=o.sent(),u(function(e){return{type:V,value:e}}(l)),t.add(l),An(t),Vn(t,i,r),a.gridHelper.update(),a.gridHelper.update(),a.gridHelper.setVisible(!0),l.children[0].userData.lut?(a.colorbarHelper.setLUT(l.children[0].userData.lut),a.colorbarHelper.setVisible(!0)):a.colorbarHelper.setVisible(!1),a.pointHelper.build(),[2]}}))}));return function(n,t,i,r,a,o,u){return e.apply(this,arguments)}}(),Bn=function(){var e=(0,i.Z)((function(e,n,t,i){var r,a,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=i.domElement.width,a=i.domElement.height,u=t.aspect,520,312,i.domElement.width=520,i.domElement.height=312,t.aspect=520/312,t.updateProjectionMatrix(),i.clear(),i.setViewport(0,0,520,312),i.render(n,t),l=i.domElement.toDataURL(),i.domElement.width=r,i.domElement.height=a,t.aspect=u,t.updateProjectionMatrix(),[4,On.Z.add({name:"snapshot",uid:"snapshot_"+(0,nn.Z)(),data:l},{id:e.id})];case 1:return o.sent(),[3,3];case 2:return s=o.sent(),(0,P.lt)(Tn,s),[3,3];case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),Hn=function(e){var n=e.loading,t=e.project,r=e.part,a=(0,d.useRef)(null),l=(0,d.useRef)(),s=(0,d.useRef)(),v=(0,d.useRef)(),y=(0,d.useRef)(),g=(0,d.useRef)(),x=(0,d.useRef)(),b=(0,d.useRef)(),Z=(0,d.useRef)(),j=(0,d.useRef)(),C=(0,d.useRef)(),S=(0,d.useRef)(),k=(0,d.useState)(!1),E=k[0],_=k[1],N=(0,d.useState)(!1),O=N[0],M=N[1],T=(0,d.useState)(!1),z=T[0],A=T[1],F=(0,d.useState)(!1),R=F[0],D=F[1],L=(0,c.useRouter)(),U=(0,d.useContext)(Y),V=U.enabled,I=U.part,B=U.highlighted,H=U.selected,G=U.point,W=U.type,J=U.dispatch;(0,d.useEffect)((function(){if(un.Z.isWebGLAvailable()){var e,n=a.current,t=n.clientWidth,i=n.clientHeight;l.current=new en.xsS,l.current.boundingBox=new en.ZzF,l.current.boundingSphere=new en.aLr,s.current=new en.cPb(50,t/i,.1,1e3),s.current.position.z=10;var r=new en.Mig("#aaa",.75);l.current.add(r);var o=new en.cek("#fff",.5);o.decay=2,s.current.add(o),l.current.add(s.current),v.current=new en.CP7({antialias:!0,alpha:!0}),v.current.setClearColor("#ffffff"),v.current.setSize(t,i),v.current.setPixelRatio(window.devicePixelRatio||1),v.current.shadowMap.enabled=!0,v.current.autoClear=!1,n.appendChild(v.current.domElement);var u=new rn.C(l.current,s.current);y.current=new an.f(new en.FM8(t,i),l.current,s.current),y.current.visibleEdgeColor.set("#FAD114"),y.current.hiddenEdgeColor.set("#FAD114"),g.current=new on.xC(v.current),g.current.addPass(u),g.current.addPass(y.current),x.current=new tn.$(s.current,n),x.current.rotateSpeed=3,x.current.panSpeed=.1;var c=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{offsetWidth:0,offsetHeight:0,width:150,height:150},i=t.offsetWidth,r=t.offsetHeight,a=t.width,o=t.height,u="green",l="blue",s="black",c=i,d=r,f=a,m=o,h=ln("red");h.rotateZ(-Math.PI/2);var v=sn(e,"X",{position:new en.Pa4(1.1,0,0)}),p=ln(u),y=sn(e,"Y",{position:new en.Pa4(0,1.1,0)}),g=ln(l);g.rotateX(Math.PI/2);var x=sn(e,"Z",{position:new en.Pa4(0,0,1.1)}),b=new en.xo$(.05,50,50),Z=new en.vBJ({color:s}),j=new en.Kj0(b,Z),w=new en.ZAu;w.type="AxisHelper",w.add(h),w.add(v),w.add(p),w.add(y),w.add(g),w.add(x),w.add(j);var C=new en.xsS;C.add(w);var S=new en.iKG(-1.2,1.2,1.2,-1.2,-2,2),k=function(e){var n=e.newOffsetWidth,t=e.newOffsetHeight,i=e.newWidth,r=e.newHeight;c=n,d=t,f=i,m=r};return{dispose:function(){b.dispose(),Z.dispose(),w.children.forEach((function(e){"ArrowHelper"!==e.type&&"LabelHelper"!==e.type||e.dispose()})),C.remove(w)},render:function(){e.setViewport(c,d,f,m),S.rotation.copy(n.rotation),e.render(C,S)},resize:k}}(v.current,s.current,{offsetWidth:t-155,offsetHeight:i-155,width:150,height:150}),d=function(e,n,t,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{offsetWidth:0,offsetHeight:0,width:150,height:150},a=r.offsetWidth,o=r.offsetHeight,u=r.width,l=r.height,s="#d3d3d3",c="#ffffff",d="#000000",f="#FAD114",m=100,h=.25,v=null,p=null,y=[{text:"FRONT",normal:new en.Pa4(0,0,1),up:new en.Pa4(0,1,0)},{text:"BACK",normal:new en.Pa4(0,0,-1),up:new en.Pa4(0,1,0)},{text:"RIGHT",normal:new en.Pa4(1,0,0),up:new en.Pa4(0,1,0)},{text:"LEFT",normal:new en.Pa4(-1,0,0),up:new en.Pa4(0,1,0)},{text:"UP",normal:new en.Pa4(0,1,0),up:new en.Pa4(0,0,-1)},{text:"DOWN",normal:new en.Pa4(0,-1,0),up:new en.Pa4(0,0,1)}],g=new en._12(m*(1-h),m*(1-h)),x=new en.TOt(g),b=new en.xo$(m*(1-h)/2,10,10,0,Math.PI,0),Z=new en.ZAu;y.forEach((function(e){var n=document.createElement("canvas"),t=n.getContext("2d");n.width=n.height=256,t.fillStyle=s,t.fillRect(0,0,n.width,n.height),t.font="bold 50pt sans-serif",t.fillStyle=d,t.textAlign="center",t.textBaseline="middle",t.fillText(e.text,n.width/2,n.height/2);var i=new en.ROQ(n);i.needsUpdate=!0;var r=new en.vBJ({map:i}),a=new en.vBJ({color:s}),o=new en.Kj0(g,r),u=new en.Kj0(g,a);u.rotateY(Math.PI);var l=new en.nls({color:c}),f=new en.ejS(x,l),h=new en.vBJ({color:s,transparent:!0,opacity:.2}),v=new en.Kj0(b,h),p=new en.ZAu;p.add(o,u,f,v),p.lookAt(e.normal),p.translateZ(m/2),p.normal=e.normal,p.up=e.up,Z.add(p)}));var j=new en.Mig("#ffffff",1),w=new en.xsS;w.add(Z),w.add(j);var C=new en.iKG(-m,m,m,-m,-m,m);C.position.z=2;var S=new en.iMs,k=function(e){var n=P(e);E(n)?(v=_(n),N(),(null===v||void 0===v?void 0:v.uuid)!==(null===p||void 0===p?void 0:p.uuid)&&(O(),p=v)):(v=null,O())},P=function(e){var n=e.target.getBoundingClientRect(),t=e.clientX-n.left,i=e.clientY-n.top,r=new en.FM8;return r.x=(t-a)/u*2-1,r.y=-(i+l-n.height+o)/l*2+1,r},E=function(e){return e.x>-1&&e.x<1&&e.y>-1&&e.y<1},_=function(e){var n=new en.Pa4(e.x,e.y,-1);n.unproject(C);var t=new en.Pa4;C.getWorldDirection(t),S.set(n,t);var i=S.intersectObjects(w.children,!0);return i.length?i[0].object.parent:null},N=function(){v&&v.children&&v.children.forEach((function(e){var n=e;n.material&&n.material.color&&(n.material.previousColor=n.material.color,n.material.color=new en.Ilk(f))}))},O=function(){p&&p.children&&p.children.forEach((function(e){var n=e;n.material&&n.material.color&&(n.material.color=new en.Ilk(s))}))},M=function(e){if(v){var r=v.normal,a=v.up,o=new en.Pa4;n.boundingBox&&n.boundingBox.getCenter(o);var u=t.position.distanceTo(i.target),l=r.clone().multiplyScalar(u),s=o.add(l);t.position.copy(s),t.up.copy(a),v=null,O(),k(e)}};e.domElement.addEventListener("pointermove",k),e.domElement.addEventListener("pointerdown",M);var T=function(e){var n=e.newOffsetWidth,t=e.newOffsetHeight,i=e.newWidth,r=e.newHeight;a=n,o=t,u=i,l=r},z=function(){e.domElement.removeEventListener("pointermove",k),e.domElement.removeEventListener("pointerdown",M),Z.children.forEach((function(e){e.children.forEach((function(e){var n=e;n.geometry.dispose(),n.material.dispose()}))})),w.remove(Z)};return{resize:T,render:function(){e.setViewport(a,o,u,l),C.rotation.copy(t.rotation),e.render(w,C)},dispose:z}}(v.current,l.current,s.current,x.current,{offsetWidth:t-155,offsetHeight:i-155,width:150,height:150});b.current=dn(v.current,l.current,s.current,x.current),Z.current=function(e,n,t,i){var r=document.createElement("div");r.style.pointerEvents="none",r.style.border="1px solid #55aaff",r.style.backgroundColor="rgba(75, 160, 255, 0.3)",r.style.position="fixed";var a=new en.FM8,o=new en.FM8,u=new en.FM8,l=new en.FM8,s=!1,c=!1,d=new en.iMs,f=function(){s=!1},m=function(e){s&&0===e.button&&(c=!0,p(e))},h=function(e){s&&c&&y(e)},v=function(e){c=!1,s&&g(e)};e.domElement.addEventListener("pointerdown",m),e.domElement.addEventListener("pointermove",h),e.domElement.addEventListener("pointerup",v);var p=function(n){i.enabled=!1,e.domElement.parentElement.appendChild(r),r.style.left=n.clientX+"px",r.style.top=n.clientY+"px",r.style.width="0px",r.style.height="0px",a.x=n.clientX,a.y=n.clientY},y=function(e){l.x=Math.max(a.x,e.clientX),l.y=Math.max(a.y,e.clientY),u.x=Math.min(a.x,e.clientX),u.y=Math.min(a.y,e.clientY),r.style.left=u.x+"px",r.style.top=u.y+"px",r.style.width=l.x-u.x+"px",r.style.height=l.y-u.y+"px"},g=function(e){i.enabled=!0,r.parentElement&&r.parentElement.removeChild(r),o.x=e.clientX,o.y=e.clientY;var n=new en.TUj(a,o);x(n),f()},x=function(r){var a=new en.FM8;if(r.getSize(a),!(a.x<5||a.y<5)){var o=new en.FM8((r.max.x+r.min.x)/2,(r.max.y+r.min.y)/2),u=e.domElement.getBoundingClientRect(),l=o.x-u.left,s=o.y-u.top,c=new en.FM8(l/u.width*2-1,-s/u.height*2+1),f=n.children.find((function(e){return"Part"===e.type}));if(f){d.setFromCamera(c,t);var m=d.intersectObject(f);if(m.length){i.target.copy(m[0].point);var h=new en.FM8(a.x/u.width,a.y/u.height),v=1-Math.max(h.x,h.y),p=t.position.distanceTo(i.target)*v,y=i.target.clone().sub(t.position).normalize().multiplyScalar(p);t.position.add(y)}}}};return{dispose:function(){e.domElement.removeEventListener("pointerdown",m),e.domElement.removeEventListener("pointermove",h),e.domElement.removeEventListener("pointerup",v)},end:f,isEnabled:function(){return s},start:function(){s=!0}}}(v.current,l.current,s.current,x.current),j.current=vn(v.current,l.current,s.current,x.current),C.current=function(e){var n=new en.xsS,t=new en.iKG(-1,1,1,-1,2,1);t.position.set(0,0,1);var i=new en.ZAu;n.add(i);var r=function(){n.children.forEach((function(e){return e.children.forEach((function(n){var t=n;"LabelHelper"===t.type&&t.dispose();var i=n;"Sprite"===i.type&&i.dispose(),e.remove(n)}))}))},a=function(n){var t=cn(n.minV),r=cn(n.maxV),a=sn(e,String(t),{position:new en.Pa4(-.62,0,0),width:512,align:"right"});a.scale.x=.4,a.scale.y=2.8;var o=sn(e,String(r),{position:new en.Pa4(.62,0,0),width:512,align:"left"});o.scale.x=.4,o.scale.y=2.8,i.add(a),i.add(o)};return{render:function(){var i=e.domElement.getBoundingClientRect();e.setViewport(i.width/2-350,i.height-50,700,50),e.render(n,t)},setLUT:function(e){r();var n=new pn.A("rainbow",e.n);n.setMin(e.minV),n.setMax(e.maxV);var t=new en.ROQ(n.createCanvas()),o=new en.xeV({map:t,depthWrite:!1}),u=new en.jyi(o);u.material.rotation=-Math.PI/2,u.scale.x=.2,u.scale.y=1.2,u.dispose=u.material.dispose,i.add(u),a(n)},setVisible:function(e){n.children.forEach((function(n){n.children.forEach((function(n){return n.visible=e}))}))},dispose:function(){r()}}}(v.current),C.current.setVisible(!1),S.current=yn(l.current);var f=function(){x.current.update(),v.current.setViewport(0,0,t,i),v.current.render(l.current,s.current),b.current.update(),g.current.render(),c.render(),d.render(),C.current.render()},m=function(){t=n.clientWidth,i=n.clientHeight,s.current.aspect=t/i,s.current.updateProjectionMatrix(),v.current.setSize(t,i),g.current.setSize(t,i),c.resize({newOffsetWidth:t-155,newOffsetHeight:i-155,newWidth:150,newHeight:150}),d.resize({newOffsetWidth:t-155,newOffsetHeight:i-155,newWidth:150,newHeight:150}),f()},h=function(){p(),f(),e=requestAnimationFrame(h)},p=function(){cancelAnimationFrame(e)};return window.addEventListener("resize",m),e=requestAnimationFrame(h),function(){p(),window.removeEventListener("resize",m),n.removeChild(v.current.domElement),l.current.children.forEach((function(e){l.current.remove(e)})),c.dispose(),d.dispose(),b.current.dispose(),j.current.dispose(),Z.current.dispose(),C.current.dispose(),S.current.dispose()}}L.push("/webgl")}),[L]),(0,d.useEffect)((function(){var e;l.current&&(l.current.children.find((function(e){return"Part"===e.type&&e.uuid===(null===r||void 0===r?void 0:r.summary.uuid)}))||(l.current.children.forEach((function(e){if("Part"===e.type){var n=e;l.current.remove(n),n.dispose()}})),r?In(r,E,l.current,s.current,x.current,{gridHelper:b.current,sectionViewHelper:j.current,colorbarHelper:C.current,pointHelper:S.current},J).catch((function(e){(0,P.lt)(Mn,e),An(l.current)})):(An(l.current),b.current.update(),null===(e=S.current)||void 0===e||e.build())))}),[r,E,J]),(0,d.useEffect)((function(){if(l.current)if(2===(null===r||void 0===r?void 0:r.summary.dimension)){An(l.current);var e=new en.Pa4(0,0,1),n=new en.Pa4(0,1,0),t=new en.Pa4;l.current.boundingBox.getCenter(t);var i=s.current.position.distanceTo(x.current.target),a=e.clone().multiplyScalar(i),o=t.add(a);s.current.position.copy(o),s.current.up.copy(n),x.current.noRotate=!0}else x.current.noRotate=!1}),[r]),(0,d.useEffect)((function(){l.current&&l.current.children.forEach((function(e){if("Part"===e.type&&e.uuid===(null===I||void 0===I?void 0:I.uuid)){var n=e;V?n.startSelection(v.current,s.current,y.current,W):n.stopSelection()}}))}),[V,I,W]),(0,d.useEffect)((function(){l.current&&l.current.children.forEach((function(e){if("Part"===e.type&&e.uuid===(null===I||void 0===I?void 0:I.uuid)){var n=e;n.highlight(null===B||void 0===B?void 0:B.uuid);var t=n.getSelected();H.filter((function(e){return!t.find((function(n){return n.uuid===e.uuid}))})).forEach((function(e){e.uuid&&n.select(e.uuid)})),t.filter((function(e){return!H.find((function(n){return n.uuid===e.uuid}))})).forEach((function(e){n.unselect(e.uuid)}))}}))}),[I,B,H]),(0,d.useEffect)((function(){var e;l.current&&(null===(e=S.current)||void 0===e||e.update(G?new en.Pa4(G.x,G.y,G.z):void 0))}),[G]);var X=(0,d.useCallback)((function(e){_(e),l.current.children.forEach((function(n){"Part"===n.type&&n.setTransparent(e)}))}),[]),q=(0,d.useCallback)((function(){var e=!O;M(e),e?j.current.start():j.current.stop()}),[O]);return(0,u.jsxs)(m.Z,{className:"View no-scroll",children:[(0,u.jsx)(m.Z.Header,{className:"View-header",children:(0,u.jsxs)("div",{className:"View-controls-main",children:[(0,u.jsx)(f.Z,{title:"Take snasphot",placement:"right",children:(0,u.jsx)(Le.Z,{placement:"bottom",overlay:(0,u.jsx)(h.Z,{items:[{key:"project",label:(0,u.jsx)(p.Z,{type:"text",loading:z,onClick:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:A(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Bn(t,l.current,s.current,v.current)];case 2:return e.sent(),[3,4];case 3:return A(!1),[7];case 4:return[2]}}))})),children:"Project snapshot"})},{key:"image",label:(0,u.jsx)(p.Z,{type:"text",loading:R,onClick:function(){D(!0);try{!function(e,n,t,i){try{var r=i.domElement.width,a=i.domElement.height;i.clear(),i.setViewport(0,0,r,a),i.render(n,t);var o=i.domElement.toDataURL(),u=document.createElement("a");u.href=o.replace("image/png","image/octet-stream"),u.download=e.title+"_"+(new Date).toLocaleDateString()+".png",u.click()}catch(l){(0,P.lt)(zn,l)}}(t,l.current,s.current,v.current)}finally{D(!1)}},children:"Export image"})}]}),children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(Be.Z,{})})})}),(0,u.jsx)(Ue.Z,{className:"no-margin"}),(0,u.jsx)(f.Z,{title:"Display grid",placement:"right",children:(0,u.jsx)(Ve.Z,{defaultChecked:!0,checkedChildren:(0,u.jsx)(He.Z,{}),unCheckedChildren:(0,u.jsx)(He.Z,{}),onChange:function(e){return function(e,n){e.setVisible(n)}(b.current,e)}})}),(0,u.jsx)(f.Z,{title:"Set transparency",placement:"right",children:(0,u.jsx)(Ve.Z,{className:"transparent",checked:E,checkedChildren:(0,u.jsx)(Ge.Z,{}),unCheckedChildren:(0,u.jsx)(Ge.Z,{}),onChange:X})}),(0,u.jsx)(Ue.Z,{className:"no-margin"}),(0,u.jsx)(f.Z,{title:"Zoom out",placement:"right",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(We.Z,{}),onMouseDown:function(){return Ln(s.current,x.current)},onMouseUp:Un,onMouseOut:Un})}),(0,u.jsx)(f.Z,{title:"Zoom to fit",placement:"right",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(Ye.Z,{}),onClick:function(){return Vn(l.current,s.current,x.current)}})}),(0,u.jsx)(f.Z,{title:"Zoom in",placement:"right",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(Je.Z,{}),onMouseDown:function(){return Dn(s.current,x.current)},onMouseUp:Un,onMouseOut:Un})}),(0,u.jsx)(f.Z,{title:"Zoom to selection",placement:"right",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(Xe.Z,{}),onClick:function(){return Z.current.isEnabled()?Z.current.end():Z.current.start()}})}),(0,u.jsx)(Ue.Z,{className:"no-margin"}),!O&&(0,u.jsx)(f.Z,{title:"Section view",placement:"right",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(qe.Z,{}),onClick:q})}),O&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(f.Z,{title:"Stop",placement:"left",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(Ke.Z,{}),onClick:q})}),(0,u.jsx)(f.Z,{title:"Hide plane",placement:"left",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(Qe.Z,{}),onClick:function(){return j.current.toggleVisible()}})}),(0,u.jsx)(f.Z,{title:"Snap to X",placement:"left",children:(0,u.jsx)(p.Z,{className:"ant-btn-icon-only",onClick:function(){return j.current.toAxis(new en.Pa4(-1,0,0))},children:"X"})}),(0,u.jsx)(f.Z,{title:"Snap to Y",placement:"left",children:(0,u.jsx)(p.Z,{className:"ant-btn-icon-only",onClick:function(){return j.current.toAxis(new en.Pa4(0,-1,0))},children:"Y"})}),(0,u.jsx)(f.Z,{title:"Snap to Z",placement:"left",children:(0,u.jsx)(p.Z,{className:"ant-btn-icon-only",onClick:function(){return j.current.toAxis(new en.Pa4(0,0,-1))},children:"Z"})}),(0,u.jsx)(f.Z,{title:"Flip",placement:"left",children:(0,u.jsx)(p.Z,{onClick:function(){return j.current.flip()},icon:(0,u.jsx)($e.Z,{})})})]})]})}),(0,u.jsxs)(m.Z.Content,{className:"View-content no-scroll",children:[(0,u.jsx)("div",{style:{display:n?"flex":"none"},className:"View-loading",children:(0,u.jsx)(Ie.Z,{indicator:(0,u.jsx)(w.Z,{className:"View-loading-spin",style:{fontSize:80},spin:!0})})}),(0,u.jsx)("div",{ref:a,className:"View-canvas"})]})]})},Gn="Unable to load part",Wn=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),"geometry"!==t?[3,2]:(i=n,[4,ue.getPart({id:i.id})]);case 1:case 3:return[2,o.sent()];case 2:return r=n,[4,De.load({id:e.id},{originPath:r.originPath,glb:r.glb})];case 4:return[3,6];case 5:throw a=o.sent(),(0,P.lt)(Gn,a),a;case 6:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Yn=function(e){var n=e.project,t=e.simulation,i=e.geometry,r=e.result,a=e.postprocessing,o=(0,d.useState)(),l=o[0],s=o[1],c=(0,d.useState)(),f=c[0],m=c[1],h=(0,d.useState)(!1),v=h[0],p=h[1];return(0,d.useEffect)((function(){t&&a?a.glb!==(null===f||void 0===f?void 0:f.glb)&&(m(a),p(!0),Wn(t,a,"result").then((function(e){return s(e)})).catch((function(e){})).finally((function(){return p(!1)}))):t&&r?r.glb!==(null===f||void 0===f?void 0:f.glb)&&(m(r),p(!0),Wn(t,r,"result").then((function(e){return s(e)})).catch((function(e){})).finally((function(){return p(!1)}))):i&&i.id!==(null===f||void 0===f?void 0:f.id)&&(m(i),p(!0),i.needCleanup?(s(void 0),p(!1)):Wn(void 0,i,"geometry").then((function(e){return s(e)})).catch((function(e){})).finally((function(){return p(!1)})))}),[t,i,r,a,f]),(0,u.jsx)(Hn,{loading:v,project:{id:n.id,title:n.title},part:l})},Jn=t(40038),Xn=t(67040),qn=t(90575),Kn=t(23389),Qn=t(93398),$n=t(96486),et=t(20518),nt=t(60877),tt=t(4687),it=t(14670),rt=t(57132),at="Unable to copy simulation",ot=function(){var e=(0,i.Z)((function(e,n,t){var i,r,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),(i=nt.Z.deepCopy(n.scheme)).configuration.run.done=!1,i.configuration.run.error=void 0,[4,Q.Z.add({id:e.id},{name:n.name+" (copy)",scheme:i})];case 1:return r=o.sent(),t.addOneSimulation(r),t.mutateProject({id:e.id,simulations:(0,a.Z)(e.simulations).concat([r.id])}),[3,3];case 2:return u=o.sent(),(0,P.lt)(at,u),[3,3];case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),ut=function(e){var n=e.project,t=e.simulation,r=e.swr,a=(0,d.useState)(!1),l=a[0],s=a[1];return(0,u.jsx)(f.Z,{title:"Copy simulation",children:(0,u.jsx)(p.Z,{className:"no-border",loading:l,icon:(0,u.jsx)(rt.Z,{}),onClick:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:s(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,ot(n,t,r)];case 2:return e.sent(),[3,4];case 3:return s(!1),[7];case 4:return[2]}}))}))})})},lt="Unable to update simulation",st=function(){var e=(0,i.Z)((function(e,n,t){var i;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Q.Z.update({id:e.id},[{key:"name",value:n.name}])];case 1:return r.sent(),t.mutateOneSimulation({id:e.id,name:n.name}),[3,3];case 2:throw i=r.sent(),(0,P.lt)(lt,i),i;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),ct=function(e){var n=e.simulation,t=e.swr,r=(0,d.useState)(!1),a=r[0],l=r[1],s=(0,d.useState)(!1),c=s[0],f=s[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(k.w6,{onEdit:function(){return l(!0)}}),(0,u.jsx)(fe.ZP,{title:"Edit the simulation's name",visible:a,initialValues:{name:n.name},onCancel:function(){return l(!1)},onOk:function(){var e=(0,i.Z)((function(e){var i;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:f(!0),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,st(n,e,t)];case 2:return r.sent(),f(!1),l(!1),[3,4];case 3:throw i=r.sent(),f(!1),i;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),loading:c,children:(0,u.jsx)(xe.Z.Item,{name:"name",label:"Name:",rules:[{required:!0,message:"Name is required"}],children:(0,u.jsx)(be.Z,{})})})]})},dt="Unable to delete simulation",ft=function(){var e=(0,i.Z)((function(e,n,t){var i,r;return(0,o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Q.Z.del(n)];case 1:return a.sent(),i=e.simulations.filter((function(e){return e!==n.id})),t.mutateProject({id:e.id,simulations:i}),t.delOneSimulation({id:n.id}),[3,3];case 2:throw r=a.sent(),(0,P.lt)(dt,r),r;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),mt=function(e){var n=e.project,t=e.simulation,r=e.swr,a=(0,d.useState)(!1),l=a[0],s=a[1];return(0,u.jsx)(k.m1,{loading:l,text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the simulation"," ",(0,u.jsx)(v.Z.Text,{strong:!0,children:t.name}),"?"]}),onDelete:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:s(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,ft(n,t,r)];case 2:return e.sent(),[3,4];case 3:return s(!1),[7];case 4:return[2]}}))}))})},ht=function(e){var n=e.project,t=e.simulation,i=e.swr;return n&&t?(0,u.jsx)(m.Z,{children:(0,u.jsx)(m.Z.Content,{children:(0,u.jsx)(_.Z,{size:"small",title:(0,u.jsx)(v.Z.Title,{level:5,ellipsis:!0,children:t.name}),actions:[(0,u.jsx)(ut,{project:{id:n.id,simulations:n.simulations},simulation:t,swr:{mutateProject:i.mutateProject,addOneSimulation:i.addOneSimulation}},"copy"),(0,u.jsx)(ct,{simulation:{id:t.id,name:t.name},swr:{mutateOneSimulation:i.mutateOneSimulation}},"edit"),(0,u.jsx)(mt,{project:{id:n.id,simulations:n.simulations},simulation:{id:t.id,name:t.name},swr:{mutateProject:i.mutateProject,delOneSimulation:i.delOneSimulation}},"delete")],children:(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[t.scheme.user&&(0,u.jsx)(it.Z,{message:"User algorithm",type:"info",showIcon:!0}),(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Category:"})," ",t.scheme.category]}),(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Algorithm:"})," ",t.scheme.algorithm]}),(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Code:"})," ",t.scheme.code]}),(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Version:"})," ",t.scheme.version]}),(0,u.jsx)("div",{className:"full-wdith scroll",children:(0,u.jsx)(ce.Z.Html,{html:t.scheme.description})})]})})})}):(0,u.jsx)(_.Z,{children:(0,u.jsx)(Ie.Z,{})})},vt=t(32808),pt=function(e){var n=e.label,t=e.className,i=e.defaultValue,r=e.defaultChecked,a=e.onValueChange,o=e.onCheckedChange,l=e.unit,s=(0,d.useState)(String(null!==i&&void 0!==i?i:0)),c=s[0],f=s[1],m=(0,d.useState)(!!r),h=m[0],v=m[1],p=(0,d.useState)(void 0!==r&&!r),y=p[0],x=p[1],b=(0,d.useState)(0),Z=b[0],j=b[1],C=(0,d.useState)(!1),S=C[0],k=C[1];(0,d.useEffect)((function(){f(String(null!==i&&void 0!==i?i:0))}),[i]),(0,d.useEffect)((function(){v(!!r)}),[r]);var P=(0,d.useCallback)((function(e){var n=e.target.checked;v(n),k(!0),null===o||void 0===o||o(n),x(!n)}),[o]),E=(0,d.useCallback)((function(e){Z&&clearTimeout(Z);var n=setTimeout((function(){a(e),k(!1)}),500);j(+n)}),[Z,a]),_=(0,d.useCallback)((function(e){var n=e.target.value;f(n),k(!0),E(n)}),[E]);return(0,u.jsx)(N.Z,{className:"full-width space-full-width "+t,align:"start",children:(0,u.jsx)(xe.Z,{layout:"vertical",children:(0,u.jsx)(xe.Z.Item,{label:(0,u.jsxs)(u.Fragment,{children:[void 0!==r&&(0,u.jsx)(vt.Z,{checked:h,onChange:P,style:{marginRight:"5px"}}),n]}),children:(0,u.jsx)(be.Z,{disabled:y,value:c,onChange:_,addonAfter:(0,u.jsxs)(N.Z,{className:"full-width",children:[(0,u.jsx)(ce.Z.Inline,{text:l}),S?(0,u.jsx)(w.Z,{spin:!0,className:"color-orange"}):(0,u.jsx)(g.Z,{className:"color-green"})]})})})})})},yt="Unable to update simulation",gt=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(i=nt.Z.deepCopy(e)).scheme.configuration.geometry.meshParameters={type:n,value:"auto"===n?"normal":"1"},r=(0,A.Z)((0,z.Z)({},i.scheme.configuration.geometry),{done:!0}),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","geometry"],value:r}])];case 1:return o.sent(),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:(0,A.Z)((0,z.Z)({},i.scheme.configuration.run),{done:!1})}])];case 2:return o.sent(),t.mutateOneSimulation(i),[3,4];case 3:throw a=o.sent(),(0,P.lt)(yt,a),a;case 4:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),xt=function(){var e=(0,i.Z)((function(e,n,t,i){var r,a,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(r=nt.Z.deepCopy(e)).scheme.configuration.geometry.meshParameters=(0,A.Z)((0,z.Z)({},r.scheme.configuration.geometry.meshParameters),{type:n,value:t}),a=(0,A.Z)((0,z.Z)({},r.scheme.configuration.geometry),{done:!0}),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","geometry"],value:a}])];case 1:return o.sent(),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:(0,A.Z)((0,z.Z)({},r.scheme.configuration.run),{done:!1})}])];case 2:return o.sent(),i.mutateOneSimulation(r),[3,4];case 3:throw u=o.sent(),(0,P.lt)(yt,u),u;case 4:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),bt=function(e){var n=e.simulation,t=e.swr,r=(0,d.useState)(),a=r[0],l=r[1],s=(0,d.useState)(),c=s[0],f=s[1];(0,d.useEffect)((function(){var e=n.scheme.configuration.geometry.meshParameters;e?(l(e.type),f(e.value)):(l("auto"),f("normal"))}),[n]);var m=(0,d.useCallback)(function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,xt(n,a,e,t)];case 1:return i.sent(),f(e),[3,3];case 2:return i.sent(),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),[n,a,t]);return(0,u.jsx)(_.Z,{size:"small",title:"Mesh refinement",children:(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(xe.Z,{layout:"vertical",children:(0,u.jsx)(xe.Z.Item,{label:"Type",children:(0,u.jsxs)(Jn.Z,{className:"full-width",value:a,onChange:function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,gt(n,e,t)];case 1:return i.sent(),l(e),f("auto"===e?"normal":"1"),[3,3];case 2:return i.sent(),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:[(0,u.jsx)(Jn.Z.Option,{value:"auto",children:"Automatic"}),(0,u.jsx)(Jn.Z.Option,{value:"manual",children:"Manual"})]})})}),"auto"===a&&(0,u.jsx)(xe.Z,{layout:"vertical",children:(0,u.jsx)(xe.Z.Item,{label:"Size",children:(0,u.jsxs)(Jn.Z,{className:"full-width",value:c,onChange:m,children:[(0,u.jsx)(Jn.Z.Option,{value:"veryfine",children:"Very fine"}),(0,u.jsx)(Jn.Z.Option,{value:"fine",children:"Fine"}),(0,u.jsx)(Jn.Z.Option,{value:"normal",children:"Normal"}),(0,u.jsx)(Jn.Z.Option,{value:"coarse",children:"Coarse"}),(0,u.jsx)(Jn.Z.Option,{value:"verycoarse",children:"Very coarse"})]})})}),"manual"===a&&(0,u.jsx)(pt,{label:"Size",defaultValue:c,onValueChange:m,unit:"m"})]})})},Zt="Unable to update simulation",jt=function(){var e=(0,i.Z)((function(e,n,t,i,r){var a,u,l,s,c;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),(a=nt.Z.deepCopy(e)).scheme.configuration.geometry.value=t.id,l=(0,A.Z)((0,z.Z)({},a.scheme.configuration),{dimension:null!==(u=t.summary.dimension)&&void 0!==u?u:3,geometry:(0,A.Z)((0,z.Z)({},a.scheme.configuration.geometry),{done:!0}),run:(0,A.Z)((0,z.Z)({},a.scheme.configuration.run),{done:!1})}),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration"],value:l}])];case 1:return o.sent(),r.mutateOneSimulation(a),s=n.find((function(e){return e.id===t.id})),i(s),[3,3];case 2:return c=o.sent(),(0,P.lt)(Zt,c),[3,3];case 3:return[2]}}))}));return function(n,t,i,r,a){return e.apply(this,arguments)}}(),wt=function(e){var n=e.geometries,t=e.geometry,i=e.simulation,r=e.setGeometry,a=e.swr;!i.scheme.configuration.geometry.value&&t&&jt(i,n,t,r,a);var o=n.map((function(e){return(0,u.jsx)("div",{className:"Geometry-list",style:{backgroundColor:e.id===(null===t||void 0===t?void 0:t.id)?"#FFFBE6":"#FAFAFA"},onClick:function(){return jt(i,n,e,r,a)},children:(0,u.jsx)(v.Z.Text,{children:e.name})},e.id)}));return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(_.Z,{size:"small",children:(0,u.jsx)(v.Z.Text,{children:"When changing the simulation domain, you might lose your topological entity assignments"})}),(0,u.jsx)(_.Z,{size:"small",children:(0,u.jsx)(v.Z.Text,{strong:!0,children:"Select a simulation domain"})}),o,i.scheme.configuration.geometry.meshable&&(0,u.jsx)(bt,{simulation:{id:i.id,scheme:i.scheme},swr:{mutateOneSimulation:a.mutateOneSimulation}})]})},Ct="Unable to delete material",St=function(){var e=(0,i.Z)((function(e,n,t,i){var r,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=nt.Z.deepCopy(e),u=r.scheme.configuration.materials,u.values[n].selected.forEach((function(e){t(_n(e))})),u.values=(0,a.Z)(u.values.slice(0,n)).concat((0,a.Z)(u.values.slice(n+1))),l=(0,A.Z)((0,z.Z)({},u),{done:!!u.values.length}),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:l}])];case 1:return o.sent(),i.mutateOneSimulation(r),[3,3];case 2:throw s=o.sent(),(0,P.lt)(Ct,s),s;case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),kt=function(e){var n=e.simulation,t=e.index,r=e.swr,a=(0,d.useState)(!1),l=a[0],s=a[1],c=(0,d.useContext)(Y).dispatch,f=n.scheme.configuration.materials.values[t];return(0,u.jsx)(k.m1,{loading:l,text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the material"," ",(0,u.jsx)(v.Z.Text,{strong:!0,children:f.material.label})]}),onDelete:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:s(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,St(n,t,c,r)];case 2:return e.sent(),[3,4];case 3:return s(!1),[7];case 4:return[2]}}))}))})},Pt=function(e){var n,t=e.simulation,i=e.swr,r=e.onEdit,a=(0,d.useState)(!0),o=a[0],l=a[1],s=t.scheme.configuration.materials,c=(0,d.useContext)(Y).dispatch,f=(0,d.useCallback)((function(e){c(wn());var n=s.values[e].selected;null===n||void 0===n||n.forEach((function(e){c(En(e))}))}),[s,c]),m=(0,d.useCallback)((function(){c(Cn())}),[c]);return(0,u.jsx)(u.Fragment,{children:null===(n=s.values)||void 0===n?void 0:n.map((function(e,n){return(0,u.jsx)(_.Z,{className:"material-item text-center",hoverable:!0,onMouseEnter:function(){return f(n)},onMouseLeave:function(){o&&m()},actions:[(0,u.jsx)(k.w6,{onEdit:function(){l(!1),r(n),setTimeout((function(){return l(!0)}),500)}},"edit"),(0,u.jsx)(kt,{index:n,simulation:{id:t.id,scheme:t.scheme},swr:{mutateOneSimulation:i.mutateOneSimulation}},"delete")],children:(0,u.jsx)(v.Z.Text,{strong:!0,className:"text-center",children:e.material.label})},n)})).filter((function(e){return e}))})},Et=t(63463),_t=t(20550),Nt=t(13982),Ot=t(14618),Mt=t(94668),Tt=t(68795),zt=function(e){var n,t=e.geometry,i=e.alreadySelected,r=e.updateSelected,a=(0,d.useState)([]),o=a[0],l=a[1],s=(0,d.useState)(),c=s[0],m=s[1],h=(0,d.useState)(),y=h[0],g=h[1],x=(0,d.useContext)(Y),b=x.type,Z=x.highlighted,j=x.selected,w=x.dispatch;(0,d.useEffect)((function(){r(j)}),[r,j]),(0,d.useEffect)((function(){var e,n=[];b&&(null===(e=t.summary[b])||void 0===e||e.forEach((function(e){e.color&&(n.find((function(n){return n.r===e.color.r&&n.g===e.color.g&&n.b===e.color.b}))||n.push(e.color))}))),l(n)}),[t,b]);var C=function(){w(Pn())},S=(0,d.useCallback)((function(e){m(e)}),[]),k=(0,d.useCallback)((function(e){var n=e.target.value;g(n)}),[]),P=(0,d.useCallback)((function(e){var n,t,i;return(!c||c.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&c.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&c.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&!(y&&e.name&&!e.name.includes(y))}),[c,y]);return(0,u.jsxs)(_.Z,{size:"small",className:"no-border-bottom",children:[(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(v.Z.Text,{strong:!0,children:"Filters"}),(0,u.jsxs)(N.Z,{direction:"horizontal",wrap:!0,children:[o.length>1&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(f.Z,{title:"Reset",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(le.Z,{}),onClick:function(){return S()}})}),o.map((function(e){return(0,u.jsx)(f.Z,{title:"Color",children:(0,u.jsx)(p.Z,{style:{backgroundColor:nt.Z.rgbToHex(e)},onClick:function(){return S(e)},children:" "})},JSON.stringify(e))}))]}),(0,u.jsx)(f.Z,{title:"Select all",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(Nt.Z,{}),onClick:function(){var e;null===(e=t.summary[b])||void 0===e||e.forEach((function(e){var n,t,i;(!c||c&&c.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&c.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&c.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&w(En({uuid:e.uuid,label:e.label}))}))}})}),(0,u.jsx)(f.Z,{title:"Unselect all",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(Ot.Z,{}),onClick:function(){var e;null===(e=t.summary[b])||void 0===e||e.forEach((function(e){var n,t,i;(!c||c&&c.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&c.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&c.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&w(_n({uuid:e.uuid,label:e.label}))}))}})}),(0,u.jsx)(f.Z,{title:"Swap",children:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(Mt.Z,{}),onClick:function(){var e;null===(e=t.summary[b])||void 0===e||e.forEach((function(e){var n,t,i;(!c||c&&c.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&c.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&c.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&j.find((function(n){return n.uuid===e.uuid}))?w(_n({uuid:e.uuid,label:e.label})):w(En({uuid:e.uuid,label:e.label}))}))}})})]}),(0,u.jsx)(be.Z,{placeholder:"Search",value:y,onChange:k,suffix:(0,u.jsx)(Tt.Z,{className:"text-light"})})]}),(0,u.jsx)("div",{className:"full-width marginTop-20",children:b?null===(n=t.summary[b])||void 0===n?void 0:n.map((function(e,n){if(P(e)){var t="transparent",r="transparent";return j.find((function(n){return n.uuid===e.uuid}))&&(null===Z||void 0===Z?void 0:Z.uuid)!==e.uuid?(t="#FAD114",r="rgba(255, 251, 230, 0.3)"):(null===Z||void 0===Z?void 0:Z.uuid)===e.uuid&&(t="#FAD114",r="#FFFBE6"),(0,u.jsx)(_.Z,{className:"marginBottom-10",bodyStyle:{position:"relative",padding:"10px 10px 10px 40px",borderWidth:"2px",borderStyle:"solid",borderColor:t,backgroundColor:r},onMouseEnter:function(){return n={uuid:e.uuid,label:e.label},void w(kn(n));var n},onMouseLeave:C,onClick:function(){return n={uuid:e.uuid,label:e.label},void(j.find((function(e){return e.uuid===n.uuid}))?w(_n(n)):w(En(n)));var n},children:(0,u.jsxs)(N.Z,{direction:"vertical",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{position:"absolute",left:"-2px",top:"-2px",bottom:"-2px",width:"30px",backgroundColor:nt.Z.rgbToRgba(e.color,1)}}),e.name]}),null===i||void 0===i?void 0:i.map((function(n){if(n.selected.find((function(n){return n.uuid===e.uuid})))return(0,u.jsx)(_t.Z,{color:nt.Z.stringToColor(n.label),children:n.label},e.uuid)}))]})},n)}})):[]})]})},At=t(95507),Ft=t(13520),Rt=t(47403),Dt=function(e){var n=e.onSelect,t=(0,d.useState)(),i=t[0],r=t[1],a=(0,d.useState)(),o=a[0],l=a[1],s=(0,d.useState)(),c=s[0],f=s[1],v=(0,d.useState)(),y=v[0],g=v[1],x=Object.keys(Rt.E),b=(0,d.useCallback)((function(e){var n=e.key,t=Rt.E[n];l({key:n,children:t.children}),f(void 0),g(void 0)}),[]),Z=(0,d.useCallback)((function(e){var n=e.key,t=Rt.E[o.key].children.find((function(e){return e.key===n}));f({key:n}),g(t)}),[o]),j=(0,d.useCallback)((function(e){n(e),r(!1)}),[n]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(p.Z,{icon:(0,u.jsx)(Ft.Z,{}),onClick:function(){return r(!0)},className:"full-width",children:"Pick a material"}),(0,u.jsx)(Xn.Z,{open:i,title:"Material database",onCancel:function(){return r(!1)},onOk:function(){return j(y)},okText:"Choose",okButtonProps:{disabled:!y},width:"50%",children:(0,u.jsx)(m.Z,{children:(0,u.jsx)(m.Z.Content,{children:(0,u.jsxs)(N.Z,{style:{alignItems:"stretch"},children:[(0,u.jsx)(h.Z,{mode:"inline",items:x.map((function(e){return{key:e,label:Rt.E[e].label}})),onClick:b}),(0,u.jsx)(h.Z,{mode:"inline",items:null===o||void 0===o?void 0:o.children.map((function(e){return{key:e.key,label:e.label}})),selectedKeys:(null===c||void 0===c?void 0:c.key)?[null===c||void 0===c?void 0:c.key]:[],onClick:Z}),y&&(0,u.jsx)(At.ZP,{itemLayout:"vertical",children:y.children.map((function(e){return(0,u.jsxs)(At.ZP.Item,{children:[e.label,": ",e.symbol," = ",e.value]},e.label)}))})]})})})})]})},Lt="You need to define a material",Ut="You need to select a solid",Vt="Unable to add material",It=function(){var e=(0,i.Z)((function(e,n,t){var i,r,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(i=nt.Z.deepCopy(n)).uuid=(0,nn.Z)(),r=nt.Z.deepCopy(e),(u=r.scheme.configuration.materials).values=(0,a.Z)(u.values||[]).concat([i]),l=(0,A.Z)((0,z.Z)({},u),{done:!0}),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:l}])];case 1:return o.sent(),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:(0,A.Z)((0,z.Z)({},r.scheme.configuration.run),{done:!1})}])];case 2:return o.sent(),t.mutateOneSimulation(r),[3,4];case 3:throw s=o.sent(),(0,P.lt)(Vt,s),s;case 4:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Bt=function(e){var n=e.simulation,t=e.material,r=e.swr,a=e.onError,l=e.onClose,s=(0,d.useState)(!1),c=s[0],f=s[1];return(0,u.jsx)(k.HS,{loading:c,needMargin:!0,onAdd:(0,i.Z)((function(){var e;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:f(!0),i.label=1;case 1:return i.trys.push([1,3,,4]),t.material?(null===(e=t.selected)||void 0===e?void 0:e.length)?(a(),[4,It(n,t,r)]):(a(Ut),f(!1),[2]):(a(Lt),f(!1),[2]);case 2:return i.sent(),f(!1),l(),[3,4];case 3:return i.sent(),f(!1),[3,4];case 4:return[2]}}))})),children:"Add"})},Ht="You need to define a material",Gt="You need to select a solid",Wt="Unable to edit material",Yt=function(){var e=(0,i.Z)((function(e,n,t){var i,r,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=nt.Z.deepCopy(e),r=i.scheme.configuration.materials,u=r.values.findIndex((function(e){return e.uuid===n.uuid})),r.values=(0,a.Z)(r.values.slice(0,u)).concat([n],(0,a.Z)(r.values.slice(u+1))),l=(0,z.Z)({},r),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:l}])];case 1:return o.sent(),t.mutateOneSimulation(i),[3,3];case 2:throw s=o.sent(),(0,P.lt)(Wt,s),s;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Jt=function(e){var n=e.simulation,t=e.material,r=e.swr,a=e.onError,l=e.onClose,s=(0,d.useState)(!1),c=s[0],f=s[1];return(0,u.jsx)(k.w6,{loading:c,primary:!0,needMargin:!0,onEdit:(0,i.Z)((function(){var e;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:f(!0),i.label=1;case 1:return i.trys.push([1,3,,4]),t.material?(null===(e=t.selected)||void 0===e?void 0:e.length)?(a(),[4,Yt(n,t,r)]):(a(Gt),f(!1),[2]):(a(Ht),f(!1),[2]);case 2:return i.sent(),f(!1),l(),[3,4];case 3:return i.sent(),f(!1),[3,4];case 4:return[2]}}))})),children:"Edit"})},Xt=function(e){var n,t,i=e.visible,r=e.geometry,o=e.simulation,l=e.material,s=e.swr,c=e.onClose,f=(0,d.useState)(),m=f[0],h=f[1],y=(0,d.useState)(),g=y[0],x=y[1],Z=(0,d.useState)(),j=Z[0],w=Z[1],C=o.scheme.configuration.materials;(0,d.useEffect)((function(){!i&&g&&x(void 0)})),(0,d.useEffect)((function(){i&&!g&&l&&x(l)}),[g,i,l]),(0,d.useEffect)((function(){var e,n=null===C||void 0===C||null===(e=C.values)||void 0===e?void 0:e.map((function(e){if(e.uuid!==(null===l||void 0===l?void 0:l.uuid))return{label:e.material.label,selected:e.selected}})).filter((function(e){return e}));h(n||[])}),[o,l,C]);var S,P,E,O,M=(0,d.useCallback)((function(e){x((function(n){return(0,A.Z)((0,z.Z)({},n),{material:e})}))}),[]),T=(0,d.useCallback)((function(e){x((function(n){return(0,A.Z)((0,z.Z)({},n),{selected:e})}))}),[]),F=(0,d.useCallback)((function(e,n,t){x((function(i){var r,o,u,l;return(0,A.Z)((0,z.Z)({},i),{material:{label:"Custom",children:(0,a.Z)((null===i||void 0===i||null===(r=i.material)||void 0===r||null===(o=r.children)||void 0===o?void 0:o.slice(0,n))||[]).concat([{label:e.label,symbol:e.name,value:t}],(0,a.Z)((null===i||void 0===i||null===(u=i.material)||void 0===u||null===(l=u.children)||void 0===l?void 0:l.slice(n+1))||[]))}})}))}),[]);return(0,u.jsx)(Et.Z,{className:"material",title:"Material",placement:"left",closable:!1,open:i,mask:!1,maskClosable:!1,width:300,extra:(0,u.jsx)(p.Z,{type:"text",icon:(0,u.jsx)(le.Z,{}),onClick:function(){x(void 0),c()}}),footer:(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,u.jsx)(k.Lw,{onCancel:function(){x(void 0),c()}}),l?(0,u.jsx)(Jt,{material:{uuid:null!==(S=null===g||void 0===g?void 0:g.uuid)&&void 0!==S?S:l.uuid,material:null!==(P=null===g||void 0===g?void 0:g.material)&&void 0!==P?P:l.material,selected:null!==(E=null===g||void 0===g?void 0:g.selected)&&void 0!==E?E:l.selected},simulation:{id:o.id,scheme:o.scheme},swr:{mutateOneSimulation:s.mutateOneSimulation},onError:function(e){return w(e)},onClose:c}):(0,u.jsx)(Bt,{material:{material:null===g||void 0===g?void 0:g.material,selected:null===g||void 0===g?void 0:g.selected},simulation:{id:o.id,scheme:o.scheme},swr:{mutateOneSimulation:s.mutateOneSimulation},onError:function(e){return w(e)},onClose:c})]}),children:(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(_.Z,{size:"small",children:(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(Dt,{onSelect:M}),(0,u.jsxs)(v.Z.Text,{children:["Material: ",null!==(O=null===g||void 0===g||null===(n=g.material)||void 0===n?void 0:n.label)&&void 0!==O?O:"default"]}),null===C||void 0===C||null===(t=C.children)||void 0===t?void 0:t.map((function(e,n){var t,i,r=null===g||void 0===g||null===(t=g.material)||void 0===t||null===(i=t.children)||void 0===i?void 0:i.find((function(n){return n.symbol===e.name}));return(0,u.jsx)(pt,{label:e.name,defaultValue:r?r.value:String(e.default),unit:e.unit,onValueChange:function(t){F(e,n,t)}},e.name)}))]})}),(0,u.jsx)(zt,{geometry:r,alreadySelected:m,updateSelected:T}),j&&(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)(b.Z,{style:{color:"red"}})," ",j]})]})})},qt=function(e){var n=e.geometry,t=e.simulation,i=e.swr,r=e.setVisible,a=(0,d.useState)(),o=a[0],l=a[1],s=(0,d.useState)(!1),c=s[0],f=s[1],h=(0,d.useContext)(Y).dispatch,v=t.scheme.configuration.materials;(0,d.useEffect)((function(){(null===n||void 0===n?void 0:n.summary)&&h(Sn(2===n.summary.dimension?"faces":"solids"))}),[n,h]);var p=(0,d.useCallback)((function(){l(void 0),f(!0),r(!1),h(wn())}),[h,r]),y=(0,d.useCallback)((function(e){var n=v.values[e];l(n),f(!0),r(!1),h(wn())}),[v,h,r]),g=(0,d.useCallback)((function(){h(Cn()),f(!1),l(void 0),r(!0)}),[h,r]);return n?(0,u.jsx)(m.Z,{children:(0,u.jsx)(m.Z.Content,{children:(0,u.jsxs)(_.Z,{size:"small",children:[(0,u.jsx)(k.HS,{onAdd:p,fullWidth:!0,primary:!1,children:"Add material"}),(0,u.jsx)(Pt,{simulation:{id:t.id,scheme:t.scheme},swr:i,onEdit:y}),(0,u.jsx)(Xt,{visible:c,geometry:{summary:n.summary},simulation:{id:t.id,scheme:t.scheme},material:o&&{uuid:o.uuid,material:o.material,selected:o.selected},swr:{mutateOneSimulation:i.mutateOneSimulation},onClose:g})]})})}):(0,u.jsx)(E.Z.Simple,{})},Kt=t(54907),Qt="Unable to update simulation",$t=function(){var e=(0,i.Z)((function(e,n){var t,i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),t=nt.Z.deepCopy(e),i=t.scheme.configuration.parameters,r=(0,A.Z)((0,z.Z)({},i),{done:!0}),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","parameters"],value:r}])];case 1:return o.sent(),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:(0,A.Z)((0,z.Z)({},t.scheme.configuration.run),{done:!1})}])];case 2:return o.sent(),n.mutateOneSimulation(t),[3,4];case 3:return a=o.sent(),(0,P.lt)(Qt,a),[3,4];case 4:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),ei=function(){var e=(0,i.Z)((function(e,n,t,i,r){var a,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),a=nt.Z.deepCopy(e),u=a.scheme.configuration.parameters,u[n].children[t].value=i,l=(0,A.Z)((0,z.Z)({},u),{done:!0}),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","parameters"],value:l}])];case 1:return o.sent(),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:(0,A.Z)((0,z.Z)({},a.scheme.configuration.run),{done:!1})}])];case 2:return o.sent(),r.mutateOneSimulation(a),[3,4];case 3:return s=o.sent(),(0,P.lt)(Qt,s),[3,4];case 4:return[2]}}))}));return function(n,t,i,r,a){return e.apply(this,arguments)}}(),ni=function(e){var n=e.simulation,t=e.swr,i=null===n||void 0===n?void 0:n.scheme.configuration.parameters,r=null===n||void 0===n?void 0:n.scheme.configuration.dimension;(0,d.useEffect)((function(){(null===i||void 0===i?void 0:i.done)||$t(n,t)}),[n,i,t]);var a=[],o=[];return 2===r?Object.keys(i).forEach((function(e){if("index"!==e&&"title"!==e&&"done"!=e){var r=i[e],l=null===r||void 0===r?void 0:r.children.map((function(i,r){if(!i.only3D)return"formula"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(pt,{label:n.label2D||n.label,defaultValue:null!==(Ne=n.value)&&void 0!==Ne?Ne:n.default,onValueChange:t,unit:n.unit},e)}(e+"&"+r,i,(function(i){return ei(n,e,r,i,t)})):"select"===i.htmlEntity?function(e,n,t){var i;return(0,u.jsx)(xe.Z,{layout:"vertical",children:(0,u.jsx)(xe.Z.Item,{label:n.label2D||n.label,children:(0,u.jsx)(Jn.Z,{options:null===(i=n.options)||void 0===i?void 0:i.map((function(e){return{label:e.label,value:null!==(Oe=e.value2D)&&void 0!==Oe?Oe:e.value}})),defaultValue:n.value||n.default2D||n.default,onChange:t})})},e)}(e+"&"+r,i,(function(i){return ei(n,e,r,i,t)})):"checkbox"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(xe.Z,{layout:"horizontal",children:(0,u.jsx)(xe.Z.Item,{label:n.label2D||n.label,children:(0,u.jsx)(vt.Z,{defaultChecked:n.value,onChange:t})})},e)}(e+"&"+r,i,(function(i){return ei(n,e,r,i.target.checked,t)})):void 0}));(null===r||void 0===r?void 0:r.advanced)?o.push((0,u.jsx)(_.Z,{size:"small",title:null===r||void 0===r?void 0:r.label,children:(0,u.jsx)(N.Z,{direction:"vertical",children:l})},e)):a.push((0,u.jsx)(_.Z,{size:"small",title:null===r||void 0===r?void 0:r.label,children:(0,u.jsx)(N.Z,{direction:"vertical",children:l})},e))}})):Object.keys(i).forEach((function(e){if("index"!==e&&"title"!==e&&"done"!=e){var r=i[e],l=null===r||void 0===r?void 0:r.children.map((function(i,r){return"formula"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(pt,{label:n.label,defaultValue:null!==(Me=n.value)&&void 0!==Me?Me:n.default,onValueChange:t,unit:n.unit},e)}(e+"&"+r,i,(function(i){return ei(n,e,r,i,t)})):"select"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(xe.Z,{layout:"vertical",children:(0,u.jsx)(xe.Z.Item,{label:n.label,children:(0,u.jsx)(Jn.Z,{options:n.options,defaultValue:n.value||n.default,onChange:t})})},e)}(e+"&"+r,i,(function(i){return ei(n,e,r,i,t)})):"checkbox"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(xe.Z,{layout:"horizontal",children:(0,u.jsx)(xe.Z.Item,{label:n.label,children:(0,u.jsx)(vt.Z,{defaultChecked:n.value,onChange:t})})},e)}(e+"&"+r,i,(function(i){return ei(n,e,r,i.target.checked,t)})):void 0}));(null===r||void 0===r?void 0:r.advanced)?o.push((0,u.jsx)(_.Z,{size:"small",title:null===r||void 0===r?void 0:r.label,children:(0,u.jsx)(N.Z,{direction:"vertical",children:l})},e)):a.push((0,u.jsx)(_.Z,{size:"small",title:null===r||void 0===r?void 0:r.label,children:(0,u.jsx)(N.Z,{direction:"vertical",children:l})},e))}})),(0,u.jsx)(m.Z,{children:(0,u.jsx)(m.Z.Content,{children:(0,u.jsxs)(N.Z,{direction:"vertical",children:[a,(0,u.jsx)(Kt.Z,{children:(0,u.jsx)(Kt.Z.Panel,{header:"Advanced",children:(0,u.jsx)(N.Z,{direction:"vertical",children:o})},"advanced")})]})})})},ti=function(e,n){return e.map((function(e){var t=e.fileName.replace(new RegExp(n.prefixPattern),"").replace(new RegExp(n.suffixPattern),"");return(0,A.Z)((0,z.Z)({},e),{number:+t})}))},ii=function(e,n){var t=n.multiplicator;if(t){var i,r=t.reduce((function(e,n){return e[n]}),e);return null!==(i=r.value)&&void 0!==i?i:r.default}},ri="Unable to update simulation",ai=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=nt.Z.deepCopy(e),(r=i.scheme.configuration.initialization).value={type:n},[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:r}])];case 1:return o.sent(),t.mutateOneSimulation(i),[3,3];case 2:throw a=o.sent(),(0,P.lt)(ri,a),a;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),oi=function(){var e=(0,i.Z)((function(e,n,t,i){var r,a,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,si(e,t)];case 1:return a=o.sent(),u=nt.Z.deepCopy(n),(l=u.scheme.configuration.initialization).value=(0,A.Z)((0,z.Z)({},l.value),{simulation:t,result:null===a||void 0===a||null===(r=a[0])||void 0===r?void 0:r.value}),[4,Q.Z.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:l}])];case 2:return o.sent(),i.mutateOneSimulation(u),[3,4];case 3:throw s=o.sent(),(0,P.lt)(ri,s),s;case 4:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),ui=function(){var e=(0,i.Z)((function(e,n,t,i){var r,a,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=nt.Z.deepCopy(e),(a=r.scheme.configuration.initialization).value=(0,A.Z)((0,z.Z)({},a.value),{number:+n,result:t.file}),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:a}])];case 1:return o.sent(),i.mutateOneSimulation(r),[3,3];case 2:return u=o.sent(),(0,P.lt)(ri,u),[3,3];case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),li=function(){var e=(0,i.Z)((function(e,n,t,i){var r,a,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=nt.Z.deepCopy(e),(a=r.scheme.configuration.initialization).value.values||(a.value.values=[]),a.value.values[n]=t,[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:a}])];case 1:return o.sent(),i.mutateOneSimulation(r),[3,3];case 2:return u=o.sent(),(0,P.lt)(ri,u),[3,3];case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),si=function(){var e=(0,i.Z)((function(e,n){var t,i,r,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,Q.Z.tasks({id:n})];case 1:return i=o.sent(),r=e.find((function(e){return e.id===n})),u=r.scheme.configuration,l=null===u||void 0===u||null===(t=u.run)||void 0===t?void 0:t.resultsFilter,s=[],i.forEach((function(e){if(e.file&&"result"===e.file.type&&s.push({label:e.file.fileName,value:e.file.fileName,file:e.file.fileName}),e.files)if(l){var n,t,i=new RegExp(l.pattern),r=e.files.filter((function(e){return!i.test(e.fileName)})).filter((function(e){return"result"===e.type})),o=e.files.filter((function(e){return i.test(e.fileName)})),c=ti(o,l).map((function(e){return{number:e.number,fileName:e.fileName.replace(new RegExp(l.suffixPattern),"")}})).filter((function(e,n,t){return t.findIndex((function(n){return n.number===e.number}))===n})).sort((function(e,n){return e.number-n.number})),d=ii(u,l),f=c.map((function(e,n){var t=d?e.number*d:n,i=Math.round(1e15*t)/1e15;return{label:String(i),value:e.fileName,file:e.fileName}}));(n=s).push.apply(n,(0,a.Z)(r.map((function(e){return{label:e.fileName,value:e.fileName,file:e.fileName}})).filter((function(e){return e})))),(t=s).push.apply(t,(0,a.Z)(f))}else e.files.forEach((function(e){"result"===e.type&&s.push({label:e.fileName,value:e.fileName,file:e.fileName})}))})),[2,s]}}))}));return function(n,t){return e.apply(this,arguments)}}(),ci=function(e){var n=e.simulations,t=e.simulation,r=e.swr,a=(0,d.useState)(!1),l=a[0],s=a[1],c=(0,d.useState)(),f=c[0],h=c[1],p=(0,d.useState)(),y=p[0],g=p[1],x=(0,d.useState)(),b=x[0],Z=x[1],j=null===t||void 0===t?void 0:t.scheme.configuration.initialization,w=null===t||void 0===t?void 0:t.scheme.configuration.dimension,C=(0,d.useCallback)((function(e){var t=n.find((function(n){return n.id===e}));g(t)}),[n]);(0,d.useEffect)((function(){var e,n;!f&&j.value&&h(j.value.type),!y&&(null===(e=j.value)||void 0===e?void 0:e.simulation)&&C(null===(n=j.value)||void 0===n?void 0:n.simulation)}),[j,f,y,C]),(0,d.useEffect)((function(){y&&si(n,y.id).then((function(e){return Z(e)}))}),[n,y]);var S=[{label:"None",value:"none"}];j.coupling&&S.push({label:j.coupling.label,value:"coupling"}),j.direct&&S.push({label:j.direct.label,value:"direct"});var k={none:(0,u.jsx)("div",{})},P=j.value,E=j.coupling;if(null===E||void 0===E?void 0:E.compatibility){var O=n.map((function(e){var n=e.id===t.id||!E.compatibility.find((function(n){return n.algorithm===e.scheme.algorithm}));return{label:e.name,value:e.id,disabled:n}})),M=E.compatibility.find((function(e){var n;return e.algorithm===(null===y||void 0===y||null===(n=y.scheme)||void 0===n?void 0:n.algorithm)})),T=null===M||void 0===M?void 0:M.filter;k.coupling=function(e,a){return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(v.Z.Text,{children:"If you use coupling, the selected simulation mesh will be used, at least for the first iteration."}),(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width marginTop-10",children:[(0,u.jsx)(Jn.Z,{className:"full-width",options:e,placeholder:"Select a simulation",value:null===P||void 0===P?void 0:P.simulation,onChange:function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(i){switch(i.label){case 0:s(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,oi(n,t,e,r)];case 2:return i.sent(),C(e),[3,5];case 3:return i.sent(),[3,5];case 4:return s(!1),[7];case 5:return[2]}}))}));return function(n){return e.apply(this,arguments)}}()}),l&&(0,u.jsx)(Ie.Z,{}),(null===b||void 0===b?void 0:b.length)?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(v.Z.Text,{children:[null===a||void 0===a?void 0:a.name,":"]},"simulation"),(0,u.jsx)(Jn.Z,{className:"full-width",options:b,placeholder:"Select a "+a.name,value:null===P||void 0===P?void 0:P.result,onChange:function(){var e=(0,i.Z)((function(e,n){return(0,o.__generator)(this,(function(i){return ui(t,e,n,r),[2]}))}));return function(n,t){return e.apply(this,arguments)}}()})]}):(0,u.jsx)(v.Z.Text,{type:"danger",children:"No results, please select an other simulation."})]})]})}(O,T)}var z=j.direct;return(null===z||void 0===z?void 0:z.children)&&(k.direct=function(e){return(0,u.jsx)(N.Z,{direction:"vertical",className:"full-width",children:e.children.map((function(e,n){var i,a;if(2!==w||!e.only3D)return(0,u.jsx)(pt,{label:e.label,defaultValue:(null!==(a=null===P||void 0===P||null===(i=P.values)||void 0===i?void 0:i[n])&&void 0!==a?a:e.default).toString(),unit:e.unit,onValueChange:function(e){return li(t,n,e,r)}},n)}))})}(z)),(0,u.jsx)(m.Z,{children:(0,u.jsx)(m.Z.Content,{children:(0,u.jsxs)(_.Z,{size:"small",children:[(0,u.jsx)(Jn.Z,{className:"full-width marginBottom-10",defaultValue:"none",value:f,options:S,onChange:function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,ai(t,e,r)];case 1:return n.sent(),h(e),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}()}),k[f||"none"]]})})})},di="Unable to delete boundary condition",fi=function(){var e=(0,i.Z)((function(e,n,t,i,r){var u,l,s,c,d,f;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),u=nt.Z.deepCopy(e),l=u.scheme.configuration.boundaryConditions,s=l[n],s.values[t].selected.forEach((function(e){i(_n(e))})),s.values=(0,a.Z)(s.values.slice(0,t)).concat((0,a.Z)(s.values.slice(t+1))),c=!1,Object.keys(l).forEach((function(e){var n;"index"!==e&&"title"!==e&&"done"!==e&&((null===(n=l[e].values)||void 0===n?void 0:n.length)&&(c=!0))})),d=(0,A.Z)((0,z.Z)({},l),{done:c}),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:d}])];case 1:return o.sent(),r.mutateOneSimulation(u),[3,3];case 2:throw f=o.sent(),(0,P.lt)(di,f),f;case 3:return[2]}}))}));return function(n,t,i,r,a){return e.apply(this,arguments)}}(),mi=function(e){var n=e.type,t=e.index,r=e.simulation,a=e.swr,l=(0,d.useState)(!1),s=l[0],c=l[1],f=(0,d.useContext)(Y).dispatch,m=r.scheme.configuration.boundaryConditions[n].values[t];return(0,u.jsx)(k.m1,{loading:s,onDelete:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:c(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,fi(r,n,t,f,a)];case 2:return e.sent(),[3,4];case 3:return c(!1),[7];case 4:return[2]}}))})),text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the condition"," ",(0,u.jsx)(v.Z.Text,{strong:!0,children:null===m||void 0===m?void 0:m.name}),"?"]})})},hi=function(e){var n=e.simulation,t=e.swr,i=e.onEdit,r=(0,d.useState)(!0),a=r[0],o=r[1],l=n.scheme.configuration.boundaryConditions,s=(0,d.useContext)(Y).dispatch,c=(0,d.useCallback)((function(e,n){s(wn());var t=l[e].values[n].selected;null===t||void 0===t||t.forEach((function(e){s(En(e))}))}),[l,s]),f=(0,d.useCallback)((function(){s(Cn())}),[s]);return(0,u.jsx)(u.Fragment,{children:Object.keys(l).map((function(e){var r;if("index"!==e&&"title"!==e&&"done"!==e){var s=l[e];return null===(r=s.values)||void 0===r?void 0:r.map((function(r,l){return(0,u.jsxs)(_.Z,{className:"boundaryCondition-item",hoverable:!0,onMouseEnter:function(){return c(e,l)},onMouseLeave:function(){a&&f()},actions:[(0,u.jsx)(k.w6,{onEdit:function(){o(!1),i(e,l),setTimeout((function(){return o(!0)}),500)}},"edit"),(0,u.jsx)(mi,{simulation:{id:n.id,scheme:n.scheme},type:e,index:l,swr:{mutateOneSimulation:t.mutateOneSimulation}},"delete")],children:[(0,u.jsx)(v.Z.Text,{strong:!0,children:r.name})," ",(0,u.jsxs)(v.Z.Text,{children:["(",s.label,")"]})]},l)}))}})).filter((function(e){return e}))})},vi=t(29924),pi="You need to define a name",yi="You need to select a type",gi="You need to select a face",xi="Unable to add boundary condition",bi=function(){var e=(0,i.Z)((function(e,n,t){var i,r,u,l,s,c,d;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),i=(0,z.Z)({},n),r=i.type.key,i.uuid=(0,nn.Z)(),u=nt.Z.deepCopy(e),l=u.scheme.configuration.boundaryConditions,(s=l[r]).values=(0,a.Z)(s.values||[]).concat([i]),c=(0,A.Z)((0,z.Z)({},l),{done:!0}),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:c}])];case 1:return o.sent(),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:(0,A.Z)((0,z.Z)({},u.scheme.configuration.run),{done:!1})}])];case 2:return o.sent(),t.mutateOneSimulation(u),[3,4];case 3:throw d=o.sent(),(0,P.lt)(xi,d),d;case 4:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Zi=function(e){var n=e.simulation,t=e.boundaryCondition,r=e.swr,a=e.onError,l=e.onClose,s=(0,d.useState)(!1),c=s[0],f=s[1];return(0,u.jsx)(k.HS,{loading:c,onAdd:(0,i.Z)((function(){var e,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:f(!0),o.label=1;case 1:return o.trys.push([1,3,,4]),t.name?(null===(e=t.type)||void 0===e?void 0:e.key)?(null===(i=t.selected)||void 0===i?void 0:i.length)?(a(),[4,bi(n,t,r)]):(a(gi),f(!1),[2]):(a(yi),f(!1),[2]):(a(pi),f(!1),[2]);case 2:return o.sent(),f(!1),l(),[3,4];case 3:return o.sent(),f(!1),[3,4];case 4:return[2]}}))})),needMargin:!0,children:"Add"})},ji="You need to define a name",wi="You need to select a type",Ci="You need to select a face",Si="Unable to edit boundary condition",ki=function(){var e=(0,i.Z)((function(e,n,t,i){var r,u,l,s,c,d,f,m,h,v,p;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=nt.Z.deepCopy(e),u=r.scheme.configuration.boundaryConditions,l=n.type.key,(s=t.type.key)!==l&&(c=u[s],d=c.values.findIndex((function(e){return e.uuid===t.uuid})),c.values=(0,a.Z)(c.values.slice(0,d)).concat((0,a.Z)(c.values.slice(d+1)))),s!==l?(f=u[l]).values=(0,a.Z)(f.values||[]).concat([n]):(m=u[l],h=m.values.findIndex((function(e){return e.uuid===n.uuid})),m.values=(0,a.Z)(m.values.slice(0,h)).concat([n],(0,a.Z)(m.values.slice(h+1)))),v=(0,z.Z)({},u),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:v}])];case 1:return o.sent(),i.mutateOneSimulation(r),[3,3];case 2:throw p=o.sent(),(0,P.lt)(Si,p),p;case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),Pi=function(e){var n=e.simulation,t=e.boundaryCondition,r=e.oldBoundaryCondition,a=e.swr,l=e.onError,s=e.onClose,c=(0,d.useState)(!1),f=c[0],m=c[1];return(0,u.jsx)(k.w6,{loading:f,onEdit:(0,i.Z)((function(){var e,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:m(!0),o.label=1;case 1:return o.trys.push([1,3,,4]),t.name?(null===(e=t.type)||void 0===e?void 0:e.key)?(null===(i=t.selected)||void 0===i?void 0:i.length)?(l(),[4,ki(n,t,r,a)]):(l(Ci),m(!1),[2]):(l(wi),m(!1),[2]):(l(ji),m(!1),[2]);case 2:return o.sent(),m(!1),s(),[3,4];case 3:return o.sent(),m(!1),[3,4];case 4:return[2]}}))})),primary:!0,needMargin:!0,children:"Edit"})},Ei=function(e){var n,t=e.visible,i=e.geometry,r=e.simulation,o=e.boundaryCondition,l=e.swr,s=e.onClose,c=(0,d.useState)([]),f=c[0],m=c[1],h=(0,d.useState)([]),y=h[0],g=h[1],x=(0,d.useState)(),Z=x[0],j=x[1],w=(0,d.useState)(),C=w[0],S=w[1],P=(0,d.useState)(),E=P[0],O=P[1],M=r.scheme.configuration.boundaryConditions,T=r.scheme.configuration.dimension;(0,d.useEffect)((function(){!t&&C&&S(void 0)})),(0,d.useEffect)((function(){t&&!C&&o?S(o):!t||C||o||void 0===Z||S((function(e){return(0,A.Z)((0,z.Z)({},e),{name:"Boundary condition "+(Z+1)})}))}),[C,Z,t,o]),(0,d.useEffect)((function(){var e=Object.keys(M).map((function(e){var n;if("index"!==e&&"title"!==e&&"done"!==e){var t=M[e];return null===t||void 0===t||null===(n=t.values)||void 0===n?void 0:n.map((function(e){if(e.uuid!==(null===o||void 0===o?void 0:o.uuid))return{label:e.name,selected:e.selected}})).filter((function(e){return e}))}})).flat().filter((function(e){return e}));m(e)}),[M,o]),(0,d.useEffect)((function(){var e=Object.keys(M).map((function(e){if("index"!==e&&"title"!==e&&"done"!==e){var n=M[e];return{key:e,label:n.label,children:n.children,values:n.values}}})).filter((function(e){return e}));g(e)}),[M]),(0,d.useEffect)((function(){var e=null===y||void 0===y?void 0:y.map((function(e){var n;return null===(n=e.values)||void 0===n?void 0:n.length})).filter((function(e){return e})).reduce((function(e,n){return e+n}),0);j(e)}),[y]);var F=(0,d.useCallback)((function(e){var n=e.target.value;S((function(e){return(0,A.Z)((0,z.Z)({},e),{name:n})}))}),[]),R=(0,d.useCallback)((function(e){var n,t=e.target.value,i=y.find((function(e){return e.key===t})),r=null===(n=M[t].children)||void 0===n?void 0:n.map((function(e){return{checked:!0,value:e.default}}));S((function(e){return(0,A.Z)((0,z.Z)({},e),{type:{key:i.key,label:i.label,children:i.children},values:r})}))}),[M,y]),D=(0,d.useCallback)((function(e,n){S((function(t){return(0,A.Z)((0,z.Z)({},t),{values:(0,a.Z)(t.values.slice(0,e)).concat([{checked:t.values[e].checked,value:n}],(0,a.Z)(t.values.slice(e+1)))})}))}),[]),L=(0,d.useCallback)((function(e,n){S((function(t){return(0,A.Z)((0,z.Z)({},t),{values:(0,a.Z)(t.values.slice(0,e)).concat([{checked:n,value:t.values[e].value}],(0,a.Z)(t.values.slice(e+1)))})}))}),[]),U=(0,d.useCallback)((function(e){S((function(n){return(0,A.Z)((0,z.Z)({},n),{selected:e})}))}),[]),V=(0,d.useMemo)((function(){var e;return(null===C||void 0===C?void 0:C.type)&&(null===(e=C.type)||void 0===e?void 0:e.children)?(0,u.jsx)(_.Z,{children:C.type.children.map((function(e,n){if(2!==T||!e.only3D)return(0,u.jsx)(pt,{className:"marginBottom-10",label:e.label,defaultValue:String(C.values[n].value),defaultChecked:C.type.children.length>1?C.values[n].checked:void 0,onValueChange:function(e){return D(n,e)},onCheckedChange:function(e){return L(n,e)},unit:e.unit},n)}))}):null}),[C,T,L,D]);return(0,u.jsx)(Et.Z,{className:"boundaryCondition",title:"Boundary condition",placement:"left",closable:!1,open:t,mask:!1,maskClosable:!1,width:300,extra:(0,u.jsx)(p.Z,{type:"text",icon:(0,u.jsx)(le.Z,{}),onClick:function(){S(void 0),s()}}),footer:(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,u.jsx)(k.Lw,{onCancel:function(){S(void 0),s()}}),o?(0,u.jsx)(Pi,{boundaryCondition:{uuid:(null===C||void 0===C?void 0:C.uuid)||o.uuid,name:(null===C||void 0===C?void 0:C.name)||o.name,type:(null===C||void 0===C?void 0:C.type)||o.type,selected:(null===C||void 0===C?void 0:C.selected)||o.selected,values:(null===C||void 0===C?void 0:C.values)||o.values},oldBoundaryCondition:{uuid:o.uuid,name:o.name,type:o.type,selected:o.selected,values:o.values},simulation:{id:r.id,scheme:r.scheme},swr:{mutateOneSimulation:l.mutateOneSimulation},onError:function(e){return O(e)},onClose:s}):(0,u.jsx)(Zi,{boundaryCondition:{name:null===C||void 0===C?void 0:C.name,type:null===C||void 0===C?void 0:C.type,selected:null===C||void 0===C?void 0:C.selected,values:null===C||void 0===C?void 0:C.values},simulation:{id:r.id,scheme:r.scheme},swr:{mutateOneSimulation:l.mutateOneSimulation},onError:function(e){return O(e)},onClose:s})]}),children:(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(_.Z,{size:"small",children:(0,u.jsx)(xe.Z,{layout:"vertical",children:(0,u.jsx)(xe.Z.Item,{label:(0,u.jsx)(v.Z.Text,{strong:!0,children:"Boundary condition name"}),children:(0,u.jsx)(be.Z,{value:(null===C||void 0===C?void 0:C.name)||"",onChange:F,maxLength:50})})})}),(0,u.jsx)(_.Z,{size:"small",children:(0,u.jsx)(xe.Z,{layout:"vertical",children:(0,u.jsx)(xe.Z.Item,{label:(0,u.jsx)(v.Z.Text,{strong:!0,children:"Boundary condition type"}),children:(0,u.jsx)(vi.ZP.Group,{className:"BoundaryCondition-types",optionType:"button",buttonStyle:"solid",value:null===C||void 0===C||null===(n=C.type)||void 0===n?void 0:n.key,onChange:R,children:null===y||void 0===y?void 0:y.map((function(e){return(0,u.jsx)(vi.ZP.Button,{value:e.key,children:e.label},e.key)}))})})})}),V,(0,u.jsx)(zt,{geometry:i,alreadySelected:f,updateSelected:U}),E&&(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)(b.Z,{style:{color:"red"}})," ",E]})]})})},_i=function(e){var n=e.simulation,t=e.geometry,i=e.swr,r=e.setVisible,a=(0,d.useState)(),o=a[0],l=a[1],s=(0,d.useState)(!1),c=s[0],f=s[1],h=(0,d.useContext)(Y).dispatch,v=n.scheme.configuration.boundaryConditions;(0,d.useEffect)((function(){(null===t||void 0===t?void 0:t.summary)&&h(Sn(2===t.summary.dimension?"edges":"faces"))}),[t,h]);var p=(0,d.useCallback)((function(){l(void 0),f(!0),r(!1),h(wn())}),[h,r]),y=(0,d.useCallback)((function(e,n){var t=v[e].values[n];l(t),f(!0),r(!1),h(wn())}),[v,h,r]),g=(0,d.useCallback)((function(){h(Cn()),f(!1),l(void 0),r(!0)}),[h,r]);return t?(0,u.jsx)(m.Z,{children:(0,u.jsx)(m.Z.Content,{children:(0,u.jsxs)(_.Z,{size:"small",children:[(0,u.jsx)(k.HS,{onAdd:p,fullWidth:!0,primary:!1,children:"Add boundary condition"}),(0,u.jsx)(hi,{simulation:{id:n.id,scheme:n.scheme},swr:{mutateOneSimulation:i.mutateOneSimulation},onEdit:y}),(0,u.jsx)(Ei,{visible:c,geometry:{summary:t.summary},simulation:{id:n.id,scheme:n.scheme},boundaryCondition:o&&{uuid:o.uuid,name:o.name,type:o.type,selected:o.selected,values:o.values},swr:{mutateOneSimulation:i.mutateOneSimulation},onClose:g})]})})}):(0,u.jsx)(E.Z.Simple,{})},Ni=t(91756),Oi=t(67841),Mi=t(36027),Ti=t(57184),zi="You need to define a name",Ai="You need to select a point",Fi="You need to define a formula",Ri="Unable to update simulation",Di=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=nt.Z.deepCopy(e),r=i.scheme.configuration.run,a=n.index,r.sensors[a]={name:n.name,point:n.point,formula:n.formula},[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:r}])];case 1:return o.sent(),t.mutateOneSimulation(i),[3,3];case 2:throw u=o.sent(),(0,P.lt)(Ri,u),u;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Li=function(e){var n=e.simulation,t=e.sensor,r=e.onError,a=e.onClose,l=e.swr,s=(0,d.useState)(),c=s[0],f=s[1];return(0,u.jsx)(k.w6,{loading:c,primary:!0,needMargin:!0,onEdit:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:f(!0),e.label=1;case 1:return e.trys.push([1,3,,4]),t.name?t.point?t.formula?(r(),[4,Di(n,t,l)]):(r(Fi),f(!1),[2]):(r(Ai),f(!1),[2]):(r(zi),f(!1),[2]);case 2:return e.sent(),f(!1),a(),[3,4];case 3:return e.sent(),f(!1),[3,4];case 4:return[2]}}))})),children:"Edit"})},Ui="You need to define a name",Vi="You need to select a point",Ii="You need to define a formula",Bi="Unable to update simulation",Hi=function(){var e=(0,i.Z)((function(e,n,t){var i,r,u,l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=nt.Z.deepCopy(e),r=i.scheme.configuration.run,u=(0,A.Z)((0,z.Z)({},r),{sensors:(0,a.Z)(r.sensors||[]).concat([n])}),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:u}])];case 1:return o.sent(),t.mutateOneSimulation(i),[3,3];case 2:throw l=o.sent(),(0,P.lt)(Bi,l),l;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Gi=function(e){var n=e.simulation,t=e.sensor,r=e.onError,a=e.onClose,l=e.swr,s=(0,d.useState)(),c=s[0],f=s[1];return(0,u.jsx)(k.HS,{loading:c,needMargin:!0,onAdd:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:f(!0),e.label=1;case 1:return e.trys.push([1,3,,4]),t.name?t.point?t.formula?(r(),[4,Hi(n,t,l)]):(r(Ii),f(!1),[2]):(r(Vi),f(!1),[2]):(r(Ui),f(!1),[2]);case 2:return e.sent(),f(!1),a(),[3,4];case 3:return e.sent(),f(!1),[3,4];case 4:return[2]}}))})),children:"Add"})},Wi=function(e){var n=e.visible,t=e.simulation,i=e.sensor,r=e.onClose,a=e.swr,o=(0,d.useState)(),l=o[0],s=o[1],c=(0,d.useState)(),m=c[0],h=c[1],y=(0,d.useState)(),g=y[0],x=y[1],Z=(0,d.useState)(),j=Z[0],w=Z[1],C=(0,d.useContext)(Y),S=C.point,P=C.dispatch;(0,d.useEffect)((function(){P(Sn("point"))}),[P]),(0,d.useEffect)((function(){if(!i){var e=t.scheme.configuration.run;h("Sensor "+(e.sensors?e.sensors.length+1:1))}}),[t,i]),(0,d.useEffect)((function(){i&&(h(i.name),P(Nn({x:i.point.x,y:i.point.y,z:i.point.z})),x(i.formula))}),[i,P]);var E,O,M,T,F,R,D=(0,d.useCallback)((function(){s(!1),P(Cn()),window.removeEventListener("click",D)}),[P]),L=(0,d.useCallback)((function(){l?D():(s(!0),P(wn()),setTimeout((function(){return window.addEventListener("click",D)}),50))}),[l,D,P]),U=(0,d.useCallback)((function(e,n,t){P(Nn({x:e,y:n,z:t}))}),[P]),V=(0,d.useCallback)((function(e){x(e)}),[]),I=(0,d.useCallback)((function(){h(void 0),x(void 0),w(void 0),P(Nn()),r()}),[P,r]);return(0,u.jsx)(Et.Z,{className:"sensor",title:"Sensor",placement:"left",closable:!1,open:n,mask:!1,maskClosable:!1,width:300,extra:(0,u.jsx)(p.Z,{type:"text",icon:(0,u.jsx)(le.Z,{}),onClick:I}),footer:(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,u.jsx)(k.Lw,{onCancel:I}),i?(0,u.jsx)(Li,{simulation:t,sensor:(0,A.Z)((0,z.Z)({},i),{name:m,point:S,formula:g}),onError:w,onClose:I,swr:a}):(0,u.jsx)(Gi,{simulation:t,sensor:{name:m,point:S,formula:g},onError:w,onClose:I,swr:a})]}),children:(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsxs)(_.Z,{size:"small",children:[(0,u.jsx)(v.Z.Text,{children:"Name"}),(0,u.jsx)(be.Z,{value:m,onChange:function(e){return h(e.target.value)}})]}),(0,u.jsx)(_.Z,{size:"small",children:(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsxs)(N.Z,{className:"full-width",style:{justifyContent:"space-between"},children:[(0,u.jsx)(v.Z.Text,{children:"Point selection"}),(0,u.jsx)(f.Z,{title:"Pin in the geometry",children:(0,u.jsx)(p.Z,{size:"small",type:l?"primary":"default",icon:(0,u.jsx)(Ti.Z,{}),onClick:L})})]}),(0,u.jsx)(pt,{label:"X",defaultValue:null===S||void 0===S?void 0:S.x,onValueChange:function(e){return U(+e,null!==(E=null===S||void 0===S?void 0:S.y)&&void 0!==E?E:0,null!==(O=null===S||void 0===S?void 0:S.z)&&void 0!==O?O:0)}}),(0,u.jsx)(pt,{label:"Y",defaultValue:null===S||void 0===S?void 0:S.y,onValueChange:function(e){return U(null!==(M=null===S||void 0===S?void 0:S.x)&&void 0!==M?M:0,+e,null!==(T=null===S||void 0===S?void 0:S.z)&&void 0!==T?T:0)}}),(0,u.jsx)(pt,{label:"Z",defaultValue:null===S||void 0===S?void 0:S.z,onValueChange:function(e){return U(null!==(F=null===S||void 0===S?void 0:S.x)&&void 0!==F?F:0,null!==(R=null===S||void 0===S?void 0:S.y)&&void 0!==R?R:0,+e)}})]})}),(0,u.jsx)(_.Z,{size:"small",className:"no-border-bottom",children:(0,u.jsx)(pt,{label:"Formula",defaultValue:g,onValueChange:V})}),j&&(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)(b.Z,{style:{color:"red"}})," ",j]})]})})},Yi="Unable to update simulation",Ji=function(){var e=(0,i.Z)((function(e,n,t,i){var r,u,l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=nt.Z.deepCopy(e),u=r.scheme.configuration.run,t(Nn()),u.sensors=(0,a.Z)(u.sensors.slice(0,n)).concat((0,a.Z)(u.sensors.slice(n+1))),[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:u}])];case 1:return o.sent(),i.mutateOneSimulation(r),[3,3];case 2:throw l=o.sent(),(0,P.lt)(Yi,l),l;case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),Xi=function(e){var n=e.simulation,t=e.index,r=e.swr,a=(0,d.useState)(),l=a[0],s=a[1],c=(0,d.useContext)(Y).dispatch,f=n.scheme.configuration.run.sensors[t];return(0,u.jsx)(k.m1,{loading:l,text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the sensor"," ",(0,u.jsx)(v.Z.Text,{strong:!0,children:f.name})]}),onDelete:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:s(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Ji(n,t,c,r)];case 2:return e.sent(),[3,4];case 3:return s(!1),[7];case 4:return[2]}}))}))})},qi=function(e){var n,t=e.simulation,i=e.onEdit,r=e.swr,a=(0,d.useState)(!0),o=a[0],l=a[1],s=t.scheme.configuration.run,c=(0,d.useContext)(Y).dispatch,f=(0,d.useCallback)((function(e){c(wn()),c(Nn(e.point))}),[c]),m=(0,d.useCallback)((function(){o&&c(Nn()),c(Cn())}),[o,c]);return(0,u.jsx)(u.Fragment,{children:null===(n=s.sensors)||void 0===n?void 0:n.map((function(e,n){return(0,u.jsx)(_.Z,{className:"sensor-item text-center",hoverable:!0,onMouseEnter:function(){return f(e)},onMouseLeave:m,actions:[(0,u.jsx)(k.w6,{onEdit:function(){l(!1),i((0,A.Z)((0,z.Z)({},e),{index:n})),setTimeout((function(){return l(!0)}),500)}},"edit"),(0,u.jsx)(Xi,{simulation:t,index:n,swr:r},"delete")],children:(0,u.jsx)(v.Z.Text,{strong:!0,className:"text-center",children:e.name})},n)}))})},Ki=function(e){var n=e.simulation,t=e.setVisible,i=e.swr,r=(0,d.useState)(),a=r[0],o=r[1],l=(0,d.useState)(),s=l[0],c=l[1],f=(0,d.useCallback)((function(){c(void 0),t(!1),o(!0)}),[t]),m=(0,d.useCallback)((function(e){c(e),t(!1),o(!0)}),[t]),h=(0,d.useCallback)((function(){c(void 0),t(!0),o(!1)}),[t]);return(0,u.jsxs)(_.Z,{size:"small",title:"Sensors",children:[(0,u.jsx)(Wi,{visible:a,simulation:n,sensor:s,onClose:h,swr:i}),(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(p.Z,{className:"full-width",disabled:!1,type:"primary",icon:(0,u.jsx)(Mi.Z,{}),onClick:f,children:"Add a sensor"}),(0,u.jsx)(qi,{simulation:n,onEdit:m,swr:i})]})]})},Qi=t(139),$i=t(24443),er="Plugins error",nr="Unable to load plugins",tr=function(e){var n=e.disabled,i=e.cloudServer,a=e.onOk,o=(0,d.useState)(!1),l=o[0],f=o[1],m=(0,d.useState)([]),h=m[0],y=m[1],g=(0,c.useRouter)(),x=(0,r.Z)($i.Z.usePlugins(),2),b=x[0],Z=x[1].errorPlugins;return(0,d.useEffect)((function(){Z&&(0,P.lt)(er,Z)}),[Z]),(0,d.useEffect)((function(){tt.Z.list().then((function(e){y(e)})).catch((function(e){(0,P.lt)(nr,e)}))}),[]),(0,u.jsxs)(_.Z,{size:"small",title:"Computational resource",children:[(0,u.jsx)(Xn.Z,{open:l,title:"Computational resource",okButtonProps:{disabled:!0,style:{display:"none"}},onCancel:function(){return f(!1)},style:{width:"unset"},children:(0,u.jsxs)(N.Z,{direction:"vertical",children:[(0,u.jsxs)(v.Z.Text,{children:["Your computational resource does not appear in this list? Create one in your"," ",(0,u.jsx)(k.Qj,{onClick:function(){return g.push({pathname:"/dashboard",query:{page:"account",tab:"hpc"}})},children:"account settings"})]}),(0,u.jsx)(N.Z,{align:"start",direction:"horizontal",wrap:!0,children:null===b||void 0===b?void 0:b.map((function(e){var n=h.find((function(n){return n.key===e.key}));if(n){var i=s()((function(){return t(64546)("./".concat(n.key,"/src/components"))}));return(0,u.jsx)(_.Z,{title:e.configuration.name.value,children:(0,u.jsx)(i,{data:e.data,onSelect:function(n){(0,$n.merge)(e,n),a(e),f(!1)}})},e.uuid)}}))})]})}),(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[i&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Plugin:"})," ",i.name]}),(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Name:"})," ",i.configuration.name.value]}),Object.keys(i.inUseConfiguration).map((function(e){var n=i.inUseConfiguration[e],t=n.value;return"boolean"===typeof t&&(t=t?"yes":"no"),(0,u.jsxs)(v.Z.Text,{children:[(0,u.jsxs)("span",{className:"text-light",children:[n.label,":"]})," ",t]},e)}))]}),(0,u.jsx)(p.Z,{className:"full-width",disabled:n,type:i?"link":"primary",icon:(0,u.jsx)(Qi.Z,{}),onClick:function(){return f(!0)},children:i?"Modify the resource":"Select a resource"})]})]})},ir=t(15360),rr=t(25935),ar=t(48764).lW,or="Unable to get system log",ur=function(){var e=(0,i.Z)((function(e,n){var t,i,r;return(0,o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Q.Z.log({id:e.id},n.systemLog)];case 1:return t=a.sent(),i=ar.from(t.log).toString(),Xn.Z.info({title:"System log",width:"unset",content:(0,u.jsx)("pre",{children:(0,u.jsx)("code",{children:(0,rr.ZP)(i.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))})})}),[3,3];case 2:return r=a.sent(),(0,P.lt)(or,r),[3,3];case 3:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),lr=function(e){var n=e.simulation,t=e.steps,r=(0,d.useState)(!1),a=r[0],l=r[1],s=(0,d.useState)(!1),c=s[0],m=s[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Et.Z,{title:"Log",open:a,onClose:function(){return l(!1)},width:"50%",children:(0,u.jsx)(qn.Z,{items:null===t||void 0===t?void 0:t.map((function(e){var t,r;return{key:e.label,label:e.label,children:(0,u.jsxs)(u.Fragment,{children:[e.systemLog&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(p.Z,{loading:c,onClick:(0,i.Z)((function(){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:m(!0),t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,ur(n,e)];case 2:return t.sent(),[3,5];case 3:return t.sent(),[3,5];case 4:return m(!1),[7];case 5:return[2]}}))})),children:"Complete log"}),(0,u.jsx)("br",{})]}),e.link&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("a",{href:"https://"+e.link.href,target:"_blank",rel:"noreferrer",children:(0,u.jsx)(p.Z,{type:"primary",children:e.link.label})}),(0,u.jsx)("br",{})]}),(0,u.jsxs)(Kt.Z,{ghost:!0,children:[e.warning&&(0,u.jsx)(Kt.Z.Panel,{className:"warning-collapse",header:(0,u.jsx)(v.Z.Text,{type:"warning",children:"Warnings"}),children:(0,rr.ZP)(e.warning.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))},"warnings"),e.error&&(0,u.jsx)(Kt.Z.Panel,{className:"error-collapse",header:(0,u.jsx)(v.Z.Text,{type:"danger",children:"Errors"}),children:(0,rr.ZP)(e.error.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))},"errors")]}),(0,rr.ZP)((null===(t=e.pluginLog)||void 0===t?void 0:t.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))||""),(0,rr.ZP)((null===(r=e.log)||void 0===r?void 0:r.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))||"")]})}}))})}),(0,u.jsx)(f.Z,{title:"Log",children:(0,u.jsx)(p.Z,{disabled:!t||!t.length,icon:(0,u.jsx)(ir.Z,{}),onClick:function(){return l(!0)}})})]})},sr=t(99611),cr=t(23430),dr="Unable to download file",fr=function(){var e=(0,i.Z)((function(e,n){var t,i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,De.download({id:e.id},{originPath:n.originPath,fileName:n.fileName})];case 1:return[4,o.sent().blob()];case 2:return t=o.sent(),i=window.URL.createObjectURL(new Blob([t])),(r=document.createElement("a")).href=i,r.setAttribute("download",n.name+"."+n.fileName.split(".").pop()),r.click(),[3,4];case 3:return a=o.sent(),(0,P.lt)(dr,a),[3,4];case 4:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),mr=function(e){var n=e.simulation,t=e.file,r=(0,d.useState)(!1),a=r[0],l=r[1];return(0,u.jsx)(f.Z,{title:"Download",children:(0,u.jsx)(p.Z,{loading:a,icon:(0,u.jsx)(cr.Z,{}),onClick:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:l(!0),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,fr(n,t)];case 2:return e.sent(),[3,5];case 3:return e.sent(),[3,5];case 4:return l(!1),[7];case 5:return[2]}}))}))})})},hr="Unable to download archive",vr=function(){var e=(0,i.Z)((function(e){var n,t,i,r;return(0,o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,De.archive({id:e.id})];case 1:return[4,a.sent().blob()];case 2:return n=a.sent(),t=window.URL.createObjectURL(new Blob([n])),(i=document.createElement("a")).href=t,i.setAttribute("download",e.scheme.name+".zip"),i.click(),[3,4];case 3:return r=a.sent(),(0,P.lt)(hr,r),[3,4];case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),pr=function(e){var n=e.simulation,t=(0,d.useState)(!1),r=t[0],a=t[1];return(0,u.jsx)(k.o6,{loading:r,onDownload:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:a(!0),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,vr(n)];case 2:return e.sent(),[3,5];case 3:return e.sent(),[3,5];case 4:return a(!1),[7];case 5:return[2]}}))}))})},yr=function(e){var n,t=e.simulation,i=e.result,r=e.setResult,o=(0,d.useState)(),l=o[0],s=o[1],c=(0,d.useState)(),f=c[0],m=c[1],h=(0,d.useState)(),v=h[0],y=h[1],g=null===t||void 0===t||null===(n=t.scheme)||void 0===n?void 0:n.configuration;return(0,d.useEffect)((function(){var e;if(!(null===t||void 0===t?void 0:t.tasks))return s([]),void m(void 0);var n=[],i=null===g||void 0===g||null===(e=g.run)||void 0===e?void 0:e.resultsFilter;t.tasks.forEach((function(e){if(e.file&&n.push(e.file),e.files)if(i){var t,r=new RegExp(i.pattern),o=e.files.filter((function(e){return!r.test(e.fileName)})),u=e.files.filter((function(e){return r.test(e.fileName)})),l=ti(u,i),s=l.map((function(e){return e.number})).filter((function(e,n,t){return t.indexOf(e)===n})).sort((function(e,n){return e-n})),c=ii(g,i),d=s.map((function(e,n){var t=c?e*c:n;return{label:Math.round(1e15*t)/1e15,value:e}}));(t=n).push.apply(t,(0,a.Z)(o)),m({filtered:!0,name:i.name,files:l,options:d})}else{var f;(f=n).push.apply(f,(0,a.Z)(e.files))}})),s(n)}),[t,g]),(0,d.useEffect)((function(){!v&&f&&y(null===f||void 0===f?void 0:f.options[0].value)}),[f,v]),l||f?(null===l||void 0===l?void 0:l.length)||f?(0,u.jsx)(_.Z,{size:"small",title:"Results",extra:(0,u.jsx)(pr,{simulation:t&&{id:t.id,scheme:t.scheme}}),children:(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[null===l||void 0===l?void 0:l.map((function(e){return(0,u.jsxs)(N.Z,{style:{alignItems:"center"},children:[(0,u.jsx)(p.Z,{icon:(null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?(0,u.jsx)(sr.Z,{style:{color:"#fad114"}}):(0,u.jsx)(Qe.Z,{}),onClick:function(){return r((null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?void 0:e)}}),(0,u.jsx)(mr,{simulation:t&&{id:t.id},file:e&&{name:e.name,fileName:e.fileName,originPath:e.originPath}}),e.name]},e.name)})),f&&(0,u.jsxs)(u.Fragment,{children:[f.name,(0,u.jsx)(Jn.Z,{className:"full-width",options:f.options,value:v,onChange:function(e){var n=f.files.find((function(n){return n.number===e&&n.name===(null===i||void 0===i?void 0:i.name)}));r(n),y(e)}}),f.files.map((function(e){if(e.number===v)return(0,u.jsxs)(N.Z,{style:{alignItems:"center"},children:[(0,u.jsx)(p.Z,{icon:(null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?(0,u.jsx)(sr.Z,{style:{color:"#fad114"}}):(0,u.jsx)(Qe.Z,{}),onClick:function(){return r((null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?void 0:e)}}),(0,u.jsx)(mr,{simulation:t&&{id:t.id},file:e&&{name:e.name,fileName:e.fileName,originPath:e.originPath}}),e.name]},e.name)}))]})]})}):(0,u.jsx)(_.Z,{size:"small",children:"No results yet"}):(0,u.jsx)(Ie.Z,{})},gr="Unable to run simulation",xr="Unable to stop simulation",br="Unable to update simulation",Zr=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=nt.Z.deepCopy(e),(r=e.scheme.configuration).run.cloudServer=n,i.scheme.configuration=r,[4,Q.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:r.run}])];case 1:return o.sent(),t.mutateOneSimulation(i),t.mutateSimulation(i),[3,3];case 2:return a=o.sent(),(0,P.lt)(br,a),[3,3];case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),jr=function(){var e=(0,i.Z)((function(e){var n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Q.Z.run({id:e.id})];case 1:return t.sent(),[3,3];case 2:throw n=t.sent(),(0,P.lt)(gr,n),n;case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),wr=function(){var e=(0,i.Z)((function(e){var n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Q.Z.stop({id:e.id})];case 1:return t.sent(),[3,3];case 2:throw n=t.sent(),(0,P.lt)(xr,n),n;case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Cr=function(e){var n,t,a=e.simulation,l=e.result,s=e.setResult,c=e.setVisible,f=e.swr,h=(0,d.useState)(!1),v=h[0],y=h[1],g=(0,d.useState)(!1),x=g[0],b=g[1],Z=(0,d.useState)([]),j=Z[0],w=Z[1],C=(0,r.Z)(Q.Z.useSimulation(a.id,2e3),2),S=C[0],k=C[1].mutateSimulation,P=a.scheme.configuration,E=null===S||void 0===S||null===(n=S.scheme)||void 0===n?void 0:n.configuration;return(0,d.useEffect)((function(){if(P){var e=!0;Object.keys(P).forEach((function(n){"dimension"!==n&&"run"!==n&&(P[n].done||(e=!1))})),P.run.cloudServer||(e=!1),y(!e)}else y(!0)}),[P]),(0,d.useEffect)((function(){var e,n;(null===S||void 0===S||null===(e=S.tasks)||void 0===e?void 0:e.find((function(e){return"error"===(null===e||void 0===e?void 0:e.status)})))?b(!1):(null===S||void 0===S||null===(n=S.tasks)||void 0===n?void 0:n.find((function(e){return e&&"finish"!==e.status})))?b(!0):b(!1)}),[null===S||void 0===S?void 0:S.tasks]),(0,d.useEffect)((function(){var e,n=[];null===S||void 0===S||null===(e=S.tasks)||void 0===e||e.forEach((function(e){e&&(n[e.index]={index:e.index,label:e.label,status:e.status,log:e.log,pluginLog:e.pluginLog,warning:e.warning,error:e.error,systemLog:e.systemLog,link:e.link})})),w(n)}),[null===S||void 0===S?void 0:S.tasks]),a&&S&&"0"!==(null===S||void 0===S?void 0:S.id)?(0,u.jsx)(m.Z,{children:(0,u.jsx)(m.Z.Content,{children:(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(Ki,{simulation:a,setVisible:c,swr:{mutateOneSimulation:f.mutateOneSimulation}}),(0,u.jsx)(tr,{disabled:x,cloudServer:null===E||void 0===E||null===(t=E.run)||void 0===t?void 0:t.cloudServer,onOk:function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){return[2,Zr(a,e,(0,A.Z)((0,z.Z)({},f),{mutateSimulation:k}))]}))}));return function(n){return e.apply(this,arguments)}}()}),(0,u.jsx)(_.Z,{size:"small",title:"Run",children:(0,u.jsxs)(N.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,u.jsxs)("div",{className:"full-width",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsxs)(N.Z,{children:[(0,u.jsx)(p.Z,{disabled:v,type:"primary",icon:(0,u.jsx)(Oi.Z,{}),loading:x,onClick:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:b(!0),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,jr(a)];case 2:return e.sent(),[3,4];case 3:return e.sent(),b(!1),[3,4];case 4:return[2]}}))})),children:"Run"}),(0,u.jsx)(p.Z,{disabled:!x,danger:!0,icon:(0,u.jsx)(Ke.Z,{}),shape:"circle",onClick:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,wr(a)];case 1:return e.sent(),b(!1),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}}))}))})]}),(0,u.jsx)(lr,{simulation:{id:a.id},steps:j})]}),(0,u.jsx)(Ni.Z,{direction:"vertical",children:j.map((function(e,n){return(0,u.jsx)(Ni.Z.Step,{title:e.label,description:"("+(n+1)+"/"+j.length+")",status:e.status},e.label)}))})]})}),(0,u.jsx)(yr,{simulation:S&&{id:S.id,scheme:S.scheme,tasks:S.tasks},result:l&&{name:l.name,fileName:l.fileName},setResult:s})]})})}):(0,u.jsx)(m.Z,{children:(0,u.jsx)(m.Z.Content,{children:(0,u.jsx)(_.Z,{size:"small",children:(0,u.jsx)(Ie.Z,{})})})})},Sr=t(1402),kr=[{key:"warpByVector",label:"Warp by vector",parameters:[{key:"Vectors",label:"Vectors",rules:[{required:!0,message:"Vectors is required"}]},{key:"ScaleFactor",label:"Scale factor",default:"1",rules:[{required:!0,message:"Scale factor is required"}]}]},{key:"contour",label:"Contour",parameters:[{key:"ContourBy",label:"Contour by",rules:[{required:!0,message:"ContourBy by is required"}]},{key:"isosurface",label:"Isosurface",default:"0",rules:[{required:!0,message:"Isosurface is required"}]}]},{key:"streamTracer",label:"Stream tracer",parameters:[{key:"Vectors",label:"Vectors",rules:[{required:!0,message:"Vectors is required"}]}]}],Pr=function(){var e=(0,i.Z)((function(e,n,t,i){return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,ee.R)("/api/postprocessing",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({simulation:e,result:n,filter:t,parameters:i})})];case 1:return[2,r.sent().json()]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),Er={run:Pr},_r="Unable to run filter",Nr=function(){var e=(0,i.Z)((function(e,n,t,i){var r;return(0,o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Er.run(e,n,t,i)];case 1:return[2,a.sent()];case 2:return r=a.sent(),(0,P.lt)(_r,r),[3,3];case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),Or=function(e){var n=e.simulation,t=e.result,r=e.postprocessing,a=e.setResult,l=(0,d.useState)(),s=l[0],c=l[1],h=(0,d.useState)(),v=h[0],y=h[1],g=(0,d.useState)(),x=g[0],b=g[1],Z=(0,d.useState)(),j=Z[0],w=Z[1];if((0,d.useEffect)((function(){!t&&s&&c(!1)}),[t,s]),(0,d.useEffect)((function(){n||(y(void 0),w(void 0))}),[n,t]),!n||!t)return null;var C=n.scheme.configuration.run.postprocessing;if(!C)return null;var S=kr.map((function(e){if(C.find((function(n){return n.key===e.key})))return{label:e.label,value:e.key}})).filter((function(e){return e}));if(!S.length)return null;var k=null;if(v){var P=kr.find((function(e){return e.key===v})),E=C.find((function(e){return e.key===v}));(null===P||void 0===P?void 0:P.parameters)&&(k=P.parameters.map((function(e,n){var t,i=null===E||void 0===E||null===(t=E.parameters)||void 0===t?void 0:t.find((function(n){return n.key===e.key}));return(null===i||void 0===i?void 0:i.value)?(0,u.jsx)(xe.Z.Item,{label:e.label,name:["parameters",n],initialValue:i.value,rules:e.rules,children:(0,u.jsx)(be.Z,{disabled:!0})},e.key):(null===i||void 0===i?void 0:i.options)?(0,u.jsx)(xe.Z.Item,{label:e.label,name:["parameters",n],rules:e.rules,children:(0,u.jsx)(Jn.Z,{options:i.options.map((function(e){return{label:e,value:e}}))})},e.key):(0,u.jsx)(xe.Z.Item,{label:e.label,name:["parameters",n],rules:e.rules,initialValue:e.default,children:(0,u.jsx)(be.Z,{})},e.key)})))}return(0,u.jsx)(m.Z,{style:{position:"absolute",zIndex:101,right:25,bottom:50,backgroundColor:"rgba(255, 255, 255, 0)"},children:(0,u.jsxs)(m.Z.Content,{children:[(0,u.jsx)(f.Z,{title:"Post-processing",children:(0,u.jsx)(p.Z,{type:"primary",icon:(0,u.jsx)(Sr.Z,{}),onClick:function(){return c(!0)},style:{width:40,height:40,border:"1px solid #5E14FA",borderRadius:20,marginBottom:-20}})}),(0,u.jsxs)(Et.Z,{title:"Post-processing",closable:!0,onClose:function(){return c(!1)},open:s,mask:!1,maskClosable:!1,children:[(0,u.jsx)(xe.Z,{style:{margin:"24px 0"},children:(0,u.jsx)(xe.Z.Item,{name:"filter",label:"Filter",children:(0,u.jsx)(Jn.Z,{placeholder:"Select a filter",options:S,onChange:y})})}),(0,u.jsxs)(xe.Z,{layout:"vertical",style:{margin:"24px 0"},onFinish:function(){var e=(0,i.Z)((function(e){var i;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:b(!0),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Nr({id:n.id},t,v,e.parameters||[])];case 2:return i=r.sent(),w(i),[3,4];case 3:return r.sent(),[3,4];case 4:return b(!1),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:[k,(0,u.jsx)(xe.Z.Item,{children:(0,u.jsx)(p.Z,{type:"primary",loading:x,htmlType:"submit",icon:(0,u.jsx)(Oi.Z,{}),children:"Run"})})]}),j&&(0,u.jsx)(_.Z,{size:"small",title:"Post-processing",extra:v,children:(0,u.jsx)(N.Z,{direction:"vertical",className:"full-width",children:j.length?j.map((function(e){return(0,u.jsxs)(N.Z,{children:[(0,u.jsx)(p.Z,{icon:(null===r||void 0===r?void 0:r.fileName)===e.fileName&&(null===r||void 0===r?void 0:r.name)===e.name?(0,u.jsx)(sr.Z,{style:{color:"#fad114"}}):(0,u.jsx)(Qe.Z,{}),onClick:function(){return a((null===r||void 0===r?void 0:r.fileName)===e.fileName&&(null===r||void 0===r?void 0:r.name)===e.name?void 0:(0,z.Z)({type:"postprocessing"},e))}}),(0,u.jsx)(mr,{simulation:{id:n.id},file:{name:e.name,fileName:e.fileName,originPath:e.originPath}}),e.name]},e.glb)})):"No results"})})]})]})})},Mr="Unable to load plugins",Tr="Unable to update simulation",zr=function(e,n){tt.Z.list().then((function(t){var i=Ar(e,et.Z,t);n(i)})).catch((function(e){(0,P.lt)(Mr,e)}))},Ar=function(e,n,t){var i=n;return t.forEach((function(n){var t;(null===e||void 0===e||null===(t=e.authorizedplugins)||void 0===t?void 0:t.includes(n.key))&&"Model"===n.category&&(i=(0,a.Z)(i).concat((0,a.Z)(n.models)))})),i},Fr=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=n.find((function(n){var t;return n.algorithm===(null===e||void 0===e||null===(t=e.scheme)||void 0===t?void 0:t.algorithm)})),r=nt.Z.deepCopy(e),(0,$n.merge)(r.scheme,i),[4,Q.Z.update({id:e.id},[{key:"scheme",value:r.scheme}])];case 1:return o.sent(),t.mutateOneSimulation(r),[3,3];case 2:return a=o.sent(),(0,P.lt)(Tr,a),[3,3];case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Rr={Selector:function(e){var n=e.visible,t=e.user,r=e.onOk,a=e.onCancel,l=(0,d.useState)(),s=l[0],c=l[1],f=(0,d.useState)(!1),v=f[0],p=f[1],y=(0,d.useState)([]),g=y[0],x=y[1],b=(0,d.useState)(),Z=b[0],j=b[1],w=(0,d.useState)(),C=w[0],S=w[1];(0,d.useEffect)((function(){t&&zr(t,x)}),[t]),(0,d.useEffect)((function(){var e=g.map((function(e){return e.category})).filter((function(e,n,t){return t.indexOf(e)===n})).map((function(e){return{key:e,value:e}}));j(e)}),[g]);var k=(0,d.useCallback)((function(e){var n=e.key,t=g.find((function(e){return e.algorithm===n}));c(nt.Z.deepCopy(t))}),[g]),P=(0,d.useCallback)((function(e){var n=e.key,i=t.models.find((function(e){return e.algorithm===n}));c(nt.Z.deepCopy(i))}),[t]),E=[{key:"category",disabled:!0,label:(0,u.jsx)(Jn.Z,{className:"full-width",options:Z,allowClear:!0,showArrow:!1,placeholder:"Category filter",onChange:function(e){return S(e)}})}];g.forEach((function(e){C&&e.category!==C||E.push({key:e.algorithm,label:e.name})}));var _=[{key:"category",disabled:!0,label:(0,u.jsx)(Jn.Z,{className:"full-width",options:Z,allowClear:!0,showArrow:!1,placeholder:"Category filter",onChange:function(e){return S(e)}})}];return t&&t.models.forEach((function(e){C&&e.category!==C||_.push({key:e.algorithm,label:e.name})})),(0,u.jsx)(Xn.Z,{open:n,title:"Create simulation",okText:"Create",okButtonProps:{loading:v},onOk:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:if(p(!0),!s)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,r(s)];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return p(!1),[2]}}))})),onCancel:function(){return a()},width:"80%",children:(0,u.jsxs)(m.Z,{children:[(0,u.jsx)(m.Z.Sider,{theme:"light",width:300,children:(0,u.jsx)(qn.Z,{items:[{key:"tanatloc",label:"Tanatloc algorithm",children:(0,u.jsx)(h.Z,{mode:"inline",items:E,onSelect:k})},{key:"personal",label:"User algorithm",children:(0,u.jsx)(h.Z,{mode:"inline",items:_,onSelect:P})}]})}),(0,u.jsx)(m.Z.Content,{className:"simulation-selector",children:(0,u.jsx)(ce.Z.Html,{html:null===s||void 0===s?void 0:s.description})})]})})},Updater:function(e){var n=e.user,t=e.simulation,i=e.swr,r=(0,d.useState)([]),a=r[0],o=r[1];return(0,d.useEffect)((function(){n&&zr(n,o)}),[n]),(0,d.useEffect)((function(){var e=a.find((function(e){var n;return e.algorithm===(null===t||void 0===t||null===(n=t.scheme)||void 0===n?void 0:n.algorithm)}));if(e&&(null===t||void 0===t?void 0:t.scheme)){var n=(0,Kn.Z)(t.scheme,e),r=(0,Qn.Z)(t.scheme,e);(Object.keys(n).length||Object.keys(r).length)&&(Xn.Z.info({title:"Update",content:"Your model need an update, please wait.",closable:!1,okButtonProps:{hidden:!0}}),Fr(t,a,i).finally((function(){return Xn.Z.destroyAll()})))}}),[t,a,i]),null},About:ht,Geometry:wt,Materials:qt,Parameters:ni,Initialization:ci,BoundaryConditions:_i,Run:Cr,Postprocessing:Or},Dr=Rr,Lr=s()((function(){return Promise.all([t.e(5027),t.e(2073),t.e(5706)]).then(t.bind(t,45706))}),{loadableGenerated:{webpack:function(){return[45706]}},ssr:!1}),Ur={label:"GEOMETRIES",key:"geometries"},Vr={label:"SIMULATIONS",key:"simulations"},Ir="Unable to get user",Br="Unable to get project",Hr="Unable to get simulations",Gr="Unable to get geometries",Wr="Unable to add simulation",Yr=function(){var e=(0,i.Z)((function(e,n,t){var i,r;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,Q.Z.add({id:e.id},{name:n.name,scheme:n})];case 1:return i=o.sent(),t.addOneSimulation(i),t.mutateProject({id:e.id,simulations:(0,a.Z)(e.simulations||[]).concat([i.id])}),[3,3];case 2:throw r=o.sent(),(0,P.lt)(Wr,r),r;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Jr=function(){var e=(0,c.useRouter)(),n=e.query,t=n.page,l=n.workspaceId,s=n.projectId,_=(0,d.useState)(!1),N=_[0],O=_[1],M=(0,d.useState)(),z=M[0],A=M[1],F=(0,d.useState)(!1),R=F[0],D=F[1],L=(0,d.useState)(),U=L[0],V=L[1],I=(0,d.useState)(),B=I[0],H=I[1],G=(0,d.useState)(),W=G[0],Y=G[1],J=(0,d.useState)(),$=J[0],ee=J[1],ne=(0,d.useState)(),te=ne[0],ie=ne[1],re=(0,d.useState)(!0),ae=re[0],oe=re[1],le=(0,r.Z)(q.Z.useUser(),2),ce=le[0],de=le[1],fe=de.errorUser,me=de.loadingUser,he=(0,r.Z)(K.Z.useProject(s),2),ve=he[0],pe=he[1],ye=pe.mutateProject,ge=pe.errorProject,xe=pe.loadingProject,be=(0,r.Z)(Q.Z.useSimulations(null===ve||void 0===ve?void 0:ve.simulations),2),Ze=be[0],je=be[1],we=je.addOneSimulation,Ce=je.delOneSimulation,Se=je.mutateOneSimulation,ke=je.errorSimulations,Pe=je.loadingSimulations,Ee=(0,r.Z)(ue.useGeometries(null===ve||void 0===ve?void 0:ve.geometries),2),_e=Ee[0],Ne=Ee[1],Oe=Ne.addOneGeometry,Me=Ne.delOneGeometry,ze=Ne.mutateOneGeometry,Ae=Ne.errorGeometries,Fe=Ne.loadingGeometries,Re=(0,d.useCallback)((function(){ie(void 0),ee(void 0)}),[]);(0,d.useEffect)((function(){me||ce||e.replace("/login")}),[ce,me,e]),(0,d.useEffect)((function(){fe&&(0,P.lt)(Ir,fe),ge&&(0,P.lt)(Br,ge),ke&&(0,P.lt)(Hr,ke),Ae&&(0,P.lt)(Gr,Ae)}),[fe,ge,ke,Ae]),(0,d.useEffect)((function(){xe||Fe||_e.length?O(!1):O(!0)}),[xe,Fe,_e]),(0,d.useEffect)((function(){if(!Fe&&z){var e=_e.find((function(e){return e.id===(null===z||void 0===z?void 0:z.id)}));e?JSON.stringify(e)!==JSON.stringify(z)&&A(e):A(void 0)}else A(_e[0])}),[_e,z,Fe,A]),(0,d.useEffect)((function(){if(!Pe&&U){var e=Ze.find((function(e){return e.id===(null===U||void 0===U?void 0:U.id)}));e?JSON.stringify(e)!==JSON.stringify(U)&&V(e):(Re(),V(void 0))}}),[Ze,U,Pe,V,Re]);var De=(0,d.useCallback)((function(){A({id:"0",needCleanup:!0})}),[]),Le=(0,d.useCallback)((function(e){var n=_e.find((function(n){return n.id===e}));n&&(A(n),ie((0,u.jsx)(se,{visible:!0,title:"Geometry",onClose:Re,children:(0,u.jsx)(Te,{project:{id:ve.id,geometries:ve.geometries},geometry:{id:n.id,name:n.name,summary:n.summary},swr:{mutateProject:ye,mutateOneGeometry:ze,delOneGeometry:Me},close:Re,onCleanup:De})})))}),[ve,_e,ye,ze,Me,De,Re]),Ue=(0,d.useCallback)((function(e){ie((0,u.jsx)(se,{visible:!0,title:"About",onClose:Re,children:(0,u.jsx)(Dr.About,{project:{id:ve.id,simulations:ve.simulations},simulation:{id:e.id,name:e.name,scheme:e.scheme},swr:{mutateProject:ye,addOneSimulation:we,delOneSimulation:Ce,mutateOneSimulation:Se}})}))}),[ve,ye,we,Ce,Se,Re]),Ve=(0,d.useCallback)((function(e){ie((0,u.jsx)(se,{visible:!0,title:"Geometry",onClose:Re,children:(0,u.jsx)(Dr.Geometry,{geometries:_e,geometry:z&&{id:z.id,summary:z.summary},simulation:{id:e.id,scheme:e.scheme},setGeometry:A,swr:{mutateOneSimulation:Se}})}))}),[_e,z,Se,Re]),Ie=(0,d.useCallback)((function(e){ie((0,u.jsx)(se,{visible:!0,title:"Parameters",onClose:Re,children:(0,u.jsx)(Dr.Parameters,{simulation:{id:e.id,scheme:e.scheme},swr:{mutateOneSimulation:Se}})}))}),[Se,Re]),Be=(0,d.useCallback)((function(e){ie((0,u.jsx)(se,{visible:ae,title:"Materials",onClose:Re,children:(0,u.jsx)(Dr.Materials,{geometry:z&&{id:z.id,summary:z.summary},simulation:{id:e.id,scheme:e.scheme},swr:{mutateOneSimulation:Se},setVisible:function(e){return oe(e)}})}))}),[z,ae,Se,Re]),He=(0,d.useCallback)((function(e){ie((0,u.jsx)(se,{visible:!0,title:"Initialization",onClose:Re,children:(0,u.jsx)(Dr.Initialization,{simulations:Ze,simulation:e,swr:{mutateOneSimulation:Se}})}))}),[Ze,Se,Re]),Ge=(0,d.useCallback)((function(e){ie((0,u.jsx)(se,{visible:ae,title:"Boundary conditions",onClose:Re,children:(0,u.jsx)(Dr.BoundaryConditions,{geometry:z&&{id:z.id,summary:z.summary},simulation:{id:e.id,scheme:e.scheme},swr:{mutateOneSimulation:Se},setVisible:function(e){return oe(e)}})}))}),[z,ae,Se,Re]),We=(0,d.useCallback)((function(e){ie((0,u.jsx)(se,{visible:ae,title:"Run",onClose:Re,children:(0,u.jsx)(Dr.Run,{simulation:{id:e.id,scheme:e.scheme},result:B&&{name:B.name,fileName:B.fileName},setResult:H,setVisible:function(e){return oe(e)},swr:{mutateOneSimulation:Se}})}))}),[B,ae,Se,Re]),Ye=(0,d.useCallback)((function(e,n){var t,i,r,a=Ze.find((function(n){return n.id===e}));if(a){V(a);var o=null===(t=a.scheme)||void 0===t||null===(i=t.configuration)||void 0===i||null===(r=i.geometry)||void 0===r?void 0:r.value;if(o&&(null===z||void 0===z?void 0:z.id)!==o){var u=_e.find((function(e){return e.id===o}));u&&A(u)}switch(n){case"about":Ue(a);break;case"geometry":Ve(a);break;case"parameters":Ie(a);break;case"materials":Be(a);break;case"initialization":He(a);break;case"boundaryConditions":Ge(a);break;case"run":We(a);break;default:ie(void 0)}}}),[z,_e,Ze,Ue,Ve,Ie,Be,He,Ge,We]);(0,d.useEffect)((function(){$&&($.key===Ur.key?Le($.id):(Ye($.id,$.item),"run"!==$.item&&(H(void 0),Y(void 0))))}),[$,Le,Ye,Re]),(0,d.useEffect)((function(){!B&&W&&Y(void 0)}),[B,W]);var Je=(0,d.useCallback)((function(e){var n,t=e.keyPath,i=t.pop(),r=t.pop(),a=t.pop();a&&(n=a.split("&").pop()),ee({key:i,id:r,item:n})}),[]),Xe=_e.map((function(e){return{key:e.id,icon:(0,u.jsx)(y.Z,{}),label:e.name}})),qe=Ze.map((function(e){var n=e.scheme.configuration||{},t=[];Object.keys(n).forEach((function(i){if("dimension"!==i){var r=n[i],a=(0,u.jsx)(g.Z,{style:{color:"green"}});r.error&&(a=(0,u.jsx)(x.Z,{style:{color:"red"}})),r.done||(a=(0,u.jsx)(b.Z,{style:{color:"orange"}})),"geometry"!==i||_e.filter((function(e){return e.id===r.value})).length||Fe||(a=(0,u.jsx)(b.Z,{style:{color:"orange"}}),r.done=null),t[r.index]={key:e.id+"&"+i,className:"Project-Menu-SubMenu-Simulations-SubMenu-MenuItem",disabled:!_e.length,icon:a,label:r.title}}}));var i=e.name;return e.scheme.user&&(i=(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(f.Z,{title:"User algorithm",placement:"right",children:(0,u.jsx)(Z.Z,{style:{position:"absolute",top:0,left:14,fontSize:14,color:"#fad114"}})}),e.name]})),{key:e.id,className:"Project-Menu-SubMenu-Simulations-SubMenu",icon:(0,u.jsx)(j.Z,{}),label:i,children:[{key:e.id+"&about",className:"Project-Menu-SubMenu-Simulations-SubMenu-MenuItem",disabled:!_e.length,icon:(0,u.jsx)(g.Z,{style:{color:"green"}}),label:"About"}].concat((0,a.Z)(t))}}));return!ce||me||xe?(0,u.jsx)(E.Z.Simple,{}):"0"===ve.id?(0,u.jsx)(T,{}):(0,u.jsx)(X,{children:(0,u.jsxs)(m.Z,{hasSider:!0,children:[(0,u.jsxs)(m.Z.Sider,{theme:"light",className:"Project-Sider",width:256,children:[(0,u.jsx)("div",{className:"logo",children:(0,u.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,u.jsx)(h.Z,{mode:"inline",items:[{key:"menu-go-back",disabled:!0,className:"Project-Menu-GoBack",style:{cursor:"unset",margin:"10px 0",paddingLeft:10},label:(0,u.jsx)(k.ks,{onClick:function(){return function(e,n,t){e.push({pathname:"/dashboard",query:{page:n,workspaceId:t}})}(e,t,l)},children:"Return to dashboard"})},{type:"divider",className:"Project-Menu-Divider"},{key:"title",disabled:!0,className:"Project-Menu-Title",label:(0,u.jsx)(v.Z.Paragraph,{ellipsis:{tooltip:!0,rows:1},children:ve.title})}]}),(0,u.jsx)("div",{className:"Project-Menu-scroll",children:(0,u.jsx)(h.Z,{className:"Project-Menu",mode:"inline",defaultOpenKeys:[Ur.key,Vr.key],items:[{key:Ur.key,className:"Project-Menu-SubMenu-Geometries",icon:Fe?(0,u.jsx)(w.Z,{}):(0,u.jsx)(y.Z,{}),label:(0,u.jsxs)(v.Z.Text,{strong:!0,children:[Ur.label," (",_e.length,")"]}),children:[{key:"new_geometry",className:"Project-Menu-SubMenu-Geometries-New",disabled:!0,label:(0,u.jsx)(p.Z,{icon:(0,u.jsx)(C.Z,{}),onClick:function(){return O(!0)},children:"New Geometry"})},{key:"geometry-needed",className:"text-dark "+(_e.length?"display-none":""),disabled:!0,icon:(0,u.jsx)(b.Z,{style:{color:"red"}}),label:"A Geometry is needed"}].concat((0,a.Z)(Xe))},{key:Vr.key,className:"Project-Menu-SubMenu-Simulations",icon:Pe?(0,u.jsx)(w.Z,{}):(0,u.jsx)(j.Z,{}),label:(0,u.jsxs)(v.Z.Text,{strong:!0,children:[Vr.label," (",Ze.length,")"]}),children:[{key:"new_simulation",className:"Project-Menu-SubMenu-Simulations-New",disabled:!0,label:(0,u.jsx)(p.Z,{disabled:!_e.length,icon:(0,u.jsx)(S.Z,{}),onClick:function(){return D(!0)},children:"New Simulation"})}].concat((0,a.Z)(qe))}],onClick:Je})})]}),(0,u.jsxs)(m.Z.Content,{className:"no-scroll relative",children:[(0,u.jsx)(Te.Add,{visible:N,project:{id:ve.id,geometries:ve.geometries},swr:{mutateProject:ye,addOneGeometry:Oe},setVisible:function(e){return O(e)}}),(0,u.jsx)(Dr.Selector,{user:{authorizedplugins:ce.authorizedplugins,models:ce.models},visible:R,onOk:function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Yr(ve,e,{addOneSimulation:we,mutateProject:ye})];case 1:return n.sent(),D(!1),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),onCancel:function(){return D(!1)}}),(0,u.jsx)(Dr.Updater,{user:{authorizedplugins:ce.authorizedplugins},simulation:U&&{id:U.id,scheme:U.scheme},swr:{mutateOneSimulation:Se}}),te,(0,u.jsx)(Yn,{project:{id:ve.id,title:ve.title},simulation:U&&{id:U.id},geometry:z&&{id:z.id,needCleanup:z.needCleanup},result:B&&{glb:B.glb,originPath:B.originPath},postprocessing:W&&{glb:W.glb,originPath:W.originPath}}),(0,u.jsx)(Lr,{simulation:U&&{id:U.id,name:U.name}}),(0,u.jsx)(Dr.Postprocessing,{simulation:U&&{id:U.id,scheme:U.scheme},result:B&&{name:B.name,fileName:B.fileName,originPath:B.originPath},postprocessing:W&&{name:W.name,fileName:W.fileName},setResult:Y})]})]})})}},64546:function(e,n,t){var i={"./local/src/components":[17697,7697]};function r(e){if(!t.o(i,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=i[e],r=n[0];return t.e(n[1]).then((function(){return t(r)}))}r.keys=function(){return Object.keys(i)},r.id=64546,e.exports=r}}]);