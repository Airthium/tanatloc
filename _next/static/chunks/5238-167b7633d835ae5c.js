(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5238],{41686:function(e,n,t){"use strict";t.d(n,{Z:function(){return u}});var i=t(47568),r=t(20414),a=t(87492),o=function(){var e=(0,i.Z)((function(e,n){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,a.R)("/api/avatar",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({file:e,project:n})})];case 1:return[2,t.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),u={add:o}},24443:function(e,n,t){"use strict";t.d(n,{Z:function(){return m}});var i=t(47568),r=t(20414),a=t(87492),o=function(){var e=(0,i.Z)((function(e){return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,a.R)("/api/plugin",{method:"POST",body:JSON.stringify(e)})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),u=function(){var e=(0,i.Z)((function(e){return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,a.R)("/api/plugin",{method:"PUT",body:JSON.stringify(e)})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),l=function(){var e=(0,i.Z)((function(e){return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,a.R)("/api/plugin",{method:"DELETE",body:JSON.stringify(e)})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),s=t(26042),c=t(29815),d=t(8100),f=t(67294),m={add:o,update:u,del:l,usePlugins:function(){var e=(0,d.ZP)("/api/plugin",a._),n=e.data,t=e.error,i=e.mutate,r=!n,o=(null===n||void 0===n?void 0:n.plugins)||[],u=(0,f.useCallback)((function(e){var n=(0,c.Z)(o).concat([e]);i({plugins:n})}),[o,i]),l=(0,f.useCallback)((function(e){var n=o.filter((function(n){return n.key!==e.key}));i({plugins:n})}),[o,i]),m=(0,f.useCallback)((function(e){var n=o.map((function(n){return n.key===e.key&&(n=(0,s.Z)({},n,e)),n}));i({plugins:n})}),[o,i]);return[o,{mutatePlugins:i,addOnePlugin:u,delOnePlugin:l,mutateOnePlugin:m,errorPlugins:t,loadingPlugins:r}]}}},4687:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var i=t(47568),r=t(20414),a=t(87492),o=function(){var e=(0,i.Z)((function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,a.R)("/api/plugins",{method:"GET",headers:{Accept:"application/json"}})];case 1:return[2,e.sent().json()]}}))}));return function(){return e.apply(this,arguments)}}(),u=function(){var e=(0,i.Z)((function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,a.R)("/api/plugins",{method:"POST",headers:{Accept:"application/json"}})];case 1:return[2,e.sent().json()]}}))}));return function(){return e.apply(this,arguments)}}(),l={list:o,completeList:u}},94370:function(e,n,t){"use strict";t.d(n,{Z:function(){return g}});var i=t(26042),r=t(69396),a=t(29815),o=t(8100),u=t(67294),l=t(87492),s=t(47568),c=t(20414),d=function(){var e=(0,s.Z)((function(e,n){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,l.R)("/api/project",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({workspace:{id:e.id},project:n})})];case 1:return[2,t.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),f=function(){var e=(0,s.Z)((function(e,n){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,l.R)("/api/project/"+e.id,{method:"PUT",body:JSON.stringify(n)})];case 1:return t.sent(),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),m=function(){var e=(0,s.Z)((function(e,n){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,l.R)("/api/project/"+n.id,{method:"DELETE",body:JSON.stringify({id:e.id})})];case 1:return t.sent(),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),h=function(){var e=(0,s.Z)((function(e){return(0,c.__generator)(this,(function(n){return[2,(0,l.R)("/api/project/"+e.id+"/archive",{method:"GET",headers:{Accept:"application/json"}})]}))}));return function(n){return e.apply(this,arguments)}}(),v=function(){var e=(0,s.Z)((function(e){return(0,c.__generator)(this,(function(n){return[2,(0,l.R)("/api/project/"+e.id+"/archive",{method:"PUT"})]}))}));return function(n){return e.apply(this,arguments)}}(),p=function(){var e=(0,s.Z)((function(e){return(0,c.__generator)(this,(function(n){return[2,(0,l.R)("/api/project/"+e.id+"/archive",{method:"DELETE"})]}))}));return function(n){return e.apply(this,arguments)}}(),y=function(){var e=(0,s.Z)((function(e,n){return(0,c.__generator)(this,(function(t){return[2,(0,l.R)("/api/project/"+e.id+"/archive",{method:"POST",body:JSON.stringify({archive:n})})]}))}));return function(n,t){return e.apply(this,arguments)}}(),x={useProjects:function(e){var n=(0,o.ZP)(["/api/projects",JSON.stringify({ids:e})],l._),t=n.data,s=n.error,c=n.mutate,d=!t,f=(null===t||void 0===t?void 0:t.projects)||[],m=(0,u.useCallback)((function(e){var n=(0,a.Z)(f).concat([(0,r.Z)((0,i.Z)({},e),{users:[],geometries:[],simulations:[],groups:[]})]);c({projects:n})}),[f,c]),h=(0,u.useCallback)((function(e){var n=f.filter((function(n){return n.id!==e.id}));c({projects:n})}),[f,c]),v=(0,u.useCallback)((function(e){var n=f.map((function(n){return n.id===e.id&&(n=(0,i.Z)({},n,e)),n}));c({projects:n})}),[f,c]);return[f,{addOneProject:m,delOneProject:h,mutateOneProject:v,errorProjects:s,loadingProjects:d}]},useProject:function(e){var n=(0,o.ZP)("/api/project"+(e?"/"+e:""),l._),t=n.data,r=n.error,a=n.mutate,s=!t,c=(null===t||void 0===t?void 0:t.project)||{id:"0"},d=(0,u.useCallback)((function(e){var n=(0,i.Z)({},c,e);a({project:n})}),[c,a]);return[c,{mutateProject:d,errorProject:r,loadingProject:s}]},add:d,update:f,del:m,archive:h,unarchiveFromServer:v,deleteArchiveFile:p,unarchiveFromFile:y},g=x},65238:function(e,n,t){"use strict";t.d(n,{ZP:function(){return ha}});var i=t(47568),r=t(828),a=t(29815),o=t(20414),u=t(85893),l=t(11163),s=t(67294),c=t(84908),d=t(97183),f=t(66516),m=t(6880),h=t(71577),v=t(48869),p=t(8751),y=t(18429),x=t(11475),g=t(73480),b=t(22844),j=t(50888),Z=t(88484),w=t(64789),C=t(41641),S=t(96844),k=t(75107),E=t(81474),P=t(26713),_=t(20280),N="You are not allowed to be here.",O=function(){var e=(0,l.useRouter)();return(0,s.useEffect)((function(){e.prefetch("/")}),[e]),(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsx)(E.Z,{title:"Not allowed",children:(0,u.jsxs)(P.Z,{direction:"vertical",children:[(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)(_.Z,{style:{color:"red"}})," ",N]}),(0,u.jsxs)(m.Z.Text,{children:["Go back"," ",(0,u.jsx)(h.Z,{type:"link",onClick:function(){return function(e){e.push("/")}(e)},children:"home"})]})]})})})})},M=t(26042),T=t(69396),z={enabled:!1,type:void 0,part:void 0,highlighted:void 0,selected:[],point:void 0,dispatch:function(){}},A="ENABLE",R="DISABLE",D="CLEAR",F="SETTYPE",L="SETPART",U="HIGHLIGHT",V="UNHIGHLIGHT",I="SELECT",B="UNSELECT",H="SETPOINT",G=(0,s.createContext)(z),W=function(e,n){var t;switch(n.type){case A:return(0,T.Z)((0,M.Z)({},e),{enabled:!0});case R:return(0,T.Z)((0,M.Z)({},e),{enabled:!1,highlighted:void 0,selected:[]});case D:return(0,M.Z)({},z);case F:return(0,T.Z)((0,M.Z)({},e),{type:n.value});case L:return(0,T.Z)((0,M.Z)({},e),{part:n.value});case U:return(0,T.Z)((0,M.Z)({},e),{highlighted:n.value});case V:return(0,T.Z)((0,M.Z)({},e),{highlighted:void 0});case I:return-1===(t=e.selected.findIndex((function(e){return e.uuid===n.value.uuid})))?(0,T.Z)((0,M.Z)({},e),{selected:(0,a.Z)(e.selected).concat([n.value])}):e;case B:return-1===(t=e.selected.findIndex((function(e){return e.uuid===n.value.uuid})))?e:(0,T.Z)((0,M.Z)({},e),{selected:(0,a.Z)(e.selected.slice(0,t)).concat((0,a.Z)(e.selected.slice(t+1)))});case H:return(0,T.Z)((0,M.Z)({},e),{point:n.value});default:return e}},Y=function(e){var n=e.children,t=(0,s.useReducer)(W,z),i=t[0],r=t[1];return(0,u.jsx)(G.Provider,{value:(0,T.Z)((0,M.Z)({},i),{dispatch:r}),children:n})},J=t(67169),q=t(94370),X=t(8100),K=t(87492),Q=function(){var e=(0,i.Z)((function(e,n){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,K.R)("/api/simulation",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({project:{id:e.id},simulation:n})})];case 1:return[2,t.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),$=function(){var e=(0,i.Z)((function(e,n){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,K.R)("/api/simulation/"+e.id,{method:"PUT",body:JSON.stringify(n)})];case 1:return t.sent(),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),ee=function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,K.R)("/api/simulation/"+e.id,{method:"DELETE"})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),ne=function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,K.R)("/api/simulation/"+e.id+"/run",{method:"GET"})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),te=function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,K.R)("/api/simulation/"+e.id+"/stop",{method:"GET"})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),ie=function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,K.R)("/api/simulation/"+e.id+"/tasks",{method:"GET",headers:{Accept:"application/json"}})];case 1:return[2,n.sent().json()]}}))}));return function(n){return e.apply(this,arguments)}}(),re=function(){var e=(0,i.Z)((function(e,n){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,K.R)("/api/simulation/"+e.id+"/log",{method:"POST",body:JSON.stringify({file:n})})];case 1:return[2,t.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),ae={useSimulations:function(e){var n=(0,X.ZP)(["/api/simulations",JSON.stringify({ids:e})],K._),t=n.data,i=n.error,r=n.mutate,o=!t,u=(null===t||void 0===t?void 0:t.simulations)||[],l=(0,s.useCallback)((function(e){var n=(0,a.Z)(u).concat([e]);r({simulations:n})}),[u,r]),c=(0,s.useCallback)((function(e){var n=u.filter((function(n){return n.id!==e.id}));r({simulations:n})}),[u,r]),d=(0,s.useCallback)((function(e,n){var t=u.map((function(n){return n.id===e.id&&(n=(0,M.Z)({},n,e)),n}));r({simulations:t},n)}),[u,r]);return[u,{addOneSimulation:l,delOneSimulation:c,mutateOneSimulation:d,errorSimulations:i,loadingSimulations:o}]},useSimulation:function(e,n){var t=(0,X.ZP)("/api/simulation"+(e?"/"+e:""),K._,{refreshInterval:n||0}),i=t.data,r=t.error,a=t.mutate,o=!i,u=(null===i||void 0===i?void 0:i.simulation)||{id:"0"},l=(0,s.useCallback)((function(e){a({simulation:(0,M.Z)({},u,e)})}),[u,a]);return[u,{mutateSimulation:l,errorSimulation:r,loadingSimulation:o}]},add:Q,update:$,del:ee,run:ne,stop:te,tasks:ie,log:re},oe=ae,ue=function(){var e=(0,i.Z)((function(e,n){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,K.R)("/api/geometry",{method:"POST",body:JSON.stringify({project:e,geometry:n})})];case 1:return[2,t.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),le=function(){var e=(0,i.Z)((function(e,n){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,K.R)("/api/geometry/"+e.id,{method:"PUT",body:JSON.stringify(n)})];case 1:return t.sent(),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),se=function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,K.R)("/api/geometry/"+e.id,{method:"DELETE"})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),ce=function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,K.R)("/api/geometry/"+e.id+"/download")];case 1:return[2,n.sent().json()]}}))}));return function(n){return e.apply(this,arguments)}}(),de=function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,K.R)("/api/geometry/"+e.id+"/part")];case 1:return[2,n.sent().json()]}}))}));return function(n){return e.apply(this,arguments)}}(),fe={useGeometries:function(e){var n=(0,X.ZP)(["/api/geometries",JSON.stringify({ids:e})],K._),t=n.data,i=n.error,r=n.mutate,o=!t,u=(null===t||void 0===t?void 0:t.geometries)||[],l=(0,s.useCallback)((function(e){var n=(0,a.Z)(u).concat([e]);r({geometries:n})}),[u,r]),c=(0,s.useCallback)((function(e){var n=u.filter((function(n){return n.id!==e.id}));r({geometries:n})}),[u,r]),d=(0,s.useCallback)((function(e){var n=u.map((function(n){return n.id===e.id&&(n=(0,M.Z)({},n,e)),n}));r({geometries:n})}),[u,r]);return[u,{addOneGeometry:l,delOneGeometry:c,mutateOneGeometry:d,errorGeometries:i,loadingGeometries:o}]},add:ue,update:le,del:se,download:ce,getPart:de},me=fe,he=t(97937),ve=function(e){var n=e.visible,t=e.title,i=e.children,r=e.onClose;return(0,u.jsx)(E.Z,{className:"panel",bodyStyle:{maxHeight:"calc(100vh - 65px)",overflow:"auto",padding:0},title:t,extra:(0,u.jsx)(h.Z,{type:"text",icon:(0,u.jsx)(he.Z,{}),onClick:function(){return r()}}),style:{display:n?"block":"none"},children:i})},pe=t(42473),ye=t(78116),xe=t(32834),ge=t(48764).lW,be="Unable to add geometry",je=function(e){return e.name.toLowerCase().includes(".stp")||e.name.toLowerCase().includes(".step")||e.name.toLowerCase().includes(".dxf")},Ze=function(){var e=(0,i.Z)((function(e){var n;return(0,o.__generator)(this,(function(t){return n=new FileReader,[2,new Promise((function(t){n.addEventListener("load",(function(){t(n.result)})),n.readAsArrayBuffer(e)}))]}))}));return function(n){return e.apply(this,arguments)}}(),we=function(){var e=(0,i.Z)((function(e,n,t){var i,r,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return"uploading"===n.file.status?[2,!0]:"done"!==n.file.status?[3,5]:[4,Ze(n.file.originFileObj)];case 1:i=o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,me.add({id:e.id},{name:n.file.name,uid:n.file.uid,buffer:ge.from(i)})];case 3:return r=o.sent(),t.addOneGeometry(r),t.mutateProject({id:e.id,geometries:(0,a.Z)(e.geometries).concat([r.id])}),[3,5];case 4:throw u=o.sent(),(0,S.lt)(be,u),u;case 5:return[2,!1]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Ce=function(e){var n=e.visible,t=e.project,r=e.swr,a=e.setVisible,l=(0,s.useState)(!1),c=l[0],d=l[1];return(0,u.jsx)(xe.ZP,{title:"Upload geometry",visible:n,onCancel:function(){return a(!1)},cancelButtonProps:{loading:c},children:(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(ye.Z,{className:"upload",action:"/api/noop",accept:".stp,.step,.dxf",showUploadList:!1,listType:"picture-card",beforeUpload:je,onChange:function(){var e=(0,i.Z)((function(e){var n;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,we(t,e,r)];case 1:return n=i.sent(),d(n),a(n),[3,3];case 2:return i.sent(),d(!1),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:(0,u.jsx)("div",{children:c?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(j.Z,{style:{fontSize:25}}),(0,u.jsxs)("div",{style:{marginTop:8},children:[(0,u.jsx)("b",{children:"Loading"}),", converting, ..."]})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Z.Z,{style:{fontSize:25}}),(0,u.jsxs)("div",{style:{marginTop:8},children:[(0,u.jsx)("b",{children:"Choose a file"})," or drop it here"]})]})})}),(0,u.jsx)(m.Z.Text,{children:(0,u.jsx)("p",{style:{color:"rgba(0, 0, 0, 0.45)",textAlign:"center"},children:"Native file format preferred: STEP (3D) or DXF (2D) file"})})]})})},Se=t(81579),ke=t(69677),Ee=function(e){var n=e.visible,t=e.geometry,r=e.setVisible,a=e.onEdit,l=(0,s.useState)(!1),c=l[0],d=l[1];return(0,u.jsx)(xe.ZP,{title:"Edit the geometry's name",visible:n,initialValues:{name:t.name},onCancel:function(){return r(!1)},onOk:function(){var e=(0,i.Z)((function(e){var n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:d(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,a(e)];case 2:return t.sent(),d(!1),r(!1),[3,4];case 3:throw n=t.sent(),d(!1),n;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),loading:c,children:(0,u.jsx)(Se.Z.Item,{name:"name",label:"Name:",rules:[{required:!0,message:"Name is required"}],children:(0,u.jsx)(ke.Z,{})})})},Pe=t(48764).lW,_e="Unable to download geometry",Ne="Unable to update geometry",Oe="Unable to delete geometry",Me=function(){var e=(0,i.Z)((function(e){var n,t,i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,me.download({id:e.id})];case 1:return n=o.sent(),t=new File([Pe.from(n.buffer).toString()],e.name+"."+n.extension),i=window.URL.createObjectURL(t),(r=document.createElement("a")).href=i,r.setAttribute("download",e.name+"."+n.extension),r.click(),r.remove(),[3,3];case 2:return a=o.sent(),(0,S.lt)(_e,a),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Te=function(){var e=(0,i.Z)((function(e,n,t){var i;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,me.update({id:e.id},[{key:"name",value:n.name}])];case 1:return r.sent(),e.name=n.name,t.mutateOneGeometry(e),[3,3];case 2:throw i=r.sent(),(0,S.lt)(Ne,i),i;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),ze=function(){var e=(0,i.Z)((function(e,n,t,i){var r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,me.del({id:e.id})];case 1:return o.sent(),r=n.geometries.filter((function(n){return n!==e.id})),i.mutateProject({id:n.id,geometries:r}),i.delOneGeometry(e),t(),[3,3];case 2:throw a=o.sent(),(0,S.lt)(Oe,a),a;case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),Ae=function(e){var n,t,r,a,l,c,f=e.project,h=e.geometry,v=e.swr,p=e.close,y=e.onCleanup,x=(0,s.useState)(!1),g=x[0],b=x[1],j=(0,s.useState)(!1),Z=j[0],w=j[1],S=(0,s.useState)(!1),_=S[0],N=S[1];return h?(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsx)(E.Z,{size:"small",title:"Informations",actions:[(0,u.jsx)(C.o6,{loading:g,onDownload:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:b(!0),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,Me(h)];case 2:return e.sent(),[3,5];case 3:return e.sent(),[3,5];case 4:return b(!1),[7];case 5:return[2]}}))}))},"download"),(0,u.jsxs)("div",{children:[(0,u.jsx)(Ee,{visible:Z,geometry:{id:null===h||void 0===h?void 0:h.id,name:null===h||void 0===h?void 0:h.name},setVisible:w,onEdit:function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){return[2,Te(h,e,v)]}))}));return function(n){return e.apply(this,arguments)}}()}),(0,u.jsx)(C.w6,{onEdit:function(){return w(!0)}})]},"edit"),(0,u.jsx)(C.m1,{loading:_,text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the geometry"," ",(0,u.jsx)(m.Z.Text,{strong:!0,children:h.name}),"?"]}),onDelete:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:N(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,ze(h,f,p,v)];case 2:return e.sent(),y(),[3,4];case 3:return N(!1),[7];case 4:return[2]}}))}))},"delete")],children:(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"File:"})," ",h.name," "]}),(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Unit:"})," ",(0,u.jsx)(pe.Z.Inline,{text:"m"})]}),(0,u.jsxs)(u.Fragment,{children:[3===h.summary.dimension&&(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Number of solids:"})," ",null!==(a=null===(n=h.summary.solids)||void 0===n?void 0:n.length)&&void 0!==a?a:0]}),(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Number of faces:"})," ",null!==(l=null===(t=h.summary.faces)||void 0===t?void 0:t.length)&&void 0!==l?l:0]}),2===h.summary.dimension&&(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Number of edges:"})," ",null!==(c=null===(r=h.summary.edges)||void 0===r?void 0:r.length)&&void 0!==c?c:0]})]})]})})})}):(0,u.jsx)(k.Z.Simple,{})};Ae.Add=Ce;var Re,De,Fe,Le=Ae,Ue=function(){var e=(0,i.Z)((function(e,n){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,K.R)("/api/result",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({simulation:e,result:n})})];case 1:return[2,t.sent().json()]}}))}));return function(n,t){return e.apply(this,arguments)}}(),Ve=function(){var e=(0,i.Z)((function(e,n){return(0,o.__generator)(this,(function(t){return[2,(0,K.R)("/api/result/download",{method:"POST",body:JSON.stringify({simulation:e,result:n})})]}))}));return function(n,t){return e.apply(this,arguments)}}(),Ie=function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){return[2,(0,K.R)("/api/result/archive",{method:"POST",body:JSON.stringify({simulation:e})})]}))}));return function(n){return e.apply(this,arguments)}}(),Be={load:Ue,download:Ve,archive:Ie},He=Be,Ge=t(13013),We=t(27049),Ye=t(94594),Je=t(11382),qe=t(41428),Xe=t(38095),Ke=t(86350),Qe=t(15668),$e=t(74317),en=t(35598),nn=t(49591),tn=t(19478),rn=t(87784),an=t(90420),on=t(75843),un=t(99477),ln=t(57632),sn=t(79753),cn=t(54458),dn=t(58939),fn=t(24065),mn=t(54327),hn=function(e){var n=new un.fHI(.025,.025,.8,50);n.translate(0,.4,0);var t=new un.vBJ({color:e}),i=new un.Kj0(n,t),r=new un.b_z(.05,.2,50);r.translate(0,.9,0);var a=new un.vBJ({color:e}),o=new un.Kj0(r,a),u=new un.ZAu;u.type="ArrowHelper",u.add(i),u.add(o);return u.dispose=function(){n.dispose(),t.dispose(),r.dispose(),a.dispose()},u},vn=function(e,n,t){var i=document.createElement("canvas");i.width=(null===t||void 0===t?void 0:t.width)||256,i.height=256;var r=i.getContext("2d");r.fillStyle="grey",r.font="50px sans-serif",r.textAlign=(null===t||void 0===t?void 0:t.align)||"center",r.textBaseline="middle",r.fillText(n,i.width/2,i.height/2);var a=new un.xEZ(i);a.flipY=!0,a.needsUpdate=!0;var o=new un.xeV({map:a,transparent:!0,depthWrite:!1});o.map.anisotropy=e.capabilities.getMaxAnisotropy();var u=new un.jyi(o);u.type="LabelHelper",(null===t||void 0===t?void 0:t.position)&&u.position.copy(t.position),(null===t||void 0===t?void 0:t.scale)&&u.scale.setScalar(t.scale);return u.dispose=function(){a.dispose(),o.dispose()},u},pn=function(e){return Math.abs(e)<1e-12?"0":Math.abs(e)>1e3||Math.abs(e)<.001?e.toExponential(2):e.toFixed(3)},yn=function(e,n,t,i){var r,a,o,u=function(e,n,t,i,r){for(var a=new un.ZAu,o=new un.nls({color:8947848}),u=new un.Pa4(-e/2,0,-n/2),l=e/(t-1),s=n/(i-1),c=0;c<i;++c){var d=(new un.u9r).setFromPoints([new un.Pa4(u.x,0,u.z+c*s),new un.Pa4(u.x+e,0,u.z+c*s)]);a.add(new un.x12(d,o))}for(var f=0;f<t;++f){var m=(new un.u9r).setFromPoints([new un.Pa4(u.x+f*l,0,u.z),new un.Pa4(u.x+f*l,0,u.z+n)]);a.add(new un.x12(m,o))}return null===r||void 0===r||r(a),a},l=function(n,t,i,r){for(var a=new un.ZAu,o=Math.abs(t-n),u=o/(r-1),l=(new un.Pa4).copy(i).multiplyScalar(-o/2),s=(new un.Pa4).copy(i).multiplyScalar(u),c=n,d=0;d<r;++d){var f=vn(e,pn(c));f.position.copy(l),a.add(f),l.add(s),c+=u}return a},s=function(){var e=n.boundingBox,t=n.boundingSphere.center,i=new un.Pa4(e.max.x-e.min.x,e.max.y-e.min.y,e.max.z-e.min.z),o=function(e){var n=Math.max(e.x,e.y,e.z),t=Math.max(Math.ceil(e.x/n*5),2),i=Math.max(Math.ceil(e.y/n*5),2),r=Math.max(Math.ceil(e.z/n*5),2);return new un.Pa4(t,i,r)}(i);r=.1*Math.max(i.x,i.y,i.z),a=1*r;var s=new un.ZAu,c=u(i.x,i.z,o.x,o.z),d=u(i.x,i.y,o.x,o.y,(function(e){e.rotateX(Math.PI/2)})),m=u(i.y,i.z,o.y,o.z,(function(e){e.rotateZ(-Math.PI/2)}));s.add(c,d,m);var h=l(e.min.x,e.max.x,new un.Pa4(1,0,0),o.x),v=l(e.min.y,e.max.y,new un.Pa4(0,1,0),o.y),p=l(e.min.z,e.max.z,new un.Pa4(0,0,1),o.z);return s.add(h,v,p),s.position.set(t.x,t.y,t.z),s.type="GridHelper",s.dispose=f,s},c=function(e){return e<=0?-1:1},d=function(e){return Math.abs(e)<=.5?1:-1},f=function(){null===o||void 0===o||o.children.forEach((function(e){e.children.forEach((function(e){if("Line"===e.type){var n=e;n.geometry.dispose(),n.material.dispose()}else{e.dispose()}}))}))};return{dispose:f,setVisible:function(e){o.visible=e},update:function(){var e=n.boundingBox,u=new un.Pa4(e.max.x-e.min.x,e.max.y-e.min.y,e.max.z-e.min.z),l=!1;n.children.forEach((function(e){if("GridHelper"===e.type){var t=e;l=t.visible,n.remove(t),t.dispose()}})),o=s();var f=i.object.position.distanceTo(i.target);o.traverse((function(e){"LabelHelper"===e.type&&e.scale.setScalar(.05*f)}));var m=new un.Pa4;t.getWorldDirection(m);var h=f/10/(i.minDistance+.001),v=o.children[0],p=o.children[1],y=o.children[2];v.position.set(0,c(m.y)*(u.y/2+r),0),p.position.set(0,0,c(m.z)*(u.z/2+r)),y.position.set(c(m.x)*(u.x/2+r),0,0);var x=o.children[3],g=o.children[4],b=o.children[5];x.position.set(0,c(m.y)*d(m.y)*(u.y/2+a),c(m.z)*d(m.y)*-(u.z/2+a)),g.position.set(c(m.x)*d(m.x)*(u.x/2+a),0,c(m.z)*d(m.x)*-(u.z/2+a)),b.position.set(c(m.x)*d(m.x)*(u.x/2+a),c(m.y)*d(m.x)*-(u.y/2+a),0);var j=.2*h,Z=.3*h;x.visible=Math.abs(m.y)>j||Math.abs(m.z)>Z,g.visible=Math.abs(m.x)>Z||Math.abs(m.z)>Z,b.visible=Math.abs(m.x)>Z||Math.abs(m.y)>j,o.visible=l,n.add(o)}}},xn=t(51438),gn=t(28668),bn=t(91224),jn=function(e,n,t,i){var r,a,o,u=new un.Ilk("#fad114"),l=new un.Ilk("#E98A15"),s=new un.Pa4(-1,0,0),c=new un.JOQ(s),d={up:new un.Pa4,forward:new un.Pa4,right:new un.Pa4},f=new un.Pa4,m=new un.Pa4,h=new un.USm,v=new un.Pa4,p=new un.FM8,y=new un.JOQ,x=new un.Pa4,g=new un.Pa4,b=new un.Zzh,j={up:new un.Pa4,forward:new un.Pa4,right:new un.Pa4},Z=new un.iMs,w=s,C=new un.ZAu;C.type="SectionViewHelper",C.visible=!1,n.add(C);!function(){var e=new un._12(1,1),n=new un.vBJ({color:u,side:un.ehD,transparent:!0,opacity:.5}),t=new un.Kj0(e,n);t.type="Plane",C.add(t)}();!function(){var e=new un.xo$(.2,32,32,Math.PI,-Math.PI),n=new un.vBJ({color:u,side:un.ehD,transparent:!0,opacity:.5}),t=new un.Kj0(e,n);t.type="Dome",C.add(t)}();!function(){var e=new(function(e){(0,gn.Z)(t,e);var n=(0,bn.Z)(t);function t(e){var i;return(0,xn.Z)(this,t),(i=n.call(this)).radius=e,i}return t.prototype.getPoint=function(e){return(new un.Pa4).set(this.radius*Math.cos(Math.PI*e),this.radius*Math.sin(Math.PI*e),0)},t}(un.Hyl))(.2),n=new un.WXh(e,32,.2*.1,32),t=new un.vBJ({color:u,side:un.ehD,transparent:!0,opacity:.5}),i=new un.Kj0(n,t);i.rotateX(Math.PI/2),i.type="ArcX",C.add(i);var r=new un.WXh(e,32,.2*.1,32),a=new un.vBJ({color:u,side:un.ehD,transparent:!0,opacity:.5}),o=new un.Kj0(r,a);o.rotateX(Math.PI/2),o.rotateY(Math.PI/2),o.type="ArcY",C.add(o)}();var S=function(){var e=new un.Pa4;n.boundingBox.getCenter(e),C.position.copy(e)},k=function(){C.rotateX(Math.PI);var e=c.normal.multiplyScalar(-1);c.setFromNormalAndCoplanarPoint(e,C.position)},E=function(e){var n=e.target.getBoundingClientRect(),t=e.clientX-n.left,i=e.clientY-n.top,r=new un.FM8;return r.x=t/n.width*2-1,r.y=-i/n.height*2+1,r},P=function(e){r&&r.material.color.set(u),r=e,e&&e.material.color.set(l)},_=function(e){if(C.visible){var n=E(e);if(Z.setFromCamera(n,t),a){var r=new un.Pa4;Z.ray.intersectPlane(y,r),"Plane"===(null===o||void 0===o?void 0:o.type)?N(r):"Dome"===(null===o||void 0===o?void 0:o.type)?O(n):T(r),function(){var e=new un.Pa4(0,0,1).applyQuaternion(C.quaternion).multiplyScalar(-1);c.setFromNormalAndCoplanarPoint(e,C.position)}()}else{var u=Z.intersectObject(C);u.length?(i.enabled=!1,o=u[0].object,P(o),m.copy(u[0].point),t.getWorldDirection(d.forward),d.forward.normalize(),d.up.copy(t.up).normalize(),d.right.crossVectors(d.up,d.forward).normalize()):(o=null,P(),i.enabled=!0)}}},N=function(e){e.sub(x);var n=new un.Pa4;b.closestPointToPoint(e,!1,n),C.position.copy(n)},O=function(e){C.rotation.copy(h),C.rotateOnWorldAxis(d.up,5*-(p.x-e.x)),C.rotateOnWorldAxis(d.right,5*-(p.y-e.y))},M=function(){o.getWorldDirection(v),h.copy(C.rotation),x.copy(m).sub(C.position),g.copy(x).normalize(),j.up.copy(g),j.right.copy(v),j.forward.crossVectors(j.right,j.up),b.set(m,(new un.Pa4).copy(m).add(j.forward)),y.setFromNormalAndCoplanarPoint(d.forward,m)},T=function(e){var n=i.object.position.distanceTo(i.target),t=new un.Pa4;b.closestPointToPoint(e,!1,t);var r=m.distanceTo(t);t.sub(m);var a=(new un.Pa4).copy(g).cross(t).normalize(),o=Math.sign(v.dot(a))*r*1/(n/100);C.rotation.copy(h),C.rotateOnWorldAxis(v,o)},z=function(e){switch(null===o||void 0===o?void 0:o.type){case"Plane":!function(){y.setFromNormalAndCoplanarPoint(d.forward,m),f.copy(C.position);var e=new un.Pa4;Z.ray.intersectPlane(y,e),x.copy(e).sub(f),g.copy(x).normalize(),b.set(f,(new un.Pa4).copy(f).add(c.normal))}();break;case"Dome":!function(e){h.copy(C.rotation),p.copy(e)}(e);break;case"ArcX":case"ArcY":M()}},A=function(e){if(C.visible&&o){a=!0;var n=E(e);z(n)}},R=function(){C.visible&&(a=!1,P())};return e.domElement.addEventListener("pointermove",_),e.domElement.addEventListener("pointerdown",A),e.domElement.addEventListener("pointerup",R),{getClippingPlane:function(){return c},toggleVisible:function(){var e=C.visible;C.visible=!e},start:function(){e.localClippingEnabled=!0,C.visible=!0,function(){var e=new un.Pa4;n.boundingBox.getSize(e),e.multiplyScalar(1.2);var t=Math.max(Math.max(e.x,e.y),e.z);C.scale.setScalar(t)}(),S();var t=(new un.Pa4).copy(C.position).sub(s);C.lookAt(t),c.setFromNormalAndCoplanarPoint(s,C.position)},stop:function(){e.localClippingEnabled=!1,C.visible=!1},toAxis:function(e){if(S(),w.equals(e))k();else{var n=(new un.Pa4).copy(C.position).sub(e);C.lookAt(n),c.setFromNormalAndCoplanarPoint(e,C.position),w.copy(e)}},flip:k,dispose:function(){C.traverse((function(e){if("Plane"===e.type||"Dome"===e.type||"ArcX"===e.type||"ArcY"===e.type){var n=e;n.geometry.dispose(),n.material.dispose()}})),e.domElement.removeEventListener("pointermove",_),e.domElement.removeEventListener("pointerdown",A),e.domElement.removeEventListener("pointerup",R)}}},Zn=t(54104),wn=function(e){var n=new un.ZAu;n.type="PointHelper",n.visible=!1,e.add(n);var t=function(e,n){var t=(new un.u9r).setFromPoints([e,n]),i=new un.nls({color:16711680});return new un.x12(t,i)},i=function(){n.children.forEach((function(e){n.remove(e);var t=e;t.geometry.dispose(),t.material.dispose()}))};return{build:function(){var r;i();var o=function(){var n,t,i=(null!==(t=null===(n=e.boundingSphere)||void 0===n?void 0:n.radius)&&void 0!==t?t:1)/100,r=new un.xo$(i),a=new un.Wid({color:16711680});return new un.Kj0(r,a)}(),u=function(){var n=[],i=e.boundingBox.max.x-e.boundingBox.min.x,r=e.boundingBox.max.y-e.boundingBox.min.y,a=e.boundingBox.max.z-e.boundingBox.min.z,o=Math.max(i,r,a),u=t(new un.Pa4(-o/2,0,0),new un.Pa4(o/2,0,0));n.push(u);var l=t(new un.Pa4(0,-o/2,0),new un.Pa4(0,o/2,0));n.push(l);var s=t(new un.Pa4(0,0,-o/2),new un.Pa4(0,0,o/2));return n.push(s),n}();n.add(o),(r=n).add.apply(r,(0,a.Z)(u))},dispose:i,update:function(e){e?(n.position.set(e.x,e.y,e.z),n.visible=!0):n.visible=!1}}},Cn=t(1217),Sn=t(82854),kn=t(6648),En=t(48764).lW,Pn=function(e,n){var t=new un.Ilk("#FAD114"),r=new un.Ilk("#EE9817"),u=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a,u,d,f,m,h;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return i=new Blob([En.from(e.buffer)]),r=URL.createObjectURL(i),a=new Cn.E,(u=new Sn._).setDecoderPath("/three/libs/draco/"),a.setDRACOLoader(u),(d=new kn.a).setTranscoderPath("node_modules/three//examples/js/libs/basis/"),a.setKTX2Loader(d),[4,new Promise((function(e,n){a.load(r,(function(n){e(n)}),(function(){}),(function(e){return n(e)}))}))];case 1:return f=o.sent(),m=f.scene,(h=new un.Tme).type="Part",h.uuid=e.summary.uuid,h.children=m.children,h.userData=m.userData,"mesh"===e.summary.type?function(e,n){e.traverse((function(e){if("Mesh"===e.type){var t=e,i=new un.Uk6(t.geometry),r=new un.nls({color:t.material.color,linewidth:1}),a=new un.ejS(i,r);t.add(a),t.material.visible=!1,t.material.clippingPlanes=[n]}}))}(h,t):"result"===e.summary.type?function(e,n){e.traverse((function(e){if("Mesh"===e.type||"Line"===e.type){var t=e,i=t.geometry.getAttribute("data");if(i){var r=i.array.reduce((function(e,n){return Math.min(e,n)}),i.array[0]),a=i.array.reduce((function(e,n){return Math.max(e,n)}),i.array[0]);r===a&&(r-=1,a+=1);var o=new Zn.A;o.setMin(r),o.setMax(a);for(var u=new Float32Array(3*i.count),l=0;l<i.count;l++){var s=o.getColor(i.array[l]);u[3*l+0]=s.r,u[3*l+1]=s.g,u[3*l+2]=s.b}t.geometry.setAttribute("color",new un.a$l(u,3)),t.userData=(0,T.Z)((0,M.Z)({},t.userData),{lut:o})}if("Mesh"===e.type){var c=new un.Uk6(t.geometry),d=new un.nls({linewidth:1}),f=new un.ejS(c,d);t.add(f)}t.material.vertexColors=!0,t.material.clippingPlanes=[n]}}))}(h,t):"geometry3D"!==e.summary.type&&"geometry2D"!==e.summary.type||function(e,n){e.traverse((function(e){if("Mesh"===e.type){var t=e;t.material.clippingPlanes=[n],t.material.originalColor=t.material.color}}))}(h,t),c(h,n),h.boundingBox=l(h),h.dispose=function(){return s(h)},h.setTransparent=function(e){return c(h,e)},h.startSelection=function(e,n,t,i){return g(h,e,n,t,i)},h.stopSelection=function(){return b()},h.getHighlighted=function(){return y},h.getSelected=function(){return x},h.highlight=S,h.unhighlight=k,h.select=P,h.unselect=_,[2,h]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),l=function(e){var n=new un.ZzF;return e.traverse((function(e){n.expandByObject(e)})),n},s=function(e){e.traverse((function(e){if("Mesh"===e.type){var n=e;n.geometry.dispose(),n.material.dispose()}}))},c=function(e,n){e.traverse((function(e){if("Mesh"===e.type){var t=e;t.material.transparent=n,t.material.opacity=n?.5:1,t.material.depthWrite=!n}}))},d=new un.iMs,f=null,m=null,h=null,v=null,p=null,y=null,x=[],g=function(e,n,t,i,r){f=e,m=r,h=n,v=t,(p=i).selectedObjects=[],y=null,x.length=0,h.domElement.addEventListener("pointermove",Z),h.domElement.addEventListener("pointerdown",E)},b=function(){h&&h.domElement.removeEventListener("pointermove",Z),h&&h.domElement.removeEventListener("pointerdown",E),k(),y=null,x.forEach((function(e){_(e.uuid)})),x.length=0,m=null,f=null,h=null,v=null,p=null},j=function(e,n){var t;if(e&&n)return e.traverse((function(e){e.userData.uuid===n&&(t=e)})),t},Z=function(n){var t=function(e){var n=e.target.getBoundingClientRect(),t=e.clientX-n.left,i=e.clientY-n.top,r=new un.FM8;return r.x=t/n.width*2-1,r.y=-i/n.height*2+1,r}(n);switch(d.setFromCamera(t,v),m){case"solids":!function(){var n=d.intersectObject(f,!0);if(n.length){var t=n[0].object.parent;t&&e(f,t.userData.uuid,t.userData.label)}else e(f)}();break;case"faces":!function(){var n;if(2===f.userData.dimension)if((n=d.intersectObject(f,!0)).length){var t=n[0].object,i=t.parent;"Mesh"===(null===i||void 0===i?void 0:i.type)?e(f,i.userData.uuid,i.userData.label):e(f,t.userData.uuid,t.userData.label)}else e(f);else if((n=d.intersectObject(f,!0)).length){var r=n[0].object;e(f,r.userData.uuid,r.userData.label)}else e(f)}();break;case"edges":!function(){var n,t=f.userData.edges;if((n=d.intersectObject(f,!0)).length){var i=n[0].object;(null===t||void 0===t?void 0:t.find((function(e){return e.uuid===i.userData.uuid})))?e(f,i.userData.uuid,i.userData.label):e(f)}else e(f)}();break;case"point":!function(){var n=d.intersectObject(f,!0);if(n.length){var t=n[0];e(f,void 0,void 0,t.point)}else e(f)}()}},w=function(e,n){n?p.selectedObjects.find((function(n){return n.userData.uuid===e.userData.uuid}))||p.selectedObjects.push(e):x.find((function(n){return n.uuid===e.userData.uuid}))||p.selectedObjects.push(e)},C=function(e,n){if(n){var t=p.selectedObjects.findIndex((function(n){return n.userData.uuid===e.userData.uuid}));p.selectedObjects=(0,a.Z)(p.selectedObjects.slice(0,t)).concat((0,a.Z)(p.selectedObjects.slice(t+1)))}else{if(!x.find((function(n){return n.uuid===e.userData.uuid}))){var i=p.selectedObjects.findIndex((function(n){return n.userData.uuid===e.userData.uuid}));p.selectedObjects=(0,a.Z)(p.selectedObjects.slice(0,i)).concat((0,a.Z)(p.selectedObjects.slice(i+1)))}}},S=function(e){if(e!==(null===y||void 0===y?void 0:y.uuid)){k();var n=j(f,e);if(n)if(y={uuid:n.userData.uuid,label:n.userData.label},w(n),"Mesh"===n.type)n.material.color=t;else n.traverse((function(e){"Mesh"===e.type&&(e.material.color=t)}))}},k=function(){var e=j(f,null===y||void 0===y?void 0:y.uuid);if(y=null,e){C(e);var n=x.findIndex((function(n){return n.uuid===e.userData.uuid}));if("Mesh"===e.type){var t=e;t.material.color=-1===n?t.material.originalColor:r}else{e.traverse((function(e){if("Mesh"===e.type){var t=e;t.material.color=-1===n?t.material.originalColor:r}}))}}},E=function(){y&&n(f,y.uuid,y.label)},P=function(e){var n=j(f,e);n&&(x.push({uuid:e,label:n.userData.label}),w(n,!0),"Mesh"===n.type?n.material.color=r:n.traverse((function(e){"Mesh"===e.type&&(e.material.color=r)})))},_=function(e){var n=j(f,e),t=x.findIndex((function(n){return n.uuid===e}));if(-1!==t&&(x=(0,a.Z)(x.slice(0,t)).concat((0,a.Z)(x.slice(t+1)))),n){if(C(n,!0),"Mesh"===n.type){var i=n;i.material.color=i.material.originalColor}else{n.traverse((function(e){if("Mesh"===e.type){var n=e;n.material.color=n.material.originalColor}}))}n.visible=!0}};return{load:u}},_n=function(){return{type:A}},Nn=function(){return{type:R}},On=function(e){return{type:F,value:e}},Mn=function(e){var n=e.uuid,t=e.label;return{type:U,value:{uuid:n,label:t}}},Tn=function(){return{type:V}},zn=function(e){var n=e.uuid,t=e.label;return{type:I,value:{uuid:n,label:t}}},An=function(e){var n=e.uuid,t=e.label;return{type:B,value:{uuid:n,label:t}}},Rn=function(e){return{type:H,value:e}},Dn=t(41686),Fn="Error while loading part",Ln="Error while taking snapshot",Un="Unable to save screenshot",Vn=function(e){var n=new un.ZzF;e.children.forEach((function(e){if(e.visible&&"Part"===e.type){var t=e.boundingBox,i=new un.Pa4(Math.min(n.min.x,t.min.x),Math.min(n.min.y,t.min.y),Math.min(n.min.z,t.min.z)),r=new un.Pa4(Math.max(n.max.x,t.max.x),Math.max(n.max.y,t.max.y),Math.max(n.max.z,t.max.z));n.set(i,r)}}));var t=new un.aLr;n.getBoundingSphere(t),e.boundingBox=n,e.boundingSphere=t},In=function(e,n,t){var i=n.object.position.distanceTo(n.target)*t*.01,r=n.target.clone().sub(e.position).normalize().multiplyScalar(i);e.position.add(r)},Bn=void 0,Hn=function(e,n){In(e,n,1);Bn=requestAnimationFrame((function(){return Hn(e,n)}))},Gn=function(e,n){In(e,n,-1);Bn=requestAnimationFrame((function(){return Gn(e,n)}))},Wn=function(){Bn&&cancelAnimationFrame(Bn),Bn=void 0},Yn=function(e,n,t){var i=e.boundingSphere,r=i.center,a=2*i.radius/(2*Math.atan(Math.PI*n.fov/360)),o=a/n.aspect,u=1.1*Math.max(a,o),l=t.target.clone().sub(n.position).normalize().multiplyScalar(u);t.target.copy(r),t.minDistance=u/10,t.maxDistance=10*u,n.position.copy(r).sub(l),n.near=u/100,n.far=100*u,n.updateProjectionMatrix()},Jn=function(){var e=(0,i.Z)((function(e,n,t,i,r,a,u){var l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,Pn((function(e,n,t,i){n?(e.highlight(n),setTimeout((function(){return u(Mn({uuid:n,label:t}))}),1)):i?u(Rn({x:i.x,y:i.y,z:i.z})):(e.unhighlight(),setTimeout((function(){return u(Tn())}),1))}),(function(e,n,t){e.getSelected().find((function(e){return e.uuid===n}))?(e.unselect(n),setTimeout((function(){return u(An({uuid:n,label:t}))}),1)):(e.select(n),setTimeout((function(){return u(zn({uuid:n,label:t}))}),1))})).load(e,n,a.sectionViewHelper.getClippingPlane())];case 1:return l=o.sent(),u(function(e){return{type:L,value:e}}(l)),t.add(l),Vn(t),Yn(t,i,r),a.gridHelper.update(),a.gridHelper.update(),a.gridHelper.setVisible(!0),l.children[0].userData.lut?(a.colorbarHelper.setLUT(l.children[0].userData.lut),a.colorbarHelper.setVisible(!0)):a.colorbarHelper.setVisible(!1),a.pointHelper.build(),[2]}}))}));return function(n,t,i,r,a,o,u){return e.apply(this,arguments)}}(),qn=function(){var e=(0,i.Z)((function(e,n,t,i){var r,a,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=i.domElement.width,a=i.domElement.height,u=t.aspect,520,312,i.domElement.width=520,i.domElement.height=312,t.aspect=520/312,t.updateProjectionMatrix(),i.clear(),i.setViewport(0,0,520,312),i.render(n,t),l=i.domElement.toDataURL(),i.domElement.width=r,i.domElement.height=a,t.aspect=u,t.updateProjectionMatrix(),[4,Dn.Z.add({name:"snapshot",uid:"snapshot_"+(0,ln.Z)(),data:l},{id:e.id})];case 1:return o.sent(),[3,3];case 2:return s=o.sent(),(0,S.lt)(Ln,s),[3,3];case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),Xn=function(e){var n=e.loading,t=e.project,r=e.part,a=(0,s.useRef)(null),m=(0,s.useRef)(),v=(0,s.useRef)(),p=(0,s.useRef)(),y=(0,s.useRef)(),x=(0,s.useRef)(),g=(0,s.useRef)(),b=(0,s.useRef)(),Z=(0,s.useRef)(),w=(0,s.useRef)(),C=(0,s.useRef)(),k=(0,s.useRef)(),E=(0,s.useState)(!1),P=E[0],_=E[1],N=(0,s.useState)(!1),O=N[0],M=N[1],T=(0,s.useState)(!1),z=T[0],A=T[1],R=(0,s.useState)(!1),D=R[0],F=R[1],L=(0,l.useRouter)(),U=(0,s.useContext)(G),V=U.enabled,I=U.part,B=U.highlighted,H=U.selected,W=U.point,Y=U.type,J=U.dispatch;(0,s.useEffect)((function(){if(mn.Z.isWebGLAvailable()){var e,n=a.current,t=n.clientWidth,i=n.clientHeight;m.current=new un.xsS,v.current=new un.cPb(50,t/i,.1,1e3),v.current.position.z=10;var r=new un.Mig("#aaa",.75);m.current.add(r);var o=new un.cek("#fff",.5);o.decay=2,v.current.add(o),m.current.add(v.current),p.current=new un.CP7({antialias:!0,alpha:!0}),p.current.setClearColor("#ffffff"),p.current.setSize(t,i),p.current.setPixelRatio(window.devicePixelRatio||1),p.current.shadowMap.enabled=!0,p.current.autoClear=!1,n.appendChild(p.current.domElement);var u=new cn.C(m.current,v.current);y.current=new dn.f(new un.FM8(t,i),m.current,v.current),y.current.visibleEdgeColor.set("#FAD114"),y.current.hiddenEdgeColor.set("#FAD114"),x.current=new fn.xC(p.current),x.current.addPass(u),x.current.addPass(y.current),g.current=new sn.$(v.current,n),g.current.rotateSpeed=3,g.current.panSpeed=.1;var l=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{offsetWidth:0,offsetHeight:0,width:150,height:150},i=t.offsetWidth,r=t.offsetHeight,a=t.width,o=t.height,u="green",l="blue",s="black",c=i,d=r,f=a,m=o,h=hn("red");h.rotateZ(-Math.PI/2);var v=vn(e,"X",{position:new un.Pa4(1.1,0,0)}),p=hn(u),y=vn(e,"Y",{position:new un.Pa4(0,1.1,0)}),x=hn(l);x.rotateX(Math.PI/2);var g=vn(e,"Z",{position:new un.Pa4(0,0,1.1)}),b=new un.xo$(.05,50,50),j=new un.vBJ({color:s}),Z=new un.Kj0(b,j),w=new un.ZAu;w.type="AxisHelper",w.add(h),w.add(v),w.add(p),w.add(y),w.add(x),w.add(g),w.add(Z);var C=new un.xsS;C.add(w);var S=new un.iKG(-1.2,1.2,1.2,-1.2,-2,2),k=function(e){var n=e.newOffsetWidth,t=e.newOffsetHeight,i=e.newWidth,r=e.newHeight;c=n,d=t,f=i,m=r};return{dispose:function(){b.dispose(),j.dispose(),w.children.forEach((function(e){"ArrowHelper"!==e.type&&"LabelHelper"!==e.type||e.dispose()})),C.remove(w)},render:function(){e.setViewport(c,d,f,m),S.rotation.copy(n.rotation),e.render(C,S)},resize:k}}(p.current,v.current,{offsetWidth:t-155,offsetHeight:i-155,width:150,height:150}),s=function(e,n,t,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{offsetWidth:0,offsetHeight:0,width:150,height:150},a=r.offsetWidth,o=r.offsetHeight,u=r.width,l=r.height,s="#d3d3d3",c="#ffffff",d="#000000",f="#FAD114",m=100,h=.25,v=null,p=null,y=[{text:"FRONT",normal:new un.Pa4(0,0,1),up:new un.Pa4(0,1,0)},{text:"BACK",normal:new un.Pa4(0,0,-1),up:new un.Pa4(0,1,0)},{text:"RIGHT",normal:new un.Pa4(1,0,0),up:new un.Pa4(0,1,0)},{text:"LEFT",normal:new un.Pa4(-1,0,0),up:new un.Pa4(0,1,0)},{text:"UP",normal:new un.Pa4(0,1,0),up:new un.Pa4(0,0,-1)},{text:"DOWN",normal:new un.Pa4(0,-1,0),up:new un.Pa4(0,0,1)}],x=new un._12(m*(1-h),m*(1-h)),g=new un.TOt(x),b=new un.xo$(m*(1-h)/2,10,10,0,Math.PI,0),j=new un.ZAu;y.forEach((function(e){var n=document.createElement("canvas"),t=n.getContext("2d");n.width=n.height=256,t.fillStyle=s,t.fillRect(0,0,n.width,n.height),t.font="bold 50pt sans-serif",t.fillStyle=d,t.textAlign="center",t.textBaseline="middle",t.fillText(e.text,n.width/2,n.height/2);var i=new un.ROQ(n);i.needsUpdate=!0;var r=new un.vBJ({map:i}),a=new un.vBJ({color:s}),o=new un.Kj0(x,r),u=new un.Kj0(x,a);u.rotateY(Math.PI);var l=new un.nls({color:c}),f=new un.ejS(g,l),h=new un.vBJ({color:s,transparent:!0,opacity:.2}),v=new un.Kj0(b,h),p=new un.ZAu;p.add(o,u,f,v),p.lookAt(e.normal),p.translateZ(m/2),p.normal=e.normal,p.up=e.up,j.add(p)}));var Z=new un.Mig("#ffffff",1),w=new un.xsS;w.add(j),w.add(Z);var C=new un.iKG(-m,m,m,-m,-m,m);C.position.z=2;var S=new un.iMs,k=function(e){var n=E(e);P(n)?(v=_(n),N(),(null===v||void 0===v?void 0:v.uuid)!==(null===p||void 0===p?void 0:p.uuid)&&(O(),p=v)):(v=null,O())},E=function(e){var n=e.target.getBoundingClientRect(),t=e.clientX-n.left,i=e.clientY-n.top,r=new un.FM8;return r.x=(t-a)/u*2-1,r.y=-(i+l-n.height+o)/l*2+1,r},P=function(e){return e.x>-1&&e.x<1&&e.y>-1&&e.y<1},_=function(e){var n=new un.Pa4(e.x,e.y,-1);n.unproject(C);var t=new un.Pa4;C.getWorldDirection(t),S.set(n,t);var i=S.intersectObjects(w.children,!0);return i.length?i[0].object.parent:null},N=function(){v&&v.children&&v.children.forEach((function(e){var n=e;n.material&&n.material.color&&(n.material.previousColor=n.material.color,n.material.color=new un.Ilk(f))}))},O=function(){p&&p.children&&p.children.forEach((function(e){var n=e;n.material&&n.material.color&&(n.material.color=new un.Ilk(s))}))},M=function(e){if(v){var r=v.normal,a=v.up,o=new un.Pa4;n.boundingBox&&n.boundingBox.getCenter(o);var u=t.position.distanceTo(i.target),l=r.clone().multiplyScalar(u),s=o.add(l);t.position.copy(s),t.up.copy(a),v=null,O(),k(e)}};e.domElement.addEventListener("pointermove",k),e.domElement.addEventListener("pointerdown",M);var T=function(e){var n=e.newOffsetWidth,t=e.newOffsetHeight,i=e.newWidth,r=e.newHeight;a=n,o=t,u=i,l=r},z=function(){e.domElement.removeEventListener("pointermove",k),e.domElement.removeEventListener("pointerdown",M),j.children.forEach((function(e){e.children.forEach((function(e){var n=e;n.geometry.dispose(),n.material.dispose()}))})),w.remove(j)};return{resize:T,render:function(){e.setViewport(a,o,u,l),C.rotation.copy(t.rotation),e.render(w,C)},dispose:z}}(p.current,m.current,v.current,g.current,{offsetWidth:t-155,offsetHeight:i-155,width:150,height:150});b.current=yn(p.current,m.current,v.current,g.current),Z.current=function(e,n,t,i){var r=document.createElement("div");r.style.pointerEvents="none",r.style.border="1px solid #55aaff",r.style.backgroundColor="rgba(75, 160, 255, 0.3)",r.style.position="fixed";var a=new un.FM8,o=new un.FM8,u=new un.FM8,l=new un.FM8,s=!1,c=!1,d=new un.iMs,f=function(){s=!1},m=function(e){s&&0===e.button&&(c=!0,p(e))},h=function(e){s&&c&&y(e)},v=function(e){c=!1,s&&x(e)};e.domElement.addEventListener("pointerdown",m),e.domElement.addEventListener("pointermove",h),e.domElement.addEventListener("pointerup",v);var p=function(n){i.enabled=!1,e.domElement.parentElement.appendChild(r),r.style.left=n.clientX+"px",r.style.top=n.clientY+"px",r.style.width="0px",r.style.height="0px",a.x=n.clientX,a.y=n.clientY},y=function(e){l.x=Math.max(a.x,e.clientX),l.y=Math.max(a.y,e.clientY),u.x=Math.min(a.x,e.clientX),u.y=Math.min(a.y,e.clientY),r.style.left=u.x+"px",r.style.top=u.y+"px",r.style.width=l.x-u.x+"px",r.style.height=l.y-u.y+"px"},x=function(e){i.enabled=!0,r.parentElement&&r.parentElement.removeChild(r),o.x=e.clientX,o.y=e.clientY;var n=new un.TUj(a,o);g(n),f()},g=function(r){var a=new un.FM8;if(r.getSize(a),!(a.x<5||a.y<5)){var o=new un.FM8((r.max.x+r.min.x)/2,(r.max.y+r.min.y)/2),u=e.domElement.getBoundingClientRect(),l=o.x-u.left,s=o.y-u.top,c=new un.FM8(l/u.width*2-1,-s/u.height*2+1),f=n.children.find((function(e){return"Part"===e.type}));if(f){d.setFromCamera(c,t);var m=d.intersectObject(f);if(m.length){i.target.copy(m[0].point);var h=new un.FM8(a.x/u.width,a.y/u.height),v=1-Math.max(h.x,h.y),p=t.position.distanceTo(i.target)*v,y=i.target.clone().sub(t.position).normalize().multiplyScalar(p);t.position.add(y)}}}};return{dispose:function(){e.domElement.removeEventListener("pointerdown",m),e.domElement.removeEventListener("pointermove",h),e.domElement.removeEventListener("pointerup",v)},end:f,isEnabled:function(){return s},start:function(){s=!0}}}(p.current,m.current,v.current,g.current),w.current=jn(p.current,m.current,v.current,g.current),C.current=function(e){var n=new un.xsS,t=new un.iKG(-1,1,1,-1,2,1);t.position.set(0,0,1);var i=new un.ZAu;n.add(i);var r=function(){n.children.forEach((function(e){return e.children.forEach((function(n){var t=n;"LabelHelper"===t.type&&t.dispose();var i=n;"Sprite"===i.type&&i.dispose(),e.remove(n)}))}))},a=function(n){var t=pn(n.minV),r=pn(n.maxV),a=vn(e,String(t),{position:new un.Pa4(-.62,0,0),width:512,align:"right"});a.scale.x=.4,a.scale.y=2.8;var o=vn(e,String(r),{position:new un.Pa4(.62,0,0),width:512,align:"left"});o.scale.x=.4,o.scale.y=2.8,i.add(a),i.add(o)};return{render:function(){var i=e.domElement.getBoundingClientRect();e.setViewport(i.width/2-350,i.height-50,700,50),e.render(n,t)},setLUT:function(e){r();var n=new Zn.A("rainbow",e.n);n.setMin(e.minV),n.setMax(e.maxV);var t=new un.ROQ(n.createCanvas()),o=new un.xeV({map:t,depthWrite:!1}),u=new un.jyi(o);u.material.rotation=-Math.PI/2,u.scale.x=.2,u.scale.y=1.2,u.dispose=u.material.dispose,i.add(u),a(n)},setVisible:function(e){n.children.forEach((function(n){n.children.forEach((function(n){return n.visible=e}))}))},dispose:function(){r()}}}(p.current),C.current.setVisible(!1),k.current=wn(m.current);var c=function(){g.current.update(),p.current.setViewport(0,0,t,i),p.current.render(m.current,v.current),b.current.update(),x.current.render(),l.render(),s.render(),C.current.render()},d=function(){t=n.clientWidth,i=n.clientHeight,v.current.aspect=t/i,v.current.updateProjectionMatrix(),p.current.setSize(t,i),x.current.setSize(t,i),l.resize({newOffsetWidth:t-155,newOffsetHeight:i-155,newWidth:150,newHeight:150}),s.resize({newOffsetWidth:t-155,newOffsetHeight:i-155,newWidth:150,newHeight:150}),c()},f=function(){c(),requestAnimationFrame(f)};return window.addEventListener("resize",d),e=requestAnimationFrame(f),function(){e&&cancelAnimationFrame(e),e=void 0,window.removeEventListener("resize",d),n.removeChild(p.current.domElement),m.current.children.forEach((function(e){m.current.remove(e)})),l.dispose(),s.dispose(),b.current.dispose(),w.current.dispose(),Z.current.dispose(),C.current.dispose(),k.current.dispose()}}L.push("/webgl")}),[L]),(0,s.useEffect)((function(){var e;m.current&&(m.current.children.find((function(e){return"Part"===e.type&&e.uuid===(null===r||void 0===r?void 0:r.summary.uuid)}))||(m.current.children.forEach((function(e){if("Part"===e.type){var n=e;m.current.remove(n),n.dispose()}})),r?Jn(r,P,m.current,v.current,g.current,{gridHelper:b.current,sectionViewHelper:w.current,colorbarHelper:C.current,pointHelper:k.current},J).catch((function(e){(0,S.lt)(Fn,e),Vn(m.current)})):(Vn(m.current),b.current.update(),null===(e=k.current)||void 0===e||e.build())))}),[r,P,J]),(0,s.useEffect)((function(){if(m.current)if(2===(null===r||void 0===r?void 0:r.summary.dimension)){Vn(m.current);var e=new un.Pa4(0,0,1),n=new un.Pa4(0,1,0),t=new un.Pa4;m.current.boundingBox.getCenter(t);var i=v.current.position.distanceTo(g.current.target),a=e.clone().multiplyScalar(i),o=t.add(a);v.current.position.copy(o),v.current.up.copy(n),g.current.noRotate=!0}else g.current.noRotate=!1}),[r]),(0,s.useEffect)((function(){m.current&&m.current.children.forEach((function(e){if("Part"===e.type&&e.uuid===(null===I||void 0===I?void 0:I.uuid)){var n=e;V?n.startSelection(p.current,v.current,y.current,Y):n.stopSelection()}}))}),[V,I,Y]),(0,s.useEffect)((function(){m.current&&m.current.children.forEach((function(e){if("Part"===e.type&&e.uuid===(null===I||void 0===I?void 0:I.uuid)){var n=e;n.highlight(null===B||void 0===B?void 0:B.uuid);var t=n.getSelected();H.filter((function(e){return!t.find((function(n){return n.uuid===e.uuid}))})).forEach((function(e){e.uuid&&n.select(e.uuid)})),t.filter((function(e){return!H.find((function(n){return n.uuid===e.uuid}))})).forEach((function(e){n.unselect(e.uuid)}))}}))}),[I,B,H]),(0,s.useEffect)((function(){var e;m.current&&(null===(e=k.current)||void 0===e||e.update(W?new un.Pa4(W.x,W.y,W.z):void 0))}),[W]);var q=(0,s.useCallback)((function(e){_(e),m.current.children.forEach((function(n){"Part"===n.type&&n.setTransparent(e)}))}),[]),X=(0,s.useCallback)((function(){var e=!O;M(e),e?w.current.start():w.current.stop()}),[O]);return(0,u.jsxs)(d.Z,{className:"View no-scroll",children:[(0,u.jsx)(d.Z.Header,{className:"View-header",children:(0,u.jsxs)("div",{className:"View-controls-main",children:[(0,u.jsx)(c.Z,{title:"Take snasphot",placement:"right",children:(0,u.jsx)(Ge.Z,{placement:"bottom",overlay:(0,u.jsx)(f.Z,{items:[{key:"project",label:(0,u.jsx)(h.Z,{type:"text",loading:z,onClick:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:A(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,qn(t,m.current,v.current,p.current)];case 2:return e.sent(),[3,4];case 3:return A(!1),[7];case 4:return[2]}}))})),children:"Project snapshot"})},{key:"image",label:(0,u.jsx)(h.Z,{type:"text",loading:D,onClick:function(){F(!0);try{!function(e,n,t,i){try{var r=i.domElement.width,a=i.domElement.height;i.clear(),i.setViewport(0,0,r,a),i.render(n,t);var o=i.domElement.toDataURL(),u=document.createElement("a");u.href=o.replace("image/png","image/octet-stream"),u.download=e.title+"_"+(new Date).toLocaleDateString()+".png",u.click()}catch(l){(0,S.lt)(Un,l)}}(t,m.current,v.current,p.current)}finally{F(!1)}},children:"Export image"})}]}),children:(0,u.jsx)(h.Z,{icon:(0,u.jsx)(qe.Z,{})})})}),(0,u.jsx)(We.Z,{className:"no-margin"}),(0,u.jsx)(c.Z,{title:"Display grid",placement:"right",children:(0,u.jsx)(Ye.Z,{defaultChecked:!0,checkedChildren:(0,u.jsx)(Xe.Z,{}),unCheckedChildren:(0,u.jsx)(Xe.Z,{}),onChange:function(e){return function(e,n){e.setVisible(n)}(b.current,e)}})}),(0,u.jsx)(c.Z,{title:"Set transparency",placement:"right",children:(0,u.jsx)(Ye.Z,{className:"transparent",checked:P,checkedChildren:(0,u.jsx)(Ke.Z,{}),unCheckedChildren:(0,u.jsx)(Ke.Z,{}),onChange:q})}),(0,u.jsx)(We.Z,{className:"no-margin"}),(0,u.jsx)(c.Z,{title:"Zoom out",placement:"right",children:(0,u.jsx)(h.Z,{icon:(0,u.jsx)(Qe.Z,{}),onMouseDown:function(){return Gn(v.current,g.current)},onMouseUp:Wn,onMouseOut:Wn})}),(0,u.jsx)(c.Z,{title:"Zoom to fit",placement:"right",children:(0,u.jsx)(h.Z,{icon:(0,u.jsx)($e.Z,{}),onClick:function(){return Yn(m.current,v.current,g.current)}})}),(0,u.jsx)(c.Z,{title:"Zoom in",placement:"right",children:(0,u.jsx)(h.Z,{icon:(0,u.jsx)(en.Z,{}),onMouseDown:function(){return Hn(v.current,g.current)},onMouseUp:Wn,onMouseOut:Wn})}),(0,u.jsx)(c.Z,{title:"Zoom to selection",placement:"right",children:(0,u.jsx)(h.Z,{icon:(0,u.jsx)(nn.Z,{}),onClick:function(){return Z.current.isEnabled()?Z.current.end():Z.current.start()}})}),(0,u.jsx)(We.Z,{className:"no-margin"}),!O&&(0,u.jsx)(c.Z,{title:"Section view",placement:"right",children:(0,u.jsx)(h.Z,{icon:(0,u.jsx)(tn.Z,{}),onClick:X})}),O&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(c.Z,{title:"Stop",placement:"left",children:(0,u.jsx)(h.Z,{icon:(0,u.jsx)(rn.Z,{}),onClick:X})}),(0,u.jsx)(c.Z,{title:"Hide plane",placement:"left",children:(0,u.jsx)(h.Z,{icon:(0,u.jsx)(an.Z,{}),onClick:function(){return w.current.toggleVisible()}})}),(0,u.jsx)(c.Z,{title:"Snap to X",placement:"left",children:(0,u.jsx)(h.Z,{className:"ant-btn-icon-only",onClick:function(){return w.current.toAxis(new un.Pa4(-1,0,0))},children:"X"})}),(0,u.jsx)(c.Z,{title:"Snap to Y",placement:"left",children:(0,u.jsx)(h.Z,{className:"ant-btn-icon-only",onClick:function(){return w.current.toAxis(new un.Pa4(0,-1,0))},children:"Y"})}),(0,u.jsx)(c.Z,{title:"Snap to Z",placement:"left",children:(0,u.jsx)(h.Z,{className:"ant-btn-icon-only",onClick:function(){return w.current.toAxis(new un.Pa4(0,0,-1))},children:"Z"})}),(0,u.jsx)(c.Z,{title:"Flip",placement:"left",children:(0,u.jsx)(h.Z,{onClick:function(){return w.current.flip()},icon:(0,u.jsx)(on.Z,{})})})]})]})}),(0,u.jsxs)(d.Z.Content,{className:"View-content no-scroll",children:[(0,u.jsx)("div",{style:{display:n?"flex":"none"},className:"View-loading",children:(0,u.jsx)(Je.Z,{indicator:(0,u.jsx)(j.Z,{className:"View-loading-spin",style:{fontSize:80},spin:!0})})}),(0,u.jsx)("div",{ref:a,className:"View-canvas"})]})]})},Kn="Unable to load part",Qn=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),"geometry"!==t?[3,2]:(i=n,[4,me.getPart({id:i.id})]);case 1:case 3:return[2,o.sent()];case 2:return r=n,[4,He.load({id:e.id},{originPath:r.originPath,glb:r.glb})];case 4:return[3,6];case 5:throw a=o.sent(),(0,S.lt)(Kn,a),a;case 6:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),$n=function(e){var n=e.project,t=e.simulation,i=e.geometry,r=e.result,a=e.postprocessing,o=(0,s.useState)(),l=o[0],c=o[1],d=(0,s.useState)(),f=d[0],m=d[1],h=(0,s.useState)(!1),v=h[0],p=h[1];return(0,s.useEffect)((function(){t&&a?a.glb!==(null===f||void 0===f?void 0:f.glb)&&(m(a),p(!0),Qn(t,a,"result").then((function(e){return c(e)})).catch((function(e){})).finally((function(){return p(!1)}))):t&&r?r.glb!==(null===f||void 0===f?void 0:f.glb)&&(m(r),p(!0),Qn(t,r,"result").then((function(e){return c(e)})).catch((function(e){})).finally((function(){return p(!1)}))):i&&i.id!==(null===f||void 0===f?void 0:f.id)&&(m(i),p(!0),i.needCleanup?(c(void 0),p(!1)):Qn(void 0,i,"geometry").then((function(e){return c(e)})).catch((function(e){})).finally((function(){return p(!1)})))}),[t,i,r,a,f]),(0,u.jsx)(Xn,{loading:v,project:{id:n.id,title:n.title},part:l})},et=t(14924),nt=t(32808),tt=t(63463),it=t(5027),rt=t(56299),at=t(18870),ot=t(9253),ut=t(51584),lt=t(14195),st=t(3023),ct=t(75358),dt=t(14888),ft=t(44141),mt=t(96486),ht=t(60877),vt="Unable to download CSV",pt=function(e){var n=e.simulation,t=(0,s.useState)(!1),i=t[0],o=t[1],l=(0,s.useState)(),f=l[0],m=l[1],v=(0,s.useState)(),p=v[0],y=v[1],x=(0,s.useState)(),g=x[0],b=x[1],j=(0,s.useState)(),Z=j[0],w=j[1],k=(0,s.useState)([!0]),E=k[0],_=k[1],N=(0,s.useState)(),O=N[0],M=N[1],T=(0,s.useState)(!1),z=T[0],A=T[1],R=(0,r.Z)(oe.useSimulation(null===n||void 0===n?void 0:n.id),1)[0];return(0,s.useEffect)((function(){var e=null===R||void 0===R?void 0:R.tasks;if(!e)return m(void 0),y(void 0),void b(void 0);var n=e.map((function(e){return e.datas})).filter((function(e){return e})).flatMap((function(e){return e}));if(!n.length||!n[0].names)return y(void 0),void b(void 0);n.sort((function(e,n){return e.x-n.x}));var t=n.map((function(e){return e.names})).flatMap((function(e){return e})).filter((function(e,n,t){return t.findIndex((function(n){return n===e}))===n})),i=t.map((function(e){return(0,mt.camelCase)(e)})),r=[];n.forEach((function(e,n){e.names.forEach((function(t,i){var a=r.find((function(n){return n.x===e.x}));a?a[(0,mt.camelCase)(t)]=e.ys[i]:r.push((0,et.Z)({key:n,x:e.x},(0,mt.camelCase)(t),e.ys[i]))}))})),m(r),y(t),b(i)}),[R]),(0,s.useEffect)((function(){if(f&&p&&g){var e=p.map((function(e,n){return{align:"center",className:"Data-column"+(E[n]?" Data-column-selected":""),title:(0,u.jsxs)(P.Z,{children:[e,(0,u.jsx)(nt.Z,{checked:E[n],onChange:function(e){return _(function(e,n,t){var i=e.target.checked,r=(0,a.Z)(t);return r[n]=i,r}(e,n,E))},children:(0,u.jsx)(rt.Z,{style:{fontSize:20}})})]}),dataIndex:g[n],key:g[n]}}));e.unshift({title:"",dataIndex:"x",key:"x"}),w(e)}else w(void 0)}),[f,p,g,E]),(0,s.useEffect)((function(){var e,n;if(f&&p&&g){var t=[],i=E.map((function(e,n){if(e){var i=g[n],r=p[n];return t.push(i),(0,u.jsx)(at.x,{name:r,type:"monotone",dataKey:i,stroke:ht.Z.stringToColor(i),strokeWidth:2},n)}})).filter((function(e){return e})),r=f.map((function(e){var n={x:e.x};return t.forEach((function(t){e[t]&&(n[t]=e[t])})),n})).filter((function(e){return e})),o=(e=Math).min.apply(e,(0,a.Z)(t.flatMap((function(e){return r.map((function(n){return n[e]}))})))),l=(n=Math).max.apply(n,(0,a.Z)(t.flatMap((function(e){return r.map((function(n){return n[e]}))}))));M({data:r,min:o,max:l,lines:i})}else M(void 0)}),[f,p,g,E]),n&&f&&p&&g?(0,u.jsx)(d.Z,{style:{position:"absolute",zIndex:100,right:50,bottom:25,backgroundColor:"rgba(255, 255, 255, 0)"},children:(0,u.jsxs)(d.Z.Content,{children:[(0,u.jsx)(c.Z,{title:"Data visualization",children:(0,u.jsx)(h.Z,{type:"primary",icon:(0,u.jsx)(rt.Z,{}),onClick:function(){return o(!0)},style:{width:40,height:40,border:"1px solid #5E14FA",borderRadius:20,marginBottom:-20}})}),(0,u.jsx)(tt.Z,{title:"Data visualization",placement:"bottom",closable:!0,onClose:function(){return o(!1)},open:i,mask:!1,maskClosable:!1,height:"50vh",bodyStyle:{height:"100%",overflow:"hidden"},extra:(0,u.jsx)(C.o6,{bordered:!0,loading:z,disabled:!f,onDownload:function(){A(!0);try{!function(e,n,t,i){var r="";r="x,"+t.join(",")+"\n",n.forEach((function(e){r+=e.x,null===i||void 0===i||i.forEach((function(n){void 0!==e[n]&&(r+=","+e[n])})),r+="\n"}));var a=e.name+".csv",o=new File([r],a,{type:"text/csv"}),u=window.URL.createObjectURL(o),l=document.createElement("a");l.href=u,l.setAttribute("download",a),l.click(),l.remove()}(n,f,p,g)}catch(e){(0,S.lt)(vt,e)}finally{A(!1)}},children:"Export CSV"}),children:(0,u.jsxs)("div",{style:{display:"flex",height:"100%",padding:"10px"},children:[(0,u.jsx)("div",{style:{display:"flex",height:"100%",width:"50%",overflow:"auto"},children:(0,u.jsx)(it.Z,{size:"small",dataSource:f,columns:Z,pagination:!1})}),(0,u.jsx)(ot.h,{width:"50%",height:"100%",children:(0,u.jsxs)(ut.w,{data:null===O||void 0===O?void 0:O.data,margin:{top:0,right:40,left:40,bottom:0},children:[(0,u.jsx)(lt.q,{strokeDasharray:"3 3"}),(0,u.jsx)(st.K,{dataKey:"x"}),(0,u.jsx)(ct.B,{domain:[(null===O||void 0===O?void 0:O.min)||-1,(null===O||void 0===O?void 0:O.max)||1]}),(0,u.jsx)(dt.u,{}),(0,u.jsx)(ft.D,{}),null===O||void 0===O?void 0:O.lines]})})]})})]})}):null},yt=t(40038),xt=t(67040),gt=t(80284),bt=t(23389),jt=t(93398),Zt=t(20518),wt=t(4687),Ct=t(14670),St=t(57132),kt="Unable to copy simulation",Et=function(){var e=(0,i.Z)((function(e,n,t){var i,r,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),(i=ht.Z.deepCopy(n.scheme)).configuration.run.done=!1,i.configuration.run.error=void 0,[4,oe.add({id:e.id},{name:n.name+" (copy)",scheme:i})];case 1:return r=o.sent(),t.addOneSimulation(r),t.mutateProject({id:e.id,simulations:(0,a.Z)(e.simulations).concat([r.id])}),[3,3];case 2:return u=o.sent(),(0,S.lt)(kt,u),[3,3];case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Pt=function(e){var n=e.project,t=e.simulation,r=e.swr,a=(0,s.useState)(!1),l=a[0],d=a[1];return(0,u.jsx)(c.Z,{title:"Copy simulation",children:(0,u.jsx)(h.Z,{className:"no-border",loading:l,icon:(0,u.jsx)(St.Z,{}),onClick:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:d(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Et(n,t,r)];case 2:return e.sent(),[3,4];case 3:return d(!1),[7];case 4:return[2]}}))}))})})},_t="Unable to update simulation",Nt=function(){var e=(0,i.Z)((function(e,n,t){var i;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,oe.update({id:e.id},[{key:"name",value:n.name}])];case 1:return r.sent(),t.mutateOneSimulation({id:e.id,name:n.name}),[3,3];case 2:throw i=r.sent(),(0,S.lt)(_t,i),i;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Ot=function(e){var n=e.simulation,t=e.swr,r=(0,s.useState)(!1),a=r[0],l=r[1],c=(0,s.useState)(!1),d=c[0],f=c[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(C.w6,{onEdit:function(){return l(!0)}}),(0,u.jsx)(xe.ZP,{title:"Edit the simulation's name",visible:a,initialValues:{name:n.name},onCancel:function(){return l(!1)},onOk:function(){var e=(0,i.Z)((function(e){var i;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:f(!0),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Nt(n,e,t)];case 2:return r.sent(),f(!1),l(!1),[3,4];case 3:throw i=r.sent(),f(!1),i;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),loading:d,children:(0,u.jsx)(Se.Z.Item,{name:"name",label:"Name:",rules:[{required:!0,message:"Name is required"}],children:(0,u.jsx)(ke.Z,{})})})]})},Mt="Unable to delete simulation",Tt=function(){var e=(0,i.Z)((function(e,n,t){var i,r;return(0,o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,oe.del(n)];case 1:return a.sent(),i=e.simulations.filter((function(e){return e!==n.id})),t.mutateProject({id:e.id,simulations:i}),t.delOneSimulation({id:n.id}),[3,3];case 2:throw r=a.sent(),(0,S.lt)(Mt,r),r;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),zt=function(e){var n=e.project,t=e.simulation,r=e.swr,a=(0,s.useState)(!1),l=a[0],c=a[1];return(0,u.jsx)(C.m1,{loading:l,text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the simulation"," ",(0,u.jsx)(m.Z.Text,{strong:!0,children:t.name}),"?"]}),onDelete:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:c(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Tt(n,t,r)];case 2:return e.sent(),[3,4];case 3:return c(!1),[7];case 4:return[2]}}))}))})},At=function(e){var n=e.project,t=e.simulation,i=e.swr;return n&&t?(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsx)(E.Z,{size:"small",title:(0,u.jsx)(m.Z.Title,{level:5,ellipsis:!0,children:t.name}),actions:[(0,u.jsx)(Pt,{project:{id:n.id,simulations:n.simulations},simulation:t,swr:{mutateProject:i.mutateProject,addOneSimulation:i.addOneSimulation}},"copy"),(0,u.jsx)(Ot,{simulation:{id:t.id,name:t.name},swr:{mutateOneSimulation:i.mutateOneSimulation}},"edit"),(0,u.jsx)(zt,{project:{id:n.id,simulations:n.simulations},simulation:{id:t.id,name:t.name},swr:{mutateProject:i.mutateProject,delOneSimulation:i.delOneSimulation}},"delete")],children:(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[t.scheme.user&&(0,u.jsx)(Ct.Z,{message:"User algorithm",type:"info",showIcon:!0}),(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Category:"})," ",t.scheme.category]}),(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Algorithm:"})," ",t.scheme.algorithm]}),(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Code:"})," ",t.scheme.code]}),(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Version:"})," ",t.scheme.version]}),(0,u.jsx)("div",{className:"full-wdith scroll",children:(0,u.jsx)(pe.Z.Html,{html:t.scheme.description})})]})})})}):(0,u.jsx)(E.Z,{children:(0,u.jsx)(Je.Z,{})})},Rt=function(e){var n=e.label,t=e.className,i=e.defaultValue,r=e.defaultChecked,a=e.onValueChange,o=e.onCheckedChange,l=e.unit,c=(0,s.useState)(String(null!==i&&void 0!==i?i:0)),d=c[0],f=c[1],m=(0,s.useState)(!!r),h=m[0],v=m[1],y=(0,s.useState)(void 0!==r&&!r),x=y[0],g=y[1],b=(0,s.useState)(0),Z=b[0],w=b[1],C=(0,s.useState)(!1),S=C[0],k=C[1];(0,s.useEffect)((function(){f(String(null!==i&&void 0!==i?i:0))}),[i]),(0,s.useEffect)((function(){v(!!r)}),[r]);var E=(0,s.useCallback)((function(e){var n=e.target.checked;v(n),k(!0),null===o||void 0===o||o(n),g(!n)}),[o]),_=(0,s.useCallback)((function(e){Z&&clearTimeout(Z);var n=setTimeout((function(){a(e),k(!1)}),500);w(+n)}),[Z,a]),N=(0,s.useCallback)((function(e){var n=e.target.value;f(n),k(!0),_(n)}),[_]);return(0,u.jsx)(P.Z,{className:"full-width space-full-width "+t,align:"start",children:(0,u.jsx)(Se.Z,{layout:"vertical",children:(0,u.jsx)(Se.Z.Item,{label:(0,u.jsxs)(u.Fragment,{children:[void 0!==r&&(0,u.jsx)(nt.Z,{checked:h,onChange:E,style:{marginRight:"5px"}}),n]}),children:(0,u.jsx)(ke.Z,{disabled:x,value:d,onChange:N,addonAfter:(0,u.jsxs)(P.Z,{className:"full-width",children:[(0,u.jsx)(pe.Z.Inline,{text:l}),S?(0,u.jsx)(j.Z,{spin:!0,className:"color-orange"}):(0,u.jsx)(p.Z,{className:"color-green"})]})})})})})},Dt="Unable to update simulation",Ft=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(i=ht.Z.deepCopy(e)).scheme.configuration.geometry.meshParameters={type:n,value:"auto"===n?"normal":"1"},r=(0,T.Z)((0,M.Z)({},i.scheme.configuration.geometry),{done:!0}),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","geometry"],value:r}])];case 1:return o.sent(),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:(0,T.Z)((0,M.Z)({},i.scheme.configuration.run),{done:!1})}])];case 2:return o.sent(),t.mutateOneSimulation(i),[3,4];case 3:throw a=o.sent(),(0,S.lt)(Dt,a),a;case 4:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Lt=function(){var e=(0,i.Z)((function(e,n,t,i){var r,a,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(r=ht.Z.deepCopy(e)).scheme.configuration.geometry.meshParameters=(0,T.Z)((0,M.Z)({},r.scheme.configuration.geometry.meshParameters),{type:n,value:t}),a=(0,T.Z)((0,M.Z)({},r.scheme.configuration.geometry),{done:!0}),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","geometry"],value:a}])];case 1:return o.sent(),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:(0,T.Z)((0,M.Z)({},r.scheme.configuration.run),{done:!1})}])];case 2:return o.sent(),i.mutateOneSimulation(r),[3,4];case 3:throw u=o.sent(),(0,S.lt)(Dt,u),u;case 4:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),Ut=function(e){var n=e.simulation,t=e.swr,r=(0,s.useState)(),a=r[0],l=r[1],c=(0,s.useState)(),d=c[0],f=c[1];(0,s.useEffect)((function(){var e=n.scheme.configuration.geometry.meshParameters;e?(l(e.type),f(e.value)):(l("auto"),f("normal"))}),[n]);var m=(0,s.useCallback)(function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Lt(n,a,e,t)];case 1:return i.sent(),f(e),[3,3];case 2:return i.sent(),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),[n,a,t]);return(0,u.jsx)(E.Z,{size:"small",title:"Mesh refinement",children:(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(Se.Z,{layout:"vertical",children:(0,u.jsx)(Se.Z.Item,{label:"Type",children:(0,u.jsxs)(yt.Z,{className:"full-width",value:a,onChange:function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Ft(n,e,t)];case 1:return i.sent(),l(e),f("auto"===e?"normal":"1"),[3,3];case 2:return i.sent(),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:[(0,u.jsx)(yt.Z.Option,{value:"auto",children:"Automatic"}),(0,u.jsx)(yt.Z.Option,{value:"manual",children:"Manual"})]})})}),"auto"===a&&(0,u.jsx)(Se.Z,{layout:"vertical",children:(0,u.jsx)(Se.Z.Item,{label:"Size",children:(0,u.jsxs)(yt.Z,{className:"full-width",value:d,onChange:m,children:[(0,u.jsx)(yt.Z.Option,{value:"veryfine",children:"Very fine"}),(0,u.jsx)(yt.Z.Option,{value:"fine",children:"Fine"}),(0,u.jsx)(yt.Z.Option,{value:"normal",children:"Normal"}),(0,u.jsx)(yt.Z.Option,{value:"coarse",children:"Coarse"}),(0,u.jsx)(yt.Z.Option,{value:"verycoarse",children:"Very coarse"})]})})}),"manual"===a&&(0,u.jsx)(Rt,{label:"Size",defaultValue:d,onValueChange:m,unit:"m"})]})})},Vt="Unable to update simulation",It=function(){var e=(0,i.Z)((function(e,n,t,i,r){var a,u,l,s,c;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),(a=ht.Z.deepCopy(e)).scheme.configuration.geometry.value=t.id,l=(0,T.Z)((0,M.Z)({},a.scheme.configuration),{dimension:null!==(u=t.summary.dimension)&&void 0!==u?u:3,geometry:(0,T.Z)((0,M.Z)({},a.scheme.configuration.geometry),{done:!0}),run:(0,T.Z)((0,M.Z)({},a.scheme.configuration.run),{done:!1})}),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration"],value:l}])];case 1:return o.sent(),r.mutateOneSimulation(a),s=n.find((function(e){return e.id===t.id})),i(s),[3,3];case 2:return c=o.sent(),(0,S.lt)(Vt,c),[3,3];case 3:return[2]}}))}));return function(n,t,i,r,a){return e.apply(this,arguments)}}(),Bt=function(e){var n=e.geometries,t=e.geometry,i=e.simulation,r=e.setGeometry,a=e.swr;!i.scheme.configuration.geometry.value&&t&&It(i,n,t,r,a);var o=n.map((function(e){return(0,u.jsx)("div",{className:"Geometry-list",style:{backgroundColor:e.id===(null===t||void 0===t?void 0:t.id)?"#FFFBE6":"#FAFAFA"},onClick:function(){return It(i,n,e,r,a)},children:(0,u.jsx)(m.Z.Text,{children:e.name})},e.id)}));return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(E.Z,{size:"small",children:(0,u.jsx)(m.Z.Text,{children:"When changing the simulation domain, you might lose your topological entity assignments"})}),(0,u.jsx)(E.Z,{size:"small",children:(0,u.jsx)(m.Z.Text,{strong:!0,children:"Select a simulation domain"})}),o,i.scheme.configuration.geometry.meshable&&(0,u.jsx)(Ut,{simulation:{id:i.id,scheme:i.scheme},swr:{mutateOneSimulation:a.mutateOneSimulation}})]})},Ht="Unable to delete material",Gt=function(){var e=(0,i.Z)((function(e,n,t,i){var r,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=ht.Z.deepCopy(e),u=r.scheme.configuration.materials,u.values[n].selected.forEach((function(e){t(An(e))})),u.values=(0,a.Z)(u.values.slice(0,n)).concat((0,a.Z)(u.values.slice(n+1))),l=(0,T.Z)((0,M.Z)({},u),{done:!!u.values.length}),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:l}])];case 1:return o.sent(),i.mutateOneSimulation(r),[3,3];case 2:throw s=o.sent(),(0,S.lt)(Ht,s),s;case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),Wt=function(e){var n=e.simulation,t=e.index,r=e.swr,a=(0,s.useState)(!1),l=a[0],c=a[1],d=(0,s.useContext)(G).dispatch,f=n.scheme.configuration.materials.values[t];return(0,u.jsx)(C.m1,{loading:l,text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the material"," ",(0,u.jsx)(m.Z.Text,{strong:!0,children:f.material.label})]}),onDelete:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:c(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Gt(n,t,d,r)];case 2:return e.sent(),[3,4];case 3:return c(!1),[7];case 4:return[2]}}))}))})},Yt=function(e){var n,t=e.simulation,i=e.swr,r=e.onEdit,a=(0,s.useState)(!0),o=a[0],l=a[1],c=t.scheme.configuration.materials,d=(0,s.useContext)(G).dispatch,f=(0,s.useCallback)((function(e){d(_n());var n=c.values[e].selected;null===n||void 0===n||n.forEach((function(e){d(zn(e))}))}),[c,d]),h=(0,s.useCallback)((function(){d(Nn())}),[d]);return(0,u.jsx)(u.Fragment,{children:null===(n=c.values)||void 0===n?void 0:n.map((function(e,n){return(0,u.jsx)(E.Z,{className:"material-item text-center",hoverable:!0,onMouseEnter:function(){return f(n)},onMouseLeave:function(){o&&h()},actions:[(0,u.jsx)(C.w6,{onEdit:function(){l(!1),r(n),setTimeout((function(){return l(!0)}),500)}},"edit"),(0,u.jsx)(Wt,{index:n,simulation:{id:t.id,scheme:t.scheme},swr:{mutateOneSimulation:i.mutateOneSimulation}},"delete")],children:(0,u.jsx)(m.Z.Text,{strong:!0,className:"text-center",children:e.material.label})},n)})).filter((function(e){return e}))})},Jt=t(20550),qt=t(13982),Xt=t(14618),Kt=t(94668),Qt=t(68795),$t=function(e){var n,t=e.geometry,i=e.alreadySelected,r=e.updateSelected,a=(0,s.useState)([]),o=a[0],l=a[1],d=(0,s.useState)(),f=d[0],v=d[1],p=(0,s.useState)(),y=p[0],x=p[1],g=(0,s.useContext)(G),b=g.type,j=g.highlighted,Z=g.selected,w=g.dispatch;(0,s.useEffect)((function(){r(Z)}),[r,Z]),(0,s.useEffect)((function(){var e,n=[];b&&(null===(e=t.summary[b])||void 0===e||e.forEach((function(e){e.color&&(n.find((function(n){return n.r===e.color.r&&n.g===e.color.g&&n.b===e.color.b}))||n.push(e.color))}))),l(n)}),[t,b]);var C=function(){w(Tn())},S=(0,s.useCallback)((function(e){v(e)}),[]),k=(0,s.useCallback)((function(e){var n=e.target.value;x(n)}),[]),_=(0,s.useCallback)((function(e){var n,t,i;return(!f||f.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&f.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&f.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&!(y&&e.name&&!e.name.includes(y))}),[f,y]);return(0,u.jsxs)(E.Z,{size:"small",className:"no-border-bottom",children:[(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(m.Z.Text,{strong:!0,children:"Filters"}),(0,u.jsxs)(P.Z,{direction:"horizontal",wrap:!0,children:[o.length>1&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(c.Z,{title:"Reset",children:(0,u.jsx)(h.Z,{icon:(0,u.jsx)(he.Z,{}),onClick:function(){return S()}})}),o.map((function(e){return(0,u.jsx)(c.Z,{title:"Color",children:(0,u.jsx)(h.Z,{style:{backgroundColor:ht.Z.rgbToHex(e)},onClick:function(){return S(e)},children:" "})},JSON.stringify(e))}))]}),(0,u.jsx)(c.Z,{title:"Select all",children:(0,u.jsx)(h.Z,{icon:(0,u.jsx)(qt.Z,{}),onClick:function(){var e;null===(e=t.summary[b])||void 0===e||e.forEach((function(e){var n,t,i;(!f||f&&f.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&f.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&f.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&w(zn({uuid:e.uuid,label:e.label}))}))}})}),(0,u.jsx)(c.Z,{title:"Unselect all",children:(0,u.jsx)(h.Z,{icon:(0,u.jsx)(Xt.Z,{}),onClick:function(){var e;null===(e=t.summary[b])||void 0===e||e.forEach((function(e){var n,t,i;(!f||f&&f.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&f.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&f.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&w(An({uuid:e.uuid,label:e.label}))}))}})}),(0,u.jsx)(c.Z,{title:"Swap",children:(0,u.jsx)(h.Z,{icon:(0,u.jsx)(Kt.Z,{}),onClick:function(){var e;null===(e=t.summary[b])||void 0===e||e.forEach((function(e){var n,t,i;(!f||f&&f.r===(null===(n=e.color)||void 0===n?void 0:n.r)&&f.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&f.b===(null===(i=e.color)||void 0===i?void 0:i.b))&&Z.find((function(n){return n.uuid===e.uuid}))?w(An({uuid:e.uuid,label:e.label})):w(zn({uuid:e.uuid,label:e.label}))}))}})})]}),(0,u.jsx)(ke.Z,{placeholder:"Search",value:y,onChange:k,suffix:(0,u.jsx)(Qt.Z,{className:"text-light"})})]}),(0,u.jsx)("div",{className:"full-width marginTop-20",children:b?null===(n=t.summary[b])||void 0===n?void 0:n.map((function(e,n){if(_(e)){var t="transparent",r="transparent";return Z.find((function(n){return n.uuid===e.uuid}))&&(null===j||void 0===j?void 0:j.uuid)!==e.uuid?(t="#FAD114",r="rgba(255, 251, 230, 0.3)"):(null===j||void 0===j?void 0:j.uuid)===e.uuid&&(t="#FAD114",r="#FFFBE6"),(0,u.jsx)(E.Z,{className:"marginBottom-10",bodyStyle:{position:"relative",padding:"10px 10px 10px 40px",borderWidth:"2px",borderStyle:"solid",borderColor:t,backgroundColor:r},onMouseEnter:function(){return n={uuid:e.uuid,label:e.label},void w(Mn(n));var n},onMouseLeave:C,onClick:function(){return n={uuid:e.uuid,label:e.label},void(Z.find((function(e){return e.uuid===n.uuid}))?w(An(n)):w(zn(n)));var n},children:(0,u.jsxs)(P.Z,{direction:"vertical",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{position:"absolute",left:"-2px",top:"-2px",bottom:"-2px",width:"30px",backgroundColor:ht.Z.rgbToRgba(e.color,1)}}),e.name]}),null===i||void 0===i?void 0:i.map((function(n){if(n.selected.find((function(n){return n.uuid===e.uuid})))return(0,u.jsx)(Jt.Z,{color:ht.Z.stringToColor(n.label),children:n.label},e.uuid)}))]})},n)}})):[]})]})},ei=t(95507),ni=t(13520),ti=t(47403),ii=function(e){var n=e.onSelect,t=(0,s.useState)(),i=t[0],r=t[1],a=(0,s.useState)(),o=a[0],l=a[1],c=(0,s.useState)(),m=c[0],v=c[1],p=(0,s.useState)(),y=p[0],x=p[1],g=Object.keys(ti.E),b=(0,s.useCallback)((function(e){var n=e.key,t=ti.E[n];l({key:n,children:t.children}),v(void 0),x(void 0)}),[]),j=(0,s.useCallback)((function(e){var n=e.key,t=ti.E[o.key].children.find((function(e){return e.key===n}));v({key:n}),x(t)}),[o]),Z=(0,s.useCallback)((function(e){n(e),r(!1)}),[n]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(h.Z,{icon:(0,u.jsx)(ni.Z,{}),onClick:function(){return r(!0)},className:"full-width",children:"Pick a material"}),(0,u.jsx)(xt.Z,{open:i,title:"Material database",onCancel:function(){return r(!1)},onOk:function(){return Z(y)},okText:"Choose",okButtonProps:{disabled:!y},width:"50%",children:(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsxs)(P.Z,{style:{alignItems:"stretch"},children:[(0,u.jsx)(f.Z,{mode:"inline",items:g.map((function(e){return{key:e,label:ti.E[e].label}})),onClick:b}),(0,u.jsx)(f.Z,{mode:"inline",items:null===o||void 0===o?void 0:o.children.map((function(e){return{key:e.key,label:e.label}})),selectedKeys:(null===m||void 0===m?void 0:m.key)?[null===m||void 0===m?void 0:m.key]:[],onClick:j}),y&&(0,u.jsx)(ei.ZP,{itemLayout:"vertical",children:y.children.map((function(e){return(0,u.jsxs)(ei.ZP.Item,{children:[e.label,": ",e.symbol," = ",e.value]},e.label)}))})]})})})})]})},ri="You need to define a material",ai="You need to select a solid",oi="Unable to add material",ui=function(){var e=(0,i.Z)((function(e,n,t){var i,r,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(i=ht.Z.deepCopy(n)).uuid=(0,ln.Z)(),r=ht.Z.deepCopy(e),(u=r.scheme.configuration.materials).values=(0,a.Z)(u.values||[]).concat([i]),l=(0,T.Z)((0,M.Z)({},u),{done:!0}),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:l}])];case 1:return o.sent(),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:(0,T.Z)((0,M.Z)({},r.scheme.configuration.run),{done:!1})}])];case 2:return o.sent(),t.mutateOneSimulation(r),[3,4];case 3:throw s=o.sent(),(0,S.lt)(oi,s),s;case 4:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),li=function(e){var n=e.simulation,t=e.material,r=e.swr,a=e.onError,l=e.onClose,c=(0,s.useState)(!1),d=c[0],f=c[1];return(0,u.jsx)(C.HS,{loading:d,needMargin:!0,onAdd:(0,i.Z)((function(){var e;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:f(!0),i.label=1;case 1:return i.trys.push([1,3,,4]),t.material?(null===(e=t.selected)||void 0===e?void 0:e.length)?(a(),[4,ui(n,t,r)]):(a(ai),f(!1),[2]):(a(ri),f(!1),[2]);case 2:return i.sent(),f(!1),l(),[3,4];case 3:return i.sent(),f(!1),[3,4];case 4:return[2]}}))})),children:"Add"})},si="You need to define a material",ci="You need to select a solid",di="Unable to edit material",fi=function(){var e=(0,i.Z)((function(e,n,t){var i,r,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=ht.Z.deepCopy(e),r=i.scheme.configuration.materials,u=r.values.findIndex((function(e){return e.uuid===n.uuid})),r.values=(0,a.Z)(r.values.slice(0,u)).concat([n],(0,a.Z)(r.values.slice(u+1))),l=(0,M.Z)({},r),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:l}])];case 1:return o.sent(),t.mutateOneSimulation(i),[3,3];case 2:throw s=o.sent(),(0,S.lt)(di,s),s;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),mi=function(e){var n=e.simulation,t=e.material,r=e.swr,a=e.onError,l=e.onClose,c=(0,s.useState)(!1),d=c[0],f=c[1];return(0,u.jsx)(C.w6,{loading:d,primary:!0,needMargin:!0,onEdit:(0,i.Z)((function(){var e;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:f(!0),i.label=1;case 1:return i.trys.push([1,3,,4]),t.material?(null===(e=t.selected)||void 0===e?void 0:e.length)?(a(),[4,fi(n,t,r)]):(a(ci),f(!1),[2]):(a(si),f(!1),[2]);case 2:return i.sent(),f(!1),l(),[3,4];case 3:return i.sent(),f(!1),[3,4];case 4:return[2]}}))})),children:"Edit"})},hi=function(e){var n,t,i=e.visible,r=e.geometry,o=e.simulation,l=e.material,c=e.swr,d=e.onClose,f=(0,s.useState)(),v=f[0],p=f[1],y=(0,s.useState)(),g=y[0],b=y[1],j=(0,s.useState)(),Z=j[0],w=j[1],S=o.scheme.configuration.materials;(0,s.useEffect)((function(){!i&&g&&b(void 0)})),(0,s.useEffect)((function(){i&&!g&&l&&b(l)}),[g,i,l]),(0,s.useEffect)((function(){var e,n=null===S||void 0===S||null===(e=S.values)||void 0===e?void 0:e.map((function(e){if(e.uuid!==(null===l||void 0===l?void 0:l.uuid))return{label:e.material.label,selected:e.selected}})).filter((function(e){return e}));p(n||[])}),[o,l,S]);var k,_,N,O,z=(0,s.useCallback)((function(e){b((function(n){return(0,T.Z)((0,M.Z)({},n),{material:e})}))}),[]),A=(0,s.useCallback)((function(e){b((function(n){return(0,T.Z)((0,M.Z)({},n),{selected:e})}))}),[]),R=(0,s.useCallback)((function(e,n,t){b((function(i){var r,o,u,l;return(0,T.Z)((0,M.Z)({},i),{material:{label:"Custom",children:(0,a.Z)((null===i||void 0===i||null===(r=i.material)||void 0===r||null===(o=r.children)||void 0===o?void 0:o.slice(0,n))||[]).concat([{label:e.label,symbol:e.name,value:t}],(0,a.Z)((null===i||void 0===i||null===(u=i.material)||void 0===u||null===(l=u.children)||void 0===l?void 0:l.slice(n+1))||[]))}})}))}),[]);return(0,u.jsx)(tt.Z,{className:"material",title:"Material",placement:"left",closable:!1,open:i,mask:!1,maskClosable:!1,width:300,extra:(0,u.jsx)(h.Z,{type:"text",icon:(0,u.jsx)(he.Z,{}),onClick:function(){b(void 0),d()}}),footer:(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,u.jsx)(C.Lw,{onCancel:function(){b(void 0),d()}}),l?(0,u.jsx)(mi,{material:{uuid:null!==(k=null===g||void 0===g?void 0:g.uuid)&&void 0!==k?k:l.uuid,material:null!==(_=null===g||void 0===g?void 0:g.material)&&void 0!==_?_:l.material,selected:null!==(N=null===g||void 0===g?void 0:g.selected)&&void 0!==N?N:l.selected},simulation:{id:o.id,scheme:o.scheme},swr:{mutateOneSimulation:c.mutateOneSimulation},onError:function(e){return w(e)},onClose:d}):(0,u.jsx)(li,{material:{material:null===g||void 0===g?void 0:g.material,selected:null===g||void 0===g?void 0:g.selected},simulation:{id:o.id,scheme:o.scheme},swr:{mutateOneSimulation:c.mutateOneSimulation},onError:function(e){return w(e)},onClose:d})]}),children:(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(E.Z,{size:"small",children:(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(ii,{onSelect:z}),(0,u.jsxs)(m.Z.Text,{children:["Material: ",null!==(O=null===g||void 0===g||null===(n=g.material)||void 0===n?void 0:n.label)&&void 0!==O?O:"default"]}),null===S||void 0===S||null===(t=S.children)||void 0===t?void 0:t.map((function(e,n){var t,i,r=null===g||void 0===g||null===(t=g.material)||void 0===t||null===(i=t.children)||void 0===i?void 0:i.find((function(n){return n.symbol===e.name}));return(0,u.jsx)(Rt,{label:e.name,defaultValue:r?r.value:String(e.default),unit:e.unit,onValueChange:function(t){R(e,n,t)}},e.name)}))]})}),(0,u.jsx)($t,{geometry:r,alreadySelected:v,updateSelected:A}),Z&&(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)(x.Z,{style:{color:"red"}})," ",Z]})]})})},vi=function(e){var n=e.geometry,t=e.simulation,i=e.swr,r=e.setVisible,a=(0,s.useState)(),o=a[0],l=a[1],c=(0,s.useState)(!1),f=c[0],m=c[1],h=(0,s.useContext)(G).dispatch,v=t.scheme.configuration.materials;(0,s.useEffect)((function(){(null===n||void 0===n?void 0:n.summary)&&h(On(2===n.summary.dimension?"faces":"solids"))}),[n,h]);var p=(0,s.useCallback)((function(){l(void 0),m(!0),r(!1),h(_n())}),[h,r]),y=(0,s.useCallback)((function(e){var n=v.values[e];l(n),m(!0),r(!1),h(_n())}),[v,h,r]),x=(0,s.useCallback)((function(){h(Nn()),m(!1),l(void 0),r(!0)}),[h,r]);return n?(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsxs)(E.Z,{size:"small",children:[(0,u.jsx)(C.HS,{onAdd:p,fullWidth:!0,primary:!1,children:"Add material"}),(0,u.jsx)(Yt,{simulation:{id:t.id,scheme:t.scheme},swr:i,onEdit:y}),(0,u.jsx)(hi,{visible:f,geometry:{summary:n.summary},simulation:{id:t.id,scheme:t.scheme},material:o&&{uuid:o.uuid,material:o.material,selected:o.selected},swr:{mutateOneSimulation:i.mutateOneSimulation},onClose:x})]})})}):(0,u.jsx)(k.Z.Simple,{})},pi=t(54907),yi="Unable to update simulation",xi=function(){var e=(0,i.Z)((function(e,n){var t,i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),t=ht.Z.deepCopy(e),i=t.scheme.configuration.parameters,r=(0,T.Z)((0,M.Z)({},i),{done:!0}),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","parameters"],value:r}])];case 1:return o.sent(),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:(0,T.Z)((0,M.Z)({},t.scheme.configuration.run),{done:!1})}])];case 2:return o.sent(),n.mutateOneSimulation(t),[3,4];case 3:return a=o.sent(),(0,S.lt)(yi,a),[3,4];case 4:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),gi=function(){var e=(0,i.Z)((function(e,n,t,i,r){var a,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),a=ht.Z.deepCopy(e),u=a.scheme.configuration.parameters,u[n].children[t].value=i,l=(0,T.Z)((0,M.Z)({},u),{done:!0}),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","parameters"],value:l}])];case 1:return o.sent(),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:(0,T.Z)((0,M.Z)({},a.scheme.configuration.run),{done:!1})}])];case 2:return o.sent(),r.mutateOneSimulation(a),[3,4];case 3:return s=o.sent(),(0,S.lt)(yi,s),[3,4];case 4:return[2]}}))}));return function(n,t,i,r,a){return e.apply(this,arguments)}}(),bi=function(e){var n=e.simulation,t=e.swr,i=null===n||void 0===n?void 0:n.scheme.configuration.parameters,r=null===n||void 0===n?void 0:n.scheme.configuration.dimension;(0,s.useEffect)((function(){(null===i||void 0===i?void 0:i.done)||xi(n,t)}),[n,i,t]);var a=[],o=[];return 2===r?Object.keys(i).forEach((function(e){if("index"!==e&&"title"!==e&&"done"!=e){var r=i[e],l=null===r||void 0===r?void 0:r.children.map((function(i,r){if(!i.only3D)return"formula"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(Rt,{label:n.label2D||n.label,defaultValue:null!==(Re=n.value)&&void 0!==Re?Re:n.default,onValueChange:t,unit:n.unit},e)}(e+"&"+r,i,(function(i){return gi(n,e,r,i,t)})):"select"===i.htmlEntity?function(e,n,t){var i;return(0,u.jsx)(Se.Z,{layout:"vertical",children:(0,u.jsx)(Se.Z.Item,{label:n.label2D||n.label,children:(0,u.jsx)(yt.Z,{options:null===(i=n.options)||void 0===i?void 0:i.map((function(e){return{label:e.label,value:null!==(De=e.value2D)&&void 0!==De?De:e.value}})),defaultValue:n.value||n.default2D||n.default,onChange:t})})},e)}(e+"&"+r,i,(function(i){return gi(n,e,r,i,t)})):"checkbox"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(Se.Z,{layout:"horizontal",children:(0,u.jsx)(Se.Z.Item,{label:n.label2D||n.label,children:(0,u.jsx)(nt.Z,{defaultChecked:n.value,onChange:t})})},e)}(e+"&"+r,i,(function(i){return gi(n,e,r,i.target.checked,t)})):void 0}));(null===r||void 0===r?void 0:r.advanced)?o.push((0,u.jsx)(E.Z,{size:"small",title:null===r||void 0===r?void 0:r.label,children:(0,u.jsx)(P.Z,{direction:"vertical",children:l})},e)):a.push((0,u.jsx)(E.Z,{size:"small",title:null===r||void 0===r?void 0:r.label,children:(0,u.jsx)(P.Z,{direction:"vertical",children:l})},e))}})):Object.keys(i).forEach((function(e){if("index"!==e&&"title"!==e&&"done"!=e){var r=i[e],l=null===r||void 0===r?void 0:r.children.map((function(i,r){return"formula"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(Rt,{label:n.label,defaultValue:null!==(Fe=n.value)&&void 0!==Fe?Fe:n.default,onValueChange:t,unit:n.unit},e)}(e+"&"+r,i,(function(i){return gi(n,e,r,i,t)})):"select"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(Se.Z,{layout:"vertical",children:(0,u.jsx)(Se.Z.Item,{label:n.label,children:(0,u.jsx)(yt.Z,{options:n.options,defaultValue:n.value||n.default,onChange:t})})},e)}(e+"&"+r,i,(function(i){return gi(n,e,r,i,t)})):"checkbox"===i.htmlEntity?function(e,n,t){return(0,u.jsx)(Se.Z,{layout:"horizontal",children:(0,u.jsx)(Se.Z.Item,{label:n.label,children:(0,u.jsx)(nt.Z,{defaultChecked:n.value,onChange:t})})},e)}(e+"&"+r,i,(function(i){return gi(n,e,r,i.target.checked,t)})):void 0}));(null===r||void 0===r?void 0:r.advanced)?o.push((0,u.jsx)(E.Z,{size:"small",title:null===r||void 0===r?void 0:r.label,children:(0,u.jsx)(P.Z,{direction:"vertical",children:l})},e)):a.push((0,u.jsx)(E.Z,{size:"small",title:null===r||void 0===r?void 0:r.label,children:(0,u.jsx)(P.Z,{direction:"vertical",children:l})},e))}})),(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsxs)(P.Z,{direction:"vertical",children:[a,(0,u.jsx)(pi.Z,{children:(0,u.jsx)(pi.Z.Panel,{header:"Advanced",children:(0,u.jsx)(P.Z,{direction:"vertical",children:o})},"advanced")})]})})})},ji=function(e,n){return e.map((function(e){var t=e.fileName.replace(new RegExp(n.prefixPattern),"").replace(new RegExp(n.suffixPattern),"");return(0,T.Z)((0,M.Z)({},e),{number:+t})}))},Zi=function(e,n){var t=n.multiplicator;if(t){var i,r=t.reduce((function(e,n){return e[n]}),e);return null!==(i=r.value)&&void 0!==i?i:r.default}},wi="Unable to update simulation",Ci=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=ht.Z.deepCopy(e),(r=i.scheme.configuration.initialization).value={type:n},[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:r}])];case 1:return o.sent(),t.mutateOneSimulation(i),[3,3];case 2:throw a=o.sent(),(0,S.lt)(wi,a),a;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Si=function(){var e=(0,i.Z)((function(e,n,t,i){var r,a,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Pi(e,t)];case 1:return a=o.sent(),u=ht.Z.deepCopy(n),(l=u.scheme.configuration.initialization).value=(0,T.Z)((0,M.Z)({},l.value),{simulation:t,result:null===a||void 0===a||null===(r=a[0])||void 0===r?void 0:r.value}),[4,oe.update({id:n.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:l}])];case 2:return o.sent(),i.mutateOneSimulation(u),[3,4];case 3:throw s=o.sent(),(0,S.lt)(wi,s),s;case 4:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),ki=function(){var e=(0,i.Z)((function(e,n,t,i){var r,a,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=ht.Z.deepCopy(e),(a=r.scheme.configuration.initialization).value=(0,T.Z)((0,M.Z)({},a.value),{number:+n,result:t.file}),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:a}])];case 1:return o.sent(),i.mutateOneSimulation(r),[3,3];case 2:return u=o.sent(),(0,S.lt)(wi,u),[3,3];case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),Ei=function(){var e=(0,i.Z)((function(e,n,t,i){var r,a,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=ht.Z.deepCopy(e),(a=r.scheme.configuration.initialization).value.values||(a.value.values=[]),a.value.values[n]=t,[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:a}])];case 1:return o.sent(),i.mutateOneSimulation(r),[3,3];case 2:return u=o.sent(),(0,S.lt)(wi,u),[3,3];case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),Pi=function(){var e=(0,i.Z)((function(e,n){var t,i,r,u,l,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,oe.tasks({id:n})];case 1:return i=o.sent(),r=e.find((function(e){return e.id===n})),u=r.scheme.configuration,l=null===u||void 0===u||null===(t=u.run)||void 0===t?void 0:t.resultsFilter,s=[],i.forEach((function(e){if(e.file&&"result"===e.file.type&&s.push({label:e.file.fileName,value:e.file.fileName,file:e.file.fileName}),e.files)if(l){var n,t,i=new RegExp(l.pattern),r=e.files.filter((function(e){return!i.test(e.fileName)})).filter((function(e){return"result"===e.type})),o=e.files.filter((function(e){return i.test(e.fileName)})),c=ji(o,l).map((function(e){return{number:e.number,fileName:e.fileName.replace(new RegExp(l.suffixPattern),"")}})).filter((function(e,n,t){return t.findIndex((function(n){return n.number===e.number}))===n})).sort((function(e,n){return e.number-n.number})),d=Zi(u,l),f=c.map((function(e,n){var t=d?e.number*d:n,i=Math.round(1e15*t)/1e15;return{label:String(i),value:e.fileName,file:e.fileName}}));(n=s).push.apply(n,(0,a.Z)(r.map((function(e){return{label:e.fileName,value:e.fileName,file:e.fileName}})).filter((function(e){return e})))),(t=s).push.apply(t,(0,a.Z)(f))}else e.files.forEach((function(e){"result"===e.type&&s.push({label:e.fileName,value:e.fileName,file:e.fileName})}))})),[2,s]}}))}));return function(n,t){return e.apply(this,arguments)}}(),_i=function(e){var n=e.simulations,t=e.simulation,r=e.swr,a=(0,s.useState)(!1),l=a[0],c=a[1],f=(0,s.useState)(),h=f[0],v=f[1],p=(0,s.useState)(),y=p[0],x=p[1],g=(0,s.useState)(),b=g[0],j=g[1],Z=null===t||void 0===t?void 0:t.scheme.configuration.initialization,w=null===t||void 0===t?void 0:t.scheme.configuration.dimension,C=(0,s.useCallback)((function(e){var t=n.find((function(n){return n.id===e}));x(t)}),[n]);(0,s.useEffect)((function(){var e,n;!h&&Z.value&&v(Z.value.type),!y&&(null===(e=Z.value)||void 0===e?void 0:e.simulation)&&C(null===(n=Z.value)||void 0===n?void 0:n.simulation)}),[Z,h,y,C]),(0,s.useEffect)((function(){y&&Pi(n,y.id).then((function(e){return j(e)}))}),[n,y]);var S=[{label:"None",value:"none"}];Z.coupling&&S.push({label:Z.coupling.label,value:"coupling"}),Z.direct&&S.push({label:Z.direct.label,value:"direct"});var k={none:(0,u.jsx)("div",{})},_=Z.value,N=Z.coupling;if(null===N||void 0===N?void 0:N.compatibility){var O=n.map((function(e){var n=e.id===t.id||!N.compatibility.find((function(n){return n.algorithm===e.scheme.algorithm}));return{label:e.name,value:e.id,disabled:n}})),M=N.compatibility.find((function(e){var n;return e.algorithm===(null===y||void 0===y||null===(n=y.scheme)||void 0===n?void 0:n.algorithm)})),T=null===M||void 0===M?void 0:M.filter;k.coupling=function(e,a){return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(m.Z.Text,{children:"If you use coupling, the selected simulation mesh will be used, at least for the first iteration."}),(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width marginTop-10",children:[(0,u.jsx)(yt.Z,{className:"full-width",options:e,placeholder:"Select a simulation",value:null===_||void 0===_?void 0:_.simulation,onChange:function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(i){switch(i.label){case 0:c(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,Si(n,t,e,r)];case 2:return i.sent(),C(e),[3,5];case 3:return i.sent(),[3,5];case 4:return c(!1),[7];case 5:return[2]}}))}));return function(n){return e.apply(this,arguments)}}()}),l&&(0,u.jsx)(Je.Z,{}),(null===b||void 0===b?void 0:b.length)?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(m.Z.Text,{children:[null===a||void 0===a?void 0:a.name,":"]},"simulation"),(0,u.jsx)(yt.Z,{className:"full-width",options:b,placeholder:"Select a "+a.name,value:null===_||void 0===_?void 0:_.result,onChange:function(){var e=(0,i.Z)((function(e,n){return(0,o.__generator)(this,(function(i){return ki(t,e,n,r),[2]}))}));return function(n,t){return e.apply(this,arguments)}}()})]}):(0,u.jsx)(m.Z.Text,{type:"danger",children:"No results, please select an other simulation."})]})]})}(O,T)}var z=Z.direct;return(null===z||void 0===z?void 0:z.children)&&(k.direct=function(e){return(0,u.jsx)(P.Z,{direction:"vertical",className:"full-width",children:e.children.map((function(e,n){var i,a;if(2!==w||!e.only3D)return(0,u.jsx)(Rt,{label:e.label,defaultValue:(null!==(a=null===_||void 0===_||null===(i=_.values)||void 0===i?void 0:i[n])&&void 0!==a?a:e.default).toString(),unit:e.unit,onValueChange:function(e){return Ei(t,n,e,r)}},n)}))})}(z)),(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsxs)(E.Z,{size:"small",children:[(0,u.jsx)(yt.Z,{className:"full-width marginBottom-10",defaultValue:"none",value:h,options:S,onChange:function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Ci(t,e,r)];case 1:return n.sent(),v(e),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}()}),k[h||"none"]]})})})},Ni="Unable to delete boundary condition",Oi=function(){var e=(0,i.Z)((function(e,n,t,i,r){var u,l,s,c,d,f;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),u=ht.Z.deepCopy(e),l=u.scheme.configuration.boundaryConditions,s=l[n],s.values[t].selected.forEach((function(e){i(An(e))})),s.values=(0,a.Z)(s.values.slice(0,t)).concat((0,a.Z)(s.values.slice(t+1))),c=!1,Object.keys(l).forEach((function(e){var n;"index"!==e&&"title"!==e&&"done"!==e&&((null===(n=l[e].values)||void 0===n?void 0:n.length)&&(c=!0))})),d=(0,T.Z)((0,M.Z)({},l),{done:c}),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:d}])];case 1:return o.sent(),r.mutateOneSimulation(u),[3,3];case 2:throw f=o.sent(),(0,S.lt)(Ni,f),f;case 3:return[2]}}))}));return function(n,t,i,r,a){return e.apply(this,arguments)}}(),Mi=function(e){var n=e.type,t=e.index,r=e.simulation,a=e.swr,l=(0,s.useState)(!1),c=l[0],d=l[1],f=(0,s.useContext)(G).dispatch,h=r.scheme.configuration.boundaryConditions[n].values[t];return(0,u.jsx)(C.m1,{loading:c,onDelete:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:d(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Oi(r,n,t,f,a)];case 2:return e.sent(),[3,4];case 3:return d(!1),[7];case 4:return[2]}}))})),text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the condition"," ",(0,u.jsx)(m.Z.Text,{strong:!0,children:null===h||void 0===h?void 0:h.name}),"?"]})})},Ti=function(e){var n=e.simulation,t=e.swr,i=e.onEdit,r=(0,s.useState)(!0),a=r[0],o=r[1],l=n.scheme.configuration.boundaryConditions,c=(0,s.useContext)(G).dispatch,d=(0,s.useCallback)((function(e,n){c(_n());var t=l[e].values[n].selected;null===t||void 0===t||t.forEach((function(e){c(zn(e))}))}),[l,c]),f=(0,s.useCallback)((function(){c(Nn())}),[c]);return(0,u.jsx)(u.Fragment,{children:Object.keys(l).map((function(e){var r;if("index"!==e&&"title"!==e&&"done"!==e){var s=l[e];return null===(r=s.values)||void 0===r?void 0:r.map((function(r,l){return(0,u.jsxs)(E.Z,{className:"boundaryCondition-item",hoverable:!0,onMouseEnter:function(){return d(e,l)},onMouseLeave:function(){a&&f()},actions:[(0,u.jsx)(C.w6,{onEdit:function(){o(!1),i(e,l),setTimeout((function(){return o(!0)}),500)}},"edit"),(0,u.jsx)(Mi,{simulation:{id:n.id,scheme:n.scheme},type:e,index:l,swr:{mutateOneSimulation:t.mutateOneSimulation}},"delete")],children:[(0,u.jsx)(m.Z.Text,{strong:!0,children:r.name})," ",(0,u.jsxs)(m.Z.Text,{children:["(",s.label,")"]})]},l)}))}})).filter((function(e){return e}))})},zi=t(29924),Ai="You need to define a name",Ri="You need to select a type",Di="You need to select a face",Fi="Unable to add boundary condition",Li=function(){var e=(0,i.Z)((function(e,n,t){var i,r,u,l,s,c,d;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),i=(0,M.Z)({},n),r=i.type.key,i.uuid=(0,ln.Z)(),u=ht.Z.deepCopy(e),l=u.scheme.configuration.boundaryConditions,(s=l[r]).values=(0,a.Z)(s.values||[]).concat([i]),c=(0,T.Z)((0,M.Z)({},l),{done:!0}),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:c}])];case 1:return o.sent(),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:(0,T.Z)((0,M.Z)({},u.scheme.configuration.run),{done:!1})}])];case 2:return o.sent(),t.mutateOneSimulation(u),[3,4];case 3:throw d=o.sent(),(0,S.lt)(Fi,d),d;case 4:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Ui=function(e){var n=e.simulation,t=e.boundaryCondition,r=e.swr,a=e.onError,l=e.onClose,c=(0,s.useState)(!1),d=c[0],f=c[1];return(0,u.jsx)(C.HS,{loading:d,onAdd:(0,i.Z)((function(){var e,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:f(!0),o.label=1;case 1:return o.trys.push([1,3,,4]),t.name?(null===(e=t.type)||void 0===e?void 0:e.key)?(null===(i=t.selected)||void 0===i?void 0:i.length)?(a(),[4,Li(n,t,r)]):(a(Di),f(!1),[2]):(a(Ri),f(!1),[2]):(a(Ai),f(!1),[2]);case 2:return o.sent(),f(!1),l(),[3,4];case 3:return o.sent(),f(!1),[3,4];case 4:return[2]}}))})),needMargin:!0,children:"Add"})},Vi="You need to define a name",Ii="You need to select a type",Bi="You need to select a face",Hi="Unable to edit boundary condition",Gi=function(){var e=(0,i.Z)((function(e,n,t,i){var r,u,l,s,c,d,f,m,h,v,p;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=ht.Z.deepCopy(e),u=r.scheme.configuration.boundaryConditions,l=n.type.key,(s=t.type.key)!==l&&(c=u[s],d=c.values.findIndex((function(e){return e.uuid===t.uuid})),c.values=(0,a.Z)(c.values.slice(0,d)).concat((0,a.Z)(c.values.slice(d+1)))),s!==l?(f=u[l]).values=(0,a.Z)(f.values||[]).concat([n]):(m=u[l],h=m.values.findIndex((function(e){return e.uuid===n.uuid})),m.values=(0,a.Z)(m.values.slice(0,h)).concat([n],(0,a.Z)(m.values.slice(h+1)))),v=(0,M.Z)({},u),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:v}])];case 1:return o.sent(),i.mutateOneSimulation(r),[3,3];case 2:throw p=o.sent(),(0,S.lt)(Hi,p),p;case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),Wi=function(e){var n=e.simulation,t=e.boundaryCondition,r=e.oldBoundaryCondition,a=e.swr,l=e.onError,c=e.onClose,d=(0,s.useState)(!1),f=d[0],m=d[1];return(0,u.jsx)(C.w6,{loading:f,onEdit:(0,i.Z)((function(){var e,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:m(!0),o.label=1;case 1:return o.trys.push([1,3,,4]),t.name?(null===(e=t.type)||void 0===e?void 0:e.key)?(null===(i=t.selected)||void 0===i?void 0:i.length)?(l(),[4,Gi(n,t,r,a)]):(l(Bi),m(!1),[2]):(l(Ii),m(!1),[2]):(l(Vi),m(!1),[2]);case 2:return o.sent(),m(!1),c(),[3,4];case 3:return o.sent(),m(!1),[3,4];case 4:return[2]}}))})),primary:!0,needMargin:!0,children:"Edit"})},Yi=function(e){var n,t=e.visible,i=e.geometry,r=e.simulation,o=e.boundaryCondition,l=e.swr,c=e.onClose,d=(0,s.useState)([]),f=d[0],v=d[1],p=(0,s.useState)([]),y=p[0],g=p[1],b=(0,s.useState)(),j=b[0],Z=b[1],w=(0,s.useState)(),S=w[0],k=w[1],_=(0,s.useState)(),N=_[0],O=_[1],z=r.scheme.configuration.boundaryConditions,A=r.scheme.configuration.dimension;(0,s.useEffect)((function(){!t&&S&&k(void 0)})),(0,s.useEffect)((function(){t&&!S&&o?k(o):!t||S||o||void 0===j||k((function(e){return(0,T.Z)((0,M.Z)({},e),{name:"Boundary condition "+(j+1)})}))}),[S,j,t,o]),(0,s.useEffect)((function(){var e=Object.keys(z).map((function(e){var n;if("index"!==e&&"title"!==e&&"done"!==e){var t=z[e];return null===t||void 0===t||null===(n=t.values)||void 0===n?void 0:n.map((function(e){if(e.uuid!==(null===o||void 0===o?void 0:o.uuid))return{label:e.name,selected:e.selected}})).filter((function(e){return e}))}})).flat().filter((function(e){return e}));v(e)}),[z,o]),(0,s.useEffect)((function(){var e=Object.keys(z).map((function(e){if("index"!==e&&"title"!==e&&"done"!==e){var n=z[e];return{key:e,label:n.label,children:n.children,values:n.values}}})).filter((function(e){return e}));g(e)}),[z]),(0,s.useEffect)((function(){var e=null===y||void 0===y?void 0:y.map((function(e){var n;return null===(n=e.values)||void 0===n?void 0:n.length})).filter((function(e){return e})).reduce((function(e,n){return e+n}),0);Z(e)}),[y]);var R=(0,s.useCallback)((function(e){var n=e.target.value;k((function(e){return(0,T.Z)((0,M.Z)({},e),{name:n})}))}),[]),D=(0,s.useCallback)((function(e){var n,t=e.target.value,i=y.find((function(e){return e.key===t})),r=null===(n=z[t].children)||void 0===n?void 0:n.map((function(e){return{checked:!0,value:e.default}}));k((function(e){return(0,T.Z)((0,M.Z)({},e),{type:{key:i.key,label:i.label,children:i.children},values:r})}))}),[z,y]),F=(0,s.useCallback)((function(e,n){k((function(t){return(0,T.Z)((0,M.Z)({},t),{values:(0,a.Z)(t.values.slice(0,e)).concat([{checked:t.values[e].checked,value:n}],(0,a.Z)(t.values.slice(e+1)))})}))}),[]),L=(0,s.useCallback)((function(e,n){k((function(t){return(0,T.Z)((0,M.Z)({},t),{values:(0,a.Z)(t.values.slice(0,e)).concat([{checked:n,value:t.values[e].value}],(0,a.Z)(t.values.slice(e+1)))})}))}),[]),U=(0,s.useCallback)((function(e){k((function(n){return(0,T.Z)((0,M.Z)({},n),{selected:e})}))}),[]),V=(0,s.useMemo)((function(){var e;return(null===S||void 0===S?void 0:S.type)&&(null===(e=S.type)||void 0===e?void 0:e.children)?(0,u.jsx)(E.Z,{children:S.type.children.map((function(e,n){if(2!==A||!e.only3D)return(0,u.jsx)(Rt,{className:"marginBottom-10",label:e.label,defaultValue:String(S.values[n].value),defaultChecked:S.type.children.length>1?S.values[n].checked:void 0,onValueChange:function(e){return F(n,e)},onCheckedChange:function(e){return L(n,e)},unit:e.unit},n)}))}):null}),[S,A,L,F]);return(0,u.jsx)(tt.Z,{className:"boundaryCondition",title:"Boundary condition",placement:"left",closable:!1,open:t,mask:!1,maskClosable:!1,width:300,extra:(0,u.jsx)(h.Z,{type:"text",icon:(0,u.jsx)(he.Z,{}),onClick:function(){k(void 0),c()}}),footer:(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,u.jsx)(C.Lw,{onCancel:function(){k(void 0),c()}}),o?(0,u.jsx)(Wi,{boundaryCondition:{uuid:(null===S||void 0===S?void 0:S.uuid)||o.uuid,name:(null===S||void 0===S?void 0:S.name)||o.name,type:(null===S||void 0===S?void 0:S.type)||o.type,selected:(null===S||void 0===S?void 0:S.selected)||o.selected,values:(null===S||void 0===S?void 0:S.values)||o.values},oldBoundaryCondition:{uuid:o.uuid,name:o.name,type:o.type,selected:o.selected,values:o.values},simulation:{id:r.id,scheme:r.scheme},swr:{mutateOneSimulation:l.mutateOneSimulation},onError:function(e){return O(e)},onClose:c}):(0,u.jsx)(Ui,{boundaryCondition:{name:null===S||void 0===S?void 0:S.name,type:null===S||void 0===S?void 0:S.type,selected:null===S||void 0===S?void 0:S.selected,values:null===S||void 0===S?void 0:S.values},simulation:{id:r.id,scheme:r.scheme},swr:{mutateOneSimulation:l.mutateOneSimulation},onError:function(e){return O(e)},onClose:c})]}),children:(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(E.Z,{size:"small",children:(0,u.jsx)(Se.Z,{layout:"vertical",children:(0,u.jsx)(Se.Z.Item,{label:(0,u.jsx)(m.Z.Text,{strong:!0,children:"Boundary condition name"}),children:(0,u.jsx)(ke.Z,{value:(null===S||void 0===S?void 0:S.name)||"",onChange:R,maxLength:50})})})}),(0,u.jsx)(E.Z,{size:"small",children:(0,u.jsx)(Se.Z,{layout:"vertical",children:(0,u.jsx)(Se.Z.Item,{label:(0,u.jsx)(m.Z.Text,{strong:!0,children:"Boundary condition type"}),children:(0,u.jsx)(zi.ZP.Group,{className:"BoundaryCondition-types",optionType:"button",buttonStyle:"solid",value:null===S||void 0===S||null===(n=S.type)||void 0===n?void 0:n.key,onChange:D,children:null===y||void 0===y?void 0:y.map((function(e){return(0,u.jsx)(zi.ZP.Button,{value:e.key,children:e.label},e.key)}))})})})}),V,(0,u.jsx)($t,{geometry:i,alreadySelected:f,updateSelected:U}),N&&(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)(x.Z,{style:{color:"red"}})," ",N]})]})})},Ji=function(e){var n=e.simulation,t=e.geometry,i=e.swr,r=e.setVisible,a=(0,s.useState)(),o=a[0],l=a[1],c=(0,s.useState)(!1),f=c[0],m=c[1],h=(0,s.useContext)(G).dispatch,v=n.scheme.configuration.boundaryConditions;(0,s.useEffect)((function(){(null===t||void 0===t?void 0:t.summary)&&h(On(2===t.summary.dimension?"edges":"faces"))}),[t,h]);var p=(0,s.useCallback)((function(){l(void 0),m(!0),r(!1),h(_n())}),[h,r]),y=(0,s.useCallback)((function(e,n){var t=v[e].values[n];l(t),m(!0),r(!1),h(_n())}),[v,h,r]),x=(0,s.useCallback)((function(){h(Nn()),m(!1),l(void 0),r(!0)}),[h,r]);return t?(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsxs)(E.Z,{size:"small",children:[(0,u.jsx)(C.HS,{onAdd:p,fullWidth:!0,primary:!1,children:"Add boundary condition"}),(0,u.jsx)(Ti,{simulation:{id:n.id,scheme:n.scheme},swr:{mutateOneSimulation:i.mutateOneSimulation},onEdit:y}),(0,u.jsx)(Yi,{visible:f,geometry:{summary:t.summary},simulation:{id:n.id,scheme:n.scheme},boundaryCondition:o&&{uuid:o.uuid,name:o.name,type:o.type,selected:o.selected,values:o.values},swr:{mutateOneSimulation:i.mutateOneSimulation},onClose:x})]})})}):(0,u.jsx)(k.Z.Simple,{})},qi=t(91756),Xi=t(67841),Ki=t(36027),Qi=t(57184),$i="You need to define a name",er="You need to select a point",nr="You need to define a formula",tr="Unable to update simulation",ir=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=ht.Z.deepCopy(e),r=i.scheme.configuration.run,a=n.index,r.sensors[a]={name:n.name,point:n.point,formula:n.formula},[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:r}])];case 1:return o.sent(),t.mutateOneSimulation(i),[3,3];case 2:throw u=o.sent(),(0,S.lt)(tr,u),u;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),rr=function(e){var n=e.simulation,t=e.sensor,r=e.onError,a=e.onClose,l=e.swr,c=(0,s.useState)(),d=c[0],f=c[1];return(0,u.jsx)(C.w6,{loading:d,primary:!0,needMargin:!0,onEdit:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:f(!0),e.label=1;case 1:return e.trys.push([1,3,,4]),t.name?t.point?t.formula?(r(),[4,ir(n,t,l)]):(r(nr),f(!1),[2]):(r(er),f(!1),[2]):(r($i),f(!1),[2]);case 2:return e.sent(),f(!1),a(),[3,4];case 3:return e.sent(),f(!1),[3,4];case 4:return[2]}}))})),children:"Edit"})},ar="You need to define a name",or="You need to select a point",ur="You need to define a formula",lr="Unable to update simulation",sr=function(){var e=(0,i.Z)((function(e,n,t){var i,r,u,l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=ht.Z.deepCopy(e),r=i.scheme.configuration.run,u=(0,T.Z)((0,M.Z)({},r),{sensors:(0,a.Z)(r.sensors||[]).concat([n])}),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:u}])];case 1:return o.sent(),t.mutateOneSimulation(i),[3,3];case 2:throw l=o.sent(),(0,S.lt)(lr,l),l;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),cr=function(e){var n=e.simulation,t=e.sensor,r=e.onError,a=e.onClose,l=e.swr,c=(0,s.useState)(),d=c[0],f=c[1];return(0,u.jsx)(C.HS,{loading:d,needMargin:!0,onAdd:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:f(!0),e.label=1;case 1:return e.trys.push([1,3,,4]),t.name?t.point?t.formula?(r(),[4,sr(n,t,l)]):(r(ur),f(!1),[2]):(r(or),f(!1),[2]):(r(ar),f(!1),[2]);case 2:return e.sent(),f(!1),a(),[3,4];case 3:return e.sent(),f(!1),[3,4];case 4:return[2]}}))})),children:"Add"})},dr=function(e){var n=e.visible,t=e.simulation,i=e.sensor,r=e.onClose,a=e.swr,o=(0,s.useState)(),l=o[0],d=o[1],f=(0,s.useState)(),v=f[0],p=f[1],y=(0,s.useState)(),g=y[0],b=y[1],j=(0,s.useState)(),Z=j[0],w=j[1],S=(0,s.useContext)(G),k=S.point,_=S.dispatch;(0,s.useEffect)((function(){_(On("point"))}),[_]),(0,s.useEffect)((function(){if(!i){var e=t.scheme.configuration.run;p("Sensor "+(e.sensors?e.sensors.length+1:1))}}),[t,i]),(0,s.useEffect)((function(){i&&(p(i.name),_(Rn({x:i.point.x,y:i.point.y,z:i.point.z})),b(i.formula))}),[i,_]);var N,O,z,A,R,D,F=(0,s.useCallback)((function(){d(!1),_(Nn()),window.removeEventListener("click",F)}),[_]),L=(0,s.useCallback)((function(){l?F():(d(!0),_(_n()),setTimeout((function(){return window.addEventListener("click",F)}),50))}),[l,F,_]),U=(0,s.useCallback)((function(e,n,t){_(Rn({x:e,y:n,z:t}))}),[_]),V=(0,s.useCallback)((function(e){b(e)}),[]),I=(0,s.useCallback)((function(){p(void 0),b(void 0),w(void 0),_(Rn()),r()}),[_,r]);return(0,u.jsx)(tt.Z,{className:"sensor",title:"Sensor",placement:"left",closable:!1,open:n,mask:!1,maskClosable:!1,width:300,extra:(0,u.jsx)(h.Z,{type:"text",icon:(0,u.jsx)(he.Z,{}),onClick:I}),footer:(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,u.jsx)(C.Lw,{onCancel:I}),i?(0,u.jsx)(rr,{simulation:t,sensor:(0,T.Z)((0,M.Z)({},i),{name:v,point:k,formula:g}),onError:w,onClose:I,swr:a}):(0,u.jsx)(cr,{simulation:t,sensor:{name:v,point:k,formula:g},onError:w,onClose:I,swr:a})]}),children:(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsxs)(E.Z,{size:"small",children:[(0,u.jsx)(m.Z.Text,{children:"Name"}),(0,u.jsx)(ke.Z,{value:v,onChange:function(e){return p(e.target.value)}})]}),(0,u.jsx)(E.Z,{size:"small",children:(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsxs)(P.Z,{className:"full-width",style:{justifyContent:"space-between"},children:[(0,u.jsx)(m.Z.Text,{children:"Point selection"}),(0,u.jsx)(c.Z,{title:"Pin in the geometry",children:(0,u.jsx)(h.Z,{size:"small",type:l?"primary":"default",icon:(0,u.jsx)(Qi.Z,{}),onClick:L})})]}),(0,u.jsx)(Rt,{label:"X",defaultValue:null===k||void 0===k?void 0:k.x,onValueChange:function(e){return U(+e,null!==(N=null===k||void 0===k?void 0:k.y)&&void 0!==N?N:0,null!==(O=null===k||void 0===k?void 0:k.z)&&void 0!==O?O:0)}}),(0,u.jsx)(Rt,{label:"Y",defaultValue:null===k||void 0===k?void 0:k.y,onValueChange:function(e){return U(null!==(z=null===k||void 0===k?void 0:k.x)&&void 0!==z?z:0,+e,null!==(A=null===k||void 0===k?void 0:k.z)&&void 0!==A?A:0)}}),(0,u.jsx)(Rt,{label:"Z",defaultValue:null===k||void 0===k?void 0:k.z,onValueChange:function(e){return U(null!==(R=null===k||void 0===k?void 0:k.x)&&void 0!==R?R:0,null!==(D=null===k||void 0===k?void 0:k.y)&&void 0!==D?D:0,+e)}})]})}),(0,u.jsx)(E.Z,{size:"small",className:"no-border-bottom",children:(0,u.jsx)(Rt,{label:"Formula",defaultValue:g,onValueChange:V})}),Z&&(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)(x.Z,{style:{color:"red"}})," ",Z]})]})})},fr="Unable to update simulation",mr=function(){var e=(0,i.Z)((function(e,n,t,i){var r,u,l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=ht.Z.deepCopy(e),u=r.scheme.configuration.run,t(Rn()),u.sensors=(0,a.Z)(u.sensors.slice(0,n)).concat((0,a.Z)(u.sensors.slice(n+1))),[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:u}])];case 1:return o.sent(),i.mutateOneSimulation(r),[3,3];case 2:throw l=o.sent(),(0,S.lt)(fr,l),l;case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),hr=function(e){var n=e.simulation,t=e.index,r=e.swr,a=(0,s.useState)(),l=a[0],c=a[1],d=(0,s.useContext)(G).dispatch,f=n.scheme.configuration.run.sensors[t];return(0,u.jsx)(C.m1,{loading:l,text:(0,u.jsxs)(u.Fragment,{children:["Are you sure you want to delete the sensor"," ",(0,u.jsx)(m.Z.Text,{strong:!0,children:f.name})]}),onDelete:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:c(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,mr(n,t,d,r)];case 2:return e.sent(),[3,4];case 3:return c(!1),[7];case 4:return[2]}}))}))})},vr=function(e){var n,t=e.simulation,i=e.onEdit,r=e.swr,a=(0,s.useState)(!0),o=a[0],l=a[1],c=t.scheme.configuration.run,d=(0,s.useContext)(G).dispatch,f=(0,s.useCallback)((function(e){d(_n()),d(Rn(e.point))}),[d]),h=(0,s.useCallback)((function(){o&&d(Rn()),d(Nn())}),[o,d]);return(0,u.jsx)(u.Fragment,{children:null===(n=c.sensors)||void 0===n?void 0:n.map((function(e,n){return(0,u.jsx)(E.Z,{className:"sensor-item text-center",hoverable:!0,onMouseEnter:function(){return f(e)},onMouseLeave:h,actions:[(0,u.jsx)(C.w6,{onEdit:function(){l(!1),i((0,T.Z)((0,M.Z)({},e),{index:n})),setTimeout((function(){return l(!0)}),500)}},"edit"),(0,u.jsx)(hr,{simulation:t,index:n,swr:r},"delete")],children:(0,u.jsx)(m.Z.Text,{strong:!0,className:"text-center",children:e.name})},n)}))})},pr=function(e){var n=e.simulation,t=e.setVisible,i=e.swr,r=(0,s.useState)(),a=r[0],o=r[1],l=(0,s.useState)(),c=l[0],d=l[1],f=(0,s.useCallback)((function(){d(void 0),t(!1),o(!0)}),[t]),m=(0,s.useCallback)((function(e){d(e),t(!1),o(!0)}),[t]),v=(0,s.useCallback)((function(){d(void 0),t(!0),o(!1)}),[t]);return(0,u.jsxs)(E.Z,{size:"small",title:"Sensors",children:[(0,u.jsx)(dr,{visible:a,simulation:n,sensor:c,onClose:v,swr:i}),(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(h.Z,{className:"full-width",disabled:!1,type:"primary",icon:(0,u.jsx)(Ki.Z,{}),onClick:f,children:"Add a sensor"}),(0,u.jsx)(vr,{simulation:n,onEdit:m,swr:i})]})]})},yr=t(5152),xr=t.n(yr),gr=t(139),br=t(24443),jr="Plugins error",Zr="Unable to load plugins",wr=function(e){var n=e.disabled,i=e.cloudServer,a=e.onOk,o=(0,s.useState)(!1),c=o[0],d=o[1],f=(0,s.useState)([]),v=f[0],p=f[1],y=(0,l.useRouter)(),x=(0,r.Z)(br.Z.usePlugins(),2),g=x[0],b=x[1].errorPlugins;return(0,s.useEffect)((function(){b&&(0,S.lt)(jr,b)}),[b]),(0,s.useEffect)((function(){wt.Z.list().then((function(e){p(e)})).catch((function(e){(0,S.lt)(Zr,e)}))}),[]),(0,u.jsxs)(E.Z,{size:"small",title:"Computational resource",children:[(0,u.jsx)(xt.Z,{open:c,title:"Computational resource",okButtonProps:{disabled:!0,style:{display:"none"}},onCancel:function(){return d(!1)},style:{width:"unset"},children:(0,u.jsxs)(P.Z,{direction:"vertical",children:[(0,u.jsxs)(m.Z.Text,{children:["Your computational resource does not appear in this list? Create one in your"," ",(0,u.jsx)(C.Qj,{onClick:function(){return y.push({pathname:"/dashboard",query:{page:"account",tab:"hpc"}})},children:"account settings"})]}),(0,u.jsx)(P.Z,{align:"start",direction:"horizontal",wrap:!0,children:null===g||void 0===g?void 0:g.map((function(e){var n=v.find((function(n){return n.key===e.key}));if(n){var i=xr()((function(){return t(64546)("./".concat(n.key,"/src/components"))}));return(0,u.jsx)(E.Z,{title:e.configuration.name.value,children:(0,u.jsx)(i,{data:e.data,onSelect:function(n){(0,mt.merge)(e,n),a(e),d(!1)}})},e.uuid)}}))})]})}),(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[i&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Plugin:"})," ",i.name]}),(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsx)("span",{className:"text-light",children:"Name:"})," ",i.configuration.name.value]}),Object.keys(i.inUseConfiguration).map((function(e){var n=i.inUseConfiguration[e],t=n.value;return"boolean"===typeof t&&(t=t?"yes":"no"),(0,u.jsxs)(m.Z.Text,{children:[(0,u.jsxs)("span",{className:"text-light",children:[n.label,":"]})," ",t]},e)}))]}),(0,u.jsx)(h.Z,{className:"full-width",disabled:n,type:i?"link":"primary",icon:(0,u.jsx)(gr.Z,{}),onClick:function(){return d(!0)},children:i?"Modify the resource":"Select a resource"})]})]})},Cr=t(15360),Sr=t(25935),kr=t(48764).lW,Er="Unable to get system log",Pr=function(){var e=(0,i.Z)((function(e,n){var t,i,r;return(0,o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,oe.log({id:e.id},n.systemLog)];case 1:return t=a.sent(),i=kr.from(t.log).toString(),xt.Z.info({title:"System log",width:"unset",content:(0,u.jsx)("pre",{children:(0,u.jsx)("code",{children:(0,Sr.ZP)(i.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))})})}),[3,3];case 2:return r=a.sent(),(0,S.lt)(Er,r),[3,3];case 3:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),_r=function(e){var n=e.simulation,t=e.steps,r=(0,s.useState)(!1),a=r[0],l=r[1],d=(0,s.useState)(!1),f=d[0],v=d[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(tt.Z,{title:"Log",open:a,onClose:function(){return l(!1)},width:"50%",children:(0,u.jsx)(gt.Z,{items:null===t||void 0===t?void 0:t.map((function(e){var t,r;return{key:e.label,label:e.label,children:(0,u.jsxs)(u.Fragment,{children:[e.systemLog&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(h.Z,{loading:f,onClick:(0,i.Z)((function(){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:v(!0),t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,Pr(n,e)];case 2:return t.sent(),[3,5];case 3:return t.sent(),[3,5];case 4:return v(!1),[7];case 5:return[2]}}))})),children:"Complete log"}),(0,u.jsx)("br",{})]}),e.link&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("a",{href:"https://"+e.link.href,target:"_blank",rel:"noreferrer",children:(0,u.jsx)(h.Z,{type:"primary",children:e.link.label})}),(0,u.jsx)("br",{})]}),(0,u.jsxs)(pi.Z,{ghost:!0,children:[e.warning&&(0,u.jsx)(pi.Z.Panel,{className:"warning-collapse",header:(0,u.jsx)(m.Z.Text,{type:"warning",children:"Warnings"}),children:(0,Sr.ZP)(e.warning.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))},"warnings"),e.error&&(0,u.jsx)(pi.Z.Panel,{className:"error-collapse",header:(0,u.jsx)(m.Z.Text,{type:"danger",children:"Errors"}),children:(0,Sr.ZP)(e.error.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))},"errors")]}),(0,Sr.ZP)((null===(t=e.pluginLog)||void 0===t?void 0:t.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))||""),(0,Sr.ZP)((null===(r=e.log)||void 0===r?void 0:r.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))||"")]})}}))})}),(0,u.jsx)(c.Z,{title:"Log",children:(0,u.jsx)(h.Z,{disabled:!t||!t.length,icon:(0,u.jsx)(Cr.Z,{}),onClick:function(){return l(!0)}})})]})},Nr=t(99611),Or=t(23430),Mr="Unable to download file",Tr=function(){var e=(0,i.Z)((function(e,n){var t,i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,He.download({id:e.id},{originPath:n.originPath,fileName:n.fileName})];case 1:return[4,o.sent().blob()];case 2:return t=o.sent(),i=window.URL.createObjectURL(new Blob([t])),(r=document.createElement("a")).href=i,r.setAttribute("download",n.name+"."+n.fileName.split(".").pop()),r.click(),[3,4];case 3:return a=o.sent(),(0,S.lt)(Mr,a),[3,4];case 4:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),zr=function(e){var n=e.simulation,t=e.file,r=(0,s.useState)(!1),a=r[0],l=r[1];return(0,u.jsx)(c.Z,{title:"Download",children:(0,u.jsx)(h.Z,{loading:a,icon:(0,u.jsx)(Or.Z,{}),onClick:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:l(!0),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,Tr(n,t)];case 2:return e.sent(),[3,5];case 3:return e.sent(),[3,5];case 4:return l(!1),[7];case 5:return[2]}}))}))})})},Ar="Unable to download archive",Rr=function(){var e=(0,i.Z)((function(e){var n,t,i,r;return(0,o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,He.archive({id:e.id})];case 1:return[4,a.sent().blob()];case 2:return n=a.sent(),t=window.URL.createObjectURL(new Blob([n])),(i=document.createElement("a")).href=t,i.setAttribute("download",e.scheme.name+".zip"),i.click(),[3,4];case 3:return r=a.sent(),(0,S.lt)(Ar,r),[3,4];case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Dr=function(e){var n=e.simulation,t=(0,s.useState)(!1),r=t[0],a=t[1];return(0,u.jsx)(C.o6,{loading:r,onDownload:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:a(!0),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,Rr(n)];case 2:return e.sent(),[3,5];case 3:return e.sent(),[3,5];case 4:return a(!1),[7];case 5:return[2]}}))}))})},Fr=function(e){var n,t=e.simulation,i=e.result,r=e.setResult,o=(0,s.useState)(),l=o[0],c=o[1],d=(0,s.useState)(),f=d[0],m=d[1],v=(0,s.useState)(),p=v[0],y=v[1],x=null===t||void 0===t||null===(n=t.scheme)||void 0===n?void 0:n.configuration;return(0,s.useEffect)((function(){var e;if(!(null===t||void 0===t?void 0:t.tasks))return c([]),void m(void 0);var n=[],i=null===x||void 0===x||null===(e=x.run)||void 0===e?void 0:e.resultsFilter;t.tasks.forEach((function(e){if(e.file&&n.push(e.file),e.files)if(i){var t,r=new RegExp(i.pattern),o=e.files.filter((function(e){return!r.test(e.fileName)})),u=e.files.filter((function(e){return r.test(e.fileName)})),l=ji(u,i),s=l.map((function(e){return e.number})).filter((function(e,n,t){return t.indexOf(e)===n})).sort((function(e,n){return e-n})),c=Zi(x,i),d=s.map((function(e,n){var t=c?e*c:n;return{label:Math.round(1e15*t)/1e15,value:e}}));(t=n).push.apply(t,(0,a.Z)(o)),m({filtered:!0,name:i.name,files:l,options:d})}else{var f;(f=n).push.apply(f,(0,a.Z)(e.files))}})),c(n)}),[t,x]),(0,s.useEffect)((function(){!p&&f&&y(null===f||void 0===f?void 0:f.options[0].value)}),[f,p]),l||f?(null===l||void 0===l?void 0:l.length)||f?(0,u.jsx)(E.Z,{size:"small",title:"Results",extra:(0,u.jsx)(Dr,{simulation:t&&{id:t.id,scheme:t.scheme}}),children:(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[null===l||void 0===l?void 0:l.map((function(e){return(0,u.jsxs)(P.Z,{style:{alignItems:"center"},children:[(0,u.jsx)(h.Z,{icon:(null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?(0,u.jsx)(Nr.Z,{style:{color:"#fad114"}}):(0,u.jsx)(an.Z,{}),onClick:function(){return r((null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?void 0:e)}}),(0,u.jsx)(zr,{simulation:t&&{id:t.id},file:e&&{name:e.name,fileName:e.fileName,originPath:e.originPath}}),e.name]},e.name)})),f&&(0,u.jsxs)(u.Fragment,{children:[f.name,(0,u.jsx)(yt.Z,{className:"full-width",options:f.options,value:p,onChange:function(e){var n=f.files.find((function(n){return n.number===e&&n.name===(null===i||void 0===i?void 0:i.name)}));r(n),y(e)}}),f.files.map((function(e){if(e.number===p)return(0,u.jsxs)(P.Z,{style:{alignItems:"center"},children:[(0,u.jsx)(h.Z,{icon:(null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?(0,u.jsx)(Nr.Z,{style:{color:"#fad114"}}):(0,u.jsx)(an.Z,{}),onClick:function(){return r((null===i||void 0===i?void 0:i.fileName)===(null===e||void 0===e?void 0:e.fileName)&&(null===i||void 0===i?void 0:i.name)===(null===e||void 0===e?void 0:e.name)?void 0:e)}}),(0,u.jsx)(zr,{simulation:t&&{id:t.id},file:e&&{name:e.name,fileName:e.fileName,originPath:e.originPath}}),e.name]},e.name)}))]})]})}):(0,u.jsx)(E.Z,{size:"small",children:"No results yet"}):(0,u.jsx)(Je.Z,{})},Lr="Unable to run simulation",Ur="Unable to stop simulation",Vr="Unable to update simulation",Ir=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=ht.Z.deepCopy(e),(r=e.scheme.configuration).run.cloudServer=n,i.scheme.configuration=r,[4,oe.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:r.run}])];case 1:return o.sent(),t.mutateOneSimulation(i),t.mutateSimulation(i),[3,3];case 2:return a=o.sent(),(0,S.lt)(Vr,a),[3,3];case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),Br=function(){var e=(0,i.Z)((function(e){var n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,oe.run({id:e.id})];case 1:return t.sent(),[3,3];case 2:throw n=t.sent(),(0,S.lt)(Lr,n),n;case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Hr=function(){var e=(0,i.Z)((function(e){var n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,oe.stop({id:e.id})];case 1:return t.sent(),[3,3];case 2:throw n=t.sent(),(0,S.lt)(Ur,n),n;case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Gr=function(e){var n,t,a=e.simulation,l=e.result,c=e.setResult,f=e.setVisible,m=e.swr,v=(0,s.useState)(!1),p=v[0],y=v[1],x=(0,s.useState)(!1),g=x[0],b=x[1],j=(0,s.useState)([]),Z=j[0],w=j[1],C=(0,r.Z)(oe.useSimulation(a.id,2e3),2),S=C[0],k=C[1].mutateSimulation,_=a.scheme.configuration,N=null===S||void 0===S||null===(n=S.scheme)||void 0===n?void 0:n.configuration;return(0,s.useEffect)((function(){if(_){var e=!0;Object.keys(_).forEach((function(n){"dimension"!==n&&"run"!==n&&(_[n].done||(e=!1))})),_.run.cloudServer||(e=!1),y(!e)}else y(!0)}),[_]),(0,s.useEffect)((function(){var e,n;(null===S||void 0===S||null===(e=S.tasks)||void 0===e?void 0:e.find((function(e){return"error"===(null===e||void 0===e?void 0:e.status)})))?b(!1):(null===S||void 0===S||null===(n=S.tasks)||void 0===n?void 0:n.find((function(e){return e&&"finish"!==e.status})))?b(!0):b(!1)}),[null===S||void 0===S?void 0:S.tasks]),(0,s.useEffect)((function(){var e,n=[];null===S||void 0===S||null===(e=S.tasks)||void 0===e||e.forEach((function(e){e&&(n[e.index]={index:e.index,label:e.label,status:e.status,log:e.log,pluginLog:e.pluginLog,warning:e.warning,error:e.error,systemLog:e.systemLog,link:e.link})})),w(n)}),[null===S||void 0===S?void 0:S.tasks]),a&&S&&"0"!==(null===S||void 0===S?void 0:S.id)?(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",children:[(0,u.jsx)(pr,{simulation:a,setVisible:f,swr:{mutateOneSimulation:m.mutateOneSimulation}}),(0,u.jsx)(wr,{disabled:g,cloudServer:null===N||void 0===N||null===(t=N.run)||void 0===t?void 0:t.cloudServer,onOk:function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){return[2,Ir(a,e,(0,T.Z)((0,M.Z)({},m),{mutateSimulation:k}))]}))}));return function(n){return e.apply(this,arguments)}}()}),(0,u.jsx)(E.Z,{size:"small",title:"Run",children:(0,u.jsxs)(P.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,u.jsxs)("div",{className:"full-width",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsxs)(P.Z,{children:[(0,u.jsx)(h.Z,{disabled:p,type:"primary",icon:(0,u.jsx)(Xi.Z,{}),loading:g,onClick:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:b(!0),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Br(a)];case 2:return e.sent(),[3,4];case 3:return e.sent(),b(!1),[3,4];case 4:return[2]}}))})),children:"Run"}),(0,u.jsx)(h.Z,{disabled:!g,danger:!0,icon:(0,u.jsx)(rn.Z,{}),shape:"circle",onClick:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Hr(a)];case 1:return e.sent(),b(!1),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}}))}))})]}),(0,u.jsx)(_r,{simulation:{id:a.id},steps:Z})]}),(0,u.jsx)(qi.Z,{direction:"vertical",children:Z.map((function(e,n){return(0,u.jsx)(qi.Z.Step,{title:e.label,description:"("+(n+1)+"/"+Z.length+")",status:e.status},e.label)}))})]})}),(0,u.jsx)(Fr,{simulation:S&&{id:S.id,scheme:S.scheme,tasks:S.tasks},result:l&&{name:l.name,fileName:l.fileName},setResult:c})]})})}):(0,u.jsx)(d.Z,{children:(0,u.jsx)(d.Z.Content,{children:(0,u.jsx)(E.Z,{size:"small",children:(0,u.jsx)(Je.Z,{})})})})},Wr=t(1402),Yr=[{key:"warpByVector",label:"Warp by vector",parameters:[{key:"Vectors",label:"Vectors",rules:[{required:!0,message:"Vectors is required"}]},{key:"ScaleFactor",label:"Scale factor",default:"1",rules:[{required:!0,message:"Scale factor is required"}]}]},{key:"contour",label:"Contour",parameters:[{key:"ContourBy",label:"Contour by",rules:[{required:!0,message:"ContourBy by is required"}]},{key:"isosurface",label:"Isosurface",default:"0",rules:[{required:!0,message:"Isosurface is required"}]}]},{key:"streamTracer",label:"Stream tracer",parameters:[{key:"Vectors",label:"Vectors",rules:[{required:!0,message:"Vectors is required"}]}]}],Jr=function(){var e=(0,i.Z)((function(e,n,t,i){return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,K.R)("/api/postprocessing",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({simulation:e,result:n,filter:t,parameters:i})})];case 1:return[2,r.sent().json()]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),qr={run:Jr},Xr="Unable to run filter",Kr=function(){var e=(0,i.Z)((function(e,n,t,i){var r;return(0,o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,qr.run(e,n,t,i)];case 1:return[2,a.sent()];case 2:return r=a.sent(),(0,S.lt)(Xr,r),[3,3];case 3:return[2]}}))}));return function(n,t,i,r){return e.apply(this,arguments)}}(),Qr=function(e){var n=e.simulation,t=e.result,r=e.postprocessing,a=e.setResult,l=(0,s.useState)(),f=l[0],m=l[1],v=(0,s.useState)(),p=v[0],y=v[1],x=(0,s.useState)(),g=x[0],b=x[1],j=(0,s.useState)(),Z=j[0],w=j[1];if((0,s.useEffect)((function(){!t&&f&&m(!1)}),[t,f]),(0,s.useEffect)((function(){n||(y(void 0),w(void 0))}),[n,t]),!n||!t)return null;var C=n.scheme.configuration.run.postprocessing;if(!C)return null;var S=Yr.map((function(e){if(C.find((function(n){return n.key===e.key})))return{label:e.label,value:e.key}})).filter((function(e){return e}));if(!S.length)return null;var k=null;if(p){var _=Yr.find((function(e){return e.key===p})),N=C.find((function(e){return e.key===p}));(null===_||void 0===_?void 0:_.parameters)&&(k=_.parameters.map((function(e,n){var t,i=null===N||void 0===N||null===(t=N.parameters)||void 0===t?void 0:t.find((function(n){return n.key===e.key}));return(null===i||void 0===i?void 0:i.value)?(0,u.jsx)(Se.Z.Item,{label:e.label,name:["parameters",n],initialValue:i.value,rules:e.rules,children:(0,u.jsx)(ke.Z,{disabled:!0})},e.key):(null===i||void 0===i?void 0:i.options)?(0,u.jsx)(Se.Z.Item,{label:e.label,name:["parameters",n],rules:e.rules,children:(0,u.jsx)(yt.Z,{options:i.options.map((function(e){return{label:e,value:e}}))})},e.key):(0,u.jsx)(Se.Z.Item,{label:e.label,name:["parameters",n],rules:e.rules,initialValue:e.default,children:(0,u.jsx)(ke.Z,{})},e.key)})))}return(0,u.jsx)(d.Z,{style:{position:"absolute",zIndex:101,right:25,bottom:50,backgroundColor:"rgba(255, 255, 255, 0)"},children:(0,u.jsxs)(d.Z.Content,{children:[(0,u.jsx)(c.Z,{title:"Post-processing",children:(0,u.jsx)(h.Z,{type:"primary",icon:(0,u.jsx)(Wr.Z,{}),onClick:function(){return m(!0)},style:{width:40,height:40,border:"1px solid #5E14FA",borderRadius:20,marginBottom:-20}})}),(0,u.jsxs)(tt.Z,{title:"Post-processing",closable:!0,onClose:function(){return m(!1)},open:f,mask:!1,maskClosable:!1,children:[(0,u.jsx)(Se.Z,{style:{margin:"24px 0"},children:(0,u.jsx)(Se.Z.Item,{name:"filter",label:"Filter",children:(0,u.jsx)(yt.Z,{placeholder:"Select a filter",options:S,onChange:y})})}),(0,u.jsxs)(Se.Z,{layout:"vertical",style:{margin:"24px 0"},onFinish:function(){var e=(0,i.Z)((function(e){var i;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:b(!0),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Kr({id:n.id},t,p,e.parameters||[])];case 2:return i=r.sent(),w(i),[3,4];case 3:return r.sent(),[3,4];case 4:return b(!1),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:[k,(0,u.jsx)(Se.Z.Item,{children:(0,u.jsx)(h.Z,{type:"primary",loading:g,htmlType:"submit",icon:(0,u.jsx)(Xi.Z,{}),children:"Run"})})]}),Z&&(0,u.jsx)(E.Z,{size:"small",title:"Post-processing",extra:p,children:(0,u.jsx)(P.Z,{direction:"vertical",className:"full-width",children:Z.length?Z.map((function(e){return(0,u.jsxs)(P.Z,{children:[(0,u.jsx)(h.Z,{icon:(null===r||void 0===r?void 0:r.fileName)===e.fileName&&(null===r||void 0===r?void 0:r.name)===e.name?(0,u.jsx)(Nr.Z,{style:{color:"#fad114"}}):(0,u.jsx)(an.Z,{}),onClick:function(){return a((null===r||void 0===r?void 0:r.fileName)===e.fileName&&(null===r||void 0===r?void 0:r.name)===e.name?void 0:(0,M.Z)({type:"postprocessing"},e))}}),(0,u.jsx)(zr,{simulation:{id:n.id},file:{name:e.name,fileName:e.fileName,originPath:e.originPath}}),e.name]},e.glb)})):"No results"})})]})]})})},$r="Unable to load plugins",ea="Unable to update simulation",na=function(e,n){wt.Z.list().then((function(t){var i=ta(e,Zt.Z,t);n(i)})).catch((function(e){(0,S.lt)($r,e)}))},ta=function(e,n,t){var i=n;return t.forEach((function(n){var t;(null===e||void 0===e||null===(t=e.authorizedplugins)||void 0===t?void 0:t.includes(n.key))&&"Model"===n.category&&(i=(0,a.Z)(i).concat((0,a.Z)(n.models)))})),i},ia=function(){var e=(0,i.Z)((function(e,n,t){var i,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=n.find((function(n){var t;return n.algorithm===(null===e||void 0===e||null===(t=e.scheme)||void 0===t?void 0:t.algorithm)})),r=ht.Z.deepCopy(e),(0,mt.merge)(r.scheme,i),[4,oe.update({id:e.id},[{key:"scheme",value:r.scheme}])];case 1:return o.sent(),t.mutateOneSimulation(r),[3,3];case 2:return a=o.sent(),(0,S.lt)(ea,a),[3,3];case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),ra={Selector:function(e){var n=e.visible,t=e.user,r=e.onOk,a=e.onCancel,l=(0,s.useState)(),c=l[0],m=l[1],h=(0,s.useState)(!1),v=h[0],p=h[1],y=(0,s.useState)([]),x=y[0],g=y[1],b=(0,s.useState)(),j=b[0],Z=b[1],w=(0,s.useState)(),C=w[0],S=w[1];(0,s.useEffect)((function(){t&&na(t,g)}),[t]),(0,s.useEffect)((function(){var e=x.map((function(e){return e.category})).filter((function(e,n,t){return t.indexOf(e)===n})).map((function(e){return{key:e,value:e}}));Z(e)}),[x]);var k=(0,s.useCallback)((function(e){var n=e.key,t=x.find((function(e){return e.algorithm===n}));m(ht.Z.deepCopy(t))}),[x]),E=(0,s.useCallback)((function(e){var n=e.key,i=t.models.find((function(e){return e.algorithm===n}));m(ht.Z.deepCopy(i))}),[t]),P=[{key:"category",disabled:!0,label:(0,u.jsx)(yt.Z,{className:"full-width",options:j,allowClear:!0,showArrow:!1,placeholder:"Category filter",onChange:function(e){return S(e)}})}];x.forEach((function(e){C&&e.category!==C||P.push({key:e.algorithm,label:e.name})}));var _=[{key:"category",disabled:!0,label:(0,u.jsx)(yt.Z,{className:"full-width",options:j,allowClear:!0,showArrow:!1,placeholder:"Category filter",onChange:function(e){return S(e)}})}];return t&&t.models.forEach((function(e){C&&e.category!==C||_.push({key:e.algorithm,label:e.name})})),(0,u.jsx)(xt.Z,{open:n,title:"Create simulation",okText:"Create",okButtonProps:{loading:v},onOk:(0,i.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:if(p(!0),!c)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,r(c)];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return p(!1),[2]}}))})),onCancel:function(){return a()},width:"80%",children:(0,u.jsxs)(d.Z,{children:[(0,u.jsx)(d.Z.Sider,{theme:"light",width:300,children:(0,u.jsx)(gt.Z,{items:[{key:"tanatloc",label:"Tanatloc algorithm",children:(0,u.jsx)(f.Z,{mode:"inline",items:P,onSelect:k})},{key:"personal",label:"User algorithm",children:(0,u.jsx)(f.Z,{mode:"inline",items:_,onSelect:E})}]})}),(0,u.jsx)(d.Z.Content,{className:"simulation-selector",children:(0,u.jsx)(pe.Z.Html,{html:null===c||void 0===c?void 0:c.description})})]})})},Updater:function(e){var n=e.user,t=e.simulation,i=e.swr,r=(0,s.useState)([]),a=r[0],o=r[1];return(0,s.useEffect)((function(){n&&na(n,o)}),[n]),(0,s.useEffect)((function(){var e=a.find((function(e){var n;return e.algorithm===(null===t||void 0===t||null===(n=t.scheme)||void 0===n?void 0:n.algorithm)}));if(e&&(null===t||void 0===t?void 0:t.scheme)){var n=(0,bt.Z)(t.scheme,e),r=(0,jt.Z)(t.scheme,e);(Object.keys(n).length||Object.keys(r).length)&&(xt.Z.info({title:"Update",content:"Your model need an update, please wait.",closable:!1,okButtonProps:{hidden:!0}}),ia(t,a,i).finally((function(){return xt.Z.destroyAll()})))}}),[t,a,i]),null},About:At,Geometry:Bt,Materials:vi,Parameters:bi,Initialization:_i,BoundaryConditions:Ji,Run:Gr,Postprocessing:Qr},aa=ra,oa={label:"GEOMETRIES",key:"geometries"},ua={label:"SIMULATIONS",key:"simulations"},la="Unable to get user",sa="Unable to get project",ca="Unable to get simulations",da="Unable to get geometries",fa="Unable to add simulation",ma=function(){var e=(0,i.Z)((function(e,n,t){var i,r;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,oe.add({id:e.id},{name:n.name,scheme:n})];case 1:return i=o.sent(),t.addOneSimulation(i),t.mutateProject({id:e.id,simulations:(0,a.Z)(e.simulations||[]).concat([i.id])}),[3,3];case 2:throw r=o.sent(),(0,S.lt)(fa,r),r;case 3:return[2]}}))}));return function(n,t,i){return e.apply(this,arguments)}}(),ha=function(){var e=(0,l.useRouter)(),n=e.query,t=n.page,E=n.workspaceId,P=n.projectId,_=(0,s.useState)(!1),N=_[0],M=_[1],T=(0,s.useState)(),z=T[0],A=T[1],R=(0,s.useState)(!1),D=R[0],F=R[1],L=(0,s.useState)(),U=L[0],V=L[1],I=(0,s.useState)(),B=I[0],H=I[1],G=(0,s.useState)(),W=G[0],X=G[1],K=(0,s.useState)(),Q=K[0],$=K[1],ee=(0,s.useState)(),ne=ee[0],te=ee[1],ie=(0,s.useState)(!0),re=ie[0],ae=ie[1],ue=(0,r.Z)(J.Z.useUser(),2),le=ue[0],se=ue[1],ce=se.errorUser,de=se.loadingUser,fe=(0,r.Z)(q.Z.useProject(P),2),he=fe[0],pe=fe[1],ye=pe.mutateProject,xe=pe.errorProject,ge=pe.loadingProject,be=(0,r.Z)(oe.useSimulations(null===he||void 0===he?void 0:he.simulations),2),je=be[0],Ze=be[1],we=Ze.addOneSimulation,Ce=Ze.delOneSimulation,Se=Ze.mutateOneSimulation,ke=Ze.errorSimulations,Ee=Ze.loadingSimulations,Pe=(0,r.Z)(me.useGeometries(null===he||void 0===he?void 0:he.geometries),2),_e=Pe[0],Ne=Pe[1],Oe=Ne.addOneGeometry,Me=Ne.delOneGeometry,Te=Ne.mutateOneGeometry,ze=Ne.errorGeometries,Ae=Ne.loadingGeometries,Re=(0,s.useCallback)((function(){te(void 0),$(void 0)}),[]);(0,s.useEffect)((function(){de||le||e.replace("/login")}),[le,de,e]),(0,s.useEffect)((function(){ce&&(0,S.lt)(la,ce),xe&&(0,S.lt)(sa,xe),ke&&(0,S.lt)(ca,ke),ze&&(0,S.lt)(da,ze)}),[ce,xe,ke,ze]),(0,s.useEffect)((function(){ge||Ae||_e.length?M(!1):M(!0)}),[ge,Ae,_e]),(0,s.useEffect)((function(){if(!Ae&&z){var e=_e.find((function(e){return e.id===(null===z||void 0===z?void 0:z.id)}));e?JSON.stringify(e)!==JSON.stringify(z)&&A(e):A(void 0)}else A(_e[0])}),[_e,z,Ae,A]),(0,s.useEffect)((function(){if(!Ee&&U){var e=je.find((function(e){return e.id===(null===U||void 0===U?void 0:U.id)}));e?JSON.stringify(e)!==JSON.stringify(U)&&V(e):(Re(),V(void 0))}}),[je,U,Ee,V,Re]);var De=(0,s.useCallback)((function(){A({id:"0",needCleanup:!0})}),[]),Fe=(0,s.useCallback)((function(e){var n=_e.find((function(n){return n.id===e}));n&&(A(n),te((0,u.jsx)(ve,{visible:!0,title:"Geometry",onClose:Re,children:(0,u.jsx)(Le,{project:{id:he.id,geometries:he.geometries},geometry:{id:n.id,name:n.name,summary:n.summary},swr:{mutateProject:ye,mutateOneGeometry:Te,delOneGeometry:Me},close:Re,onCleanup:De})})))}),[he,_e,ye,Te,Me,De,Re]),Ue=(0,s.useCallback)((function(e){te((0,u.jsx)(ve,{visible:!0,title:"About",onClose:Re,children:(0,u.jsx)(aa.About,{project:{id:he.id,simulations:he.simulations},simulation:{id:e.id,name:e.name,scheme:e.scheme},swr:{mutateProject:ye,addOneSimulation:we,delOneSimulation:Ce,mutateOneSimulation:Se}})}))}),[he,ye,we,Ce,Se,Re]),Ve=(0,s.useCallback)((function(e){te((0,u.jsx)(ve,{visible:!0,title:"Geometry",onClose:Re,children:(0,u.jsx)(aa.Geometry,{geometries:_e,geometry:z&&{id:z.id,summary:z.summary},simulation:{id:e.id,scheme:e.scheme},setGeometry:A,swr:{mutateOneSimulation:Se}})}))}),[_e,z,Se,Re]),Ie=(0,s.useCallback)((function(e){te((0,u.jsx)(ve,{visible:!0,title:"Parameters",onClose:Re,children:(0,u.jsx)(aa.Parameters,{simulation:{id:e.id,scheme:e.scheme},swr:{mutateOneSimulation:Se}})}))}),[Se,Re]),Be=(0,s.useCallback)((function(e){te((0,u.jsx)(ve,{visible:re,title:"Materials",onClose:Re,children:(0,u.jsx)(aa.Materials,{geometry:z&&{id:z.id,summary:z.summary},simulation:{id:e.id,scheme:e.scheme},swr:{mutateOneSimulation:Se},setVisible:function(e){return ae(e)}})}))}),[z,re,Se,Re]),He=(0,s.useCallback)((function(e){te((0,u.jsx)(ve,{visible:!0,title:"Initialization",onClose:Re,children:(0,u.jsx)(aa.Initialization,{simulations:je,simulation:e,swr:{mutateOneSimulation:Se}})}))}),[je,Se,Re]),Ge=(0,s.useCallback)((function(e){te((0,u.jsx)(ve,{visible:re,title:"Boundary conditions",onClose:Re,children:(0,u.jsx)(aa.BoundaryConditions,{geometry:z&&{id:z.id,summary:z.summary},simulation:{id:e.id,scheme:e.scheme},swr:{mutateOneSimulation:Se},setVisible:function(e){return ae(e)}})}))}),[z,re,Se,Re]),We=(0,s.useCallback)((function(e){te((0,u.jsx)(ve,{visible:re,title:"Run",onClose:Re,children:(0,u.jsx)(aa.Run,{simulation:{id:e.id,scheme:e.scheme},result:B&&{name:B.name,fileName:B.fileName},setResult:H,setVisible:function(e){return ae(e)},swr:{mutateOneSimulation:Se}})}))}),[B,re,Se,Re]),Ye=(0,s.useCallback)((function(e,n){var t,i,r,a=je.find((function(n){return n.id===e}));if(a){V(a);var o=null===(t=a.scheme)||void 0===t||null===(i=t.configuration)||void 0===i||null===(r=i.geometry)||void 0===r?void 0:r.value;if(o&&(null===z||void 0===z?void 0:z.id)!==o){var u=_e.find((function(e){return e.id===o}));u&&A(u)}switch(n){case"about":Ue(a);break;case"geometry":Ve(a);break;case"parameters":Ie(a);break;case"materials":Be(a);break;case"initialization":He(a);break;case"boundaryConditions":Ge(a);break;case"run":We(a);break;default:te(void 0)}}}),[z,_e,je,Ue,Ve,Ie,Be,He,Ge,We]);(0,s.useEffect)((function(){Q&&(Q.key===oa.key?Fe(Q.id):(Ye(Q.id,Q.item),"run"!==Q.item&&(H(void 0),X(void 0))))}),[Q,Fe,Ye,Re]),(0,s.useEffect)((function(){!B&&W&&X(void 0)}),[B,W]);var Je=(0,s.useCallback)((function(e){var n,t=e.keyPath,i=t.pop(),r=t.pop(),a=t.pop();a&&(n=a.split("&").pop()),$({key:i,id:r,item:n})}),[]),qe=_e.map((function(e){return{key:e.id,icon:(0,u.jsx)(v.Z,{}),label:e.name}})),Xe=je.map((function(e){var n=e.scheme.configuration||{},t=[];Object.keys(n).forEach((function(i){if("dimension"!==i){var r=n[i],a=(0,u.jsx)(p.Z,{style:{color:"green"}});r.error&&(a=(0,u.jsx)(y.Z,{style:{color:"red"}})),r.done||(a=(0,u.jsx)(x.Z,{style:{color:"orange"}})),"geometry"!==i||_e.filter((function(e){return e.id===r.value})).length||Ae||(a=(0,u.jsx)(x.Z,{style:{color:"orange"}}),r.done=null),t[r.index]={key:e.id+"&"+i,className:"Project-Menu-SubMenu-Simulations-SubMenu-MenuItem",disabled:!_e.length,icon:a,label:r.title}}}));var i=e.name;return e.scheme.user&&(i=(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(c.Z,{title:"User algorithm",placement:"right",children:(0,u.jsx)(g.Z,{style:{position:"absolute",top:0,left:14,fontSize:14,color:"#fad114"}})}),e.name]})),{key:e.id,className:"Project-Menu-SubMenu-Simulations-SubMenu",icon:(0,u.jsx)(b.Z,{}),label:i,children:[{key:e.id+"&about",className:"Project-Menu-SubMenu-Simulations-SubMenu-MenuItem",disabled:!_e.length,icon:(0,u.jsx)(p.Z,{style:{color:"green"}}),label:"About"}].concat((0,a.Z)(t))}}));return!le||de||ge?(0,u.jsx)(k.Z.Simple,{}):"0"===he.id?(0,u.jsx)(O,{}):(0,u.jsx)(Y,{children:(0,u.jsxs)(d.Z,{hasSider:!0,children:[(0,u.jsxs)(d.Z.Sider,{theme:"light",className:"Project-Sider",width:256,children:[(0,u.jsx)("div",{className:"logo",children:(0,u.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,u.jsx)(f.Z,{mode:"inline",items:[{key:"menu-go-back",disabled:!0,className:"Project-Menu-GoBack",style:{cursor:"unset",margin:"10px 0",paddingLeft:10},label:(0,u.jsx)(C.ks,{onClick:function(){return function(e,n,t){e.push({pathname:"/dashboard",query:{page:n,workspaceId:t}})}(e,t,E)},children:"Return to dashboard"})},{type:"divider",className:"Project-Menu-Divider"},{key:"title",disabled:!0,className:"Project-Menu-Title",label:(0,u.jsx)(m.Z.Paragraph,{ellipsis:{tooltip:!0,rows:1},children:he.title})}]}),(0,u.jsx)("div",{className:"Project-Menu-scroll",children:(0,u.jsx)(f.Z,{className:"Project-Menu",mode:"inline",defaultOpenKeys:[oa.key,ua.key],items:[{key:oa.key,className:"Project-Menu-SubMenu-Geometries",icon:Ae?(0,u.jsx)(j.Z,{}):(0,u.jsx)(v.Z,{}),label:(0,u.jsxs)(m.Z.Text,{strong:!0,children:[oa.label," (",_e.length,")"]}),children:[{key:"new_geometry",className:"Project-Menu-SubMenu-Geometries-New",disabled:!0,label:(0,u.jsx)(h.Z,{icon:(0,u.jsx)(Z.Z,{}),onClick:function(){return M(!0)},children:"New Geometry"})},{key:"geometry-needed",className:"text-dark "+(_e.length?"display-none":""),disabled:!0,icon:(0,u.jsx)(x.Z,{style:{color:"red"}}),label:"A Geometry is needed"}].concat((0,a.Z)(qe))},{key:ua.key,className:"Project-Menu-SubMenu-Simulations",icon:Ee?(0,u.jsx)(j.Z,{}):(0,u.jsx)(b.Z,{}),label:(0,u.jsxs)(m.Z.Text,{strong:!0,children:[ua.label," (",je.length,")"]}),children:[{key:"new_simulation",className:"Project-Menu-SubMenu-Simulations-New",disabled:!0,label:(0,u.jsx)(h.Z,{disabled:!_e.length,icon:(0,u.jsx)(w.Z,{}),onClick:function(){return F(!0)},children:"New Simulation"})}].concat((0,a.Z)(Xe))}],onClick:Je})})]}),(0,u.jsxs)(d.Z.Content,{className:"no-scroll relative",children:[(0,u.jsx)(Le.Add,{visible:N,project:{id:he.id,geometries:he.geometries},swr:{mutateProject:ye,addOneGeometry:Oe},setVisible:function(e){return M(e)}}),(0,u.jsx)(aa.Selector,{user:{authorizedplugins:le.authorizedplugins,models:le.models},visible:D,onOk:function(){var e=(0,i.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,ma(he,e,{addOneSimulation:we,mutateProject:ye})];case 1:return n.sent(),F(!1),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),onCancel:function(){return F(!1)}}),(0,u.jsx)(aa.Updater,{user:{authorizedplugins:le.authorizedplugins},simulation:U&&{id:U.id,scheme:U.scheme},swr:{mutateOneSimulation:Se}}),ne,(0,u.jsx)($n,{project:{id:he.id,title:he.title},simulation:U&&{id:U.id},geometry:z&&{id:z.id,needCleanup:z.needCleanup},result:B&&{glb:B.glb,originPath:B.originPath},postprocessing:W&&{glb:W.glb,originPath:W.originPath}}),(0,u.jsx)(pt,{simulation:U&&{id:U.id,name:U.name}}),(0,u.jsx)(aa.Postprocessing,{simulation:U&&{id:U.id,scheme:U.scheme},result:B&&{name:B.name,fileName:B.fileName,originPath:B.originPath},postprocessing:W&&{name:W.name,fileName:W.fileName},setResult:X})]})]})})}},64546:function(e,n,t){var i={"./local/src/components":[17697,7697]};function r(e){if(!t.o(i,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=i[e],r=n[0];return t.e(n[1]).then((function(){return t(r)}))}r.keys=function(){return Object.keys(i)},r.id=64546,e.exports=r}}]);