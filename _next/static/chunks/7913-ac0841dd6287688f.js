(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7913],{27588:function(e,l,t){"use strict";t.d(l,{E:function(){return i},j:function(){return a}});let a=[{label:"Density",symbol:"Rho",unit:"\\(kg.m^{-3}\\)"},{label:"Young's modulus",symbol:"E",unit:"\\(Pa\\)"},{label:"Poisson's ratio",symbol:"Nu",unit:"\\(1\\)"},{label:"Thermal conductivity",symbol:"Lambda",unit:"\\(W.m^{-1}.K^{-1}\\)"},{label:"Heat capacity",symbol:"Cp",unit:"\\(J.K^{-1}.kg^{-1}\\)"},{label:"Dynamic viscosity",symbol:"Mu",unit:"\\(Pa.s\\)"}],i={metal:{label:"Metal",children:[{key:"steel",label:"Generic Steel",children:[{label:"Density",symbol:"Rho",value:"7850"},{label:"Young's modulus",symbol:"E",value:"2.1e11"},{label:"Poisson's ratio",symbol:"Nu",value:"0.3"},{label:"Thermal conductivity",symbol:"Lambda",value:"15"},{label:"Heat capacity",symbol:"Cp",value:"502"}]},{key:"S235JR+AR",label:"Steel (S235JR+AR)",children:[{label:"Density",symbol:"Rho",value:"7850"},{label:"Young's modulus",symbol:"E",value:"2.1e11"},{label:"Poisson's ratio",symbol:"Nu",value:"0.27"},{label:"Thermal conductivity",symbol:"Lambda",value:"15"},{label:"Heat capacity",symbol:"Cp",value:"502"}]},{key:"304",label:"Stainless Steel 304",children:[{label:"Density",symbol:"Rho",value:"8000"},{label:"Young's modulus",symbol:"E",value:"193e9"},{label:"Poisson's ratio",symbol:"Nu",value:"0.29"},{label:"Thermal conductivity",symbol:"Lambda",value:"16.2"},{label:"Heat capacity",symbol:"Cp",value:"500"},{label:"Yield strength",symbol:"SigmaY",value:"215e6"}]},{key:"316L",label:"Stainless Steel 316L",children:[{label:"Density",symbol:"Rho",value:"7990"},{label:"Young's modulus",symbol:"E",value:"193e9"},{label:"Poisson's ratio",symbol:"Nu",value:"0.25"},{label:"Thermal conductivity",symbol:"Lambda",value:"16.2"},{label:"Heat capacity",symbol:"Cp",value:"500"},{label:"Yield strength",symbol:"SigmaY",value:"290e6"}]},{key:"6082-O",label:"Aluminium 6082-O",children:[{label:"Density",symbol:"Rho",value:"2700"},{label:"Young's modulus",symbol:"E",value:"69e9"},{label:"Poisson's ratio",symbol:"Nu",value:"0.33"},{label:"Thermal conductivity",symbol:"Lambda",value:"170"},{label:"Heat capacity",symbol:"Cp",value:"960"},{label:"Yield strength",symbol:"SigmaY",value:"60e6"}]},{key:"7075-O",label:"Aluminium 7075-O",children:[{label:"Density",symbol:"Rho",value:"2810"},{label:"Young's modulus",symbol:"E",value:"71.7e9"},{label:"Poisson's ratio",symbol:"Nu",value:"0.33"},{label:"Thermal conductivity",symbol:"Lambda",value:"173"},{label:"Heat capacity",symbol:"Cp",value:"960"},{label:"Yield strength",symbol:"SigmaY",value:"110e6"}]},{key:"2017A",label:"Aluminium 2017A",children:[{label:"Density",symbol:"Rho",value:"2790"},{label:"Young's modulus",symbol:"E",value:"72.5e9"},{label:"Poisson's ratio",symbol:"Nu",value:"0.33"},{label:"Thermal conductivity",symbol:"Lambda",value:"134"},{label:"Heat capacity",symbol:"Cp",value:"873"},{label:"Yield strength",symbol:"SigmaY",value:"275e6"}]}]},polymer:{label:"Polymer",children:[{key:"PMMA",label:"PMMA",children:[{label:"Density",symbol:"Rho",value:"1180"},{label:"Young's modulus",symbol:"E",value:"2.9e9"},{label:"Poisson's ratio",symbol:"Nu",value:"0.36"},{label:"Thermal conductivity",symbol:"Lambda",value:"0.193"},{label:"Heat capacity",symbol:"Cp",value:"1480"},{label:"Yield strength",symbol:"SigmaY",value:"69e6"}]}]},fluid:{label:"Fluid",children:[{key:"water",label:"Water",children:[{label:"Density",symbol:"Rho",value:"1e3"},{label:"Dynamic viscosity",symbol:"Mu",value:"1e-3"},{label:"Thermal conductivity",symbol:"Lambda",value:"0.6"},{label:"Heat capacity",symbol:"Cp",value:"4185"}]}]},contact:{label:"Contact",children:[{key:"fundation",label:"Fundation",children:[]}]}}},83755:function(e,l,t){"use strict";t.d(l,{R:function(){return u},_:function(){return r}});var a=t(59134),i=t.n(a),n=t(83454);let s=n.env.PORT?parseInt(n.env.PORT):3e3,o=i()()?"http://localhost:"+s:"",r=async(e,l)=>{let t=await fetch(o+e,{method:l?"POST":"GET",headers:{accept:"application/json","Content-Type":"application/json"},...l&&{body:l}}),a=t.headers.get("Content-Type");if(!t.ok){let e=Error("An error occured while fetching data.");throw e.info=(null==a?void 0:a.includes("application/json"))&&await t.json(),e.status=t.status,e}return t.json()},u=async(e,l)=>{var t;let a=await fetch(o+e,{...l,method:null!==(t=null==l?void 0:l.method)&&void 0!==t?t:"GET",headers:{...null==l?void 0:l.headers,"Content-Type":"application/json"}}),i=a.headers.get("Content-Type");if(!a.ok){let e=Error("An error occured while fetching data.");throw e.info=(null==i?void 0:i.includes("application/json"))&&await a.json(),e.status=a.status,e}return a}},33997:function(e,l,t){"use strict";t.d(l,{Z:function(){return d}});var a=t(83755);let i=async e=>{await (0,a.R)("/api/plugin",{method:"POST",body:JSON.stringify(e)})},n=async e=>{await (0,a.R)("/api/plugin",{method:"PUT",body:JSON.stringify(e)})},s=async e=>{await (0,a.R)("/api/plugin",{method:"DELETE",body:JSON.stringify(e)})};var o=t(59734),r=t(67294);let u=()=>{var e;let{data:l,error:t,mutate:i}=(0,o.ZP)("/api/plugin",a._),n=null!==(e=null==l?void 0:l.plugins)&&void 0!==e?e:[],s=(0,r.useCallback)(async e=>{let l=[...n,e];await i({plugins:l})},[n,i]),u=(0,r.useCallback)(async e=>{let l=n.filter(l=>l.key!==e.key);await i({plugins:l})},[n,i]),d=(0,r.useCallback)(async e=>{let l=n.map(l=>(l.key===e.key&&(l={...l,...e}),l));await i({plugins:l})},[n,i]);return[n,{addOnePlugin:s,delOnePlugin:u,mutateOnePlugin:d,errorPlugins:t,loadingPlugins:!l}]};var d={add:i,update:n,del:s,usePlugins:u}},55276:function(e,l,t){"use strict";t.d(l,{Z:function(){return s}});var a=t(83755);let i=async()=>{let e=await (0,a.R)("/api/plugins",{method:"GET",headers:{Accept:"application/json"}});return e.json()},n=async()=>{let e=await (0,a.R)("/api/plugins",{method:"POST",headers:{Accept:"application/json"}});return e.json()};var s={list:i,completeList:n}},10739:function(e,l,t){"use strict";t.d(l,{Z:function(){return o}});var a=t(83755);let i=async(e,l)=>{let t=await (0,a.R)("/api/result",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({simulation:e,result:l})});return t.json()},n=async(e,l)=>(0,a.R)("/api/result/download",{method:"POST",body:JSON.stringify({simulation:e,result:l})}),s=async e=>(0,a.R)("/api/result/archive",{method:"POST",body:JSON.stringify({simulation:e})});var o={load:i,download:n,archive:s}},72616:function(e,l,t){"use strict";t.d(l,{Z:function(){return v}});var a=t(59734),i=t(67294),n=t(83755);let s=e=>{var l;let{data:t,error:s,mutate:o}=(0,a.ZP)(["/api/simulations",JSON.stringify({ids:e})],e=>{let[l,t]=e;return(0,n._)(l,t)}),r=null!==(l=null==t?void 0:t.simulations)&&void 0!==l?l:[],u=(0,i.useCallback)(async e=>{let l=[...r,e];await o({simulations:l})},[r,o]),d=(0,i.useCallback)(async e=>{let l=r.filter(l=>l.id!==e.id);await o({simulations:l})},[r,o]),c=(0,i.useCallback)(async(e,l)=>{let t=r.map(l=>(l.id===e.id&&(l={...l,...e}),l));await o({simulations:t},l)},[r,o]);return[r,{addOneSimulation:u,delOneSimulation:d,mutateOneSimulation:c,errorSimulations:s,loadingSimulations:!t}]},o=(e,l)=>{var t;let{data:s,error:o,mutate:r}=(0,a.ZP)("/api/simulation"+(e?"/"+e:""),n._,{refreshInterval:null!=l?l:0}),u=null!==(t=null==s?void 0:s.simulation)&&void 0!==t?t:{id:"0"},d=(0,i.useCallback)(async e=>{await r({simulation:{...u,...e}})},[u,r]);return[u,{mutateSimulation:d,errorSimulation:o,loadingSimulation:!s}]},r=async(e,l)=>{let t=await (0,n.R)("/api/simulation",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({project:{id:e.id},simulation:l})});return t.json()},u=async(e,l)=>{await (0,n.R)("/api/simulation/"+e.id,{method:"PUT",body:JSON.stringify(l)})},d=async e=>{await (0,n.R)("/api/simulation/"+e.id,{method:"DELETE"})},c=async e=>{await (0,n.R)("/api/simulation/"+e.id+"/run",{method:"GET"})},m=async e=>{await (0,n.R)("/api/simulation/"+e.id+"/stop",{method:"GET"})},h=async e=>{let l=await (0,n.R)("/api/simulation/"+e.id+"/tasks",{method:"GET",headers:{Accept:"application/json"}});return l.json()},y=async(e,l)=>{let t=await (0,n.R)("/api/simulation/"+e.id+"/log",{method:"POST",body:JSON.stringify({file:l})});return t.json()},p=async e=>{let l=await (0,n.R)("/api/simulation/"+e.id+"/copy",{method:"GET"});return l.json()};var v={useSimulations:s,useSimulation:o,add:r,update:u,del:d,run:c,stop:m,tasks:h,log:y,copy:p}},42661:function(e,l,t){"use strict";t.d(l,{Z:function(){return y}});var a=t(59734),i=t(67294),n=t(83755);let s=()=>{let{data:e,error:l,mutate:t}=(0,a.ZP)("/api/user",n._),s=null==e?void 0:e.user,o=(0,i.useCallback)(async e=>{await t({user:{...s,...e}})},[s,t]),r=(0,i.useCallback)(async()=>{await t({user:void 0})},[t]);return[s,{mutateUser:o,clearUser:r,errorUser:(null==l?void 0:l.status)===401?void 0:l,loadingUser:(null==l?void 0:l.status)!==401&&!e}]},o=()=>{var e;let{data:l,error:t,mutate:s}=(0,a.ZP)("/api/users",n._),o=null!==(e=null==l?void 0:l.users)&&void 0!==e?e:[],r=(0,i.useCallback)(async e=>{let l=[...o,{...e,authorizedplugins:[]}];await s({users:l})},[o,s]),u=(0,i.useCallback)(async e=>{let l=o.filter(l=>l.id!==e.id);await s({users:l})},[o,s]),d=(0,i.useCallback)(async e=>{let l=o.map(l=>(l.id===e.id&&(l={...l,...e}),l));await s({users:l})},[o,s]);return[o,{addOneUser:r,delOneUser:u,mutateOneUser:d,errorUsers:t,loadingUsers:!l}]},r=async e=>{let l=await (0,n.R)("/api/user",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(e)});return l.json()},u=async e=>{await (0,n.R)("/api/user",{method:"PUT",body:JSON.stringify(e)})},d=async(e,l)=>{await (0,n.R)("/api/user/"+e,{method:"PUT",body:JSON.stringify(l)})},c=async()=>{await (0,n.R)("/api/user",{method:"DELETE"})},m=async e=>{await (0,n.R)("/api/user/"+e,{method:"DELETE"})},h=async e=>{let l=await (0,n.R)("/api/user/check",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(e)});return l.json()};var y={useUser:s,useUsers:o,add:r,update:u,updateById:d,del:c,delById:m,check:h}},94725:function(e,l,t){"use strict";var a=t(85893),i=t(67294),n=t(41664),s=t.n(n),o=t(26713),r=t(85813),u=t(57953),d=t(97183),c=t(22850),m=t(3363),h=t(50888),y=t(28058),p=t(14856),v=t.n(p),f=t(80108),b=t.n(f);let g=()=>(0,a.jsx)(o.Z,{style:{height:"100%",width:"100%",justifyContent:"center",alignItems:"center"},children:(0,a.jsx)(r.Z,{children:(0,a.jsxs)(o.Z,{children:[(0,a.jsx)(u.Z,{}),"Loading, please wait..."]})})}),x=e=>{let{text:l,status:t,errors:n}=e,[o,p]=(0,i.useState)([]),[f,g]=(0,i.useState)([]);(0,i.useEffect)(()=>{if(!(null==t?void 0:t.length)){p([]);return}let e=t.map((e,l)=>({index:l,status:"finish",icon:0===l?(0,a.jsx)(h.Z,{}):void 0,title:e})).filter(e=>e);p(e)},[t]),(0,i.useEffect)(()=>{if(!(null==n?void 0:n.length)){g([]);return}g(n.map(e=>{let l=null;return e.includes("docker: command not found")||e.includes("Is the docker daemon running")?l=(0,a.jsxs)(r.Z,{className:b().errorCard,children:["There is an error with your Docker installation.",(0,a.jsx)("br",{}),"Please verify that Docker is correctly installed and running."]}):(e.includes("EHOSTUNREACH")||e.includes("ENETUNREACH")||e.includes("ETIMEOUT"))&&(l=(0,a.jsxs)(r.Z,{className:b().errorCard,children:["There is an error with your PostgreSQL installation.",(0,a.jsx)("br",{}),'Please verify that postgres Docker container "tanatloc-postgres" is correctly installed and running.']})),(0,a.jsxs)("div",{children:[e,l]},e)}))},[n]);let x=!!(null==t?void 0:t.length)||!!(null==n?void 0:n.length);return(0,a.jsxs)(d.Z,{children:[(0,a.jsx)("div",{className:v().logo,children:(0,a.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,a.jsx)(r.Z,{className:b().loading,bodyStyle:{padding:0},title:(0,a.jsx)("div",{className:b().title,children:(null==n?void 0:n.length)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Z,{className:"warning"}),(0,a.jsx)(c.Z.Title,{level:3,style:{margin:"0"},children:"An error occurs"}),(0,a.jsx)(s(),{href:"https://github.com/Airthium/tanatloc/issues/new/choose",target:"_blank",children:"Open an issue"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.Z,{size:"large",indicator:(0,a.jsx)(h.Z,{})}),null!=l?l:"Loading, please wait..."]})}),children:x?(0,a.jsxs)("div",{className:b().content,children:[f.length?(0,a.jsxs)("div",{className:b().errors,children:[f.map(e=>e),(0,a.jsx)(c.Z.Title,{level:5,children:"Please restart the application"})]}):null,(0,a.jsx)("div",{className:b().status,children:(0,a.jsx)(m.Z,{direction:"vertical",items:o})})]}):null})]})};x.Simple=g,l.Z=x},28913:function(e,l,t){"use strict";t.d(l,{ZP:function(){return tP}});var a,i,n,s,o,r,u,d,c,m=t(85893),h=t(67294),y=t(34041),p=t(39014),v=t(97183),f=t(44442),b=t(68508),g=t(23389),x=t(93398),j=t(96486),Z=t(36642),k=t(9242),C=t(62585),S=t(51302),w=[{category:"Academic",name:"Poisson's equation",algorithm:"poisson",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Poisson\'s equation\n  </h3>\n  <p>\n  Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n  The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n  The Poisson\'s equation reads as follow:\n  \\begin{align}\n    \\Delta u &= f &\\text{on }\\Omega\\\\\n    u &= u_D &\\text{on }\\Gamma_D\\\\\n    \\nabla u &= g_N &\\text{on }\\Gamma_N\n  \\end{align}\n  </p>\n  <figure>\n    <img src="/images/Poisson.png" alt="Poisson" />\n    <figcaption>Poisson\'s equation example on a cube.</figcaption>\n  </figure>\n  <p>\n      See <a target="_blank" href="https://en.wikipedia.org/wiki/Poisson%27s_equation">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},parameters:{index:2,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force",htmlEntity:"formula",default:"0"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"u",htmlEntity:"select",options:[{label:"P1",value:"P1"},{label:"P2",value:"P2"}],default:"P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]}},boundaryConditions:{index:3,title:"Boundary conditions",dirichlet:{label:"Dirichlet",children:[{label:"u",htmlEntity:"formula",default:"0"}]},neumann:{label:"Neumann",children:[{label:"du/dn",htmlEntity:"formula",default:"0"}]}},run:{index:4,title:"Run",results:[{name:"u"}]}}},{category:"Mechanics",name:"Linear elasticity",algorithm:"linearElasticity",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Linear elasticity\n  </h3>\n  <p>\n  Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n  The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n    \\(u\\) is the displacement.<br/>\n\n  The linear elasticity equation reads as follow:\n\n  $$\n  \\begin{align}\n    -\\text{div}(\\sigma) &= f &\\text{on }\\Omega\\\\\n    u &= u_D&\\text{on }\\Gamma_D\\\\\n    \\sigma\\cdot n &= u_N&\\text{on }\\Gamma_N\n  \\end{align}\n  $$\n\n  With \\(\\sigma_{ij}(u) = \\lambda\\delta_{ij}\\nabla\\cdot u + 2\\mu\\epsilon_{ij}(u)\\).<br/>\n\n  \\(\\lambda\\) and \\(\\mu\\) are the Lam\xe9 coefficients.\n  </p>\n  <figure>\n    <img src="/images/LinearElasticity.png" alt="Linear Elasticity" />\n    <figcaption>Linear elasticity equation example on a beam.</figcaption>\n  </figure>\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Linear_elasticity">Wikipedia</a>.\n  </p>\n  ',variables:[{name:"Displacement (x)",value:"Ux"},{name:"Displacement (y)",value:"Uy"},{name:"Displacement (z)",value:"Uz"}],configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Density",name:"Rho",htmlEntity:"formula",default:"8050",unit:"\\(kg.m^{-3}\\)"},{label:"Young's modulus",name:"E",htmlEntity:"formula",default:"1e9",unit:"\\(Pa\\)"},{label:"Poisson's ratio",name:"Nu",htmlEntity:"formula",default:"0.4",unit:"\\(1\\)"}]},parameters:{index:3,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force (x)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-3}\\)"},{label:"External force (y)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-3}\\)"},{only3D:!0,label:"External force (z)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-3}\\)"}]},gravity:{advanced:!0,label:"Gravity",children:[{label:"Standard gravity",htmlEntity:"formula",default:"9.81",unit:"\\(m.s^{-2}\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"[Ux, Uy, Uz]",label2D:"[Ux, Uy]",htmlEntity:"select",options:[{label:"P1",value:"P1, P1, P1",value2D:"P1, P1"},{label:"P2",value:"P2, P2, P2",value2D:"P2, P2"}],default:"P1, P1, P1",default2D:"P1, P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]},meshAdaptation:{advanced:!0,label:"Mesh adaptation",children:[{label:"Enabled",htmlEntity:"checkbox",default:!1},{label:"Number of mesh adaptation loops",htmlEntity:"formula",default:1}]}},boundaryConditions:{index:4,title:"Boundary conditions",fixed:{label:"Fixed",refineFactor:2},displacement:{label:"Displacement",children:[{label:"Ux",htmlEntity:"formula",default:"0",unit:"\\(m\\)"},{label:"Uy",htmlEntity:"formula",default:"0",unit:"\\(m\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:"0",unit:"\\(m\\)"}],refineFactor:2},presure:{label:"Surface force (normal)",children:[{label:"d(U)/d(N)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-2}\\)"}],refineFactor:2},componentsPresure:{label:"Surface force (components)",children:[{label:"x",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-2}\\)"},{label:"y",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-2}\\)"},{label:"z",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-2}\\)"}]}},run:{index:5,title:"Run",results:[{name:"Displacement"},{name:"vonMises"},{name:"gamma11"},{name:"gamma12"},{name:"gamma13"},{name:"gamma22"},{name:"gamma23"},{name:"gamma33"}],postprocessing:[{key:"warpByVector",parameters:[{key:"Vectors",value:"Displacement"}]},{key:"contour",parameters:[{key:"ContourBy",options:["Displacement","vonMises","gamma11","gamma12","gamma13","gamma22","gamma23","gamma33"]}]}]}}},{category:"Mechanics",name:"Linear elasticity (time dependent)",algorithm:"linearElasticityTime",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Linear elasticity (time dependent)\n  </h3>\n  <p>\n  Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n  The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n    \\(u\\) is the displacement.<br/>\n\n  The linear elasticity equation reads as follow:\n\n  $$\n  \\begin{align}\n    \\frac{\\partial^2u}{\\partial t^2}-\\text{div}(\\sigma) &= f &\\text{on }\\Omega\\\\\n    u &= u_D&\\text{on }\\Gamma_D\\\\\n    \\sigma\\cdot n &= u_N&\\text{on }\\Gamma_N\n  \\end{align}\n  $$\n\n  With \\(\\sigma_{ij}(u) = \\lambda\\delta_{ij}\\nabla\\cdot u + 2\\mu\\epsilon_{ij}(u)\\).<br>\n\n  \\(\\lambda\\) and \\(\\mu\\) are the Lam\xe9 coefficients.\n  </p>\n  <figure>\n    <img src="/images/LinearElasticity.png" alt="Linear Elasticity" />\n    <figcaption>Linear elasticity equation example on a beam.</figcaption>\n  </figure>\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Linear_elasticity">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Density",name:"Rho",htmlEntity:"formula",default:"8050",unit:"\\(kg.m^{-3}\\)"},{label:"Young's modulus",name:"E",htmlEntity:"formula",default:"1e9",unit:"\\(Pa\\)"},{label:"Poisson's ratio",name:"Nu",htmlEntity:"formula",default:"0.4",unit:"\\(1\\)"}]},parameters:{index:3,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force (x)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-3}\\)"},{label:"External force (y)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-3}\\)"},{only3D:!0,label:"External force (z)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-3}\\)"}]},gravity:{advanced:!0,label:"Gravity",children:[{label:"Standard gravity",htmlEntity:"formula",default:"9.81",unit:"\\(m.s^{-2}\\)"}]},time:{label:"Time",children:[{label:"Total time",htmlEntity:"formula",default:"1",unit:"\\(s\\)"},{label:"Time step",htmlEntity:"formula",default:"0.1",unit:"\\(s\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"[Ux, Uy, Uz]",label2D:"[Ux, Uy]",htmlEntity:"select",options:[{label:"P1",value:"P1, P1, P1",value2D:"P1, P1"},{label:"P2",value:"P2, P2, P2",value2D:"P2, P2"}],default:"P1, P1, P1",default2D:"P1, P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]},meshAdaptation:{advanced:!0,label:"Mesh adaptation",children:[{label:"Enabled",htmlEntity:"checkbox",default:!1}]}},boundaryConditions:{index:4,title:"Boundary conditions",fixed:{label:"Fixed",refineFactor:2},displacement:{label:"Displacement",children:[{label:"Ux",htmlEntity:"formula",default:"0",unit:"\\(m\\)"},{label:"Uy",htmlEntity:"formula",default:"0",unit:"\\(m\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:"0",unit:"\\(m\\)"}],refineFactor:2},presure:{label:"Surface force (normal)",children:[{label:"d(U)/d(N)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-2}\\)"}],refineFactor:2},componentsPresure:{label:"Surface force (components)",children:[{label:"x",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-2}\\)"},{label:"y",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-2}\\)"},{label:"z",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-2}\\)"}]}},run:{index:5,title:"Run",results:[{name:"Displacement"},{name:"vonMises"},{name:"gamma11"},{name:"gamma12"},{name:"gamma13"},{name:"gamma22"},{name:"gamma23"},{name:"gamma33"}],resultsFilter:{name:"Time",prefixPattern:"Result_",suffixPattern:".vtu",pattern:"Result_\\d+.vtu",multiplicator:["parameters","time","children","1"]},postprocessing:[{key:"warpByVector",parameters:[{key:"Vectors",value:"Displacement"}]},{key:"contour",parameters:[{key:"ContourBy",options:["Displacement","vonMises","gamma11","gamma12","gamma13","gamma22","gamma23","gamma33"]}]}]}}},{category:"Mechanics",name:"Linear elasticity - Modal analysis",algorithm:"linearElasticityModal",code:"FreeFEM",sequential:!0,version:"1.0.0",description:'<h3>\n  Modal analysis\n  </h3>\n  <p>\n  The modal analysis consists in finding the eigenfrequencies and eigenvectors of a structure.<br/>\n  Let \\(K\\) be the rigidity matrix of the structure and \\(M\\) its mass matrix.<br/>\n  The eigenvalue problem reads as follows\n  $$ (K -\\lambda M) x =0 $$\n  where \\(\\lambda\\) is the eigenvalue related to the natural frequency \\(f\\) by the following <br/>\n  $$\\lambda=(2\\pi f)^{2} $$\n  and \\(x\\) the eigenvector for the mode of the frequency \\(f\\).<br/>\n  Moreover the eigenvalue problem can be transformed as follows\n  $$ (A -\\sigma M)^{-1}Mx  = \\nu x$$\n  where\n  $$ \\nu  = \\frac{1}{\\lambda-\\sigma} $$\n  and \\(\\sigma\\) the shift of the method which helps to find eigenvalues near \\(\\sigma\\). By default \\(\\sigma\\) \\(=\\) \\(0\\). <br/>\n  </p>\n  <p>\n  You can see <a target="_blank" href="https://freefem.org">FreeFEM</a>.\n</p> ',variables:[{name:"Displacement (x)",value:"Ux"},{name:"Displacement (y)",value:"Uy"},{name:"Displacement (z)",value:"Uz"}],configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Density",name:"Rho",htmlEntity:"formula",default:"8050",unit:"\\(kg.m^{-3}\\)"},{label:"Young's modulus",name:"E",htmlEntity:"formula",default:"1e4",unit:"\\(Pa\\)"},{label:"Poisson's ratio",name:"Nu",htmlEntity:"formula",default:"0.3",unit:"\\(1\\)"}]},parameters:{index:3,title:"Parameters",modalparameters:{label:"Modal parameters",children:[{label:"sigma",htmlEntity:"formula",default:"0"},{label:"Eigenvectors number ",htmlEntity:"formula",default:"4"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"[Ux, Uy, Uz]",label2D:"[Ux, Uy]",htmlEntity:"select",options:[{label:"P1",value:"P1, P1, P1",value2D:"P1, P1"},{label:"P2",value:"P2, P2, P2",value2D:"P2, P2"}],default:"P1, P1, P1",default2D:"P1, P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]}},boundaryConditions:{index:4,title:"Boundary conditions",fixed:{label:"Fixed",refineFactor:2},free:{label:"Free"},displacement:{label:"Displacement",children:[{label:"Ux",htmlEntity:"formula",default:"0",unit:"\\(m\\)"},{label:"Uy",htmlEntity:"formula",default:"0",unit:"\\(m\\)"},{label:"Uz",htmlEntity:"formula",default:"0",unit:"\\(m\\)"}],refineFactor:2}},run:{index:5,title:"Run",results:[{name:"Displacement"}],resultsFilter:{name:"Mode number",prefixPattern:"Result_",suffixPattern:".vtu",pattern:"Result_\\d+.vtu"},postprocessing:[{key:"warpByVector",parameters:[{key:"Vectors",value:"Displacement"}]},{key:"contour",parameters:[{key:"ContourBy",options:["Displacement"]}]}]}}},{category:"Fluid",name:"Stokes",algorithm:"stokes",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Stokes\n  </h3>\n  <p>\n    Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n    The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n    \\(u\\) is the velocity and \\(p\\) the pressure.<br/>\n\n    The Stokes equations reads as follow:\n\n    $$\n    \\begin{align}\n      \\mu\\Delta u - \\nabla p &= f&\\text{on }\\Omega\\\\\n      u &= u_D&\\text{on }\\Gamma_D\\\\\n      \\mu\\frac{\\partial u}{\\partial n} - pn &= g_N&\\text{on }\\Gamma_N\n    \\end{align}\n    $$\n\n    With \\(\\mu\\) the viscosity.\n  </p>\n  <figure>\n    <img src="/images/Stokes.png" alt="Stokes" />\n    <figcaption>Stokes equation example on a pipe.</figcaption>\n  </figure>\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Navier%E2%80%93Stokes_equations">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Dynamic viscosity",name:"Mu",htmlEntity:"formula",default:"1e-3",unit:"\\(Pa.s\\)"}]},parameters:{index:3,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force (x)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-3}\\)"},{label:"External force (y)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-3}\\)"},{only3D:!0,label:"External force (z)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-3}\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"[Ux, Uy, Uz, p]",label2D:"[Ux, Uy, p]",htmlEntity:"select",options:[{label:"P2/P1",value:"P2, P2, P2, P1",value2D:"P2, P2, P1"},{label:"P1b/P1",value:"P1b, P1b, P1b, P1",value2D:"P1b, P1b, P1"}],default:"P2, P2, P2, P1",default2D:"P2, P2, P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]},symmetric:{advanced:!0,label:"Symmetric formulation",children:[{label:"Enabled",htmlEntity:"checkbox",default:!1}]}},boundaryConditions:{index:5,title:"Boundary conditions",wall:{label:"Wall"},freeOutlet:{label:"Free outlet"},dirichlet:{label:"Velocity",children:[{label:"Ux",htmlEntity:"formula",default:"0",unit:"\\(m.s^{-1}\\)"},{label:"Uy",htmlEntity:"formula",default:"0",unit:"\\(m.s^{-1}\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:"0",unit:"\\(m.s^{-1}\\)"}],refineFactor:2},neumann:{label:"Pressure",children:[{label:"d(U)/d(N)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-2}\\)"}],refineFactor:2}},run:{index:6,title:"Run",results:[{name:"Velocity"},{name:"Presure"}],postprocessing:[{key:"streamTracer",parameters:[{key:"Vectors",value:"Velocity"}]}]}}},{category:"Fluid",name:"Navier-Stokes time-dependant",algorithm:"navierStokesTime",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Navier-Stokes time-dependant\n  </h3>\n  <p>\n    Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n    The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n    \\(u\\) is the velocity and \\(p\\) the pressure.<br/>\n\n    The Navier-Stokes equations reads as follow:\n\n    $$\n    \\begin{align}\n      \\rho\\frac{\\partial u}{\\partial t} + \\rho(u\\cdot\\nabla)u + \\nabla p - \\mu\\Delta u &= f&\\text{on }\\Omega\\\\\n      u &= u_D&\\text{on }\\Gamma_D\\\\\n      \\mu\\frac{\\partial u}{\\partial n} - pn &= g_N&\\text{on }\\Gamma_N\n    \\end{align}\n    $$\n\n    With \\(\\mu\\) the viscosity and \\(\\rho\\) the density.\n  </p>\n  <figure>\n    <img src="/images/Stokes.png" alt="Stokes" />\n    <figcaption>Navier-Stokes equation example on a pipe.</figcaption>\n  </figure>\n  </p>\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Navier%E2%80%93Stokes_equations">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Density",name:"Rho",htmlEntity:"formula",default:"1e3",unit:"\\(kg.m^{-3}\\)"},{label:"Dynamic viscosity",name:"Mu",htmlEntity:"formula",default:"1e-3",unit:"\\(Pa.s\\)"}]},parameters:{index:3,title:"Parameters",rightHandSide:{label:"Right hand side",children:[{label:"External force (x)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-3}\\)"},{label:"External force (y)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-3}\\)"},{only3D:!0,label:"External force (z)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-3}\\)"}]},time:{label:"Time",children:[{label:"Total time",htmlEntity:"formula",default:"1",unit:"\\(s\\)"},{label:"Time step",htmlEntity:"formula",default:"0.1",unit:"\\(s\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"[Ux, Uy, Uz, p]",label2D:"[Ux, Uy, p]",htmlEntity:"select",options:[{label:"P2/P1",value:"P2, P2, P2, P1",value2D:"P2, P2, P1"},{label:"P1b/P1",value:"P1b, P1b, P1b, P1",value2D:"P1b, P1b, P1"}],default:"P2, P2, P2, P1",default2D:"P2, P2, P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]},symmetric:{advanced:!0,label:"Symmetric formulation",children:[{label:"Enabled",htmlEntity:"checkbox",default:!1}]}},initialization:{index:4,title:"Initialization",done:!0,direct:{label:"Velocity",children:[{label:"Ux",htmlEntity:"formula",default:"0",unit:"\\(m.s^{-1}\\)"},{label:"Uy",htmlEntity:"formula",default:"0",unit:"\\(m.s^{-1}\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:"0",unit:"\\(m.s^{-1}\\)"}]},coupling:{label:"Coupling",compatibility:[{algorithm:"navierStokesTime",filter:{name:"Time step",prefixPattern:"Result_",suffixPattern:".vtu",pattern:"Result_\\d+.vtu",multiplicator:["parameters","time","children","1"]}}]}},boundaryConditions:{index:5,title:"Boundary conditions",wall:{label:"Wall"},freeOutlet:{label:"Free outlet"},dirichlet:{label:"Velocity",children:[{label:"Ux",htmlEntity:"formula",default:"0",unit:"\\(m.s^{-1}\\)"},{label:"Uy",htmlEntity:"formula",default:"0",unit:"\\(m.s^{-1}\\)"},{only3D:!0,label:"Uz",htmlEntity:"formula",default:"0",unit:"\\(m.s^{-1}\\)"}],refineFactor:2},neumann:{label:"Pressure",children:[{label:"d(U)/d(N)",htmlEntity:"formula",default:"0",unit:"\\(N.m^{-2}\\)"}],refineFactor:2}},run:{index:6,title:"Run",results:[{name:"Velocity"},{name:"Presure"}],resultsFilter:{name:"Time",prefixPattern:"Result_",suffixPattern:".vtu",pattern:"Result_\\d+.vtu",multiplicator:["parameters","time","children","1"]},postprocessing:[{key:"streamTracer",parameters:[{key:"Vectors",value:"Velocity"}]}]}}},{category:"Thermic",name:"Thermal diffusion",algorithm:"thermicDiffusion",code:"FreeFEM",version:"1.0.0",description:'\n  <h3>\n    Thermal diffusion\n  </h3>\n  <p>\n    Let \\(\\Omega\\) be a domain of \\(\\mathbb{R}^{d}\\), with \\(d\\in\\{2,3\\}\\).<br/>\n\n    The domain \\(\\Omega\\) is bounded by \\(\\Gamma = \\Gamma_D \\cup \\Gamma_N\\).<br/>\n\n      \\(T\\) is the temperature.<br/>\n\n    The heat equation reads as follow:\n\n    $$\n    \\begin{align}\n      \\rho C_p \\frac{\\partial T}{\\partial t} - \\lambda\\Delta T &= f&\\text{on }\\Omega\\\\\n      T &= T_D&\\text{on }\\Gamma_D\\\\\n      \\lambda\\frac{\\partial T}{\\partial n} &= g_N&\\text{on }\\Gamma_N\n    \\end{align}\n    $$\n\n    With \\(\\rho\\) the density, \\(C_p\\) the heat capacity and \\(\\lambda\\) the thermal conductivity.\n  </p>\n\n  <figure>\n    <img src="/images/Heat.png" alt="Heat" />\n    <figcaption>Heat equation example on a beam.</figcaption>\n  </figure>\n  </p>\n\n  <p>\n    See <a target="_blank" href="https://en.wikipedia.org/wiki/Navier%E2%80%93Stokes_equations">Wikipedia</a>.\n  </p>\n  ',configuration:{geometry:{index:1,title:"Geometry",meshable:!0},materials:{index:2,title:"Materials",children:[{label:"Density",name:"Rho",htmlEntity:"formula",default:"7960",unit:"\\(kg.m^{-3}\\)"},{label:"Thermal conductivity",name:"Lambda",htmlEntity:"formula",default:"15",unit:"\\(W.m^{-1}.K^{-1}\\)"},{label:"Heat capacity",name:"Cp",htmlEntity:"formula",default:"502",unit:"\\(J.K^{-1}.kg^{-1}\\)"}]},parameters:{index:3,title:"Parameters",time:{label:"Time",children:[{label:"Total time",htmlEntity:"formula",default:"1",unit:"\\(s\\)"},{label:"Time step",htmlEntity:"formula",default:"0.1",unit:"\\(s\\)"}]},finiteElementSpace:{advanced:!0,label:"Finite element space",children:[{label:"T",htmlEntity:"select",options:[{label:"P1",value:"P1"},{label:"P2",value:"P2"}],default:"P1"}]},solver:{advanced:!0,label:"Solver",children:[{label:"System resolution",htmlEntity:"select",options:[{label:"GMRES",value:"GMRES"},{label:"MUMPS",value:"MUMPS"},{label:"UMFPACK",value:"UMFPACK"}],default:"MUMPS"}]}},boundaryConditions:{index:4,title:"Boundary conditions",temperature:{label:"Temperature",children:[{label:"T",htmlEntity:"formula",default:"0",unit:"K"}],refineFactor:2}},run:{index:5,title:"Run",results:[{name:"T"}],resultsFilter:{name:"Time",prefixPattern:"Result_",suffixPattern:".vtu",pattern:"Result_\\d+.vtu",multiplicator:["parameters","time","children","1"]}}}}],P=t(87782),E=t(72616),N=t(55276),T=t(85813),M=t(57953),O=t(22850),U=t(26713),_=t(99138),R=t(83062),D=t(71577),L=t(57132),F=t(14856),A=t.n(F);let G={copy:"Unable to copy simulation"},z=async(e,l,t)=>{try{let a=await E.Z.copy(l);await t.addOneSimulation(a),await t.mutateProject({id:e.id,simulations:[...e.simulations,a.id]})}catch(e){(0,k.lt)(G.copy,e)}},I=e=>{let{project:l,simulation:t,swr:a}=e,[i,n]=(0,h.useState)(!1),s=(0,h.useCallback)(()=>{(async()=>{n(!0);try{await z(l,t,a)}finally{n(!1)}})()},[l,t,a]);return(0,m.jsx)(R.Z,{title:"Copy simulation",children:(0,m.jsx)(D.ZP,{className:A().noBorder,loading:i,icon:(0,m.jsx)(L.Z,{}),onClick:s})})};var H=t(638),B=t(69677),W=t(86373);let V={update:"Unable to update simulation"},Y=async(e,l,t)=>{try{await E.Z.update({id:e.id},[{key:"name",value:l.name}]),await t.mutateOneSimulation({id:e.id,name:l.name})}catch(e){throw(0,k.lt)(V.update,e),e}},$=e=>{let{simulation:l,swr:t}=e,a=(0,h.useRef)(null),[i,n]=(0,h.useState)(!1),[s,o]=(0,h.useState)(!1);(0,h.useEffect)(()=>{a.current&&a.current.focus()});let r=(0,h.useCallback)(async e=>{o(!0);try{await Y(l,e,t),o(!1),n(!1)}catch(e){throw o(!1),e}},[l,t]),u=(0,h.useCallback)(()=>n(!0),[]),d=(0,h.useCallback)(()=>n(!1),[]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(S.w6,{onEdit:u}),(0,m.jsx)(W.ZP,{title:"Edit the simulation's name",visible:i,initialValues:{name:l.name},onCancel:d,onOk:r,loading:s,children:(0,m.jsx)(H.Z.Item,{name:"name",label:"Name:",rules:[{required:!0,message:"Name is required"}],children:(0,m.jsx)(B.Z,{ref:a})})})]})},q={del:"Unable to delete simulation"},K=async(e,l,t)=>{try{await E.Z.del(l);let a=e.simulations.filter(e=>e!==l.id);await t.mutateProject({id:e.id,simulations:a}),await t.delOneSimulation({id:l.id})}catch(e){throw(0,k.lt)(q.del,e),e}},J=e=>{let{project:l,simulation:t,swr:a}=e,[i,n]=(0,h.useState)(!1),s=(0,h.useCallback)(async()=>{n(!0);try{await K(l,t,a)}finally{n(!1)}},[l,t,a]);return(0,m.jsx)(S.m1,{loading:i,text:(0,m.jsxs)(m.Fragment,{children:["Are you sure you want to delete the simulation"," ",(0,m.jsx)(O.Z.Text,{strong:!0,children:t.name}),"?"]}),onDelete:s})},X=e=>{let{project:l,simulation:t,swr:a}=e;return l&&t?(0,m.jsx)(v.Z,{children:(0,m.jsx)(v.Z.Content,{children:(0,m.jsx)(T.Z,{size:"small",title:(0,m.jsx)(O.Z.Title,{level:5,ellipsis:!0,children:t.name}),actions:[(0,m.jsx)(I,{project:{id:l.id,simulations:l.simulations},simulation:t,swr:{mutateProject:a.mutateProject,addOneSimulation:a.addOneSimulation}},"copy"),(0,m.jsx)($,{simulation:{id:t.id,name:t.name},swr:{mutateOneSimulation:a.mutateOneSimulation}},"edit"),(0,m.jsx)(J,{project:{id:l.id,simulations:l.simulations},simulation:{id:t.id,name:t.name},swr:{mutateProject:a.mutateProject,delOneSimulation:a.delOneSimulation}},"delete")],children:(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,children:[t.scheme.user&&(0,m.jsx)(_.Z,{message:"User algorithm",type:"info",showIcon:!0}),(0,m.jsxs)(O.Z.Text,{children:[(0,m.jsx)("span",{className:A().textLight,children:"Category:"})," ",t.scheme.category]}),(0,m.jsxs)(O.Z.Text,{children:[(0,m.jsx)("span",{className:A().textLight,children:"Algorithm:"})," ",t.scheme.algorithm]}),(0,m.jsxs)(O.Z.Text,{children:[(0,m.jsx)("span",{className:A().textLight,children:"Code:"})," ",t.scheme.code]}),(0,m.jsxs)(O.Z.Text,{children:[(0,m.jsx)("span",{className:A().textLight,children:"Version:"})," ",t.scheme.version]}),(0,m.jsx)("div",{className:"".concat(A().fullWidth," ").concat(A().scroll),children:(0,m.jsx)(C.Z.Html,{html:t.scheme.description})})]})})})}):(0,m.jsx)(T.Z,{children:(0,m.jsx)(M.Z,{})})};var Q=t(32808),ee=t(50888),el=t(8751);let et=e=>{let{label:l,className:t,style:a,defaultValue:i,defaultChecked:n,onValueChange:s,onCheckedChange:o,unit:r}=e,[u,d]=(0,h.useState)(String(null!=i?i:0)),[c,y]=(0,h.useState)(!!n),[p,v]=(0,h.useState)(void 0!==n&&!n),[f,b]=(0,h.useState)(0),[g,x]=(0,h.useState)(!1);(0,h.useEffect)(()=>{d(String(null!=i?i:0))},[i]),(0,h.useEffect)(()=>{y(!!n)},[n]);let j=(0,h.useCallback)(e=>{let l=e.target.checked;y(l),null==o||o(l),v(!l)},[o]),Z=(0,h.useCallback)(e=>{f&&clearTimeout(f);let l=setTimeout(()=>{s(e),x(!1)},500);b(+l)},[f,s]),k=(0,h.useCallback)(e=>{let l=e.target.value;d(l),x(!0),Z(l)},[Z]);return(0,m.jsx)(U.Z,{className:"".concat(A().fullWidth," ").concat(t),style:a,align:"start",children:(0,m.jsx)(H.Z,{layout:"vertical",children:(0,m.jsx)(H.Z.Item,{label:(0,m.jsxs)(m.Fragment,{children:[void 0!==n&&(0,m.jsx)(Q.Z,{checked:c,onChange:j,style:{marginRight:"5px"}}),l]}),children:(0,m.jsx)(B.Z,{disabled:p,value:u,onChange:k,addonAfter:(0,m.jsxs)(U.Z,{className:A().fullWidth,children:[(0,m.jsx)(C.Z.Inline,{text:r}),g?(0,m.jsx)(ee.Z,{spin:!0,className:A().textOrange}):(0,m.jsx)(el.Z,{className:A().textGreen})]})})})})})},ea={update:"Unable to update simulation"},ei=async(e,l,t)=>{try{let a=P.Z.deepCopy(e);a.scheme.configuration.geometry.meshParameters={type:l,value:"auto"===l?"normal":"1"};let i={...a.scheme.configuration.geometry,done:!0};await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","geometry"],value:i}]),await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...a.scheme.configuration.run,done:!1}}]),await t.mutateOneSimulation(a)}catch(e){throw(0,k.lt)(ea.update,e),e}},en=async(e,l,t,a)=>{try{let i=P.Z.deepCopy(e);i.scheme.configuration.geometry.meshParameters={...i.scheme.configuration.geometry.meshParameters,type:l,value:t};let n={...i.scheme.configuration.geometry,done:!0};await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","geometry"],value:n}]),await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...i.scheme.configuration.run,done:!1}}]),await a.mutateOneSimulation(i)}catch(e){throw(0,k.lt)(ea.update,e),e}},es=e=>{let{simulation:l,swr:t}=e,[a,i]=(0,h.useState)(),[n,s]=(0,h.useState)();(0,h.useEffect)(()=>{let e=l.scheme.configuration.geometry.meshParameters;e?(i(e.type),s(e.value)):(i("auto"),s("normal"))},[l]);let o=(0,h.useCallback)(e=>{(async()=>{try{await ei(l,e,t),i(e),"auto"===e?s("normal"):s("1")}catch(e){}})()},[l,t]),r=(0,h.useCallback)(e=>{(async()=>{try{await en(l,a,e,t),s(e)}catch(e){}})()},[l,a,t]);return(0,m.jsx)(T.Z,{size:"small",title:"Mesh refinement",children:(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,children:[(0,m.jsx)(H.Z,{layout:"vertical",children:(0,m.jsx)(H.Z.Item,{label:"Type",children:(0,m.jsxs)(y.Z,{className:A().fullWidth,value:a,onChange:o,children:[(0,m.jsx)(y.Z.Option,{value:"auto",children:"Automatic"}),(0,m.jsx)(y.Z.Option,{value:"manual",children:"Manual"})]})})}),"auto"===a&&(0,m.jsx)(H.Z,{layout:"vertical",children:(0,m.jsx)(H.Z.Item,{label:"Size",children:(0,m.jsxs)(y.Z,{className:A().fullWidth,value:n,onChange:r,children:[(0,m.jsx)(y.Z.Option,{value:"veryfine",children:"Very fine"}),(0,m.jsx)(y.Z.Option,{value:"fine",children:"Fine"}),(0,m.jsx)(y.Z.Option,{value:"normal",children:"Normal"}),(0,m.jsx)(y.Z.Option,{value:"coarse",children:"Coarse"}),(0,m.jsx)(y.Z.Option,{value:"verycoarse",children:"Very coarse"})]})})}),"manual"===a&&(0,m.jsx)(et,{label:"Size",defaultValue:n,onValueChange:r,unit:"m"})]})})};var eo=t(98281),er=t.n(eo);let eu={update:"Unable to update simulation"},ed=async(e,l,t,a,i)=>{try{var n;let s=P.Z.deepCopy(e),o=l.find(e=>e.id===t);s.scheme.configuration.geometry.value=t,s.scheme.configuration.geometry.values=void 0;let r={...s.scheme.configuration,dimension:null!==(n=o.summary.dimension)&&void 0!==n?n:3,geometry:{...s.scheme.configuration.geometry,done:!0},run:{...s.scheme.configuration.run,done:!1}};await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration"],value:r}]),await i.mutateOneSimulation(s),a([o])}catch(e){(0,k.lt)(eu.update,e)}},ec=async(e,l,t,a,i)=>{try{var n;let s=P.Z.deepCopy(e),o=l.filter(e=>t.includes(e.id));s.scheme.configuration.geometry.value=void 0,s.scheme.configuration.geometry.values=t;let r={...s.scheme.configuration,dimension:null!==(n=o[0].summary.dimension)&&void 0!==n?n:3,geometry:{...s.scheme.configuration.geometry,done:!0},run:{...s.scheme.configuration.run,done:!1}};await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration"],value:r}]),await i.mutateOneSimulation(s),a(o)}catch(e){(0,k.lt)(eu.update,e)}},em=e=>{let{loadedGeometries:l,geometries:t,simulation:a,setGeometries:i,swr:n}=e,s=(0,h.useMemo)(()=>a.scheme.configuration.geometry.multiple,[a]),o=(0,h.useMemo)(()=>a.scheme.configuration.geometry.n,[a]),r=(0,h.useMemo)(()=>a.scheme.configuration.geometry.value,[a]),u=(0,h.useMemo)(()=>a.scheme.configuration.geometry.values,[a]);(0,Z.Z)(()=>{(async()=>{s||r||!t.length?s&&!u&&t.length&&await ec(a,l,t.map(e=>e.id),i,n):await ed(a,l,t[0].id,i,n)})()},[s,r,u,l,t,n]);let d=(0,h.useCallback)(e=>{(async()=>{s?await ec(a,l,e,i,n):await ed(a,l,e,i,n)})()},[s,l,a,i,n]),c=(0,h.useMemo)(()=>(0,m.jsx)("div",{className:er().geometriesList,children:(0,m.jsx)(y.Z,{mode:s?"multiple":void 0,options:l.map(e=>({value:e.id,label:e.name})),value:s?u:r,onChange:d})}),[s,r,u,d,l]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(T.Z,{size:"small",children:(0,m.jsx)(O.Z.Text,{children:"When changing the simulation domain, you might lose your topological entity assignments"})}),(0,m.jsxs)(T.Z,{size:"small",children:[(0,m.jsx)(O.Z.Text,{strong:!0,children:"Select a simulation domain"}),o?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("br",{}),(0,m.jsxs)(O.Z.Text,{children:[o," geometries needed"]})]}):null]}),c,a.scheme.configuration.geometry.meshable&&(0,m.jsx)(es,{simulation:{id:a.id,scheme:a.scheme},swr:{mutateOneSimulation:n.mutateOneSimulation}})]})};var eh=t(94725),ey=t(48474),ep=t(40782);let ev={update:"Unable to delete material"},ef=async(e,l,t,a)=>{try{let i=P.Z.deepCopy(e),n=i.scheme.configuration.materials,s=n.values[l];s.selected.forEach(e=>{t((0,ep.hF)(e))}),n.values=[...n.values.slice(0,l),...n.values.slice(l+1)];let o={...n,done:!!n.values.length};await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:o}]),await a.mutateOneSimulation(i)}catch(e){throw(0,k.lt)(ev.update,e),e}},eb=e=>{let{simulation:l,index:t,swr:a}=e,[i,n]=(0,h.useState)(!1),{dispatch:s}=(0,h.useContext)(ey.ZB),o=(0,h.useMemo)(()=>l.scheme.configuration.materials,[l]),r=(0,h.useMemo)(()=>o.values[t],[o,t]),u=(0,h.useCallback)(async()=>{n(!0);try{await ef(l,t,s,a)}finally{n(!1)}},[l,t,a,s]);return(0,m.jsx)(S.m1,{loading:i,text:(0,m.jsxs)(m.Fragment,{children:["Are you sure you want to delete the material"," ",(0,m.jsx)(O.Z.Text,{strong:!0,children:r.material.label})]}),onDelete:u})},eg=e=>{let{geometries:l,simulation:t,material:a,index:i,swr:n,_onEdit:s}=e,[o,r]=(0,h.useState)(!0),{dispatch:u}=(0,h.useContext)(ey.ZB),d=(0,h.useCallback)(()=>{u((0,ep.wp)());let e=a.geometry,t=l.find(l=>l.id===e);u((0,ep.rx)(null==t?void 0:t.summary.uuid));let i=a.selected;null==i||i.forEach(e=>{u((0,ep.Ys)(e))})},[l,a,u]),c=(0,h.useCallback)(()=>{o&&u((0,ep.h$)())},[o,u]),y=(0,h.useCallback)(()=>{r(!1),s(i),setTimeout(()=>r(!0),500)},[i,s]);return(0,m.jsx)(T.Z,{className:"".concat(A().textAlignCenter," ").concat(er().listItem),hoverable:!0,onMouseEnter:d,onMouseLeave:c,actions:[(0,m.jsx)(S.w6,{onEdit:y},"edit"),(0,m.jsx)(eb,{index:i,simulation:t,swr:n},"delete")],children:(0,m.jsx)(O.Z.Text,{strong:!0,className:A().textAlignCenter,children:a.material.label})})},ex=e=>{var l;let{geometries:t,simulation:a,swr:i,onEdit:n}=e,s=(0,h.useMemo)(()=>a.scheme.configuration.materials,[a]);return(0,m.jsx)(m.Fragment,{children:null===(l=s.values)||void 0===l?void 0:l.map((e,l)=>(0,m.jsx)(eg,{geometries:t,simulation:a,material:e,index:l,swr:i,_onEdit:n},e.uuid)).filter(e=>e)})};var ej=t(85265),eZ=t(97937),ek=t(11475),eC=t(51904),eS=t(13982),ew=t(14618),eP=t(94668),eE=t(68795);let eN=e=>{let{color:l,setFilter:t}=e,a=(0,h.useCallback)(()=>{t(l)},[l,t]);return(0,m.jsx)(R.Z,{title:"Color",children:(0,m.jsx)(D.ZP,{style:{backgroundColor:P.Z.rgbToHex(l)},onClick:a,children:" "})},JSON.stringify(l))},eT=e=>{let{colors:l,setFilter:t}=e,a=(0,h.useCallback)(()=>{t(void 0)},[t]);return(0,m.jsx)(m.Fragment,{children:l.length>1&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(R.Z,{title:"Reset",children:(0,m.jsx)(D.ZP,{icon:(0,m.jsx)(eZ.Z,{}),onClick:a})}),l.map(e=>(0,m.jsx)(eN,{color:e,setFilter:t},JSON.stringify(e)))]})})},eM=e=>{let{element:l,alreadySelected:t,filter:a,search:i,context:n}=e,s=(0,h.useCallback)(e=>{var l,t,n;return(!a||a.r===(null===(l=e.color)||void 0===l?void 0:l.r)&&a.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&a.b===(null===(n=e.color)||void 0===n?void 0:n.b))&&(!i||!e.name||!!e.name.includes(i))},[a,i]),o=(0,h.useCallback)(e=>{n.dispatch((0,ep.CH)(e))},[n]),r=(0,h.useCallback)(()=>{n.dispatch((0,ep.HW)())},[n]),u=(0,h.useCallback)(e=>{n.selected.find(l=>l.uuid===e.uuid)?n.dispatch((0,ep.hF)(e)):n.dispatch((0,ep.Ys)(e))},[n]),d=(0,h.useMemo)(()=>{var e;return n.selected.find(e=>e.uuid===l.uuid)?"#EE9817":(null===(e=n.highlighted)||void 0===e?void 0:e.uuid)===l.uuid?"#FAD114":"transparent"},[l,n]),c=(0,h.useMemo)(()=>{var e;return n.selected.find(e=>e.uuid===l.uuid)?"rgba(238, 152, 23, 0.3)":(null===(e=n.highlighted)||void 0===e?void 0:e.uuid)===l.uuid?"rgba(250, 209, 20, 0.3)":"transparent"},[l,n]),y=(0,h.useCallback)(()=>o({uuid:l.uuid,label:l.label}),[l,o]),p=(0,h.useCallback)(()=>u({uuid:l.uuid,label:l.label}),[l,u]);return s(l)?(0,m.jsx)(T.Z,{style:{marginBottom:"10px"},bodyStyle:{position:"relative",padding:"10px 10px 10px 40px",borderWidth:"2px",borderStyle:"solid",borderColor:d,backgroundColor:c},onMouseEnter:y,onMouseLeave:r,onClick:p,children:(0,m.jsxs)(U.Z,{direction:"vertical",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{style:{position:"absolute",left:"-2px",top:"-2px",bottom:"-2px",width:"30px",backgroundColor:P.Z.rgbToRgba(l.color,1)}}),l.name]}),null==t?void 0:t.map(e=>{if(e.selected.find(e=>e.uuid===l.uuid))return(0,m.jsx)(eC.Z,{color:P.Z.stringToColor(e.label),children:e.label},l.uuid)})]})}):null},eO=e=>{var l;let{geometry:t,alreadySelected:a,updateSelected:i}=e,[n,s]=(0,h.useState)([]),[o,r]=(0,h.useState)(),[u,d]=(0,h.useState)(),{type:c,highlighted:y,selected:p,dispatch:v}=(0,h.useContext)(ey.ZB);(0,Z.Z)(()=>i(p),[p],[i]),(0,Z.Z)(()=>{var e;let l=[];c&&(null===(e=t.summary[c])||void 0===e||e.forEach(e=>{if(e.color){let t=l.find(l=>l.r===e.color.r&&l.g===e.color.g&&l.b===e.color.b);t||l.push(e.color)}})),s(l)},[t,c]);let f=(0,h.useCallback)(()=>{var e;null===(e=t.summary[c])||void 0===e||e.forEach(e=>{var l,t,a;(!o||o&&o.r===(null===(l=e.color)||void 0===l?void 0:l.r)&&o.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&o.b===(null===(a=e.color)||void 0===a?void 0:a.b))&&v((0,ep.Ys)({uuid:e.uuid,label:e.label}))})},[t,c,o,v]),b=(0,h.useCallback)(()=>{var e;null===(e=t.summary[c])||void 0===e||e.forEach(e=>{var l,t,a;(!o||o&&o.r===(null===(l=e.color)||void 0===l?void 0:l.r)&&o.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&o.b===(null===(a=e.color)||void 0===a?void 0:a.b))&&v((0,ep.hF)({uuid:e.uuid,label:e.label}))})},[t,c,o,v]),g=(0,h.useCallback)(()=>{var e;null===(e=t.summary[c])||void 0===e||e.forEach(e=>{var l,t,a;(!o||o&&o.r===(null===(l=e.color)||void 0===l?void 0:l.r)&&o.g===(null===(t=e.color)||void 0===t?void 0:t.g)&&o.b===(null===(a=e.color)||void 0===a?void 0:a.b))&&p.find(l=>l.uuid===e.uuid)?v((0,ep.hF)({uuid:e.uuid,label:e.label})):v((0,ep.Ys)({uuid:e.uuid,label:e.label}))})},[t,p,c,o,v]),x=(0,h.useCallback)(e=>{let l=e.target.value;d(l)},[]);return(0,m.jsxs)(T.Z,{size:"small",className:A().noBorderBottom,children:[(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,children:[(0,m.jsx)(O.Z.Text,{strong:!0,children:"Filters"}),(0,m.jsxs)(U.Z,{direction:"horizontal",wrap:!0,children:[(0,m.jsx)(eT,{colors:n,setFilter:r}),(0,m.jsx)(R.Z,{title:"Select all",children:(0,m.jsx)(D.ZP,{icon:(0,m.jsx)(eS.Z,{}),onClick:f})}),(0,m.jsx)(R.Z,{title:"Unselect all",children:(0,m.jsx)(D.ZP,{icon:(0,m.jsx)(ew.Z,{}),onClick:b})}),(0,m.jsx)(R.Z,{title:"Swap",children:(0,m.jsx)(D.ZP,{icon:(0,m.jsx)(eP.Z,{}),onClick:g})})]}),(0,m.jsx)(B.Z,{placeholder:"Search",value:u,onChange:x,suffix:(0,m.jsx)(eE.Z,{className:A().textLight})})]}),(0,m.jsx)("div",{className:A().fullWidth,style:{marginTop:"20px"},children:c?null===(l=t.summary[c])||void 0===l?void 0:l.map(e=>(0,m.jsx)(eM,{element:e,alreadySelected:a,filter:o,search:u,context:{selected:p,highlighted:y,dispatch:v}},e.uuid)):null})]})};var eU=t(51158),e_=t(13520),eR=t(27588);let eD=e=>{let{onSelect:l}=e,[t,a]=(0,h.useState)(),[i,n]=(0,h.useState)(),[s,o]=(0,h.useState)(),[r,u]=(0,h.useState)(),d=(0,h.useMemo)(()=>Object.keys(eR.E),[]),c=(0,h.useCallback)(()=>a(!0),[]),y=(0,h.useCallback)(()=>a(!1),[]),f=(0,h.useCallback)(e=>{let{key:l}=e,t=eR.E[l];n({key:l,children:t.children}),o(void 0),u(void 0)},[]),g=(0,h.useCallback)(e=>{let{key:l}=e,t=eR.E[i.key],a=t.children.find(e=>e.key===l);o({key:l}),u(a)},[i]),x=(0,h.useCallback)(()=>{l(r),a(!1)},[r,l]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(D.ZP,{icon:(0,m.jsx)(e_.Z,{}),onClick:c,className:A().fullWidth,children:"Pick a material"}),(0,m.jsx)(p.Z,{open:t,title:"Material database",onCancel:y,onOk:x,okText:"Choose",okButtonProps:{disabled:!r},width:"50%",children:(0,m.jsx)(v.Z,{children:(0,m.jsx)(v.Z.Content,{children:(0,m.jsxs)(U.Z,{style:{alignItems:"stretch"},children:[(0,m.jsx)(b.Z,{mode:"inline",items:d.map(e=>({key:e,label:eR.E[e].label})),onClick:f}),(0,m.jsx)(b.Z,{mode:"inline",items:null==i?void 0:i.children.map(e=>({key:e.key,label:e.label})),selectedKeys:(null==s?void 0:s.key)?[null==s?void 0:s.key]:[],onClick:g}),r&&(0,m.jsx)(eU.ZP,{itemLayout:"vertical",children:r.children.map(e=>(0,m.jsxs)(eU.ZP.Item,{children:[e.label,": ",e.symbol," = ",e.value]},e.label))})]})})})})]})};var eL=t(57632);let eF={material:"You need to define a material",selected:"You need to select a solid",update:"Unable to add material"},eA=async(e,l,t)=>{try{var a;let i=P.Z.deepCopy(l);i.uuid=(0,eL.Z)();let n=P.Z.deepCopy(e),s=n.scheme.configuration.materials;s.values=[...null!==(a=s.values)&&void 0!==a?a:[],i];let o={...s,done:!0};await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:o}]),await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...n.scheme.configuration.run,done:!1}}]),await t.mutateOneSimulation(n)}catch(e){throw(0,k.lt)(eF.update,e),e}},eG=e=>{let{simulation:l,material:t,swr:a,onError:i,onClose:n}=e,[s,o]=(0,h.useState)(!1),r=(0,h.useCallback)(()=>{(async()=>{o(!0);try{var e;if(!t.material){i(eF.material),o(!1);return}if(!(null===(e=t.selected)||void 0===e?void 0:e.length)){i(eF.selected),o(!1);return}i(),await eA(l,t,a),o(!1),n()}catch(e){o(!1)}})()},[l,t,a,i,n]);return(0,m.jsx)(S.HS,{loading:s,needMargin:!0,onAdd:r,children:"Add"})},ez={material:"You need to define a material",selected:"You need to select a solid",update:"Unable to edit material"},eI=async(e,l,t)=>{try{let a=P.Z.deepCopy(e),i=a.scheme.configuration.materials,n=i.values.findIndex(e=>e.uuid===l.uuid);i.values=[...i.values.slice(0,n),l,...i.values.slice(n+1)];let s={...i};await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","materials"],value:s}]),await t.mutateOneSimulation(a)}catch(e){throw(0,k.lt)(ez.update,e),e}},eH=e=>{let{simulation:l,material:t,swr:a,onError:i,onClose:n}=e,[s,o]=(0,h.useState)(!1),r=(0,h.useCallback)(()=>{(async()=>{o(!0);try{var e;if(!t.material){i(ez.material),o(!1);return}if(!(null===(e=t.selected)||void 0===e?void 0:e.length)){i(ez.selected),o(!1);return}i(),await eI(l,t,a),o(!1),n()}catch(e){o(!1)}})()},[l,t,a,i,n]);return(0,m.jsx)(S.w6,{loading:s,primary:!0,needMargin:!0,onEdit:r,children:"Edit"})};var eB=t(68847),eW=t.n(eB);let eV=e=>{let{child:l,index:t,value:a,_onMaterialChange:i}=e,n=(0,h.useCallback)(e=>{i(l,t,e)},[l,t,i]);return(0,m.jsx)(et,{label:l.name,defaultValue:null!=a?a:String(l.default),unit:l.unit,onValueChange:n},l.name)},eY=e=>{var l,t,a,i,n,s,o;let{visible:r,geometries:u,simulation:d,material:c,swr:y,onClose:p}=e,[v,b]=(0,h.useState)(),[g,x]=(0,h.useState)(),[j,k]=(0,h.useState)(),[C,w]=(0,h.useState)(),{dispatch:P}=(0,h.useContext)(ey.ZB),E=(0,h.useMemo)(()=>d.scheme.configuration.materials,[d]);(0,Z.Z)(()=>{var e;P((0,ep.rx)(null===(e=u[0])||void 0===e?void 0:e.summary.uuid)),k(null==c?void 0:c.geometry)},[u,c],[P]),(0,Z.Z)(()=>{!r&&g&&x(void 0)},[r,g]),(0,Z.Z)(()=>{var e,l;r&&!g&&c?x(c):!r||g||c||x({material:{label:"Default",children:null!==(l=null==E?void 0:E.children.map(e=>({label:e.label,symbol:e.name,value:e.default})))&&void 0!==l?l:[]},geometry:null===(e=u[0])||void 0===e?void 0:e.id})},[r,u,E,g]),(0,Z.Z)(()=>{var e;let l=null==E?void 0:null===(e=E.values)||void 0===e?void 0:e.map(e=>{if(e.uuid!==(null==c?void 0:c.uuid))return{label:e.material.label,selected:e.selected}}).filter(e=>e);b(null!=l?l:[])},[d,c,E]);let N=(0,h.useCallback)(e=>{x(l=>({...l,material:e}))},[]),M=(0,h.useCallback)((e,l,t)=>{x(a=>({...a,material:{label:"Custom",children:[...a.material.children.slice(0,l),{label:e.label,symbol:e.name,value:t},...a.material.children.slice(l+1)]}}))},[]),_=(0,h.useCallback)(e=>{x(l=>({...l,selected:e}))},[]),R=(0,h.useCallback)(e=>{k(e);let l=u.find(l=>l.id===e);P((0,ep.rx)(l.summary.uuid)),x(l=>({...l,geometry:e}))},[u,P]),L=(0,h.useCallback)(()=>{x(void 0),p()},[p]);return(0,m.jsx)(ej.Z,{className:eW().subPanel,title:"Material",placement:"left",closable:!1,open:r,mask:!1,maskClosable:!1,width:300,extra:(0,m.jsx)(D.ZP,{type:"text",icon:(0,m.jsx)(eZ.Z,{}),onClick:L}),footer:(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,m.jsx)(S.Lw,{onCancel:L}),c?(0,m.jsx)(eH,{material:{uuid:null!==(a=null==g?void 0:g.uuid)&&void 0!==a?a:c.uuid,material:null!==(i=null==g?void 0:g.material)&&void 0!==i?i:c.material,geometry:null!==(n=null==g?void 0:g.geometry)&&void 0!==n?n:c.geometry,selected:null!==(s=null==g?void 0:g.selected)&&void 0!==s?s:c.selected},simulation:{id:d.id,scheme:d.scheme},swr:{mutateOneSimulation:y.mutateOneSimulation},onError:w,onClose:L}):(0,m.jsx)(eG,{material:{material:null==g?void 0:g.material,geometry:null==g?void 0:g.geometry,selected:null==g?void 0:g.selected},simulation:{id:d.id,scheme:d.scheme},swr:{mutateOneSimulation:y.mutateOneSimulation},onError:w,onClose:L})]}),children:(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,children:[(0,m.jsx)(T.Z,{size:"small",children:(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,children:[(0,m.jsx)(eD,{onSelect:N}),(0,m.jsxs)(O.Z.Text,{children:["Material: ",null!==(o=null==g?void 0:null===(l=g.material)||void 0===l?void 0:l.label)&&void 0!==o?o:"default"]}),null==E?void 0:null===(t=E.children)||void 0===t?void 0:t.map((e,l)=>{var t,a;let i=null==g?void 0:null===(t=g.material)||void 0===t?void 0:null===(a=t.children)||void 0===a?void 0:a.find(l=>l.symbol===e.name);return(0,m.jsx)(eV,{child:e,index:l,value:null==i?void 0:i.value,_onMaterialChange:M},e.name)})]})}),(0,m.jsx)(f.Z,{items:u.map(e=>({key:e.id,label:e.name,children:(0,m.jsx)(eO,{geometry:e,alreadySelected:v,updateSelected:_})})),activeKey:j,onChange:R}),C&&(0,m.jsxs)(O.Z.Text,{children:[(0,m.jsx)(ek.Z,{style:{color:"red"}})," ",C]})]})})},e$=e=>{let{geometries:l,simulation:t,swr:a,setVisible:i}=e,[n,s]=(0,h.useState)(),[o,r]=(0,h.useState)(!1),{dispatch:u}=(0,h.useContext)(ey.ZB),d=(0,h.useMemo)(()=>t.scheme.configuration.materials,[t]);(0,Z.Z)(()=>{var e;(null===(e=l[0])||void 0===e?void 0:e.summary)&&u((0,ep.Cw)(2===l[0].summary.dimension?"faces":"solids"))},[l],[u]);let c=(0,h.useCallback)(()=>{s(void 0),r(!0),i(!1),u((0,ep.wp)())},[u,i]),y=(0,h.useCallback)(e=>{let l=d.values[e];s(l),r(!0),i(!1),u((0,ep.wp)())},[d,u,i]),p=(0,h.useCallback)(()=>{u((0,ep.h$)()),r(!1),s(void 0),i(!0)},[u,i]);return l.length?(0,m.jsx)(v.Z,{children:(0,m.jsx)(v.Z.Content,{children:(0,m.jsxs)(T.Z,{size:"small",children:[(0,m.jsx)(S.HS,{onAdd:c,fullWidth:!0,primary:!1,children:"Add material"}),(0,m.jsx)(ex,{geometries:l.map(e=>({id:e.id,summary:e.summary})),simulation:{id:t.id,scheme:t.scheme},swr:a,onEdit:y}),(0,m.jsx)(eY,{visible:o,geometries:l.map(e=>({id:e.id,name:e.name,summary:e.summary})),simulation:{id:t.id,scheme:t.scheme},material:n&&{uuid:n.uuid,material:n.material,geometry:n.geometry,selected:n.selected},swr:{mutateOneSimulation:a.mutateOneSimulation},onClose:p})]})})}):(0,m.jsx)(eh.Z.Simple,{})};var eq=t(15045);let eK={update:"Unable to update simulation"},eJ=(e,l,t)=>(0,m.jsx)(et,{label:null!==(a=l.label2D)&&void 0!==a?a:l.label,defaultValue:null!==(i=l.value)&&void 0!==i?i:l.default,onValueChange:t,unit:l.unit},e),eX=(e,l,t)=>{var a;return(0,m.jsx)(H.Z,{layout:"vertical",children:(0,m.jsx)(H.Z.Item,{label:null!==(n=l.label2D)&&void 0!==n?n:l.label,children:(0,m.jsx)(y.Z,{options:null===(a=l.options)||void 0===a?void 0:a.map(e=>({label:e.label,value:null!==(s=e.value2D)&&void 0!==s?s:e.value})),defaultValue:null!==(r=null!==(o=l.value)&&void 0!==o?o:l.default2D)&&void 0!==r?r:l.default,onChange:t})})},e)},eQ=(e,l,t)=>(0,m.jsx)(H.Z,{layout:"horizontal",children:(0,m.jsx)(H.Z.Item,{label:null!==(u=l.label2D)&&void 0!==u?u:l.label,children:(0,m.jsx)(Q.Z,{defaultChecked:l.value,onChange:t})})},e),e0=(e,l,t)=>(0,m.jsx)(et,{label:l.label,defaultValue:null!==(d=l.value)&&void 0!==d?d:l.default,onValueChange:t,unit:l.unit},e),e1=(e,l,t)=>(0,m.jsx)(H.Z,{layout:"vertical",children:(0,m.jsx)(H.Z.Item,{label:l.label,children:(0,m.jsx)(y.Z,{options:l.options,defaultValue:null!==(c=l.value)&&void 0!==c?c:l.default,onChange:t})})},e),e2=(e,l,t)=>(0,m.jsx)(H.Z,{layout:"horizontal",children:(0,m.jsx)(H.Z.Item,{label:l.label,children:(0,m.jsx)(Q.Z,{defaultChecked:l.value,onChange:t})})},e),e3=async(e,l)=>{try{let t=P.Z.deepCopy(e),a=t.scheme.configuration.parameters,i={...a,done:!0};await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","parameters"],value:i}]),await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...t.scheme.configuration.run,done:!1}}]),await l.mutateOneSimulation(t)}catch(e){(0,k.lt)(eK.update,e)}},e5=async(e,l,t,a,i)=>{try{let n=P.Z.deepCopy(e),s=n.scheme.configuration.parameters,o=s[l];o.children[t].value=a;let r={...s,done:!0};await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","parameters"],value:r}]),await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...n.scheme.configuration.run,done:!1}}]),await i.mutateOneSimulation(n)}catch(e){(0,k.lt)(eK.update,e)}},e8=e=>{let{simulation:l,dimension:t,child:a,pkey:i,index:n,swr:s}=e,o=(0,h.useCallback)(e=>{(async()=>{await e5(l,i,n,e,s)})()},[l,i,n,s]),r=(0,h.useCallback)(e=>{(async()=>{await e5(l,i,n,e.target.checked,s)})()},[l,i,n,s]);if(2===t){if(a.only3D);else if("formula"===a.htmlEntity)return eJ(i+"&"+n,a,o);else if("select"===a.htmlEntity)return eX(i+"&"+n,a,o);else if("checkbox"===a.htmlEntity)return eQ(i+"&"+n,a,r);return null}return"formula"===a.htmlEntity?e0(i+"&"+n,a,o):"select"===a.htmlEntity?e1(i+"&"+n,a,o):"checkbox"===a.htmlEntity?e2(i+"&"+n,a,r):null},e7=e=>{let{simulation:l,dimension:t,pkey:a,parameter:i,swr:n}=e,s=(0,h.useMemo)(()=>i.children.map((e,i)=>(0,m.jsx)(e8,{simulation:l,dimension:t,child:e,pkey:a,index:i,swr:n},a+"&"+e.label)),[l,t,a,i,n]);return(0,m.jsx)(T.Z,{size:"small",title:null==i?void 0:i.label,children:(0,m.jsx)(U.Z,{direction:"vertical",children:s})},a)},e4=e=>{let{simulation:l,swr:t}=e,a=(0,h.useMemo)(()=>null==l?void 0:l.scheme.configuration.parameters,[l]),i=(0,h.useMemo)(()=>null==l?void 0:l.scheme.configuration.dimension,[l]);(0,h.useEffect)(()=>{(async()=>{(null==a?void 0:a.done)||await e3(l,t)})()},[l,a,t]);let n=(0,h.useMemo)(()=>Object.keys(a).map(e=>{if("index"===e||"title"===e||"done"==e)return null;let n=a[e];return n.advanced?null:(0,m.jsx)(e7,{simulation:l,dimension:i,pkey:e,parameter:n,swr:t},e)}).filter(e=>e),[l,i,a,t]),s=(0,h.useMemo)(()=>Object.keys(a).map(e=>{if("index"===e||"title"===e||"done"==e)return null;let n=a[e];return n.advanced?(0,m.jsx)(e7,{simulation:l,dimension:i,pkey:e,parameter:n,swr:t},e):null}).filter(e=>e),[l,i,a,t]);return(0,m.jsx)(v.Z,{children:(0,m.jsx)(v.Z.Content,{children:(0,m.jsxs)(U.Z,{direction:"vertical",children:[n,s.length?(0,m.jsx)(eq.Z,{children:(0,m.jsx)(eq.Z.Panel,{header:"Advanced",children:(0,m.jsx)(U.Z,{direction:"vertical",children:s})},"advanced")}):null]})})})},e6=(e,l)=>e.map(e=>{let t=e.fileName.replace(new RegExp(l.prefixPattern),"").replace(new RegExp(l.suffixPattern),"");return{...e,number:+t}}),e9=(e,l)=>{let t=l.multiplicator;if(t){var a;let l=t.reduce((e,l)=>e[l],e);return null!==(a=l.value)&&void 0!==a?a:l.default}},le={update:"Unable to update simulation"},ll=async(e,l,t)=>{try{let a=P.Z.deepCopy(e),i=a.scheme.configuration.initialization;i.value={type:l},await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:i}]),await t.mutateOneSimulation(a)}catch(e){throw(0,k.lt)(le.update,e),e}},lt=async(e,l,t,a)=>{try{var i;let n=await ln(e,t),s=P.Z.deepCopy(l),o=s.scheme.configuration.initialization;o.value={...o.value,simulation:t,result:null==n?void 0:null===(i=n[0])||void 0===i?void 0:i.value},await E.Z.update({id:l.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:o}]),await a.mutateOneSimulation(s)}catch(e){throw(0,k.lt)(le.update,e),e}},la=async(e,l,t,a)=>{try{let i=P.Z.deepCopy(e),n=i.scheme.configuration.initialization;n.value={...n.value,number:+l,result:t.file},await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:n}]),await a.mutateOneSimulation(i)}catch(e){(0,k.lt)(le.update,e)}},li=async(e,l,t,a)=>{try{let i=P.Z.deepCopy(e),n=i.scheme.configuration.initialization;n.value.values||(n.value.values=[]),n.value.values[l]=t,await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","initialization"],value:n}]),await a.mutateOneSimulation(i)}catch(e){(0,k.lt)(le.update,e)}},ln=async(e,l)=>{var t;let a=await E.Z.tasks({id:l}),i=e.find(e=>e.id===l),n=i.scheme.configuration,s=null==n?void 0:null===(t=n.run)||void 0===t?void 0:t.resultsFilter,o=[];return a.forEach(e=>{if(e.file&&"result"===e.file.type&&o.push({label:e.file.fileName,value:e.file.fileName,file:e.file.fileName}),e.files){if(s){let l=new RegExp(s.pattern),t=e.files.filter(e=>!l.test(e.fileName)).filter(e=>"result"===e.type),a=e.files.filter(e=>l.test(e.fileName)),i=e6(a,s),r=i.map(e=>({number:e.number,fileName:e.fileName.replace(new RegExp(s.suffixPattern),"")})).filter((e,l,t)=>t.findIndex(l=>l.number===e.number)===l).sort((e,l)=>e.number-l.number),u=e9(n,s),d=r.map((e,l)=>{let t=u?e.number*u:l;return{label:String(Math.round(1e15*t)/1e15),value:e.fileName,file:e.fileName}});o.push(...t.map(e=>({label:e.fileName,value:e.fileName,file:e.fileName})).filter(e=>e)),o.push(...d)}else e.files.forEach(e=>{"result"===e.type&&o.push({label:e.fileName,value:e.fileName,file:e.fileName})})}}),o},ls=e=>{let{simulation:l,child:t,index:a,value:i,swr:n}=e,s=(0,h.useCallback)(e=>{(async()=>{await li(l,a,e,n)})()},[l,a,n]);return(0,m.jsx)(et,{label:t.label,defaultValue:(null!=i?i:t.default).toString(),unit:t.unit,onValueChange:s})},lo=e=>{let{simulations:l,simulation:t,swr:a}=e,[i,n]=(0,h.useState)(!1),[s,o]=(0,h.useState)(),[r,u]=(0,h.useState)(),[d,c]=(0,h.useState)(),p=(0,h.useMemo)(()=>null==t?void 0:t.scheme.configuration.initialization,[t]),f=(0,h.useMemo)(()=>null==t?void 0:t.scheme.configuration.dimension,[t]),b=(0,h.useCallback)(e=>{let t=l.find(l=>l.id===e);u(t)},[l]);(0,Z.Z)(()=>{var e,l;!s&&p.value&&o(p.value.type),!r&&(null===(e=p.value)||void 0===e?void 0:e.simulation)&&b(null===(l=p.value)||void 0===l?void 0:l.simulation)},[p,s,r],[b]),(0,Z.Z)(()=>{(async()=>{if(r){let e=await ln(l,r.id);c(e)}})()},[l,r]);let g=(0,h.useMemo)(()=>{let e=[{label:"None",value:"none"}];return p.coupling&&e.push({label:p.coupling.label,value:"coupling"}),p.direct&&e.push({label:p.direct.label,value:"direct"}),e},[p]),x=p.value,j=(0,h.useCallback)(e=>{(async()=>{n(!0);try{await lt(l,t,e,a),b(e)}catch(e){}finally{n(!1)}})()},[l,t,a,b]),k=(0,h.useCallback)((e,l)=>{(async()=>{await la(t,e,l,a)})()},[t,a]),C=(0,h.useCallback)((e,l)=>(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(O.Z.Text,{children:"If you use coupling, the selected simulation mesh will be used, at least for the first iteration."}),(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,style:{marginTop:"10px"},children:[(0,m.jsx)(y.Z,{className:A().fullWidth,options:e,placeholder:"Select a simulation",value:null==x?void 0:x.simulation,onChange:j}),i&&(0,m.jsx)(M.Z,{}),(null==d?void 0:d.length)?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(O.Z.Text,{children:[null==l?void 0:l.name,":"]},"simulation"),(0,m.jsx)(y.Z,{className:A().fullWidth,options:d,placeholder:"Select a "+l.name,value:null==x?void 0:x.result,onChange:k})]}):(0,m.jsx)(O.Z.Text,{type:"danger",children:"No results, please select an other simulation."})]})]}),[x,d,i,j,k]),S=(0,h.useCallback)(e=>(0,m.jsx)(U.Z,{direction:"vertical",className:A().fullWidth,children:e.children.map((e,l)=>{var i;if(2!==f||!e.only3D)return(0,m.jsx)(ls,{simulation:t,child:e,index:l,value:null==x?void 0:null===(i=x.values)||void 0===i?void 0:i[l],swr:a},e.label)})}),[x,f,t,a]),w=(0,h.useMemo)(()=>{let e={none:(0,m.jsx)("div",{})},a=p.coupling;if(null==a?void 0:a.compatibility){let i=l.map(e=>{let l=e.id===t.id||!a.compatibility.find(l=>l.algorithm===e.scheme.algorithm);return{label:e.name,value:e.id,disabled:l}}),n=a.compatibility.find(e=>{var l;return e.algorithm===(null==r?void 0:null===(l=r.scheme)||void 0===l?void 0:l.algorithm)}),s=null==n?void 0:n.filter;e.coupling=C(i,s)}let i=p.direct;return(null==i?void 0:i.children)&&(e.direct=S(i)),e},[l,t,r,p,C,S]),P=(0,h.useCallback)(e=>{(async()=>{try{await ll(t,e,a),o(e)}catch(e){}})()},[t,a]);return(0,m.jsx)(v.Z,{children:(0,m.jsx)(v.Z.Content,{children:(0,m.jsxs)(T.Z,{size:"small",children:[(0,m.jsx)(y.Z,{className:A().fullWidth,style:{marginTop:"10px"},defaultValue:"none",value:s,options:g,onChange:P}),w[null!=s?s:"none"]]})})})},lr={update:"Unable to delete boundary condition"},lu=async(e,l,t,a,i)=>{try{let n=P.Z.deepCopy(e),s=n.scheme.configuration.boundaryConditions,o=s[l],r=o.values[t];r.selected.forEach(e=>{a((0,ep.hF)(e))}),o.values=[...o.values.slice(0,t),...o.values.slice(t+1)];let u=!1;Object.keys(s).forEach(e=>{var l;if("index"===e||"title"===e||"done"===e)return;let t=s[e];(null===(l=t.values)||void 0===l?void 0:l.length)&&(u=!0)});let d={...s,done:u};await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:d}]),await i.mutateOneSimulation(n)}catch(e){throw(0,k.lt)(lr.update,e),e}},ld=e=>{let{type:l,index:t,simulation:a,swr:i}=e,[n,s]=(0,h.useState)(!1),{dispatch:o}=(0,h.useContext)(ey.ZB),r=(0,h.useMemo)(()=>a.scheme.configuration.boundaryConditions,[a]),u=(0,h.useMemo)(()=>r[l],[r,l]),d=(0,h.useMemo)(()=>u.values[t],[u,t]),c=(0,h.useCallback)(async()=>{s(!0);try{await lu(a,l,t,o,i)}finally{s(!1)}},[a,l,t,i,o]);return(0,m.jsx)(S.m1,{loading:n,onDelete:c,text:(0,m.jsxs)(m.Fragment,{children:["Are you sure you want to delete the condition"," ",(0,m.jsx)(O.Z.Text,{strong:!0,children:null==d?void 0:d.name}),"?"]})})},lc=e=>{let{geometries:l,simulation:t,boundaryCondition:a,index:i,type:n,swr:s,_onEdit:o}=e,[r,u]=(0,h.useState)(!0),{dispatch:d}=(0,h.useContext)(ey.ZB),c=(0,h.useCallback)(()=>{d((0,ep.wp)());let e=a.geometry,t=l.find(l=>l.id===e);d((0,ep.rx)(null==t?void 0:t.summary.uuid));let i=a.selected;null==i||i.forEach(e=>{d((0,ep.Ys)(e))})},[l,a,d]),y=(0,h.useCallback)(()=>{r&&d((0,ep.h$)())},[r,d]),p=(0,h.useCallback)(()=>{u(!1),o(n,i),setTimeout(()=>u(!0),500)},[i,n,o]);return(0,m.jsxs)(T.Z,{className:er().listItem,hoverable:!0,onMouseEnter:c,onMouseLeave:y,actions:[(0,m.jsx)(S.w6,{onEdit:p},"edit"),(0,m.jsx)(ld,{simulation:{id:t.id,scheme:t.scheme},type:n,index:i,swr:{mutateOneSimulation:s.mutateOneSimulation}},"delete")],children:[(0,m.jsx)(O.Z.Text,{strong:!0,children:a.name})," ",(0,m.jsxs)(O.Z.Text,{children:["(",a.type.label,")"]})]})},lm=e=>{let{geometries:l,simulation:t,swr:a,onEdit:i}=e,n=(0,h.useMemo)(()=>t.scheme.configuration.boundaryConditions,[t]);return(0,m.jsx)(m.Fragment,{children:Object.keys(n).map(e=>{var s;if("index"===e||"title"===e||"done"===e)return;let o=n[e];return null===(s=o.values)||void 0===s?void 0:s.map((n,s)=>(0,m.jsx)(lc,{geometries:l,simulation:t,boundaryCondition:n,index:s,type:e,swr:a,_onEdit:i},n.uuid))}).filter(e=>e)})};var lh=t(78045);let ly={name:"You need to define a name",type:"You need to select a type",selected:"You need to select a face",update:"Unable to add boundary condition"},lp=async(e,l,t)=>{try{var a;let i={...l},n=i.type.key;i.uuid=(0,eL.Z)();let s=P.Z.deepCopy(e),o=s.scheme.configuration.boundaryConditions,r=o[n];r.values=[...null!==(a=r.values)&&void 0!==a?a:[],i];let u={...o,done:!0};await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:u}]),await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:{...s.scheme.configuration.run,done:!1}}]),await t.mutateOneSimulation(s)}catch(e){throw(0,k.lt)(ly.update,e),e}},lv=e=>{let{simulation:l,boundaryCondition:t,swr:a,onError:i,onClose:n}=e,[s,o]=(0,h.useState)(!1),r=(0,h.useCallback)(()=>{(async()=>{o(!0);try{var e,s;if(!t.name){i(ly.name),o(!1);return}if(!(null===(e=t.type)||void 0===e?void 0:e.key)){i(ly.type),o(!1);return}if(!(null===(s=t.selected)||void 0===s?void 0:s.length)){i(ly.selected),o(!1);return}i(),await lp(l,t,a),o(!1),n()}catch(e){o(!1)}})()},[l,t,a,i,n]);return(0,m.jsx)(S.HS,{loading:s,onAdd:r,needMargin:!0,children:"Add"})},lf={name:"You need to define a name",type:"You need to select a type",selected:"You need to select a face",update:"Unable to edit boundary condition"},lb=async(e,l,t,a)=>{try{let n=P.Z.deepCopy(e),s=n.scheme.configuration.boundaryConditions,o=l.type.key,r=t.type.key;if(r!==o){let e=s[r],l=e.values.findIndex(e=>e.uuid===t.uuid);e.values=[...e.values.slice(0,l),...e.values.slice(l+1)]}if(r!==o){var i;let e=s[o];e.values=[...null!==(i=e.values)&&void 0!==i?i:[],l]}else{let e=s[o],t=e.values.findIndex(e=>e.uuid===l.uuid);e.values=[...e.values.slice(0,t),l,...e.values.slice(t+1)]}let u={...s};await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","boundaryConditions"],value:u}]),await a.mutateOneSimulation(n)}catch(e){throw(0,k.lt)(lf.update,e),e}},lg=e=>{let{simulation:l,boundaryCondition:t,oldBoundaryCondition:a,swr:i,onError:n,onClose:s}=e,[o,r]=(0,h.useState)(!1),u=(0,h.useCallback)(()=>{(async()=>{r(!0);try{var e,o;if(!t.name){n(lf.name),r(!1);return}if(!(null===(e=t.type)||void 0===e?void 0:e.key)){n(lf.type),r(!1);return}if(!(null===(o=t.selected)||void 0===o?void 0:o.length)){n(lf.selected),r(!1);return}n(),await lb(l,t,a,i),r(!1),s()}catch(e){r(!1)}})()},[l,t,a,i,n,s]);return(0,m.jsx)(S.w6,{loading:o,onEdit:u,primary:!0,needMargin:!0,children:"Edit"})},lx=e=>{let{boundaryCondition:l,index:t,value:a,checked:i,_onValueChange:n,_onCheckedChange:s}=e,o=(0,h.useCallback)(e=>n(t,e),[t,n]),r=(0,h.useCallback)(e=>s(t,e),[t,s]);return(0,m.jsx)(et,{style:{marginBottom:"10px"},label:l.label,defaultValue:a,defaultChecked:i,onValueChange:o,onCheckedChange:r,unit:l.unit})},lj=e=>{var l,t,a,i,n,s,o,r;let{visible:u,geometries:d,simulation:c,boundaryCondition:y,swr:p,onClose:v}=e,[b,g]=(0,h.useState)([]),[x,j]=(0,h.useState)([]),[k,C]=(0,h.useState)(),[w,P]=(0,h.useState)(),[E,N]=(0,h.useState)(),[M,_]=(0,h.useState)(),{dispatch:R}=(0,h.useContext)(ey.ZB),L=(0,h.useMemo)(()=>c.scheme.configuration.boundaryConditions,[c]),F=(0,h.useMemo)(()=>c.scheme.configuration.dimension,[c]);(0,Z.Z)(()=>{var e;R((0,ep.rx)(null===(e=d[0])||void 0===e?void 0:e.summary.uuid)),N(null==y?void 0:y.geometry)},[d,y],[R]),(0,Z.Z)(()=>{!u&&w&&P(void 0)},[u,w]),(0,Z.Z)(()=>{let e=Object.keys(L).map(e=>{if("index"===e||"title"===e||"done"===e)return;let l=L[e];return{key:e,label:l.label,children:l.children,values:l.values}}).filter(e=>e);j(e)},[L]),(0,Z.Z)(()=>{let e=null==x?void 0:x.map(e=>{var l;return null===(l=e.values)||void 0===l?void 0:l.length}).filter(e=>e).reduce((e,l)=>e+l,0);C(e)},[x]),(0,Z.Z)(()=>{u&&!w&&y?P(y):!u||w||y||void 0===k||P(e=>{var l;return{...e,name:"Boundary condition "+(k+1),geometry:null===(l=d[0])||void 0===l?void 0:l.id}})},[u,y,w,k]),(0,Z.Z)(()=>{let e=Object.keys(L).map(e=>{var l;if("index"===e||"title"===e||"done"===e)return;let t=L[e];return null==t?void 0:null===(l=t.values)||void 0===l?void 0:l.map(e=>{if(e.uuid!==(null==y?void 0:y.uuid))return{label:e.name,selected:e.selected}}).filter(e=>e)}).flat().filter(e=>e);g(e)},[L,y]);let G=(0,h.useCallback)(e=>{let l=e.target.value;P(e=>({...e,name:l}))},[]),z=(0,h.useCallback)(e=>{var l;let t=e.target.value,a=x.find(e=>e.key===t),i=L[t],n=null===(l=i.children)||void 0===l?void 0:l.map(e=>({checked:!0,value:e.default}));P(e=>({...e,type:{key:a.key,label:a.label,children:a.children},values:n}))},[L,x]),I=(0,h.useCallback)((e,l)=>{P(t=>({...t,values:[...t.values.slice(0,e),{checked:t.values[e].checked,value:l},...t.values.slice(e+1)]}))},[]),W=(0,h.useCallback)((e,l)=>{P(t=>({...t,values:[...t.values.slice(0,e),{checked:l,value:t.values[e].value},...t.values.slice(e+1)]}))},[]),V=(0,h.useCallback)(e=>{P(l=>({...l,selected:e}))},[]),Y=(0,h.useMemo)(()=>{var e;return(null==w?void 0:w.type)&&(null===(e=w.type)||void 0===e?void 0:e.children)?(0,m.jsx)(T.Z,{children:w.type.children.map((e,l)=>{if(2!==F||!e.only3D)return(0,m.jsx)(lx,{boundaryCondition:e,index:l,value:String(w.values[l].value),checked:w.type.children.length>1?w.values[l].checked:void 0,_onValueChange:I,_onCheckedChange:W},e.label)})}):null},[w,F,W,I]),$=(0,h.useCallback)(e=>{N(e);let l=d.find(l=>l.id===e);R((0,ep.rx)(null==l?void 0:l.summary.uuid)),P(l=>({...l,geometry:e}))},[d,R]),q=(0,h.useCallback)(()=>{P(void 0),v()},[v]);return(0,m.jsx)(ej.Z,{className:eW().subPanel,title:"Boundary condition",placement:"left",closable:!1,open:u,mask:!1,maskClosable:!1,width:300,extra:(0,m.jsx)(D.ZP,{type:"text",icon:(0,m.jsx)(eZ.Z,{}),onClick:q}),footer:(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,m.jsx)(S.Lw,{onCancel:q}),y?(0,m.jsx)(lg,{boundaryCondition:{uuid:null!==(t=null==w?void 0:w.uuid)&&void 0!==t?t:y.uuid,name:null!==(a=null==w?void 0:w.name)&&void 0!==a?a:y.name,type:null!==(i=null==w?void 0:w.type)&&void 0!==i?i:y.type,geometry:null!==(n=null==w?void 0:w.geometry)&&void 0!==n?n:y.geometry,selected:null!==(s=null==w?void 0:w.selected)&&void 0!==s?s:y.selected,values:null!==(o=null==w?void 0:w.values)&&void 0!==o?o:y.values},oldBoundaryCondition:{uuid:y.uuid,name:y.name,type:y.type,geometry:y.geometry,selected:y.selected,values:y.values},simulation:{id:c.id,scheme:c.scheme},swr:{mutateOneSimulation:p.mutateOneSimulation},onError:_,onClose:v}):(0,m.jsx)(lv,{boundaryCondition:{name:null==w?void 0:w.name,type:null==w?void 0:w.type,geometry:null==w?void 0:w.geometry,selected:null==w?void 0:w.selected,values:null==w?void 0:w.values},simulation:{id:c.id,scheme:c.scheme},swr:{mutateOneSimulation:p.mutateOneSimulation},onError:_,onClose:v})]}),children:(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,children:[(0,m.jsx)(T.Z,{size:"small",children:(0,m.jsx)(H.Z,{layout:"vertical",children:(0,m.jsx)(H.Z.Item,{label:(0,m.jsx)(O.Z.Text,{strong:!0,children:"Boundary condition name"}),children:(0,m.jsx)(B.Z,{value:null!==(r=null==w?void 0:w.name)&&void 0!==r?r:"",onChange:G,maxLength:50})})})}),(0,m.jsx)(T.Z,{size:"small",children:(0,m.jsx)(H.Z,{layout:"vertical",children:(0,m.jsx)(H.Z.Item,{label:(0,m.jsx)(O.Z.Text,{strong:!0,children:"Boundary condition type"}),children:(0,m.jsx)(lh.ZP.Group,{optionType:"button",buttonStyle:"solid",value:null==w?void 0:null===(l=w.type)||void 0===l?void 0:l.key,onChange:z,children:null==x?void 0:x.map(e=>(0,m.jsx)(lh.ZP.Button,{value:e.key,children:e.label},e.key))})})})}),Y,(0,m.jsx)(f.Z,{items:d.map(e=>({key:e.id,label:e.name,children:(0,m.jsx)(eO,{geometry:e,alreadySelected:b,updateSelected:V})})),activeKey:E,onChange:$}),M&&(0,m.jsxs)(O.Z.Text,{children:[(0,m.jsx)(ek.Z,{style:{color:"red"}})," ",M]})]})})},lZ=e=>{let{simulation:l,geometries:t,swr:a,setVisible:i}=e,[n,s]=(0,h.useState)(),[o,r]=(0,h.useState)(!1),{dispatch:u}=(0,h.useContext)(ey.ZB),d=(0,h.useMemo)(()=>l.scheme.configuration.boundaryConditions,[l]);(0,Z.Z)(()=>{var e;(null===(e=t[0])||void 0===e?void 0:e.summary)&&u((0,ep.Cw)(2===t[0].summary.dimension?"edges":"faces"))},[t],[u]);let c=(0,h.useCallback)(()=>{s(void 0),r(!0),i(!1),u((0,ep.wp)())},[u,i]),y=(0,h.useCallback)((e,l)=>{let t=d[e],a=t.values[l];s(a),r(!0),i(!1),u((0,ep.wp)())},[d,u,i]),p=(0,h.useCallback)(()=>{u((0,ep.h$)()),r(!1),s(void 0),i(!0)},[u,i]);return t.length?(0,m.jsx)(v.Z,{children:(0,m.jsx)(v.Z.Content,{children:(0,m.jsxs)(T.Z,{size:"small",children:[(0,m.jsx)(S.HS,{onAdd:c,fullWidth:!0,primary:!1,children:"Add boundary condition"}),(0,m.jsx)(lm,{geometries:t.map(e=>({id:e.id,summary:e.summary})),simulation:{id:l.id,scheme:l.scheme},swr:{mutateOneSimulation:a.mutateOneSimulation},onEdit:y}),(0,m.jsx)(lj,{visible:o,geometries:t.map(e=>({id:e.id,name:e.name,summary:e.summary})),simulation:{id:l.id,scheme:l.scheme},boundaryCondition:n&&{uuid:n.uuid,name:n.name,type:n.type,geometry:n.geometry,selected:n.selected,values:n.values},swr:{mutateOneSimulation:a.mutateOneSimulation},onClose:p})]})})}):(0,m.jsx)(eh.Z.Simple,{})};var lk=t(3363),lC=t(67841),lS=t(87784),lw=t(36027),lP=t(57184);let lE={name:"You need to define a name",point:"You need to select a point",formula:"You need to define a formula",update:"Unable to update simulation"},lN=async(e,l,t)=>{try{let a=P.Z.deepCopy(e),i=a.scheme.configuration.run,n=l.index;delete l.index,i.sensors[n]=l,await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:i}]),await t.mutateOneSimulation(a)}catch(e){throw(0,k.lt)(lE.update,e),e}},lT=e=>{let{simulation:l,sensor:t,onError:a,onClose:i,swr:n}=e,[s,o]=(0,h.useState)(),r=(0,h.useCallback)(()=>{(async()=>{o(!0);try{if(!t.name){a(lE.name),o(!1);return}if(!t.point){a(lE.point),o(!1);return}if(!t.formula){a(lE.formula),o(!1);return}a(),await lN(l,t,n),o(!1),i()}catch(e){o(!1)}})()},[l,t,a,i,n]);return(0,m.jsx)(S.w6,{loading:s,primary:!0,needMargin:!0,onEdit:r,children:"Edit"})},lM={name:"You need to define a name",point:"You need to select a point",formula:"You need to define a formula",update:"Unable to update simulation"},lO=async(e,l,t)=>{try{var a;let i=P.Z.deepCopy(e),n=i.scheme.configuration.run,s={...n,sensors:[...null!==(a=n.sensors)&&void 0!==a?a:[],l]};await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:s}]),await t.mutateOneSimulation(i)}catch(e){throw(0,k.lt)(lM.update,e),e}},lU=e=>{let{simulation:l,sensor:t,onError:a,onClose:i,swr:n}=e,[s,o]=(0,h.useState)(),r=(0,h.useCallback)(()=>{(async()=>{o(!0);try{if(!t.name){a(lM.name),o(!1);return}if(!t.point){a(lM.point),o(!1);return}if(!t.formula){a(lM.formula),o(!1);return}a(),await lO(l,t,n),o(!1),i()}catch(e){o(!1)}})()},[l,t,a,i,n]);return(0,m.jsx)(S.HS,{loading:s,needMargin:!0,onAdd:r,children:"Add"})},l_=e=>{var l,t,a,i,n,s,o,r,u;let{visible:d,geometries:c,simulation:y,sensor:p,onClose:v,swr:b}=e,[g,x]=(0,h.useState)(),[j,k]=(0,h.useState)(),[C,w]=(0,h.useState)(),[P,E]=(0,h.useState)(),{point:N,dispatch:M}=(0,h.useContext)(ey.ZB);(0,Z.Z)(()=>{var e;M((0,ep.rx)(null===(e=c[0])||void 0===e?void 0:e.summary.uuid)),w(null==p?void 0:p.geometry)},[c,p],[M]),(0,Z.Z)(()=>{M((0,ep.Cw)("point"))},[M]),(0,Z.Z)(()=>{if(!p){let e=y.scheme.configuration.run;k(l=>({...l,name:"Sensor "+(e.sensors?e.sensors.length+1:1)}))}},[y,p]),(0,Z.Z)(()=>{p&&(k(p),M((0,ep.N7)({x:p.point.x,y:p.point.y,z:p.point.z})))},[p],[M]),(0,Z.Z)(()=>{N&&k(e=>({...e,point:N}))},[N]);let _=(0,h.useCallback)(()=>{x(!1),M((0,ep.h$)()),window.removeEventListener("click",_)},[M]),L=(0,h.useCallback)(()=>{g?_():(x(!0),M((0,ep.wp)()),setTimeout(()=>window.addEventListener("click",_),50))},[g,_,M]),F=(0,h.useCallback)(e=>{w(e);let l=c.find(l=>l.id===e);M((0,ep.rx)(l.summary.uuid)),k(l=>({...l,geometry:e}))},[c,M]),G=(0,h.useCallback)((e,l,t)=>{M((0,ep.N7)({x:e,y:l,z:t}))},[M]),z=(0,h.useCallback)(e=>{k(l=>({...l,formula:e}))},[]),I=(0,h.useCallback)(()=>{k(void 0),E(void 0),M((0,ep.N7)()),M((0,ep.h$)()),v()},[M,v]),H=(0,h.useCallback)(e=>{k(l=>({...l,name:e.target.value}))},[]),W=(0,h.useCallback)(e=>G(+e,null!==(i=null==N?void 0:N.y)&&void 0!==i?i:0,null!==(n=null==N?void 0:N.z)&&void 0!==n?n:0),[N,G]),V=(0,h.useCallback)(e=>G(null!==(s=null==N?void 0:N.x)&&void 0!==s?s:0,+e,null!==(o=null==N?void 0:N.z)&&void 0!==o?o:0),[N,G]),Y=(0,h.useCallback)(e=>G(null!==(r=null==N?void 0:N.x)&&void 0!==r?r:0,null!==(u=null==N?void 0:N.y)&&void 0!==u?u:0,+e),[N,G]);return(0,m.jsx)(ej.Z,{title:"Sensor",placement:"left",closable:!1,open:d,mask:!1,maskClosable:!1,width:300,extra:(0,m.jsx)(D.ZP,{type:"text",icon:(0,m.jsx)(eZ.Z,{}),onClick:I}),footer:(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[(0,m.jsx)(S.Lw,{onCancel:I}),p?(0,m.jsx)(lT,{simulation:y,sensor:{...p,...j},onError:E,onClose:I,swr:b}):(0,m.jsx)(lU,{simulation:y,sensor:j,onError:E,onClose:I,swr:b})]}),children:(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,children:[(0,m.jsxs)(T.Z,{size:"small",children:[(0,m.jsx)(O.Z.Text,{children:"Name"}),(0,m.jsx)(B.Z,{value:null==j?void 0:j.name,onChange:H})]}),(0,m.jsxs)(T.Z,{size:"small",children:[(0,m.jsx)(f.Z,{items:c.map(e=>({key:e.id,label:e.name})),activeKey:C,onChange:F}),(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,children:[(0,m.jsxs)(U.Z,{className:A().fullWidth,style:{justifyContent:"space-between"},children:[(0,m.jsx)(O.Z.Text,{children:"Point selection"}),(0,m.jsx)(R.Z,{title:"Pin in the geometry",children:(0,m.jsx)(D.ZP,{size:"small",type:g?"primary":"default",icon:(0,m.jsx)(lP.Z,{}),onClick:L})})]}),(0,m.jsx)(et,{label:"X",defaultValue:null==j?void 0:null===(l=j.point)||void 0===l?void 0:l.x,onValueChange:W}),(0,m.jsx)(et,{label:"Y",defaultValue:null==j?void 0:null===(t=j.point)||void 0===t?void 0:t.y,onValueChange:V}),(0,m.jsx)(et,{label:"Z",defaultValue:null==j?void 0:null===(a=j.point)||void 0===a?void 0:a.z,onValueChange:Y})]})]}),(0,m.jsx)(T.Z,{size:"small",className:A().noBorderBottom,children:(0,m.jsx)(et,{label:"Formula",defaultValue:null==j?void 0:j.formula,onValueChange:z})}),P&&(0,m.jsxs)(O.Z.Text,{children:[(0,m.jsx)(ek.Z,{style:{color:"red"}})," ",P]})]})})},lR={udpate:"Unable to update simulation"},lD=async(e,l,t,a)=>{try{let i=P.Z.deepCopy(e),n=i.scheme.configuration.run;t((0,ep.N7)()),n.sensors=[...n.sensors.slice(0,l),...n.sensors.slice(l+1)],await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:n}]),await a.mutateOneSimulation(i)}catch(e){throw(0,k.lt)(lR.udpate,e),e}},lL=e=>{let{simulation:l,index:t,swr:a}=e,[i,n]=(0,h.useState)(),{dispatch:s}=(0,h.useContext)(ey.ZB),o=(0,h.useMemo)(()=>l.scheme.configuration.run,[l]),r=(0,h.useMemo)(()=>o.sensors[t],[t,o]),u=(0,h.useCallback)(async()=>{n(!0);try{await lD(l,t,s,a)}finally{n(!1)}},[l,t,s,a]);return(0,m.jsx)(S.m1,{loading:i,text:(0,m.jsxs)(m.Fragment,{children:["Are you sure you want to delete the sensor"," ",(0,m.jsx)(O.Z.Text,{strong:!0,children:r.name})]}),onDelete:u})},lF=e=>{let{simulation:l,sensor:t,index:a,_onEdit:i,swr:n}=e,{dispatch:s}=(0,h.useContext)(ey.ZB),o=(0,h.useCallback)(()=>{s((0,ep.wp)()),s((0,ep.N7)(t.point))},[t,s]),r=(0,h.useCallback)(()=>{s((0,ep.h$)())},[s]),u=(0,h.useCallback)(()=>i({...t,index:a}),[t,a,i]);return(0,m.jsx)(T.Z,{className:"".concat(A().textAlignCenter," ").concat(er().listItem),hoverable:!0,onMouseEnter:o,onMouseLeave:r,actions:[(0,m.jsx)(S.w6,{onEdit:u},"edit"),(0,m.jsx)(lL,{simulation:l,index:a,swr:n},"delete")],children:(0,m.jsx)(O.Z.Text,{strong:!0,className:A().textAlignCenter,children:t.name})})},lA=e=>{var l;let{simulation:t,onEdit:a,swr:i}=e,n=(0,h.useMemo)(()=>t.scheme.configuration.run,[t]);return(0,m.jsx)(m.Fragment,{children:null===(l=n.sensors)||void 0===l?void 0:l.map((e,l)=>(0,m.jsx)(lF,{simulation:t,sensor:e,index:l,_onEdit:a,swr:i},e.name))})},lG=e=>{let{geometries:l,simulation:t,setVisible:a,setResults:i,setPostprocessing:n,swr:s}=e,[o,r]=(0,h.useState)(),[u,d]=(0,h.useState)(),c=(0,h.useCallback)(()=>{i([]),n(void 0),d(void 0),a(!1),r(!0)},[a,i,n]),y=(0,h.useCallback)(e=>{i([]),n(void 0),d(e),a(!1),r(!0)},[a,i,n]),p=(0,h.useCallback)(()=>{d(void 0),a(!0),r(!1)},[a]);return(0,m.jsxs)(T.Z,{size:"small",title:"Sensors",children:[(0,m.jsx)(l_,{visible:o,geometries:l,simulation:t,sensor:u,onClose:p,swr:s}),(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,children:[(0,m.jsx)(D.ZP,{className:A().fullWidth,disabled:!1,type:"primary",icon:(0,m.jsx)(lw.Z,{}),onClick:c,children:"Add a sensor"}),(0,m.jsx)(lA,{simulation:t,onEdit:y,swr:s})]})]})};var lz=t(5152),lI=t.n(lz),lH=t(11163),lB=t(139),lW=t(33997);let lV={plugins:"Plugins error",pluginsLoad:"Unable to load plugins"},lY=e=>{let{plugin:l,onOk:a,setVisible:i}=e,n=lI()(()=>t(64546)("./".concat(l.key,"/src/components"))),s=(0,h.useCallback)(e=>{(async()=>{(0,j.merge)(l,e),await a(l),i(!1)})()},[l,a,i]);return(0,m.jsx)(T.Z,{title:l.configuration.name.value,children:(0,m.jsx)(n,{data:l.data,onSelect:s})},l.uuid)},l$=e=>{let{pluginsList:l,plugins:t,onOk:a,setVisible:i}=e;return(null==t?void 0:t.length)?(0,m.jsx)(U.Z,{align:"start",direction:"horizontal",wrap:!0,children:t.map(e=>{let t=l.find(l=>l.key===e.key);return t?(0,m.jsx)(lY,{plugin:e,onOk:a,setVisible:i},e.key):null})}):null},lq=e=>{let{disabled:l,cloudServer:t,onOk:a}=e,[i,n]=(0,h.useState)(!1),[s,o]=(0,h.useState)([]),r=(0,lH.useRouter)(),[u,{errorPlugins:d}]=lW.Z.usePlugins();(0,h.useEffect)(()=>{d&&(0,k.lt)(lV.plugins,d)},[d]),(0,h.useEffect)(()=>{(async()=>{try{let e=await N.Z.list();o(e)}catch(e){(0,k.lt)(lV.pluginsLoad,e)}})()},[]);let c=(0,h.useCallback)(()=>n(!0),[]),y=(0,h.useCallback)(()=>n(!1),[]),v=(0,h.useCallback)(()=>{(async()=>{await r.push({pathname:"/dashboard",query:{page:"account",tab:"hpc"}})})()},[r]);return(0,m.jsxs)(T.Z,{size:"small",title:"Computational resource",children:[(0,m.jsx)(p.Z,{open:i,title:"Computational resource",okButtonProps:{disabled:!0,style:{display:"none"}},onCancel:y,style:{width:"unset"},children:(0,m.jsxs)(U.Z,{direction:"vertical",children:[(0,m.jsxs)(O.Z.Text,{children:["Your computational resource does not appear in this list? Create one in your"," ",(0,m.jsx)(S.Qj,{onClick:v,children:"account settings"})]}),(0,m.jsx)(l$,{pluginsList:s,plugins:u,onOk:a,setVisible:n})]})}),(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,children:[t&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(O.Z.Text,{children:[(0,m.jsx)("span",{className:A().textLight,children:"Plugin:"})," ",t.name]}),(0,m.jsxs)(O.Z.Text,{children:[(0,m.jsx)("span",{className:A().textLight,children:"Name:"})," ",t.configuration.name.value]}),Object.keys(t.inUseConfiguration).map(e=>{let l=t.inUseConfiguration[e],a=l.value;return"boolean"==typeof a&&(a=a?"yes":"no"),(0,m.jsxs)(O.Z.Text,{children:[(0,m.jsxs)("span",{className:A().textLight,children:[l.label,":"]})," ",a]},e)})]}),(0,m.jsx)(D.ZP,{className:A().fullWidth,disabled:l,type:t?"link":"primary",icon:(0,m.jsx)(lB.Z,{}),onClick:c,children:t?"Modify the resource":"Select a resource"})]})]})};var lK=t(15360),lJ=t(25935),lX=t(48764).lW;let lQ={log:"Unable to get system log"},l0=async(e,l)=>{try{let t=await E.Z.log({id:e.id},l.systemLog),a=lX.from(t.log).toString();p.Z.info({title:"System log",width:"unset",content:(0,m.jsx)("div",{style:{maxHeight:"70vh",overflow:"auto"},children:(0,m.jsx)("pre",{children:(0,m.jsx)("code",{children:(0,lJ.ZP)(a.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))})})})})}catch(e){(0,k.lt)(lQ.log,e)}},l1=e=>{var l,t,a,i;let{simulation:n,step:s,loading:o,setLoading:r}=e,u=(0,h.useCallback)(()=>{(async()=>{r(!0);try{await l0(n,s)}catch(e){}finally{r(!1)}})()},[n,s,r]);return(0,m.jsxs)(m.Fragment,{children:[s.systemLog&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(D.ZP,{loading:o,onClick:u,children:"Complete log"}),(0,m.jsx)("br",{})]}),s.link&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("a",{href:"https://"+s.link.href,target:"_blank",rel:"noreferrer",children:(0,m.jsx)(D.ZP,{type:"primary",children:s.link.label})}),(0,m.jsx)("br",{})]}),(0,m.jsxs)(eq.Z,{ghost:!0,children:[s.warning&&(0,m.jsx)(eq.Z.Panel,{className:er().warning,header:(0,m.jsx)(O.Z.Text,{type:"warning",children:"Warnings"}),children:(0,lJ.ZP)(s.warning.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))},"warnings"),s.error&&(0,m.jsx)(eq.Z.Panel,{className:er().error,header:(0,m.jsx)(O.Z.Text,{type:"danger",children:"Errors"}),children:(0,lJ.ZP)(s.error.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))},"errors")]}),(0,lJ.ZP)(null!==(a=null===(l=s.pluginLog)||void 0===l?void 0:l.replace(/\n\n/g,"\n").replace(/\n/g,"<br />"))&&void 0!==a?a:""),(0,lJ.ZP)(null!==(i=null===(t=s.log)||void 0===t?void 0:t.replace(/\n\n/g,"\n").replace(/\n/g,"<br />").replace(/Info\s*:/g,'<span style="color: blue; font-weight: bold;">Info: </span>').replace(/Error:/g,'<span style="color: red; font-weight: bold;">Error:</span>'))&&void 0!==i?i:"")]})},l2=e=>{let{simulation:l,steps:t}=e,[a,i]=(0,h.useState)(!1),[n,s]=(0,h.useState)(!1),o=(0,h.useCallback)(()=>i(!0),[]),r=(0,h.useCallback)(()=>i(!1),[]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(ej.Z,{title:"Log",open:a,onClose:r,width:"50%",children:(0,m.jsx)(f.Z,{items:null==t?void 0:t.map((e,t)=>({key:""+t,label:e.label,children:(0,m.jsx)(l1,{simulation:l,step:e,loading:n,setLoading:s})}))})}),(0,m.jsx)(R.Z,{title:"Log",children:(0,m.jsx)(D.ZP,{disabled:!(null==t?void 0:t.length),icon:(0,m.jsx)(lK.Z,{}),onClick:o})})]})};var l3=t(99611),l5=t(90420),l8=t(23430),l7=t(10739);let l4={download:"Unable to download file"},l6=async(e,l)=>{try{let t=await l7.Z.download({id:e.id},{originPath:l.originPath,fileName:l.fileName}),a=await t.blob(),i=window.URL.createObjectURL(new Blob([a])),n=document.createElement("a");n.href=i,n.setAttribute("download",l.name+"."+l.fileName.split(".").pop()),n.click()}catch(e){(0,k.lt)(l4.download,e)}},l9=e=>{let{simulation:l,file:t}=e,[a,i]=(0,h.useState)(!1),n=(0,h.useCallback)(()=>{(async()=>{i(!0);try{await l6(l,t)}catch(e){}finally{i(!1)}})()},[l,t]);return(0,m.jsx)(R.Z,{title:"Download",children:(0,m.jsx)(D.ZP,{loading:a,icon:(0,m.jsx)(l8.Z,{}),onClick:n})})},te={archive:"Unable to download archive"},tl=async e=>{try{let l=await l7.Z.archive({id:e.id}),t=await l.blob(),a=window.URL.createObjectURL(new Blob([t])),i=document.createElement("a");i.href=a,i.setAttribute("download",e.scheme.name+".zip"),i.click()}catch(e){(0,k.lt)(te.archive,e)}},tt=e=>{let{simulation:l}=e,[t,a]=(0,h.useState)(!1),i=(0,h.useCallback)(()=>{(async()=>{a(!0);try{await tl(l)}catch(e){}finally{a(!1)}})()},[l]);return(0,m.jsx)(S.o6,{loading:t,onDownload:i})},ta=e=>{var l;let{simulation:t,results:a,file:i,setResults:n}=e,s=(0,h.useCallback)(()=>{let e=a.findIndex(e=>e.fileName===i.fileName&&e.name===i.name);-1===e?n([...a,i]):n([...a.slice(0,e),...a.slice(e+1)])},[a,i,n]),o=(0,h.useMemo)(()=>a.find(e=>e.fileName===i.fileName&&e.name===i.name),[a,i]);return(0,m.jsxs)(U.Z,{style:{alignItems:"center"},children:[(0,m.jsx)(D.ZP,{icon:o?(0,m.jsx)(l3.Z,{style:{color:"#fad114"}}):(0,m.jsx)(l5.Z,{}),onClick:s}),(0,m.jsx)(l9,{simulation:{id:t.id},file:{name:i.name,fileName:i.fileName,originPath:i.originPath}}),null===(l=i.name)||void 0===l?void 0:l.replaceAll("_"," ")]})},ti=e=>{let{simulation:l,results:t,setResults:a}=e,[i,n]=(0,h.useState)(),[s,o]=(0,h.useState)(),[r,u]=(0,h.useState)(),d=(0,h.useMemo)(()=>{var e;return null==l?void 0:null===(e=l.scheme)||void 0===e?void 0:e.configuration},[l]);(0,Z.Z)(()=>{var e;if(!(null==l?void 0:l.tasks)){n([]),o(void 0);return}let t=[],a=null==d?void 0:null===(e=d.run)||void 0===e?void 0:e.resultsFilter;l.tasks.forEach(e=>{if(e.file&&t.push(e.file),e.files){if(a){let l=new RegExp(a.pattern),i=e.files.filter(e=>!l.test(e.fileName)),n=e.files.filter(e=>l.test(e.fileName)),s=e6(n,a),r=s.map(e=>e.number).filter((e,l,t)=>t.indexOf(e)===l).sort((e,l)=>e-l),u=e9(d,a),c=r.map((e,l)=>({label:Math.round(1e15*(u?e*u:l))/1e15,value:e}));t.push(...i),o({filtered:!0,name:a.name,files:s,options:c})}else t.push(...e.files)}}),n(t)},[l,d]),(0,Z.Z)(()=>{!r&&s&&u(null==s?void 0:s.options[0].value)},[s,r]);let c=(0,h.useCallback)(e=>{let l=s.files.filter(l=>l.number===e&&t.find(e=>e.name===l.name));a(l),u(e)},[t,s,a]);return i||s?(null==i?void 0:i.length)||s?(0,m.jsx)(T.Z,{size:"small",title:"Results",extra:(0,m.jsx)(tt,{simulation:l&&{id:l.id,scheme:l.scheme}}),children:(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,children:[null==i?void 0:i.map(e=>(0,m.jsx)(ta,{simulation:l,results:t,file:e,setResults:a},e.name)),s&&(0,m.jsxs)(m.Fragment,{children:[s.name,(0,m.jsx)(y.Z,{className:A().fullWidth,options:s.options,value:r,onChange:c}),s.files.map(e=>{if(e.number===r)return(0,m.jsx)(ta,{simulation:l,results:t,file:e,setResults:a},e.name)})]})]})}):(0,m.jsx)(T.Z,{size:"small",children:"No results yet"}):(0,m.jsx)(M.Z,{})},tn={run:"Unable to run simulation",stop:"Unable to stop simulation",update:"Unable to update simulation"},ts=async(e,l,t)=>{try{let a=P.Z.deepCopy(e),i=e.scheme.configuration;i.run.cloudServer=l,a.scheme.configuration=i,await E.Z.update({id:e.id},[{key:"scheme",type:"json",method:"set",path:["configuration","run"],value:i.run}]),await t.mutateOneSimulation(a),await t.mutateSimulation(a)}catch(e){(0,k.lt)(tn.update,e)}},to=async e=>{try{await E.Z.run({id:e.id})}catch(e){throw(0,k.lt)(tn.run,e),e}},tr=async e=>{try{await E.Z.stop({id:e.id})}catch(e){throw(0,k.lt)(tn.stop,e),e}},tu=e=>{var l;let{geometries:t,simulation:a,results:i,setResults:n,setPostprocessing:s,setVisible:o,swr:r}=e,[u,d]=(0,h.useState)(!1),[c,y]=(0,h.useState)(!1),[p,f]=(0,h.useState)([]),[b,g]=(0,h.useState)(0),[x,{mutateSimulation:j}]=E.Z.useSimulation(a.id,2e3),k=(0,h.useMemo)(()=>a.scheme.configuration,[a]),C=(0,h.useMemo)(()=>{var e;return null==x?void 0:null===(e=x.scheme)||void 0===e?void 0:e.configuration},[x]);(0,Z.Z)(()=>{if(!k){d(!0);return}let e=!0;Object.keys(k).forEach(l=>{if("dimension"!==l&&"run"!==l){let t=k[l];t.done||(e=!1)}}),k.run.cloudServer||(e=!1),d(!e)},[k]),(0,Z.Z)(()=>{var e,l,t;(null==x?void 0:null===(e=x.tasks)||void 0===e?void 0:e.find(e=>(null==e?void 0:e.status)==="error"))?y(!1):(null==x?void 0:null===(l=x.tasks)||void 0===l?void 0:l.find(e=>e&&"finish"!==e.status))?y(!0):y(!1);let a=[];null==x||null===(t=x.tasks)||void 0===t||t.forEach((e,l)=>{if(e){if(l===x.tasks.length-1){var t,i,n;let l=null!==(n=null===(t=e.log)||void 0===t?void 0:t.match(/[\d\s]{3}%/g))&&void 0!==n?n:null===(i=e.log)||void 0===i?void 0:i.match(/[\d\s]*%/g),a=l?parseFloat(l.pop()):void 0;a&&g(a)}a[e.index]={index:e.index,label:e.label,status:e.status,log:e.log,pluginLog:e.pluginLog,warning:e.warning,error:e.error,systemLog:e.systemLog,link:e.link}}}),f(a)},[null==x?void 0:x.tasks]);let S=(0,h.useCallback)(async e=>ts(a,e,{...r,mutateSimulation:j}),[a,r,j]),w=(0,h.useCallback)(()=>{(async()=>{y(!0);try{await to(a)}catch(e){y(!1)}})()},[a]),P=(0,h.useCallback)(()=>{(async()=>{try{await tr(a),y(!1)}catch(e){}})()},[a]);return a&&x&&(null==x?void 0:x.id)!=="0"?(0,m.jsx)(v.Z,{children:(0,m.jsx)(v.Z.Content,{children:(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,children:[(0,m.jsx)(lG,{geometries:t,simulation:a,setVisible:o,setResults:n,setPostprocessing:s,swr:{mutateOneSimulation:r.mutateOneSimulation}}),(0,m.jsx)(lq,{disabled:c,cloudServer:null==C?void 0:null===(l=C.run)||void 0===l?void 0:l.cloudServer,onOk:S}),(0,m.jsx)(T.Z,{size:"small",title:"Run",children:(0,m.jsxs)(U.Z,{direction:"vertical",className:A().fullWidth,size:20,children:[(0,m.jsxs)("div",{className:A().fullWidth,style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,m.jsxs)(U.Z,{children:[(0,m.jsx)(D.ZP,{disabled:u,type:"primary",icon:(0,m.jsx)(lC.Z,{}),loading:c,onClick:w,children:"Run"}),(0,m.jsx)(D.ZP,{disabled:!c,danger:!0,icon:(0,m.jsx)(lS.Z,{}),shape:"circle",onClick:P})]}),(0,m.jsx)(l2,{simulation:{id:a.id},steps:p})]}),(0,m.jsx)(lk.Z,{direction:"vertical",current:p.length-1,percent:b,items:p.map((e,l)=>({key:l,title:e.label,description:"("+(l+1)+"/"+p.length+")",status:e.status}))})]})}),(0,m.jsx)(ti,{simulation:x&&{id:x.id,scheme:x.scheme,tasks:x.tasks},results:i,setResults:n})]})})}):(0,m.jsx)(v.Z,{children:(0,m.jsx)(v.Z.Content,{children:(0,m.jsx)(T.Z,{size:"small",children:(0,m.jsx)(M.Z,{})})})})};var td=t(1402),tc=[{key:"warpByVector",label:"Warp by vector",parameters:[{key:"Vectors",label:"Vectors",rules:[{required:!0,message:"Vectors is required"}]},{key:"ScaleFactor",label:"Scale factor",default:"1",rules:[{required:!0,message:"Scale factor is required"}]}]},{key:"contour",label:"Contour",parameters:[{key:"ContourBy",label:"Contour by",rules:[{required:!0,message:"ContourBy by is required"}]},{key:"isosurface",label:"Isosurface",default:"0",rules:[{required:!0,message:"Isosurface is required"}]}]},{key:"streamTracer",label:"Stream tracer",parameters:[{key:"Vectors",label:"Vectors",rules:[{required:!0,message:"Vectors is required"}]}]}],tm=t(83755);let th=async(e,l,t,a)=>{let i=await (0,tm.R)("/api/postprocessing",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({simulation:e,result:l,filter:t,parameters:a})});return i.json()};var ty={run:th};let tp={run:"Unable to run filter"},tv=async(e,l,t,a)=>{try{return await ty.run(e,l,t,a)}catch(e){throw(0,k.lt)(tp.run,e),e}},tf=e=>{let{simulation:l,postprocessing:t,result:a,setResult:i}=e,n=(0,h.useCallback)(()=>i((null==t?void 0:t.fileName)===a.fileName&&(null==t?void 0:t.name)===a.name?void 0:{type:"postprocessing",...a}),[t,a,i]);return(0,m.jsxs)(U.Z,{children:[(0,m.jsx)(D.ZP,{icon:(null==t?void 0:t.fileName)===a.fileName&&(null==t?void 0:t.name)===a.name?(0,m.jsx)(l3.Z,{className:A().primaryColor}):(0,m.jsx)(l5.Z,{}),onClick:n}),(0,m.jsx)(l9,{simulation:{id:l.id},file:{name:a.name,fileName:a.fileName,originPath:a.originPath}}),a.name]},a.glb)},tb=e=>{let{simulation:l,postprocessing:t,results:a,setResult:i}=e;return a.length?(0,m.jsx)(U.Z,{direction:"vertical",className:A().fullWidth,children:a.map(e=>(0,m.jsx)(tf,{simulation:l,postprocessing:t,result:e,setResult:i},e.glb))}):(0,m.jsx)(m.Fragment,{children:"No results"})},tg=e=>{let{simulation:l,results:t,postprocessing:a,setResult:i}=e,[n,s]=(0,h.useState)(),[o,r]=(0,h.useState)(),[u,d]=(0,h.useState)(),[c,p]=(0,h.useState)();(0,h.useEffect)(()=>{1!==t.length&&n&&s(!1)},[t,n]);let f=(0,h.useMemo)(()=>t[0],[t]);(0,h.useEffect)(()=>{l||(r(void 0),p(void 0))},[l]);let b=(0,h.useMemo)(()=>null==l?void 0:l.scheme.configuration.run.postprocessing,[l]),g=(0,h.useMemo)(()=>tc.map(e=>{if(null==b?void 0:b.find(l=>l.key===e.key))return{label:e.label,value:e.key}}).filter(e=>e),[b]),x=(0,h.useMemo)(()=>{if(!b||!o)return;let e=tc.find(e=>e.key===o),l=b.find(e=>e.key===o);if(null==e?void 0:e.parameters)return e.parameters.map((e,t)=>{var a;let i=null==l?void 0:null===(a=l.parameters)||void 0===a?void 0:a.find(l=>l.key===e.key);return(null==i?void 0:i.value)?(0,m.jsx)(H.Z.Item,{label:e.label,name:["parameters",t],initialValue:i.value,rules:e.rules,children:(0,m.jsx)(B.Z,{disabled:!0})},e.key):(null==i?void 0:i.options)?(0,m.jsx)(H.Z.Item,{label:e.label,name:["parameters",t],rules:e.rules,children:(0,m.jsx)(y.Z,{options:i.options.map(e=>({label:e,value:e}))})},e.key):(0,m.jsx)(H.Z.Item,{label:e.label,name:["parameters",t],rules:e.rules,initialValue:e.default,children:(0,m.jsx)(B.Z,{})},e.key)})},[b,o]),j=(0,h.useCallback)(()=>s(!0),[]),Z=(0,h.useCallback)(()=>s(!1),[]),k=(0,h.useCallback)(e=>{(async()=>{d(!0);try{var t;let a=await tv({id:l.id},f,o,null!==(t=e.parameters)&&void 0!==t?t:[]);p({filter:o,results:a})}catch(e){}d(!1)})()},[l,f,o]);return l&&1===t.length&&b&&g.length?(0,m.jsx)(v.Z,{style:{position:"absolute",zIndex:101,right:25,bottom:50,backgroundColor:"rgba(255, 255, 255, 0)"},children:(0,m.jsxs)(v.Z.Content,{children:[(0,m.jsx)(R.Z,{title:"Post-processing",children:(0,m.jsx)(D.ZP,{type:"primary",icon:(0,m.jsx)(td.Z,{}),onClick:j,style:{width:40,height:40,border:"1px solid #5E14FA",borderRadius:20,marginBottom:-20}})}),(0,m.jsxs)(ej.Z,{title:"Post-processing",closable:!0,onClose:Z,open:n,mask:!1,maskClosable:!1,children:[(0,m.jsx)(H.Z,{style:{margin:"24px 0"},children:(0,m.jsx)(H.Z.Item,{name:"filter",label:"Filter",children:(0,m.jsx)(y.Z,{placeholder:"Select a filter",options:g,onChange:r})})}),(0,m.jsxs)(H.Z,{layout:"vertical",style:{margin:"24px 0"},onFinish:k,children:[x,(0,m.jsx)(H.Z.Item,{children:(0,m.jsx)(D.ZP,{type:"primary",loading:u,htmlType:"submit",icon:(0,m.jsx)(lC.Z,{}),children:"Run"})})]}),c&&(0,m.jsx)(T.Z,{size:"small",title:"Post-processing",extra:c.filter,children:(0,m.jsx)(tb,{simulation:l,postprocessing:a,results:c.results,setResult:i})})]})]})}):null},tx={plugins:"Unable to load plugins",update:"Unable to update simulation"},tj=async e=>{try{let l=await N.Z.list();return tZ(e,w,l)}catch(e){return(0,k.lt)(tx.plugins,e),[]}},tZ=(e,l,t)=>{let a=l;return t.forEach(l=>{var t;(null==e?void 0:null===(t=e.authorizedplugins)||void 0===t?void 0:t.includes(l.key))&&"Model"===l.category&&(a=[...a,...l.models])}),a},tk=(e,l)=>{if(!(null==l?void 0:l.length))return!0;if(Array.isArray(e)){let t=l.filter(l=>e.includes(l));return t.length==l.length}return!!(1===l.length&&l.includes(e))},tC=e=>{let{visible:l,user:t,title:a,okText:i,onOk:n,onCancel:s,onDelete:o}=e,[r,u]=(0,h.useState)(),[d,c]=(0,h.useState)(),[g,x]=(0,h.useState)(!1),[j,k]=(0,h.useState)([]),[w,E]=(0,h.useState)(),[N,T]=(0,h.useState)();(0,Z.Z)(()=>{(async()=>{if(t){let e=await tj(t);k(e)}})()},[t]),(0,Z.Z)(()=>{let e=j.map(e=>e.category).flat().filter((e,l,t)=>t.indexOf(e)===l).map(e=>({key:e,value:e}));E(e)},[j]);let M=(0,h.useCallback)(e=>{let{key:l}=e;u(l);let t=j.find(e=>e.algorithm===l);c(P.Z.deepCopy(t))},[j]),O=(0,h.useCallback)(e=>{let{key:l}=e;u(l);let a=t.models.find(e=>e.algorithm===l);c(P.Z.deepCopy(a))},[t]),U=(0,h.useCallback)(()=>{(async()=>{if(x(!0),d)try{await n(d)}catch(e){}x(!1),c(void 0),u(void 0)})()},[d,n]),_=(0,h.useCallback)(()=>{c(void 0),u(void 0),s()},[s]),R=(0,h.useMemo)(()=>{let e=[{key:"category",disabled:!0,label:(0,m.jsx)(y.Z,{mode:"multiple",className:A().fullWidth,options:w,allowClear:!0,showArrow:!1,placeholder:"Category filter",onChange:T})}];return j.forEach(l=>{tk(l.category,N)&&e.push({key:l.algorithm,label:l.name})}),e},[j,w,N]),D=(0,h.useMemo)(()=>{let e=[{key:"category",disabled:!0,label:(0,m.jsx)(y.Z,{mode:"multiple",className:A().fullWidth,options:w,allowClear:!0,showArrow:!1,placeholder:"Category filter",onChange:T})}];return null==t||t.models.forEach((l,t)=>{tk(l.category,N)&&e.push({key:l.algorithm,label:(0,m.jsxs)(m.Fragment,{children:[o?(0,m.jsx)(S.m1,{onDelete:async()=>o(t)}):null,l.name]})})}),e},[t,w,N,o]);return(0,m.jsx)(p.Z,{open:l,title:null!=a?a:"Create simulation",okText:null!=i?i:"Create",okButtonProps:{loading:g},onOk:U,onCancel:_,width:"80%",children:(0,m.jsxs)(v.Z,{className:er().selectorContent,children:[(0,m.jsx)(v.Z.Sider,{theme:"light",width:300,className:er().selectorSider,children:(0,m.jsx)(f.Z,{items:[{key:"tanatloc",label:"Tanatloc algorithm",children:(0,m.jsx)(b.Z,{selectedKeys:r?[r]:void 0,mode:"inline",items:R,onClick:M})},{key:"personal",label:"User algorithm",children:(0,m.jsx)(b.Z,{selectedKeys:r?[r]:void 0,mode:"inline",className:er().selectorMenu,items:D,onClick:O})}]})}),(0,m.jsx)(v.Z.Content,{className:er().selector,children:(0,m.jsx)(C.Z.Html,{html:null==d?void 0:d.description})})]})})},tS=async(e,l,t)=>{try{let a=l.find(l=>{var t;return l.algorithm===(null==e?void 0:null===(t=e.scheme)||void 0===t?void 0:t.algorithm)}),i=P.Z.deepCopy(e);(0,j.merge)(i.scheme,a),await E.Z.update({id:e.id},[{key:"scheme",value:i.scheme}]),await t.mutateOneSimulation(i)}catch(e){(0,k.lt)(tx.update,e)}},tw=e=>{let{user:l,simulation:t,swr:a}=e,[i,n]=(0,h.useState)([]);return(0,Z.Z)(()=>{(async()=>{if(l){let e=await tj(l);n(e)}})()},[l]),(0,Z.Z)(()=>{let e=i.find(e=>{var l;return e.algorithm===(null==t?void 0:null===(l=t.scheme)||void 0===l?void 0:l.algorithm)});if(e&&(null==t?void 0:t.scheme)){let l=(0,g.Z)(t.scheme,e),n=(0,x.Z)(t.scheme,e);(Object.keys(l).length||Object.keys(n).length)&&(p.Z.info({title:"Update",content:"Your model need an update, please wait.",closable:!1,okButtonProps:{hidden:!0}}),tS(t,i,a).finally(()=>p.Z.destroyAll()))}},[t,i,a]),null};var tP={Selector:tC,Updater:tw,About:X,Geometry:em,Materials:e$,Parameters:e4,Initialization:lo,BoundaryConditions:lZ,Run:tu,Postprocessing:tg}},36642:function(e,l,t){"use strict";t.d(l,{Z:function(){return o}});var a=t(67294);let i=(e,l)=>{if(!e||!l)return!1;let t=e.length,a=l.length;return t===a&&e.every((e,t)=>{let a=l[t];return null===e&&null===a||void 0===e&&void 0===a||(Array.isArray(e)?i(e,a):"object"==typeof e?n(e,a):e===a)})},n=(e,l)=>!!e&&!!l&&JSON.stringify(e)===JSON.stringify(l),s=(e,l,t)=>{let n=(0,a.useRef)();(0,a.useEffect)(()=>{var t;if(!(null===(t=n.current)||void 0===t?void 0:t.length)||!i(n.current,l))return n.current=[...null!=l?l:[!0]],e()},[...null!=l?l:[],...null!=t?t:[],e])};var o=s},40782:function(e,l,t){"use strict";t.d(l,{CH:function(){return r},Cw:function(){return s},HW:function(){return u},N7:function(){return m},Ys:function(){return d},h$:function(){return n},hF:function(){return c},rx:function(){return o},wp:function(){return i}});var a=t(48474);let i=()=>({type:a.Hp.ENABLE}),n=()=>({type:a.Hp.DISABLE}),s=e=>({type:a.Hp.SETTYPE,value:e}),o=e=>({type:a.Hp.SETPART,value:e}),r=e=>{let{uuid:l,label:t}=e;return{type:a.Hp.HIGHLIGHT,value:{uuid:l,label:t}}},u=()=>({type:a.Hp.UNHIGHLIGHT}),d=e=>{let{uuid:l,label:t}=e;return{type:a.Hp.SELECT,value:{uuid:l,label:t}}},c=e=>{let{uuid:l,label:t}=e;return{type:a.Hp.UNSELECT,value:{uuid:l,label:t}}},m=e=>({type:a.Hp.SETPOINT,value:e})},48474:function(e,l,t){"use strict";t.d(l,{Hp:function(){return s},ZB:function(){return o}});var a=t(85893),i=t(67294);let n={enabled:!1,type:void 0,part:void 0,highlighted:void 0,selected:[],point:void 0,dispatch:()=>void 0},s={ENABLE:"ENABLE",DISABLE:"DISABLE",CLEAR:"CLEAR",SETTYPE:"SETTYPE",SETPART:"SETPART",HIGHLIGHT:"HIGHLIGHT",UNHIGHLIGHT:"UNHIGHLIGHT",SELECT:"SELECT",UNSELECT:"UNSELECT",SETPOINT:"SETPOINT"},o=(0,i.createContext)(n),r=(e,l)=>{let t;switch(l.type){case s.ENABLE:return{...e,enabled:!0};case s.DISABLE:return{...e,enabled:!1,highlighted:void 0,selected:[],point:void 0};case s.CLEAR:return{...n};case s.SETTYPE:return{...e,type:l.value};case s.SETPART:return{...e,part:l.value};case s.HIGHLIGHT:return{...e,highlighted:l.value};case s.UNHIGHLIGHT:return{...e,highlighted:void 0};case s.SELECT:if(-1===(t=e.selected.findIndex(e=>e.uuid===l.value.uuid)))return{...e,selected:[...e.selected,l.value]};return e;case s.UNSELECT:if(-1===(t=e.selected.findIndex(e=>e.uuid===l.value.uuid)))return e;return{...e,selected:[...e.selected.slice(0,t),...e.selected.slice(t+1)]};case s.SETPOINT:return{...e,point:l.value};default:return e}},u=e=>{let{children:l}=e,[t,s]=(0,i.useReducer)(r,n),u=(0,i.useMemo)(()=>({...t,dispatch:s}),[t]);return(0,a.jsx)(o.Provider,{value:u,children:l})};l.ZP=u},80108:function(e){e.exports={loading:"loading_loading__JrCmd",title:"loading_title__ESacg",content:"loading_content__NuP8g",status:"loading_status__UhnSG",errors:"loading_errors__j2ZIA",error:"loading_error__p5Dww",errorCard:"loading_errorCard__BCfHX"}},68847:function(e){e.exports={panel:"panel_panel___hALB",subPanel:"panel_subPanel__0TV8M"}},98281:function(e){e.exports={selectorContent:"simulation_selectorContent__HWIz8",selectorSider:"simulation_selectorSider__aC0Gk",selector:"simulation_selector__Xf4pE",geometriesList:"simulation_geometriesList__1Ces7",waring:"simulation_waring__Dn3br",error:"simulation_error__4EgiV",listItem:"simulation_listItem__YxV62"}},64546:function(e,l,t){var a={"./local/src/components":[21091,1091]};function i(e){if(!t.o(a,e))return Promise.resolve().then(function(){var l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l});var l=a[e],i=l[0];return t.e(l[1]).then(function(){return t(i)})}i.keys=function(){return Object.keys(a)},i.id=64546,e.exports=i}}]);