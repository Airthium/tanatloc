(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{40528:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return r(73336)}])},15479:function(e,n,r){"use strict";r.d(n,{JT:function(){return i},ah:function(){return o},nq:function(){return a},tE:function(){return s},yL:function(){return t}});r(83454).env.AUTH_SECRET||new Array(33).join("a");var t=6,a=16,i=!0,s=!0,o=!0},81891:function(e,n,r){"use strict";r.d(n,{H:function(){return o}});var t=r(51438),a=r(28668),i=r(25892),s=r(91224),o=function(e){(0,a.Z)(r,e);var n=(0,s.Z)(r);function r(e){var a;return(0,t.Z)(this,r),(a=n.call(this,e.title)).title=e.title,a.name="APIError",a.render=e.render,a.err=e.err,a.type=e.type||"error",a}return r}((0,i.Z)(Error))},36574:function(e,n,r){"use strict";r.d(n,{Z:function(){return p}});var t=r(26042),a=r(8100),i=r(67294),s=r(87492),o=r(47568),u=r(34051),c=r.n(u),l=function(){var e=(0,o.Z)(c().mark((function e(n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.R)("/api/system",{method:"PUT",body:JSON.stringify(n)});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),d={useSystem:function(){var e=(0,a.ZP)("/api/system",s._),n=e.data,r=e.error,o=e.mutate,u=!n,c=(null===n||void 0===n?void 0:n.system)||{},l=(0,i.useCallback)((function(e){o({system:(0,t.Z)({},c,e)})}),[c,o]);return[c,{mutateSystem:l,errorSystem:r,loadingSystem:u}]},update:l},p=d},51986:function(e,n,r){"use strict";r.d(n,{o:function(){return x}});var t=r(828),a=r(85893),i=r(81579),s=r(69677),o=r(15479),u=r(36574),c="Please enter a password",l=function(e){return"Your password is too small (minimum "+e+" characters)"},d=function(e){return"Your password is too long (maximum "+e+" characters)"},p="Your password must contain a letter",f="Your password must contain a number",m="Your password must contain a symbol",h=function(e,n){return-1!==e.search(n)},v=function(e,n,r){(function(e,n){var r,t;return!(null!==(t=null===e||void 0===e||null===(r=e.password)||void 0===r?void 0:r.requireLetter)&&void 0!==t?t:o.JT)||h(n,/[a-zA-Z]/)})(e,n)||r.push(p),function(e,n){var r,t;return!(null!==(t=null===e||void 0===e||null===(r=e.password)||void 0===r?void 0:r.requireNumber)&&void 0!==t?t:o.tE)||h(n,/\d/)}(e,n)||r.push(f),function(e,n){var r,t;return!(null!==(t=null===e||void 0===e||null===(r=e.password)||void 0===r?void 0:r.requireSymbol)&&void 0!==t?t:o.ah)||h(n,/[!@#$%^&*(){}[\]<>?/|.:;_-]/)}(e,n)||r.push(m)},x=function(e){var n,r,p,f,m=e.labelCol,h=e.wrapperCol,x=e.name,g=e.label,w=e.inputPlaceholder,j=e.inputAutoComplete,Z=e.edit,k=e.style,y=e.required,b=e.className,O=(0,t.Z)(u.Z.useSystem(),1)[0],z=null!==(p=null===O||void 0===O||null===(n=O.password)||void 0===n?void 0:n.min)&&void 0!==p?p:o.yL,P=null!==(f=null===O||void 0===O||null===(r=O.password)||void 0===r?void 0:r.max)&&void 0!==f?f:o.nq;return(0,a.jsx)(i.Z.Item,{className:b,labelCol:m,wrapperCol:h,name:x||"password",label:g||"Password",rules:[function(){return{validator:function(e,n){var r=[];return Z&&"******"===n?Promise.resolve():n?(function(e,n,r,t){(function(e,n){return!(n.length<e)})(e,r)||t.push(l(e)),function(e,n){return!(n.length>e)}(n,r)||t.push(d(n))}(z,P,n,r),v(O,n,r),r.length?Promise.reject(r):Promise.resolve()):Promise.reject(c)}}},{required:!!y,message:""}],style:k,children:(0,a.jsx)(s.Z.Password,{placeholder:w,autoComplete:j})})}},73336:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return Wt}});var t=r(85893),a=r(47568),i=r(828),s=r(34051),o=r.n(s),u=r(11163),c=r(67294),l=r(97183),d=r(34155),p=r(6880),f=r(41156),m=r(42952),h=r(55355),v=r(11186),x=r(25035),g=r(92443),w=r(59134),j=r.n(w),Z=r(4147),k=r(96844),y=r(75107),b=r(7614),O=r(27049),z=r(81579),P=r(69677),C=r(10197),S=r(62986),N=50,T=r(32834),U=r(26042),E=r(29815),q=r(8100),I=r(87492),R=function(){var e=(0,a.Z)(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.R)("/api/workspace",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(n)});case 2:return r=e.sent,e.abrupt("return",r.json());case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),A=function(){var e=(0,a.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.R)("/api/workspace",{method:"PUT",body:JSON.stringify({workspace:n,data:r})});case 2:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),D=function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.R)("/api/workspace",{method:"DELETE",body:JSON.stringify(n)});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),W={useWorkspaces:function(){var e=(0,q.ZP)("/api/workspace",I._),n=e.data,r=e.error,t=e.mutate,a=!n,i=(null===n||void 0===n?void 0:n.workspaces)||[],s=(0,c.useCallback)((function(e){var n=(0,E.Z)(i).concat([e]);t({workspaces:n})}),[i,t]),o=(0,c.useCallback)((function(e){var n=i.filter((function(n){return n.id!==e.id}));t({workspaces:n})}),[i,t]),u=(0,c.useCallback)((function(e){var n=i.map((function(n){return n.id===e.id&&(n=(0,U.Z)({},n,e)),n}));t({workspaces:n})}),[i,t]);return[i,{addOneWorkspace:s,delOneWorkspace:o,mutateOneWorkspace:u,errorWorkspaces:r,loadingWorkspaces:a}]},add:R,update:A,del:D},F=W,H=r(26713),L=r(24093),G=r(68795),_=r(45278),M=r(58191),J=r(71577),B=r(20046),Y=r(41641),V=r(60877),X=r(94370),K="Unable to share",Q=function(){var e=(0,a.Z)(o().mark((function e(n,r,t,a,i){var s,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=10;break}return e.next=4,F.update({id:n.id},[{key:"groups",value:t},{key:"users",value:a}]);case 4:(s=V.Z.deepCopy(n)).groups=t.map((function(e){return{id:e}})),s.users=a.map((function(e){return{id:e}})),i.mutateOneWorkspace(s),e.next=16;break;case 10:return e.next=12,X.Z.update({id:r.id},[{key:"groups",value:t},{key:"users",value:a}]);case 12:(u=V.Z.deepCopy(r)).groups=t.map((function(e){return{id:e}})),u.users=a.map((function(e){return{id:e}})),i.mutateOneProject(u);case 16:e.next=22;break;case 18:throw e.prev=18,e.t0=e.catch(0),(0,k.lt)(K,e.t0),e.t0;case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(n,r,t,a,i){return e.apply(this,arguments)}}(),$=function(e){var n=e.email;return(e.lastname||e.firstname)&&(n=e.lastname?e.lastname+" ":"",n+=e.firstname||""),n},ee=function(e){var n=e.disabled,r=e.workspace,i=e.project,s=e.organizations,l=e.swr,d=e.style,f=(0,c.useState)(!1),m=f[0],h=f[1],v=(0,c.useState)(!1),x=v[0],g=v[1],w=(0,c.useState)([]),Z=w[0],k=w[1],y=(0,c.useState)([]),b=y[0],O=y[1],P=(0,c.useState)([]),C=P[0],S=P[1],N=(0,c.useState)([]),U=N[0],E=N[1],q=(0,u.useRouter)();(0,c.useEffect)((function(){var e=r||i,n=null===e||void 0===e?void 0:e.groups.map((function(e){return e.id})),t=null===e||void 0===e?void 0:e.users.map((function(e){return e.id}));S(n||[]),E(t||[])}),[r,i]),(0,c.useEffect)((function(){var e=s.map((function(e){var n=e.groups.map((function(e){return{key:e.id,title:e.name,value:e.id,type:"group"}}));return{key:e.id,title:e.name,value:e.id,disabled:!0,checkable:!1,children:n}})),n=[];s.forEach((function(e){e.owners.forEach((function(e){n.push({key:e.id,title:$(e),value:e.id,type:"user"})})),e.users.forEach((function(e){n.push({key:e.id,title:$(e),value:e.id,type:"user"})})),e.groups.forEach((function(e){e.users.forEach((function(e){n.push({key:e.id,title:$(e),value:e.id,type:"user"})}))}))}));var r=n.filter((function(e,n,r){return r.findIndex((function(n){return n.key===e.key}))===n}));k(e),O(r)}),[s]);var I=null;return I=Z.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(z.Z.Item,{label:(0,t.jsxs)(t.Fragment,{children:["Share this ",r?"workspace":"project"," with organizations groups"]}),children:(0,t.jsx)(_.Z,{multiple:!0,treeCheckable:!0,treeDefaultExpandAll:!0,showCheckedStrategy:_.Z.SHOW_ALL,placeholder:"Select groups",dropdownStyle:{maxHeight:400,overflow:"auto"},className:"full-width",treeData:Z,value:C,onChange:function(e){return S(e)}})}),(0,t.jsx)(z.Z.Item,{label:(0,t.jsxs)(t.Fragment,{children:["Share this ",r?"workspace":"project"," with organizations users"]}),children:(0,t.jsx)(_.Z,{multiple:!0,treeCheckable:!0,treeDefaultExpandAll:!0,showCheckedStrategy:_.Z.SHOW_ALL,placeholder:"Select users",dropdownStyle:{maxHeight:400,overflow:"auto"},className:"full-width",treeData:b,value:U,onChange:function(e){return E(e)}})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("br",{}),(0,t.jsx)(p.Z.Text,{strong:!0,children:"There is no organization for now"}),(0,t.jsx)("br",{}),(0,t.jsxs)(p.Z.Text,{children:["You can create organizations and groups in the"," ",(0,t.jsx)(Y.Qj,{onClick:function(){return q.push({pathname:"/dashboard",query:{page:"organizations"}})},children:"Organization menu"}),"."]})]}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(M.Z,{title:"Share",children:(0,t.jsx)(J.Z,{className:"no-background "+((null===d||void 0===d?void 0:d.buttonLight)?"text-light ":"")+((null===d||void 0===d?void 0:d.buttonDark)?" text-dark ":"")+((null===d||void 0===d?void 0:d.buttonBordered)?" ":"no-border ")+(j()()?"display-none ":" "),disabled:n,type:n?"link":void 0,icon:(0,t.jsx)(B.Z,{}),onClick:function(){return h(!0)}},"share")}),(0,t.jsxs)(T.ZP,{title:"Share "+(r?"workspace":"project"),visible:m,onCancel:function(){return h(!1)},onOk:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.prev=1,e.next=4,Q(r,i,C,U,l);case 4:g(!1),h(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),g(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])}))),loading:x,children:[(0,t.jsxs)(p.Z.Title,{level:5,children:[r?"Workspace: ":"Project: ",(null===r||void 0===r?void 0:r.name)||(null===i||void 0===i?void 0:i.title)]}),I]})]})},ne=r(69396),re="Unable to add a project",te=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X.Z.add({id:n.id},r);case 3:return a=e.sent,t.addOneProject(a),t.mutateOneWorkspace((0,ne.Z)((0,U.Z)({},n),{projects:(0,E.Z)(n.projects).concat([a.id])})),e.abrupt("return",a);case 9:throw e.prev=9,e.t0=e.catch(0),(0,k.lt)(re,e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n,r,t){return e.apply(this,arguments)}}(),ae=function(e){var n=e.workspace,r=e.swr,i=(0,c.useState)(!1),s=i[0],l=i[1],d=(0,c.useState)(!1),p=d[0],f=d[1],m=(0,u.useRouter)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Y.HS,{primary:!1,dark:!0,onAdd:function(){return l(!0)},children:"Create a new project"}),(0,t.jsxs)(T.ZP,{title:"Create a new project",visible:s,onCancel:function(){return l(!1)},onOk:function(){var e=(0,a.Z)(o().mark((function e(t){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.prev=1,e.next=4,te(n,t,r);case 4:a=e.sent,f(!1),l(!1),m.push({pathname:"/project",query:{page:"workspaces",workspaceId:n.id,projectId:a.id}}),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(1),f(!1),e.t0;case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n){return e.apply(this,arguments)}}(),loading:p,children:[(0,t.jsx)(z.Z.Item,{label:"Name",name:"title",rules:[{required:!0,message:"Name is required"},{max:N,message:"Max 50 characters"}],children:(0,t.jsx)(P.Z,{placeholder:"Project's name"})}),(0,t.jsx)(z.Z.Item,{label:"Description",name:"description",children:(0,t.jsx)(P.Z.TextArea,{showCount:!0,maxLength:120,placeholder:"Project's description"})})]})]})},ie=r(81474),se=r(20550),oe=r(61980),ue="Unable to edit a project",ce=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X.Z.update({id:n.id},[{key:"title",value:r.title},{key:"description",value:r.description}]);case 3:t.mutateOneProject(n),e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),(0,k.lt)(ue,e.t0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n,r,t){return e.apply(this,arguments)}}(),le=function(e){var n=e.disabled,r=e.project,i=e.swr,s=(0,c.useState)(!1),u=s[0],l=s[1],d=(0,c.useState)(!1),p=d[0],f=d[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Y.w6,{disabled:n,dark:!0,onEdit:function(){return l(!0)}}),(0,t.jsxs)(T.ZP,{title:'Edit "'+r.title+'" project',visible:u,onCancel:function(){return l(!1)},onOk:function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.prev=1,e.next=4,ce(r,n,i);case 4:f(!1),l(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),f(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),loading:p,initialValues:{title:r.title,description:r.description},children:[(0,t.jsx)(z.Z.Item,{label:"Name",name:"title",rules:[{required:!0,message:"Name is required"},{max:N,message:"Max 50 characters"}],children:(0,t.jsx)(P.Z,{placeholder:"Project's name"})}),(0,t.jsx)(z.Z.Item,{label:"Description",name:"description",children:(0,t.jsx)(P.Z.TextArea,{placeholder:"Project's description",showCount:!0,maxLength:120})})]})]})},de=r(14670),pe="Unable to delete the project",fe=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X.Z.del({id:n.id},{id:r.id});case 3:a=n.projects.findIndex((function(e){return e===r.id})),n.projects=(0,E.Z)(n.projects.slice(0,a)).concat((0,E.Z)(n.projects.slice(a+1))),t.mutateOneWorkspace(n),t.delOneProject({id:r.id}),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),(0,k.lt)(pe,e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n,r,t){return e.apply(this,arguments)}}(),me=function(e){var n=e.disabled,r=e.workspace,i=e.project,s=e.swr,u=(0,c.useState)(!1),l=u[0],d=u[1];return(0,t.jsx)(Y.m1,{disabled:n,loading:l,title:"Delete the project",text:(0,t.jsxs)(t.Fragment,{children:["Are you sure you want to delete the project"," ",(0,t.jsx)(p.Z.Text,{strong:!0,children:i.title}),"?",(0,t.jsx)(de.Z,{type:"error",message:"If you delete the project, you will no longer be able to restore the archive"})]}),onDelete:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,fe(r,i,s);case 4:return e.prev=4,d(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])})))})},he=r(78116),ve=r(57546),xe=r(238),ge=r(48764).lW,we="Unable to archive project",je="Unable to unarchive project on server",Ze="Unable to delete archive",ke="Unable to upload archive",ye=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){var a,i,s,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X.Z.archive({id:r.id});case 3:return a=e.sent,e.next=6,a.blob();case 6:i=e.sent,s=window.URL.createObjectURL(new Blob([i])),(u=document.createElement("a")).href=s,u.setAttribute("download",r.id+".tanatlocarchive"),u.click(),t.mutateOneProject((0,ne.Z)((0,U.Z)({},r),{archived:!0})),t.mutateOneWorkspace(n),e.next=20;break;case 16:throw e.prev=16,e.t0=e.catch(0),(0,k.lt)(we,e.t0),e.t0;case 20:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(n,r,t){return e.apply(this,arguments)}}(),be=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X.Z.unarchiveFromServer({id:r.id});case 3:t.mutateOneProject((0,ne.Z)((0,U.Z)({},r),{archived:!1})),t.mutateOneWorkspace(n),e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),(0,k.lt)(je,e.t0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,r,t){return e.apply(this,arguments)}}(),Oe=function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X.Z.deleteArchiveFile({id:n.id});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),(0,k.lt)(Ze,e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(n){return e.apply(this,arguments)}}(),ze=function(){var e=(0,a.Z)(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new FileReader,e.abrupt("return",new Promise((function(e){r.addEventListener("load",(function(){e(r.result)})),r.readAsArrayBuffer(n)})));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Pe=function(){var e=(0,a.Z)(o().mark((function e(n,r,t,a){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("uploading"!==t.file.status){e.next=2;break}return e.abrupt("return",!0);case 2:if("done"!==t.file.status){e.next=17;break}return e.prev=3,e.next=6,ze(t.file.originFileObj);case 6:return i=e.sent,e.next=9,X.Z.unarchiveFromFile({id:r.id},ge.from(i));case 9:a.mutateOneProject((0,ne.Z)((0,U.Z)({},r),{archived:!1})),a.mutateOneWorkspace(n),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),(0,k.lt)(ke,e.t0);case 16:case 17:return e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(n,r,t,a){return e.apply(this,arguments)}}(),Ce=function(e){var n=e.disabled,r=e.workspace,i=e.project,s=e.swr,u=(0,c.useState)(!1),l=u[0],d=u[1],f=(0,c.useState)(!1),m=f[0],h=f[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.ZP,{visible:l,loading:m,title:"Archive",onCancel:function(){return d(!1)},onOk:i.archived?void 0:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.prev=1,e.next=4,ye(r,i,s);case 4:h(!1),d(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),h(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])}))),okButtonText:"Archive",children:i.archived?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(z.Z.Item,{label:"Restore archive from the server",tooltip:"This will restore the project from the server archive file.",children:(0,t.jsx)(J.Z,{loading:m,onClick:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.prev=1,e.next=4,be(r,i,s);case 4:h(!1),d(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),h(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),children:"Restore archive from the server"})}),(0,t.jsx)(z.Z.Item,{label:"Restore archive from local file",tooltip:"This will restore the project from your local archive file (.tanatlocarchive file).",children:(0,t.jsx)(he.Z,{action:"/api/noop",accept:".tanatlocarchive",showUploadList:!1,onChange:function(){var e=(0,a.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pe(r,i,n,s);case 2:t=e.sent,h(t),d(t);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),children:(0,t.jsx)(J.Z,{children:"Restore archive from archive file"})})}),(0,t.jsx)(z.Z.Item,{label:"Delete archive from the server",tooltip:"This will delete the archive file from the server, you will have to use a local copy to restore the project.",children:(0,t.jsx)(Y.m1,{loading:m,bordered:!0,title:"Delete server archive",text:"Are you sure your want to delete the archive from the server?",onDelete:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Oe(i));case 1:case"end":return e.stop()}}),e)}))),children:"Delete server archive"})})]}):(0,t.jsxs)(p.Z.Text,{children:["An archive will be downloaded and the project will not be editable anymore, archive the project \xab",i.title,"\xbb?"]})}),(0,t.jsx)(M.Z,{title:i.archived?"Manage archive":"Archive",children:(0,t.jsx)(J.Z,{disabled:n,type:"link",icon:i.archived?(0,t.jsx)(ve.Z,{}):(0,t.jsx)(xe.Z,{}),onClick:function(){return d(!0)}})})]})},Se=r(48764).lW,Ne=function(e){var n=e.user,r=e.page,a=e.workspace,i=e.projects,s=e.organizations,o=e.filter,l=e.sorter,d=e.swr,f=(0,c.useState)(!0),m=f[0],h=f[1],v=(0,c.useState)([]),x=v[0],g=v[1],w=(0,u.useRouter)();(0,c.useEffect)((function(){var e=i.map((function(e){var n,r,a,i,s;if(!o||(null===(r=null===(n=e.title)||void 0===n?void 0:n.toLowerCase())||void 0===r?void 0:r.includes(o.toLowerCase()))){var u;u=e.archived?(0,t.jsx)(S.Z,{description:"Archived project"}):e.avatar?(0,t.jsx)("img",{src:e&&Se.from(e.avatar).toString(),alt:"Tanatloc"}):(0,t.jsx)(S.Z,{image:"images/empty.svg",description:"No preview yet."});var c=(0,t.jsxs)(H.Z,{direction:"vertical",className:"full-width text-left",children:[(0,t.jsxs)(p.Z.Text,{children:[(0,t.jsx)("b",{children:"Created:"})," ",new Date(e.createddate).toLocaleDateString()]}),(0,t.jsxs)(p.Z.Text,{children:[(0,t.jsx)("b",{children:"Last modified:"})," ",new Date(e.lastaccess).toLocaleDateString()]}),e.description&&(0,t.jsx)(p.Z.Paragraph,{ellipsis:{rows:4,tooltip:!0},children:e.description})]}),l=null===e||void 0===e||null===(a=e.owners)||void 0===a?void 0:a.map((function(e){return V.Z.userToAvatar(e)})),d=null===e||void 0===e||null===(i=e.users)||void 0===i?void 0:i.map((function(e){return V.Z.userToAvatar(e)})),f=null===e||void 0===e||null===(s=e.groups)||void 0===s?void 0:s.map((function(e){return V.Z.groupToAvatar(e)}));return(0,ne.Z)((0,U.Z)({},e),{snapshotRender:u,descriptionRender:c,ownersRender:l,usersRender:d,groupsRender:f})}})).filter((function(e){return e}));switch(l){case"alphaAsc":e.sort((function(e,n){return e.title.localeCompare(n.title)}));break;case"alphaDesc":e.sort((function(e,n){return-1*e.title.localeCompare(n.title)}));break;case"modifiedDesc":e.sort((function(e,n){return new Date(n.lastaccess).getTime()-new Date(e.lastaccess).getTime()}))}g(e),h(!1)}),[i,o,l]);var j=function(e){w.push({pathname:"/project",query:{page:r,workspaceId:a.id,projectId:e.id}})};return m||d.loadingProjects?(0,t.jsx)(y.Z.Simple,{}):x.length?(0,t.jsx)(H.Z,{className:"marginBottom-20",wrap:!0,align:"start",size:20,children:x.map((function(e){var r,i,o,u;return(0,t.jsx)(ie.Z,{title:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Z.Paragraph,{ellipsis:{rows:2,tooltip:!0},children:e.title}),e.archived&&(0,t.jsx)(se.Z,{children:"Archived"})]}),className:"Project-Card"+(e.archived?" archive":""),cover:(0,t.jsxs)(oe.Z,{className:"Project-Carousel",dots:{className:"Project-Carousel-dots"},children:[(0,t.jsx)("div",{className:"Project-Carousel-snapshot"+(e.archived?" archive":""),onClick:function(){return!e.archived&&j({id:e.id})},children:e.snapshotRender}),(0,t.jsx)("div",{className:"Project-Carousel-description"+(e.archived?" archive":""),onClick:function(){return!e.archived&&j({id:e.id})},children:e.descriptionRender})]}),actions:[(0,t.jsx)(me,{disabled:!(null===e||void 0===e||null===(r=e.owners)||void 0===r?void 0:r.find((function(e){return e.id===(null===n||void 0===n?void 0:n.id)}))),workspace:{id:a.id,projects:a.projects},project:{id:e.id,title:e.title},swr:{mutateOneWorkspace:d.mutateOneWorkspace,delOneProject:d.delOneProject}},"delete"),(0,t.jsx)(Ce,{disabled:!(null===e||void 0===e||null===(i=e.owners)||void 0===i?void 0:i.find((function(e){return e.id===(null===n||void 0===n?void 0:n.id)}))),workspace:{id:a.id},project:{archived:e.archived,id:e.id,title:e.title},swr:{mutateOneWorkspace:d.mutateOneWorkspace,mutateOneProject:d.mutateOneProject}},"archive"),(0,t.jsx)(ee,{disabled:!(null===e||void 0===e||null===(o=e.owners)||void 0===o?void 0:o.find((function(e){return e.id===(null===n||void 0===n?void 0:n.id)}))),project:{id:e.id,title:e.title,groups:e.groups,users:e.users},organizations:s,swr:{mutateOneProject:d.mutateOneProject},style:{buttonDark:!0}},"share"),(0,t.jsx)(le,{disabled:!(null===e||void 0===e||null===(u=e.owners)||void 0===u?void 0:u.find((function(e){return e.id===(null===n||void 0===n?void 0:n.id)}))),project:{id:e.id,title:e.title,description:e.description},swr:{mutateOneProject:d.mutateOneProject}},"edit")],children:(0,t.jsxs)("div",{style:{padding:"6px 0",display:"grid",gridTemplateColumns:"10fr 1fr 20fr",gridTemplateRows:"auto auto"},children:[(0,t.jsx)("div",{children:"Admin:"}),(0,t.jsx)("div",{}),(0,t.jsx)("div",{children:"Shared with:"}),(0,t.jsx)(L.C.Group,{maxCount:5,children:e.ownersRender}),(0,t.jsx)(O.Z,{type:"vertical",style:{height:"80%",borderColor:"#f0f0f0"}}),(0,t.jsxs)(L.C.Group,{children:[e.usersRender,e.groupsRender]})]})},e.id)}))}):(0,t.jsx)(S.Z,{image:"images/empty.svg",className:"Project-Empty",description:o?(0,t.jsxs)(t.Fragment,{children:["No project found with the current search"," ",(0,t.jsx)("span",{className:"Project-Empty-search-value",children:o}),"..."]}):(0,t.jsx)(t.Fragment,{children:"No project for now... Get started!"})})},Te="Unable to update the workspace",Ue=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=V.Z.deepCopy(n),n.name=r.name,e.next=5,F.update({id:n.id},[{key:"name",value:r.name}]);case 5:t.mutateOneWorkspace(a),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),(0,k.lt)(Te,e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,r,t){return e.apply(this,arguments)}}(),Ee=function(e){var n=e.workspace,r=e.swr,i=(0,c.useState)(!1),s=i[0],u=i[1],l=(0,c.useState)(!1),d=l[0],p=l[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Y.w6,{bordered:!0,dark:!0,onEdit:function(){return u(!0)}}),(0,t.jsx)(T.ZP,{visible:s,loading:d,title:"Edit a workspace",initialValues:{name:n.name},onCancel:function(){return u(!1)},onOk:function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,Ue(n,t,r);case 4:p(!1),u(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),p(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),children:(0,t.jsx)(z.Z.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is required"},{max:N,message:"Max 50 characters"}],children:(0,t.jsx)(P.Z,{placeholder:"Workspace's name"})})})]})},qe="Unable to delete the workspace",Ie=function(){var e=(0,a.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F.del({id:n.id});case 3:r.delOneWorkspace({id:n.id}),e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),(0,k.lt)(qe,e.t0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n,r){return e.apply(this,arguments)}}(),Re=function(e){var n=e.workspace,r=e.swr,i=(0,c.useState)(!1),s=i[0],u=i[1];return(0,t.jsx)(Y.m1,{bordered:!0,loading:s,text:"The projects contained in this workspace will be lost.",onDelete:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,Ie(n,r);case 4:return e.prev=4,u(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])})))})},Ae="Projects error",De=function(e){var n,r,a,s,o,u,d=e.user,p=e.page,f=e.workspace,m=e.organizations,h=e.swr,v=(0,c.useState)(),x=v[0],g=v[1],w=(0,c.useState)(),j=w[0],Z=w[1],y=(0,i.Z)(X.Z.useProjects(null===f||void 0===f?void 0:f.projects),2),O=y[0],z=y[1],S=z.addOneProject,N=z.delOneProject,T=z.mutateOneProject,U=z.errorProjects,E=z.loadingProjects;return(0,c.useEffect)((function(){U&&(0,k.lt)(Ae,U)}),[U]),(0,t.jsxs)(l.Z,{className:"no-scroll",children:[(0,t.jsx)(b.Z,{className:"inWorkspace-PageHeader",backIcon:!1,footer:(0,t.jsxs)(H.Z,{direction:"horizontal",size:"large",className:"full-width lastchild-marginLeft-auto",children:[(0,t.jsx)(P.Z,{placeholder:"Enter a project name (case sensitive)",value:x,onChange:function(e){return g(e.target.value)},style:{width:500},suffix:(0,t.jsx)(G.Z,{className:"text-light"})}),(null===f||void 0===f||null===(n=f.owners)||void 0===n?void 0:n.find((function(e){return e.id===d.id})))?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ae,{workspace:{id:f.id,projects:f.projects},swr:{mutateOneWorkspace:h.mutateOneWorkspace,addOneProject:S}}),(0,t.jsxs)(H.Z,{size:8,children:[(0,t.jsx)(Ee,{workspace:{id:f.id,name:f.name},swr:{mutateOneWorkspace:h.mutateOneWorkspace}}),(0,t.jsx)(ee,{workspace:{id:f.id,name:f.name,groups:f.groups,users:f.users},organizations:m,swr:{mutateOneWorkspace:h.mutateOneWorkspace},style:{buttonDark:!0,buttonBordered:!0}}),(0,t.jsx)(Re,{workspace:{id:f.id},swr:{delOneWorkspace:h.delOneWorkspace}})]})]}):(0,t.jsx)("div",{})]}),children:(null===(r=f.users)||void 0===r?void 0:r.length)||(null===(a=f.groups)||void 0===a?void 0:a.length)?(0,t.jsxs)("div",{className:"inWorkspace-shared",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"marginRight-10",children:"Admin:"}),(0,t.jsx)(L.C.Group,{maxCount:5,children:null===(s=f.owners)||void 0===s?void 0:s.map((function(e){return V.Z.userToAvatar(e)}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"marginRight-10",children:"Shared with:"}),(0,t.jsx)(L.C.Group,{maxCount:5,children:null===(o=f.users)||void 0===o?void 0:o.map((function(e){return V.Z.userToAvatar(e)}))}),(0,t.jsx)(L.C.Group,{maxCount:5,children:null===(u=f.groups)||void 0===u?void 0:u.map((function(e){return V.Z.groupToAvatar(e)}))})]})]}):null}),(0,t.jsxs)(C.Z,{className:"inWorkspace-Tabs",defaultActiveKey:"modifiedDesc",onChange:function(e){return Z(e)},children:[(0,t.jsx)(C.Z.TabPane,{tab:"Last modified"},"modifiedDesc"),(0,t.jsx)(C.Z.TabPane,{tab:"Name (A-Z)"},"alphaAsc"),(0,t.jsx)(C.Z.TabPane,{tab:"Name (Z-A)"},"alphaDesc")]}),(0,t.jsx)(l.Z.Content,{className:"scroll",children:(0,t.jsx)(Ne,{user:d,page:p,workspace:{id:f.id,projects:f.projects},projects:O,organizations:m,filter:x,sorter:j,swr:{mutateOneWorkspace:h.mutateOneWorkspace,delOneProject:N,mutateOneProject:T,loadingProjects:E}})})]})},We="Unable to add the workspace",Fe=function(){var e=(0,a.Z)(o().mark((function e(n,r){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F.add(n);case 3:t=e.sent,r.addOneWorkspace(t),e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),(0,k.lt)(We,e.t0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,r){return e.apply(this,arguments)}}(),He=function(e){var n=e.swr,r=(0,c.useState)(!1),i=r[0],s=r[1],u=(0,c.useState)(!1),l=u[0],d=u[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Y.HS,{onAdd:function(){return d(!0)},children:"Create a new workspace"}),(0,t.jsx)(T.ZP,{visible:l,loading:i,title:"Create a new workspace",onCancel:function(){return d(!1)},onOk:function(){var e=(0,a.Z)(o().mark((function e(r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,e.next=4,Fe(r,n);case 4:s(!1),d(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),s(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),children:(0,t.jsx)(z.Z.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is required"},{max:N,message:"Max 50 characters"}],children:(0,t.jsx)(P.Z,{placeholder:"Workspace's name"})})})]})},Le="Unable to add the workspace",Ge=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F.add(r);case 3:a=e.sent,t.addOneWorkspace(a),n.push({pathname:"/dashboard",query:{page:"workspaces",workspaceId:a.id}}),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),(0,k.lt)(Le,e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,r,t){return e.apply(this,arguments)}}(),_e=function(e){var n=e.user,r=e.workspaces,i=e.organizations,s=e.swr,d=(0,c.useState)(!1),f=d[0],m=d[1],h=(0,c.useState)(!1),v=h[0],x=h[1],g=(0,u.useRouter)(),w=g.query,j=w.page,Z=w.workspaceId;return(0,t.jsxs)(l.Z,{className:"inDashboard Workspace no-scroll",children:[(0,t.jsx)(b.Z,{className:"inDashboard-PageHeader",backIcon:!1,title:(0,t.jsx)(p.Z.Title,{level:2,className:"inDashboard-PageHeader-title",children:"Workspaces"}),footer:(0,t.jsx)(O.Z,{})}),(0,t.jsx)(l.Z.Content,{className:"no-scroll",children:r.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.ZP,{visible:f,loading:v,title:"Create a new workspace",onCancel:function(){return m(!1)},onOk:function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.prev=1,e.next=4,Ge(g,n,s);case 4:x(!1),m(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),x(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),children:(0,t.jsx)(z.Z.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is required"},{max:N,message:"Max 50 characters"}],children:(0,t.jsx)(P.Z,{placeholder:"Workspace's name"})})}),(0,t.jsx)(C.Z,{type:"editable-card",className:"inDashboard-Tabs no-scroll",defaultActiveKey:Z||"1",onEdit:function(){return m(!0)},children:r.map((function(e){return(0,t.jsx)(C.Z.TabPane,{className:"no-scroll",tab:e.name,closable:!1,children:(0,t.jsx)(De,{user:n,page:j||It.workspaces.key,workspace:{id:e.id,name:e.name,projects:e.projects,owners:e.owners,users:e.users,groups:e.groups},organizations:i,swr:{delOneWorkspace:s.delOneWorkspace,mutateOneWorkspace:s.mutateOneWorkspace}})},e.id)}))})]}):(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(S.Z,{image:"images/empty.svg",description:"No workspace for now. Get started !",children:(0,t.jsx)(He,{swr:{addOneWorkspace:s.addOneWorkspace}})})})})]})},Me=r(87547),Je=r(88484),Be=r(81891),Ye=r(67169),Ve=r(41686),Xe=r(48764).lW,Ke="Unable to update informations",Qe="Unable to upload image",$e="Supported format: jpg, png",en="Image must be smaller than 5MB",nn=function(e){var n="image/jpeg"===e.type||"image/png"===e.type;n||(0,k.lt)($e);var r=e.size/1024/1024<1;return r||(0,k.lt)(en),n&&r},rn=function(){var e=(0,a.Z)(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new FileReader,e.abrupt("return",new Promise((function(e){r.addEventListener("load",(function(){e(r.result)})),r.readAsDataURL(n)})));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),tn=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("uploading"!==r.file.status){e.next=4;break}return e.abrupt("return",!0);case 4:if("done"!==r.file.status){e.next=20;break}return e.prev=5,e.next=8,rn(r.file.originFileObj);case 8:return a=e.sent,e.next=11,Ve.Z.add({name:r.file.name,uid:r.file.uid,data:a});case 11:t.mutateUser((0,ne.Z)((0,U.Z)({},n),{avatar:Xe.from(a)})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),(0,k.lt)(Qe,e.t0);case 17:case 20:return e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(n,r,t){return e.apply(this,arguments)}}(),an=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=[],n.email!==r.email&&a.push({key:"email",value:r.email}),n.firstname!==r.firstname&&a.push({key:"firstname",value:r.firstname}),n.lastname!==r.lastname&&a.push({key:"lastname",value:r.lastname}),a.length){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,Ye.Z.update(a);case 9:t.mutateUser({email:r.email,firstname:r.firstname,lastname:r.lastname}),a.find((function(e){return"email"===e.key}))&&(0,k.Ur)("Changes saved","A validation email has been send to "+r.email),e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(0),new Be.H({title:Ke,err:e.t0});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(n,r,t){return e.apply(this,arguments)}}(),sn=function(e){var n=e.user,r=e.swr,i=(0,c.useState)(!1),s=i[0],u=i[1],l=(0,c.useState)(!1),d=l[0],p=l[1],f=(0,c.useState)(),m=f[0],h=f[1];return(0,t.jsx)(ie.Z,{title:"Contact Details",children:(0,t.jsxs)(H.Z,{direction:"horizontal",className:"Account-Information",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(L.C,{size:128,src:n.avatar&&Xe.from(n.avatar).toString(),icon:(0,t.jsx)(Me.Z,{})}),(0,t.jsx)(he.Z,{action:"/api/noop",accept:".jpg,.png",showUploadList:!1,beforeUpload:nn,onChange:function(){var e=(0,a.Z)(o().mark((function e(t){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tn(n,t,r);case 2:a=e.sent,u(a);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),children:(0,t.jsx)(J.Z,{loading:s,icon:(0,t.jsx)(Je.Z,{}),children:"Upload new"})})]}),(0,t.jsx)("div",{children:(0,t.jsxs)(z.Z,(0,ne.Z)((0,U.Z)({},{labelCol:{span:4}}),{className:"max-width-500",initialValues:{email:n.email,firstname:n.firstname||"",lastname:n.lastname||""},onFinish:function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,an(n,t,r);case 4:h(null),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),h(e.t0);case 10:return e.prev=10,p(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[1,7,10,13]])})));return function(n){return e.apply(this,arguments)}}(),children:[(0,t.jsx)(z.Z.Item,{label:"Email",name:"email",rules:[{type:"email",message:"This is not a valid email"},{max:N,message:"Max 50 characters"}],children:(0,t.jsx)(P.Z,{disabled:j()()})}),(0,t.jsx)(z.Z.Item,{label:"First name",name:"firstname",rules:[{max:N,message:"Max 50 characters"}],children:(0,t.jsx)(P.Z,{})}),(0,t.jsx)(z.Z.Item,{label:"Last name",name:"lastname",rules:[{max:N,message:"Max 50 characters"}],children:(0,t.jsx)(P.Z,{})}),(0,t.jsx)(k.Xq,{error:m}),(0,t.jsx)(z.Z.Item,(0,ne.Z)((0,U.Z)({},{wrapperCol:{offset:4}}),{children:(0,t.jsx)(J.Z,{loading:d,type:"primary",htmlType:"submit",children:"Save changes"})}))]}))})]})})},on=r(51986),un="Unable to check the password",cn="Unable to update the password",ln="Password and confirmation mismatch",dn="Current password not valid",pn=function(){var e=(0,a.Z)(o().mark((function e(n,r){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,Ye.Z.check({email:n.email,password:r.password});case 4:t=e.sent,e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(1),new Be.H({title:un,err:e.t0});case 10:if(t.valid){e.next=12;break}throw new Be.H({title:dn});case 12:return e.prev=12,e.next=15,Ye.Z.update([{type:"crypt",key:"password",value:r.newPassword}]);case 15:(0,k.Ur)("Your password has been changed successfully"),e.next=21;break;case 18:throw e.prev=18,e.t1=e.catch(12),new Be.H({title:cn,err:e.t1});case 21:case"end":return e.stop()}}),e,null,[[1,7],[12,18]])})));return function(n,r){return e.apply(this,arguments)}}(),fn=function(e){var n=e.user,r=(0,c.useState)(!1),i=r[0],s=r[1],u=(0,c.useState)(),l=u[0],d=u[1];return(0,t.jsx)(ie.Z,{title:"Your Password",children:(0,t.jsxs)(z.Z,(0,ne.Z)((0,U.Z)({},{labelCol:{offset:2},wrapperCol:{offset:2}}),{className:"max-width-500",layout:"vertical",onFinish:function(){var e=(0,a.Z)(o().mark((function e(r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,e.next=4,pn(n,r);case 4:d(null),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),d(e.t0);case 10:return e.prev=10,s(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[1,7,10,13]])})));return function(n){return e.apply(this,arguments)}}(),name:"passwordForm",children:[(0,t.jsx)(z.Z.Item,{label:"Current password",name:"password",rules:[{required:!0,message:"Current password is required"}],children:(0,t.jsx)(P.Z.Password,{placeholder:"Current password"})}),(0,t.jsx)(on.o,{name:"newPassword",label:"New password",inputPlaceholder:"Enter a new password",required:!0}),(0,t.jsx)(z.Z.Item,{label:"Password confirmation",name:"passwordConfirm",rules:[{required:!0,message:"Password confirmation is required"},function(e){var n=e.getFieldValue;return{validator:function(e,r){return r&&n("newPassword")!==r?Promise.reject(ln):Promise.resolve()}}}],children:(0,t.jsx)(P.Z.Password,{placeholder:"Confirm your new password"})}),(0,t.jsx)(k.Xq,{error:l}),(0,t.jsx)(z.Z.Item,{children:(0,t.jsx)(H.Z,{children:(0,t.jsx)(J.Z,{type:"primary",htmlType:"submit",loading:i,children:"Modify password"})})})]}))})},mn=j()()?"http://localhost:3000":"",hn=function(){var e=(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(mn+"/api/logout");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),vn="Unable to delete the user",xn=function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ye.Z.del();case 3:return e.next=5,hn();case 5:n.clearUser(),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),(0,k.lt)(vn,e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n){return e.apply(this,arguments)}}(),gn=function(e){var n=e.swr,r=(0,c.useState)(!1),i=r[0],s=r[1];return(0,t.jsx)(ie.Z,{title:"Delete your account",children:(0,t.jsx)(Y.m1,{title:"Delete your account",text:"This action cannot be undone. If you delete your account, you will permanently lose your workspaces and projects.",bordered:!0,loading:i,onDelete:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,e.next=4,xn(n);case 4:return e.prev=4,s(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])}))),children:"Delete your account"})})},wn=r(11382),jn=r(4687),Zn=r(45697),kn=r.n(Zn),yn=r(34041),bn=r(24443),On="Unable to update plugins",zn=function(){var e=(0,a.Z)(o().mark((function e(n,r,t,a){var i,s,u,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!r){e.next=11;break}return s=V.Z.deepCopy(n),Object.keys(t).forEach((function(e){s.configuration[e].value=t[e]})),s.needReInit=!0,e.next=8,bn.Z.update(s);case 8:null===(i=a.mutateOnePlugin)||void 0===i||i.call(a,s),e.next=17;break;case 11:return c=V.Z.deepCopy(n),Object.keys(t).forEach((function(e){c.configuration[e].value=t[e]})),e.next=16,bn.Z.add(c);case 16:null===(u=a.addOnePlugin)||void 0===u||u.call(a,c);case 17:e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(0),(0,k.lt)(On,e.t0),e.t0;case 23:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(n,r,t,a){return e.apply(this,arguments)}}(),Pn=function(e){var n=e.plugin,r=e.swr,i=e.edit,s=(0,c.useState)(!1),u=s[0],l=s[1],d=(0,c.useState)(!1),p=d[0],f=d[1],m=(0,c.useState)({}),h=m[0],v=m[1];return(0,c.useEffect)((function(){var e={};Object.keys(n.configuration).forEach((function(r){var t;e[r]=null!==(t=n.configuration[r].value)&&void 0!==t?t:n.configuration[r].default})),v(e)}),[null===n||void 0===n?void 0:n.configuration]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.ZP,{title:n.name,visible:u,initialValues:h,onCancel:function(){return l(!1)},onOk:function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.prev=1,e.next=4,zn(n,!!i,t,r);case 4:f(!1),l(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),f(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),loading:p,children:Object.keys(n.configuration).map((function(e){var r=n.configuration[e];return"input"===r.type?function(e,n){return(0,t.jsx)(z.Z.Item,{name:n,label:e.label,htmlFor:"input-"+n,tooltip:e.tooltip,rules:e.rules,children:(0,t.jsx)(P.Z,(0,U.Z)({id:"input-"+n,autoComplete:"off"},e.props||{}))},e.label)}(r,e):"textarea"===r.type?function(e,n){return(0,t.jsx)(z.Z.Item,{name:n,label:e.label,htmlFor:"input-"+n,tooltip:e.tooltip,rules:e.rules,children:(0,t.jsx)(P.Z.TextArea,(0,U.Z)({id:"input-"+n,autoComplete:"off"},e.props||{}))},e.label)}(r,e):"password"===r.type?function(e,n){return(0,t.jsx)(z.Z.Item,{name:n,label:e.label,htmlFor:"input-"+n,tooltip:e.tooltip,rules:e.rules,children:(0,t.jsx)(P.Z,(0,U.Z)({id:"input-"+n,type:"password",autoComplete:"off"},e.props||{}))},e.label)}(r,e):"select"===r.type?function(e,n){return(0,t.jsx)(z.Z.Item,{name:n,label:e.label,htmlFor:"select-"+n,tooltip:e.tooltip,rules:e.rules,children:(0,t.jsx)(yn.Z,{id:"select-"+n,children:e.options.map((function(n){return(0,t.jsx)(yn.Z.Option,(0,ne.Z)((0,U.Z)({value:n},e.props||{}),{children:n}),n)}))})},e.label)}(r,e):(0,t.jsx)(t.Fragment,{})}))}),i?(0,t.jsx)(Y.w6,{onEdit:function(){return l(!0)},children:"Edit"}):(0,t.jsxs)(Y.HS,{onAdd:function(){return l(!0)},children:["Add a new \xab",n.name,"\xbb configuration"]})]})};Pn.propTypes={plugin:kn().exact({uuid:kn().string,key:kn().string.isRequired,name:kn().string.isRequired,needInit:kn().bool,configuration:kn().object.isRequired,inUseConfiguration:kn().object}).isRequired,swr:kn().exact({addOnePlugin:kn().func,mutateOnePlugin:kn().func}).isRequired,edit:kn().bool};var Cn=Pn,Sn="Unable to delete plugin",Nn=function(){var e=(0,a.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,bn.Z.del({uuid:n.uuid});case 3:r.delOnePlugin(n),e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),(0,k.lt)(Sn,e.t0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n,r){return e.apply(this,arguments)}}(),Tn=function(e){var n,r=e.plugin,i=e.swr,s=(0,c.useState)(!1),u=s[0],l=s[1];return(0,t.jsx)(Y.m1,{loading:u,title:"Delete plugin",text:(0,t.jsxs)(t.Fragment,{children:["Are you sure you want to delete the plugin"," ",(0,t.jsx)(p.Z.Text,{strong:!0,children:null===(n=r.configuration.name)||void 0===n?void 0:n.value}),"?"]}),onDelete:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.prev=1,e.next=4,Nn(r,i);case 4:return e.prev=4,l(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])}))),children:"Delete"})};Tn.propTypes={plugin:kn().exact({uuid:kn().string.isRequired,configuration:kn().object.isRequired}).isRequired,swr:kn().exact({delOnePlugin:kn().func.isRequired}).isRequired};var Un=Tn,En=function(e){var n=e.plugin,r=e.plugins,a=e.swr,i=(0,c.useState)([]),s=i[0],o=i[1];return(0,c.useEffect)((function(){var e=r.map((function(e){var r;if(e.key===n.key){var i=e.configuration,s=Object.keys(i).map((function(e){if("name"!==e){var n;if("textarea"===i[e].type){var r=i[e].value;n=(0,t.jsx)(p.Z.Paragraph,{children:(0,t.jsx)("pre",{children:(0,t.jsx)("code",{children:r})})})}else n="password"===i[e].type?(0,t.jsx)(p.Z.Text,{children:"******"}):(0,t.jsx)(p.Z.Text,{children:i[e].value});return(0,t.jsxs)(p.Z.Paragraph,{children:[(0,t.jsxs)(p.Z.Text,{strong:!0,children:[i[e].label,":"]})," ",n]},e)}})).filter((function(e){return e}));return(0,t.jsx)(ie.Z,{title:null===(r=i.name)||void 0===r?void 0:r.value,actions:[(0,t.jsx)(Un,{plugin:{uuid:e.uuid,configuration:e.configuration},swr:{delOnePlugin:a.delOnePlugin}},"delete"),(0,t.jsx)(Cn,{plugin:{uuid:e.uuid,key:e.key,name:e.name,needInit:e.needInit,configuration:e.configuration,inUseConfiguration:e.inUseConfiguration},swr:{mutateOnePlugin:a.mutateOnePlugin},edit:!0},"plugin")],children:s.length?s:(0,t.jsx)(p.Z.Text,{children:"No configuration data"})},e.uuid)}})).filter((function(e){return e}));o(e)}),[n,r,a]),(0,t.jsx)(H.Z,{direction:"horizontal",wrap:!0,size:20,children:s})};En.propTypes={plugin:kn().exact({key:kn().string.isRequired}).isRequired,plugins:kn().arrayOf(kn().exact({key:kn().string.isRequired,uuid:kn().string.isRequired,name:kn().string.isRequired,configuration:kn().object.isRequired,inUseConfiguration:kn().object,data:kn().object,needInit:kn().bool,needReInit:kn().bool}).isRequired).isRequired,swr:kn().exact({delOnePlugin:kn().func.isRequired,mutateOnePlugin:kn().func.isRequired}).isRequired};var qn=En,In="Plugins error",Rn=function(e){var n=e.plugin,r=(0,i.Z)(bn.Z.usePlugins(),2),a=r[0],s=r[1],o=s.addOnePlugin,u=s.delOnePlugin,l=s.mutateOnePlugin,d=s.errorPlugins,p=s.loadingPlugins;return(0,c.useEffect)((function(){d&&(0,k.lt)(In,d)}),[d]),p?(0,t.jsx)(wn.Z,{}):(0,t.jsxs)(H.Z,{direction:"vertical",className:"full-width",children:[(0,t.jsx)(Cn,{plugin:{uuid:n.uuid,key:n.key,name:n.name,needInit:n.needInit,configuration:n.configuration,inUseConfiguration:n.inUseConfiguration},swr:{addOnePlugin:o}}),(0,t.jsx)(qn,{plugin:{key:n.key},plugins:a,swr:{delOnePlugin:u,mutateOnePlugin:l}})]})};Rn.propTypes={plugin:kn().exact({key:kn().string.isRequired,name:kn().string.isRequired,needInit:kn().bool,configuration:kn().object.isRequired,inUseConfiguration:kn().object}).isRequired};var An=Rn,Dn="Unable to load plugins",Wn=function(){var e=(0,a.Z)(o().mark((function e(){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,jn.Z.list();case 3:if(n=e.sent,!(r=n.filter((function(e){return"HPC"===e.category}))).length){e.next=9;break}return e.abrupt("return",r.map((function(e){return(0,t.jsx)(ie.Z,{title:e.name,children:(0,t.jsx)(An,{plugin:{key:e.key,name:e.name,needInit:!!e.needInit,configuration:e.configuration,inUseConfiguration:e.inUseConfiguration}})},e.key)})));case 9:return e.abrupt("return",[(0,t.jsx)(ie.Z,{title:"No access",children:"You do not have access to any HPC plugin. Request it."},"no-access")]);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(0),(0,k.lt)(Dn,e.t0),e.abrupt("return",[(0,t.jsx)(ie.Z,{title:"Error",children:"Something led to an error. Please try again later."},"error")]);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),Fn=function(){var e=(0,c.useState)([(0,t.jsx)(ie.Z,{title:"Loading",children:(0,t.jsx)(wn.Z,{})},"loading")]),n=e[0],r=e[1];return(0,c.useEffect)((function(){Wn().then(r)}),[]),(0,t.jsx)(H.Z,{direction:"vertical",className:"full-width scroll",size:20,children:n})},Hn=function(e){var n=e.user,r=e.swr,a=(0,u.useRouter)(),i=a.query.tab;return(0,t.jsxs)(l.Z,{className:"inDashboard Account no-scroll",children:[(0,t.jsx)(b.Z,{className:"inDashboard-PageHeader",backIcon:!1,title:(0,t.jsx)(p.Z.Title,{level:2,className:"inDashboard-PageHeader-title",children:"Account Settings"}),footer:(0,t.jsx)(O.Z,{})}),(0,t.jsx)(l.Z.Content,{className:"no-scroll",children:(0,t.jsxs)(C.Z,{className:"inDashboard-Tabs no-scroll",type:"card",defaultActiveKey:i||"personal",onChange:function(e){return function(e,n){e.replace({pathname:"/dashboard",query:{page:"account",tab:n}})}(a,e)},children:[(0,t.jsx)(C.Z.TabPane,{tab:"Personal Information",children:(0,t.jsxs)(H.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(sn,{user:{email:n.email,firstname:n.firstname,lastname:n.lastname,avatar:n.avatar},swr:{mutateUser:r.mutateUser}}),(0,t.jsx)(gn,{swr:{clearUser:r.clearUser}})]})},"personal"),!j()()&&(0,t.jsx)(C.Z.TabPane,{tab:"Security",children:(0,t.jsx)(H.Z,{direction:"vertical",className:"full-width",size:20,children:(0,t.jsx)(fn,{user:{email:n.email}})})},"security"),(0,t.jsx)(C.Z.TabPane,{className:"no-scroll",tab:"HPC Providers",children:(0,t.jsx)(Fn,{})},"hpc")]})})]})},Ln=r(82826),Gn=function(){var e=(0,a.Z)(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.R)("/api/organization",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(n)});case 2:return r=e.sent,e.abrupt("return",r.json());case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),_n=function(){var e=(0,a.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.R)("/api/organization",{method:"PUT",body:JSON.stringify({organization:n,data:r})});case 2:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),Mn=function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.R)("/api/organization",{method:"DELETE",body:JSON.stringify(n)});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Jn=function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.R)("/api/organization/"+n.id,{method:"PUT"});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Bn=function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.R)("/api/organization/"+n.id,{method:"POST"});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Yn=function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.R)("/api/organization/"+n.id,{method:"DELETE"});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Vn={useOrganizations:function(){var e=(0,q.ZP)("/api/organizations",I._),n=e.data,r=e.error,t=e.mutate,a=!n,i=(null===n||void 0===n?void 0:n.organizations)||[],s=(0,c.useCallback)((function(e){var n=(0,E.Z)(i).concat([(0,ne.Z)((0,U.Z)({},e),{pendingowners:[],users:[],pendingusers:[],groups:[]})]);t({organizations:n})}),[i,t]),o=(0,c.useCallback)((function(e){var n=i.filter((function(n){return n.id!==e.id}));t({organizations:n})}),[i,t]),u=(0,c.useCallback)((function(e){var n=i.map((function(n){return n.id===e.id&&(n=(0,U.Z)({},n,e)),n}));t({organizations:n})}),[i,t]);return[i,{addOneOrganization:s,delOneOrganization:o,mutateOneOrganization:u,errorOrganizations:r,loadingOrganizations:a}]},add:Gn,update:_n,del:Mn,accept:Jn,decline:Bn,quit:Yn},Xn=Vn,Kn=r(25025),Qn="Unable to add user",$n="This user already exists or its invite is pending",er=function(e,n){var r,t,a,i,s=null===(r=n.owners)||void 0===r?void 0:r.find((function(n){return n.email===e.email})),o=null===(t=n.pendingowners)||void 0===t?void 0:t.find((function(n){return n.email===e.email})),u=null===(a=n.users)||void 0===a?void 0:a.find((function(n){return n.email===e.email})),c=null===(i=n.pendingusers)||void 0===i?void 0:i.find((function(n){return n.email===e.email}));return s||o||u||c},nr=function(){var e=(0,a.Z)(o().mark((function e(n,r,t,a){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!er(t,n)){e.next=4;break}throw(0,k.lt)($n),new Error($n);case 4:return e.prev=4,e.next=7,Xn.update(n,[{key:r,type:"array",method:"append",value:t.email.trim()}]);case 7:(i=V.Z.deepCopy(n))[r]=(0,E.Z)(i[r]).concat([{email:t.email}]),a.mutateOneOrganization(i),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(4),(0,k.lt)(Qn,e.t0),e.t0;case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(n,r,t,a){return e.apply(this,arguments)}}(),rr=function(e){var n=e.title,r=e.organization,i=e.dBkey,s=e.swr,u=(0,c.useState)(!1),l=u[0],d=u[1],p=(0,c.useState)(!1),f=p[0],m=p[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.ZP,{visible:l,loading:f,title:n,onCancel:function(){return d(!1)},onOk:function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.prev=1,e.next=4,nr(r,i,n,s);case 4:m(!1),d(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),m(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),children:(0,t.jsx)(z.Z.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Email is required"}],children:(0,t.jsx)(P.Z,{})})}),(0,t.jsx)(Y.HS,{onAdd:function(){return d(!0)},children:n})]})},tr="Unable to delete user",ar=function(){var e=(0,a.Z)(o().mark((function e(n,r,t,a){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xn.update(n,[{key:t,type:"array",method:"remove",value:r.id}]);case 3:(i=V.Z.deepCopy(n))[t]=i[t].filter((function(e){return e.id!==r.id})),a.mutateOneOrganization(i),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),(0,k.lt)(tr,e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,r,t,a){return e.apply(this,arguments)}}(),ir=function(e){var n=e.disabled,r=e.user,i=e.organization,s=e.dBkey,u=e.swr,l=(0,c.useState)(!1),d=l[0],f=l[1],m=(0,c.useCallback)((function(e){return e.firstname||e.lastname?e.firstname+" "+e.lastname:e.email}),[]);return(0,t.jsx)(Y.m1,{bordered:!0,disabled:n,title:"Delete organization",text:(0,t.jsxs)(t.Fragment,{children:["Are you sure you want to delete the user"," ",(0,t.jsx)(p.Z.Text,{strong:!0,children:m(r)}),"?"]}),loading:d,onDelete:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.prev=1,e.next=4,ar(i,r,s,u);case 4:return e.prev=4,f(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])})))})},sr=function(e){var n,r,a,i=e.organization,s=e.swr,o=(0,c.useState)(),u=o[0],l=o[1],d=(0,c.useState)(),p=d[0],f=d[1],m=(0,c.useRef)(null),h=(0,c.useRef)(null),v=(0,c.useRef)(null),x=[{key:"avatar",dataIndex:"avatar",render:function(e,n){return V.Z.userToAvatar(n)}},{key:"lastname",title:"Lastname",dataIndex:"lastname"},{key:"firstname",title:"Firstname",dataIndex:"firstname"},{key:"email",title:"Email",dataIndex:"email"}],g=(0,E.Z)(x).concat([{key:"actions",title:"Actions",align:"center",fixed:"right",width:75,render:function(e){return(0,t.jsx)(ir,{disabled:i.owners.length<2&&!e.pending,user:{id:e.id,email:e.email},organization:{id:i.id,owners:i.owners,pendingowners:i.pendingowners,users:i.users,pendingusers:i.pendingusers},dBkey:e.pending?"pendingowners":"owners",swr:{mutateOneOrganization:s.mutateOneOrganization}})}}]),w=(0,E.Z)(x).concat([{key:"actions",title:"Actions",align:"center",fixed:"right",width:75,render:function(e){return(0,t.jsx)(ir,{user:{id:e.id,email:e.email,firstname:e.firstname,lastname:e.lastname},organization:{id:i.id,owners:i.owners,pendingowners:i.pendingowners,users:i.users,pendingusers:i.pendingusers},dBkey:e.pending?"pendingusers":"users",swr:{mutateOneOrganization:s.mutateOneOrganization}})}}]),j=(0,c.useCallback)((function(){var e=m.current;if(e){var n=(e.clientHeight-15)/2-39-12-32-20-75,r=e.clientHeight,t=e.clientHeight;l(r>n?{y:n}:void 0),f(t>n?{y:n}:void 0)}}),[]);return(0,c.useEffect)((function(){return window.addEventListener("resize",j),function(){window.removeEventListener("resize",j)}}),[j]),(0,c.useEffect)((function(){j()}),[i,j]),(0,t.jsx)("div",{ref:m,style:{height:"calc(100vh - 228px)"},children:(0,t.jsxs)(H.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(ie.Z,{title:"Administrators",size:"small",children:(0,t.jsxs)(H.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(rr,{title:"New administrator",organization:{id:i.id,owners:i.owners,pendingowners:i.pendingowners,pendingusers:i.pendingusers,users:i.users},dBkey:"owners",swr:{mutateOneOrganization:s.mutateOneOrganization}}),(0,t.jsx)(Kn.Z,{loading:s.loadingOrganizations,pagination:!1,size:"small",columns:g,dataSource:(0,E.Z)(i.owners.map((function(e){return(0,ne.Z)((0,U.Z)({},e),{key:e.id})}))).concat((0,E.Z)(null===(n=i.pendingowners)||void 0===n?void 0:n.map((function(e){return(0,ne.Z)((0,U.Z)({},e),{pending:!0,key:e.id})})))),scroll:{y:null===u||void 0===u?void 0:u.y},ref:h})]})}),(0,t.jsx)(ie.Z,{title:"Users",size:"small",children:(0,t.jsxs)(H.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(rr,{title:"New user",organization:{id:i.id,owners:i.owners,pendingowners:i.pendingowners,pendingusers:i.pendingusers,users:i.users},dBkey:"users",swr:{mutateOneOrganization:s.mutateOneOrganization}}),(0,t.jsx)(Kn.Z,{loading:null===s||void 0===s?void 0:s.loadingOrganizations,pagination:!1,size:"small",columns:w,dataSource:(0,E.Z)(null===(r=i.users)||void 0===r?void 0:r.map((function(e){return(0,ne.Z)((0,U.Z)({},e),{key:e.id})}))).concat((0,E.Z)(null===(a=i.pendingusers)||void 0===a?void 0:a.map((function(e){return(0,ne.Z)((0,U.Z)({},e),{pending:!0,key:e.id})})))),scroll:{y:null===p||void 0===p?void 0:p.y},ref:v})]})})]})})},or=function(){var e=(0,a.Z)(o().mark((function e(n,r){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.R)("/api/group",{method:"POST",body:JSON.stringify({organization:n,group:r})});case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),ur=function(){var e=(0,a.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.R)("/api/group",{method:"PUT",body:JSON.stringify({group:n,data:r})});case 2:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),cr=function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.R)("/api/group",{method:"DELETE",body:JSON.stringify(n)});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),lr={useGroups:function(e){var n=(0,q.ZP)("/api/groups/"+e,I._),r=n.data,t=n.error,a=n.mutate,i=!r,s=(null===r||void 0===r?void 0:r.groups)||[],o=(0,c.useCallback)((function(e){var n=(0,E.Z)(s).concat([e]);a({groups:n})}),[s,a]),u=(0,c.useCallback)((function(e){var n=s.filter((function(n){return n.id!==e.id}));a({groups:n})}),[s,a]),l=(0,c.useCallback)((function(e){var n=s.map((function(n){return n.id===e.id&&(n=(0,U.Z)({},n,e)),n}));a({groups:n})}),[s,a]);return[s,{addOneGroup:o,delOneGroup:u,mutateOneGroup:l,errorGroups:t,loadingGroups:i}]},add:or,update:ur,del:cr},dr=lr,pr="Unable to delete group",fr=function(){var e=(0,a.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,dr.del({id:n.id});case 3:r.delOneGroup({id:n.id}),e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),(0,k.lt)(pr,e.t0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n,r){return e.apply(this,arguments)}}(),mr=function(e){var n=e.group,r=e.swr,i=(0,c.useState)(!1),s=i[0],u=i[1];return(0,t.jsx)(Y.m1,{bordered:!0,title:"Delete group",text:(0,t.jsxs)(t.Fragment,{children:["Are you sure you want to delete the group"," ",(0,t.jsx)(p.Z.Text,{strong:!0,children:n.name}),"?"]}),loading:s,onDelete:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,fr(n,r);case 4:return e.prev=4,u(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])})))})},hr="Unable to add group",vr="Unable to update group",xr=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,dr.add({id:n.id},{name:r.name,users:r.users});case 3:a=e.sent,t.addOneGroup((0,ne.Z)((0,U.Z)({},a),{name:r.name,users:r.users})),t.mutateOneOrganization({id:n.id,groups:(0,E.Z)(n.groups).concat([a])}),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),(0,k.lt)(hr,e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,r,t){return e.apply(this,arguments)}}(),gr=function(){var e=(0,a.Z)(o().mark((function e(n,r,t,a){var i,s,u,c,l,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l=[],r.name!==t.name&&l.push({key:"name",value:t.name}),(null===(i=r.users)||void 0===i?void 0:i.map((function(e){return e.id})).toString())!==t.users.toString()&&l.push({key:"users",value:t.users}),l.length){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,dr.update({id:r.id},l);case 9:a.mutateOneGroup((0,U.Z)({},r,t)),d=null===(s=n.groups)||void 0===s?void 0:s.findIndex((function(e){return e.id===r.id})),a.mutateOneOrganization({id:n.id,groups:(0,E.Z)(null===(u=n.groups)||void 0===u?void 0:u.slice(0,d)).concat([r],(0,E.Z)(null===(c=n.groups)||void 0===c?void 0:c.slice(d+1)))}),e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(0),(0,k.lt)(vr,e.t0),e.t0;case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(n,r,t,a){return e.apply(this,arguments)}}(),wr=function(e){var n,r=e.userOptions,i=e.organization,s=e.group,u=e.swr,l=(0,c.useState)(!1),d=l[0],p=l[1],f=(0,c.useState)(!1),m=f[0],h=f[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(T.ZP,{title:s?"Edit group":"New group",visible:d,initialValues:s&&{name:s.name,users:null===(n=s.users)||void 0===n?void 0:n.map((function(e){return e.id}))},onCancel:function(){return p(!1)},onOk:function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h(!0),e.prev=1,!s){e.next=7;break}return e.next=5,gr(i,s,n,{mutateOneOrganization:u.mutateOneOrganization,mutateOneGroup:u.mutateOneGroup});case 5:e.next=9;break;case 7:return e.next=9,xr(i,n,{mutateOneOrganization:u.mutateOneOrganization,addOneGroup:u.addOneGroup});case 9:h(!1),p(!1),e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(1),h(!1),e.t0;case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(n){return e.apply(this,arguments)}}(),loading:m,children:[(0,t.jsx)(z.Z.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Name is requried"}],children:(0,t.jsx)(P.Z,{})}),(0,t.jsx)(z.Z.Item,{name:"users",label:"Users",rules:[{required:!0,message:"Users selection is required"}],children:(0,t.jsx)(yn.Z,{mode:"multiple",placeholder:"Select users",options:r})})]}),s?(0,t.jsx)(Y.w6,{bordered:!0,onEdit:function(){return p(!0)},children:"Edit"}):(0,t.jsx)(Y.HS,{onAdd:function(){return p(!0)},children:"New group"})]})},jr="Groups error",Zr=function(e){var n=e.organization,r=e.swr,a=(0,c.useState)([]),s=a[0],o=a[1],u=(0,c.useState)(null),l=u[0],d=u[1],p=(0,c.useRef)(null),f=(0,i.Z)(dr.useGroups(n.id),2),m=f[0],h=f[1],v=h.addOneGroup,x=h.mutateOneGroup,g=h.delOneGroup,w=h.errorGroups,j=h.loadingGroups;(0,c.useEffect)((function(){var e=n.owners,r=null===n||void 0===n?void 0:n.users,t=(0,E.Z)(e).concat((0,E.Z)(r)).map((function(e){return{label:e.firstname||e.lastname?e.firstname+" "+e.lastname:e.email,value:e.id}}));o(t)}),[n]),(0,c.useEffect)((function(){w&&(0,k.lt)(jr,w)}),[w]);var Z=[{title:"Group name",dataIndex:"name",key:"name"},{title:"Users",dataIndex:"users",key:"users",render:function(e){return(0,t.jsx)(L.C.Group,{maxCount:5,children:e.map((function(e){return V.Z.userToAvatar(e)}))})}},{title:"Actions",key:"actions",render:function(e,a){return(0,t.jsxs)(H.Z,{children:[(0,t.jsx)(wr,{userOptions:s,organization:{id:n.id,groups:n.groups},group:{id:a.id,name:a.name,users:a.users},swr:{mutateOneOrganization:r.mutateOneOrganization,mutateOneGroup:x}}),(0,t.jsx)(mr,{group:{id:a.id,name:a.name},swr:{delOneGroup:g}})]})}}],y=(0,c.useCallback)((function(){var e=p.current;e&&(e.clientHeight>window.innerHeight-e.offsetTop-59?d({y:window.innerHeight-e.offsetTop-59}):d(null))}),[]);return(0,c.useEffect)((function(){return window.addEventListener("resize",y),function(){window.removeEventListener("resize",y)}}),[y]),(0,c.useEffect)((function(){y()}),[m,y]),(0,t.jsxs)(H.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(wr,{userOptions:s,organization:{id:n.id,groups:n.groups},swr:{mutateOneOrganization:r.mutateOneOrganization,addOneGroup:v}}),(0,t.jsx)(Kn.Z,{loading:j,pagination:!1,size:"small",columns:Z,dataSource:m.map((function(e){return(0,U.Z)({key:e.id},e)})),scroll:{y:null===l||void 0===l?void 0:l.y},ref:p})]})},kr="Unable to update organization's name",yr=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xn.update(n,[{key:"name",value:r}]);case 3:t.mutateOneOrganization((0,ne.Z)((0,U.Z)({},n),{name:r})),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),(0,k.lt)(kr,e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n,r,t){return e.apply(this,arguments)}}(),br=function(e){var n=e.organization,r=e.swr,i=e.onClose;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"display-flex",children:[(0,t.jsx)(J.Z,{className:"marginRight-20",icon:(0,t.jsx)(Ln.Z,{}),onClick:function(){return i()}}),(0,t.jsx)(p.Z.Title,{level:3,editable:{onChange:function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",yr(n,t,{mutateOneOrganization:r.mutateOneOrganization}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},children:n.name})]}),(0,t.jsxs)(C.Z,{children:[(0,t.jsx)(C.Z.TabPane,{tab:"Users",children:(0,t.jsx)(sr,{organization:{id:n.id,owners:n.owners,pendingowners:n.pendingowners,users:n.users,pendingusers:n.pendingusers},swr:{mutateOneOrganization:r.mutateOneOrganization,loadingOrganizations:r.loadingOrganizations}})},"users"),(0,t.jsx)(C.Z.TabPane,{tab:"Groups",children:(0,t.jsx)(Zr,{organization:{id:n.id,owners:n.owners,users:n.users,groups:n.groups},swr:{mutateOneOrganization:r.mutateOneOrganization}})},"groups")]})]})},Or="Unable to add organization",zr=function(){var e=(0,a.Z)(o().mark((function e(n,r){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xn.add({name:n.name});case 3:(t=e.sent).name=n.name,r.addOneOrganization(t),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),(0,k.lt)(Or,e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,r){return e.apply(this,arguments)}}(),Pr=function(e){var n=e.swr,r=(0,c.useState)(!1),i=r[0],s=r[1],u=(0,c.useState)(!1),l=u[0],d=u[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.ZP,{title:"New organization",visible:i,onCancel:function(){return s(!1)},onOk:function(){var e=(0,a.Z)(o().mark((function e(r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,zr(r,n);case 4:d(!1),s(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),d(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),loading:l,children:(0,t.jsx)(z.Z.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Name is required"}],children:(0,t.jsx)(P.Z,{})})}),(0,t.jsx)(Y.HS,{onAdd:function(){return s(!0)},children:"New organization"})]})},Cr=r(75768),Sr=r(8751),Nr=r(18429),Tr="Unable to delete the organization",Ur=function(){var e=(0,a.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xn.del({id:n.id});case 3:r.delOneOrganization({id:n.id}),e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),(0,k.lt)(Tr,e.t0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n,r){return e.apply(this,arguments)}}(),Er=function(e){var n=e.organization,r=e.swr,i=(0,c.useState)(!1),s=i[0],u=i[1];return(0,t.jsx)(Y.m1,{bordered:!0,title:"Delete organization",text:(0,t.jsxs)(t.Fragment,{children:["Are you sure you want to delete the organization"," ",(0,t.jsx)(p.Z.Text,{strong:!0,children:n.name}),"?"]}),onDelete:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,Ur(n,r);case 4:return e.prev=4,u(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])}))),loading:s})},qr="Unable to quit organization",Ir="Unable to accept invitation",Rr="Unable to decline invitation",Ar=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){var a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xn.quit({id:n.id});case 3:a=V.Z.deepCopy(n),i=a.users.findIndex((function(e){return e.id===r.id})),a.users.splice(i,1),t.mutateOneOrganization(a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,k.lt)(qr,e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n,r,t){return e.apply(this,arguments)}}(),Dr=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){var a,i,s,u,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xn.accept(n);case 3:a=V.Z.deepCopy(n),i=a.pendingowners.findIndex((function(e){return e.id===r.id})),s=a.pendingowners[i],-1!==i?(a.pendingowners.splice(i,1),a.owners.push(s)):(u=a.pendingusers.findIndex((function(e){return e.id===r.id})),c=a.pendingusers[u],a.pendingusers.splice(u,1),a.users.push(c)),t.mutateOneOrganization(a),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,k.lt)(Ir,e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(n,r,t){return e.apply(this,arguments)}}(),Wr=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){var a,i,s,u,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=4,Xn.decline({id:n.id});case 4:i=V.Z.deepCopy(n),-1!==(s=null===(a=i.pendingowners)||void 0===a?void 0:a.findIndex((function(e){return e.id===r.id})))?i.pendingowners.splice(s,1):(c=null===(u=i.pendingusers)||void 0===u?void 0:u.findIndex((function(e){return e.id===r.id})),i.pendingusers.splice(c,1)),t.mutateOneOrganization(i),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,k.lt)(Rr,e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(n,r,t){return e.apply(this,arguments)}}(),Fr=function(e){var n,r=e.user,i=e.organizations,s=e.swr,u=e.setOrganization,l=(0,c.useState)(null),d=l[0],p=l[1],f=(0,c.useRef)(null),m=[{title:"Name",dataIndex:"name",key:"name",sorter:function(e,n){var r=e.name||"",t=n.name||"";return r.localeCompare(t)}},{title:"Administrators",dataIndex:"owners",key:"owners",render:function(e){return(0,t.jsx)(L.C.Group,{maxCount:5,children:null===e||void 0===e?void 0:e.map((function(e){return V.Z.userToAvatar(e)}))})}},{title:"Users",dataIndex:"users",key:"users",render:function(e){return(0,t.jsx)(L.C.Group,{maxCount:5,children:null===e||void 0===e?void 0:e.map((function(e){return V.Z.userToAvatar(e)}))})}},{title:"Groups",dataIndex:"groups",key:"groups",render:function(e){return(0,t.jsx)(L.C.Group,{maxCount:5,children:null===e||void 0===e?void 0:e.map((function(e){return V.Z.groupToAvatar(e)}))})}},{title:"Actions",key:"actions",render:function(e){return e.owners.find((function(e){return e.id===r.id}))?(0,t.jsxs)(H.Z,{wrap:!0,children:[(0,t.jsx)(J.Z,{icon:(0,t.jsx)(v.Z,{}),onClick:function(){return u(e)},children:"Manage"}),(0,t.jsx)(Er,{organization:{id:e.id,name:e.name},swr:{delOneOrganization:s.delOneOrganization}})]}):e.users.find((function(e){return e.id===r.id}))?(0,t.jsx)(H.Z,{wrap:!0,children:(0,t.jsx)(J.Z,{danger:!0,icon:(0,t.jsx)(Cr.Z,{}),onClick:function(){return Ar({id:e.id,users:e.users},{id:r.id},{mutateOneOrganization:s.mutateOneOrganization})},children:"Quit"})}):e.pendingowners.find((function(e){return e.id===r.id}))||e.pendingusers.find((function(e){return e.id===r.id}))?(0,t.jsxs)(H.Z,{wrap:!0,children:[(0,t.jsx)(J.Z,{type:"primary",icon:(0,t.jsx)(Sr.Z,{}),onClick:(0,a.Z)(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Dr({id:e.id,owners:e.owners,pendingowners:e.pendingowners,users:e.users,pendingusers:e.pendingusers},{id:r.id},{mutateOneOrganization:s.mutateOneOrganization}));case 1:case"end":return n.stop()}}),n)}))),children:"Accept invitation"}),(0,t.jsx)(J.Z,{danger:!0,icon:(0,t.jsx)(Nr.Z,{}),onClick:function(){return Wr({id:e.id,pendingowners:e.pendingowners,pendingusers:e.pendingusers},{id:r.id},{mutateOneOrganization:s.mutateOneOrganization})},children:"Decline"})]}):void 0}}],h=(0,c.useCallback)((function(){var e=f.current;e&&(e.clientHeight>window.innerHeight-e.offsetTop-59?p({y:window.innerHeight-e.offsetTop-59}):p(null))}),[]);return(0,c.useEffect)((function(){return window.addEventListener("resize",h),function(){window.removeEventListener("resize",h)}}),[h]),(0,c.useEffect)((function(){h()}),[i,h,null===(n=f.current)||void 0===n?void 0:n.offsetTop]),(0,t.jsx)(Kn.Z,{loading:s.loadingOrganizations,pagination:!1,size:"small",columns:m,dataSource:null===i||void 0===i?void 0:i.map((function(e){return{key:e.id,id:e.id,name:e.name,owners:e.owners,pendingowners:e.pendingowners,users:e.users,pendingusers:e.pendingusers,groups:e.groups}})),ref:f,scroll:{y:null===d||void 0===d?void 0:d.y}})},Hr=function(e){var n=e.user,r=e.organizations,a=e.swr,i=(0,c.useState)(),s=i[0],o=i[1],d=(0,u.useRouter)(),f=d.query.organizationId;return(0,c.useEffect)((function(){if(f){var e=r.find((function(e){return e.id===f}));o(e)}}),[f,r]),(0,c.useEffect)((function(){if(s){var e=r.find((function(e){return e.id===s.id}));JSON.stringify(e)!==JSON.stringify(s)&&o(e)}}),[r,s]),(0,t.jsxs)(l.Z,{className:"inDashboard Organization",children:[(0,t.jsx)(b.Z,{className:"inDashboard-PageHeader",backIcon:!1,title:(0,t.jsx)(p.Z.Title,{level:2,className:"inDashboard-PageHeader-title",children:"Organizations"}),footer:(0,t.jsx)(O.Z,{})}),(0,t.jsx)(l.Z.Content,{className:"no-scroll",children:s?(0,t.jsx)(br,{organization:{id:s.id,name:s.name,owners:s.owners,pendingowners:s.pendingowners,users:s.users,pendingusers:s.pendingusers,groups:s.groups},swr:{mutateOneOrganization:a.mutateOneOrganization,loadingOrganizations:a.loadingOrganizations},onClose:function(){d.push({pathname:"dashboard",query:{page:"organizations"}}),o(null)}}):(0,t.jsxs)(H.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(Pr,{swr:{addOneOrganization:a.addOneOrganization}}),(0,t.jsx)(Fr,{user:{id:n.id},organizations:r,swr:{mutateOneOrganization:a.mutateOneOrganization,delOneOrganization:a.delOneOrganization,loadingOrganizations:a.loadingOrganizations},setOrganization:function(e){d.push({pathname:"dashboard",query:{page:"organizations",organizationId:e.id}}),o(e)}})]})})]})},Lr=r(63922),Gr=r(10808),_r=r(63606),Mr=r(32808),Jr=r(36574),Br="Unable to add user",Yr=function(){var e=(0,a.Z)(o().mark((function e(n,r){var t,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ye.Z.add({email:n.email,password:n.password});case 3:if(!(t=e.sent).alreadyExists){e.next=6;break}throw new Error("User already exists");case 6:return e.next=8,Ye.Z.updateById(t.id,[{key:"firstname",value:n.firstname},{key:"lastname",value:n.lastname},{key:"authorizedplugins",value:n.authorizedplugins},{key:"superuser",value:!!n.superuser}]);case 8:a=(0,ne.Z)((0,U.Z)({},t),{email:n.email,firstname:n.firstname,lastname:n.firstname,superuser:n.superuser}),r.addOneUser(a),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(0),(0,k.lt)(Br,e.t0),e.t0;case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(n,r){return e.apply(this,arguments)}}(),Vr=function(e){var n=e.plugins,r=e.swr,s=(0,c.useState)(!1),u=s[0],l=s[1],d=(0,c.useState)(!1),p=d[0],f=d[1],m=(0,i.Z)(Jr.Z.useSystem(),1)[0];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(T.ZP,{title:"New user",visible:u,initialValues:m.defaultplugins&&{authorizedplugins:m.defaultplugins},onCancel:function(){return l(!1)},onOk:function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.prev=1,e.next=4,Yr(n,r);case 4:f(!1),l(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),f(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),loading:p,children:[(0,t.jsx)(z.Z.Item,{name:"firstname",label:"First name",children:(0,t.jsx)(P.Z,{})}),(0,t.jsx)(z.Z.Item,{name:"lastname",label:"Last name",children:(0,t.jsx)(P.Z,{})}),(0,t.jsx)(z.Z.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Email is required"}],children:(0,t.jsx)(P.Z,{})}),(0,t.jsx)(on.o,{name:"password"}),(0,t.jsx)(z.Z.Item,{name:"authorizedplugins",label:"Plugins",children:(0,t.jsx)(yn.Z,{mode:"multiple",options:n.map((function(e){return{label:e.name,value:e.key}}))})}),(0,t.jsx)(z.Z.Item,{name:"superuser",label:"Administrator",valuePropName:"checked",children:(0,t.jsx)(Mr.Z,{})})]}),(0,t.jsx)(Y.HS,{onAdd:function(){return l(!0)},children:"New user"})]})};Vr.propTypes={plugins:kn().arrayOf(kn().exact({key:kn().string.isRequired,name:kn().string.isRequired})).isRequired,swr:kn().exact({addOneUser:kn().func.isRequired}).isRequired};var Xr=Vr,Kr="Unable to update user",Qr=function(){var e=(0,a.Z)(o().mark((function e(n,r,t){var a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(a=Object.keys(r).map((function(e){var t=r[e];if(void 0!==t&&"******"!==t&&t!==n[e])return{key:e,value:t,type:"password"===e&&"crypt"}})).filter((function(e){return e}))).length){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,Ye.Z.updateById(n.id,a);case 6:r.password="******",i=(0,U.Z)({},n,r),t.mutateOneUser(i),e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(0),(0,k.lt)(Kr,e.t0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(n,r,t){return e.apply(this,arguments)}}(),$r=function(e){var n=e.plugins,r=e.user,i=e.swr,s=(0,c.useState)(!1),u=s[0],l=s[1],d=(0,c.useState)(!1),p=d[0],f=d[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(T.ZP,{title:"Edit user",visible:u,initialValues:(0,ne.Z)((0,U.Z)({},r),{password:"******",authorizedplugins:r.authorizedplugins}),onCancel:function(){return l(!1)},onOk:function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.prev=1,e.next=4,Qr(r,n,i);case 4:f(!1),l(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),f(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}(),loading:p,children:[(0,t.jsx)(z.Z.Item,{name:"firstname",label:"First name",children:(0,t.jsx)(P.Z,{})}),(0,t.jsx)(z.Z.Item,{name:"lastname",label:"Last name",children:(0,t.jsx)(P.Z,{})}),(0,t.jsx)(z.Z.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Email is required"}],children:(0,t.jsx)(P.Z,{})}),(0,t.jsx)(on.o,{name:"password",edit:!0}),(0,t.jsx)(z.Z.Item,{name:"authorizedplugins",label:"Plugins",children:(0,t.jsx)(yn.Z,{mode:"multiple",options:n.map((function(e){return{label:e.name,value:e.key}}))})}),(0,t.jsx)(z.Z.Item,{name:"superuser",label:"Administrator",valuePropName:"checked",children:(0,t.jsx)(Mr.Z,{})})]}),(0,t.jsx)(Y.w6,{bordered:!0,onEdit:function(){return l(!0)},children:"Edit"})]})};$r.propTypes={plugins:kn().arrayOf(kn().exact({key:kn().string.isRequired,name:kn().string.isRequired})).isRequired,user:kn().exact({id:kn().string.isRequired,email:kn().string.isRequired,firstname:kn().string,lastname:kn().string,authorizedplugins:kn().arrayOf(kn().string).isRequired,superuser:kn().bool.isRequired}).isRequired,swr:kn().exact({mutateOneUser:kn().func.isRequired}).isRequired};var et=$r,nt="Unable to delete user",rt=function(){var e=(0,a.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ye.Z.delById(n.id);case 3:r.delOneUser({id:n.id}),e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),(0,k.lt)(nt,e.t0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(n,r){return e.apply(this,arguments)}}(),tt=function(e){var n=e.user,r=e.swr,i=(0,c.useState)(!1),s=i[0],u=i[1];return(0,t.jsx)(Y.m1,{loading:s,bordered:!0,text:(0,t.jsxs)(t.Fragment,{children:["Are you sure you want to delete the user"," ",(0,t.jsx)(p.Z.Text,{strong:!0,children:n.email}),"?"]}),title:"Delete user",onDelete:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,rt(n,r);case 4:return e.prev=4,u(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[1,,4,7]])})))})},at="Unable to load plugins",it=function(e){var n=e.users,r=e.swr,a=(0,c.useState)(),i=a[0],s=a[1],o=(0,c.useState)(),u=o[0],l=o[1],d=(0,c.useRef)(null),p=[{title:"First name",dataIndex:"firstname",key:"firstname",sorter:function(e,n){var r=e.firstname||"",t=n.firstname||"";return r.localeCompare(t)}},{title:"Last name",dataIndex:"lastname",key:"lastname",sorter:function(e,n){var r=e.lastname||"",t=n.lastname||"";return r.localeCompare(t)}},{title:"Email",dataIndex:"email",key:"email",sorter:function(e,n){var r=e.email,t=n.email;return r.localeCompare(t)}},{title:"Password",key:"password",render:function(){return"******"}},{title:"Plugins",dataIndex:"authorizedplugins",key:"authorizedplugins",render:function(e){e.sort();var n=e.map((function(e){var n=null===i||void 0===i?void 0:i.find((function(n){return n.key===e}));return n?(0,t.jsx)(Lr.Z.Ribbon,{text:n.category,style:{marginTop:"-15px"},children:(0,t.jsx)(ie.Z,{size:"small",children:n.name})},e):void 0})),r=(0,t.jsx)(H.Z,{direction:"vertical",children:n});return(0,t.jsx)(Gr.Z,{content:r,children:(0,t.jsxs)(J.Z,{children:[n.length," plugins"]})})}},{title:"Administrator",dataIndex:"superuser",key:"superuser",render:function(e){return e&&(0,t.jsx)(_r.Z,{className:"color-green"})}},{title:"Actions",key:"actions",render:function(e,n){return(0,t.jsxs)(H.Z,{children:[(0,t.jsx)(et,{plugins:(null===i||void 0===i?void 0:i.map((function(e){return{key:e.key,name:e.name}})))||[],user:{id:n.id,firstname:n.firstname,lastname:n.lastname,email:n.email,authorizedplugins:n.authorizedplugins,superuser:n.superuser},swr:{mutateOneUser:r.mutateOneUser}}),(0,t.jsx)(tt,{user:{id:n.id,email:n.email},swr:{delOneUser:r.delOneUser}})]})}}],f=(0,c.useCallback)((function(){var e=d.current;e&&(e.clientHeight>window.innerHeight-e.offsetTop-59?l({y:window.innerHeight-e.offsetTop-59}):l(void 0))}),[]);return(0,c.useEffect)((function(){jn.Z.completeList().then((function(e){s(e)})).catch((function(e){(0,k.lt)(at,e)}))}),[]),(0,c.useEffect)((function(){return window.addEventListener("resize",f),function(){window.removeEventListener("resize",f)}}),[f]),(0,c.useEffect)((function(){f()}),[n,f]),(0,t.jsxs)(H.Z,{direction:"vertical",className:"full-width full-height",size:20,children:[(0,t.jsx)(Xr,{plugins:(null===i||void 0===i?void 0:i.map((function(e){return{key:e.key,name:e.name}})))||[],swr:{addOneUser:r.addOneUser}}),(0,t.jsx)(Kn.Z,{loading:!i,pagination:!1,size:"small",columns:p,dataSource:n.map((function(e){return(0,ne.Z)((0,U.Z)({},e),{key:e.id})})),ref:d,scroll:{y:null===u||void 0===u?void 0:u.y}})]})},st=r(26687),ot=r(15479),ut="System error",ct="Unable to update system",lt=function(){var e=(0,a.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Jr.Z.update([{key:"allowsignup",value:!n.allowsignup}]);case 3:r({allowsignup:!n.allowsignup}),(0,k.Ur)("Changes saved"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),(0,k.lt)(ct,e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,r){return e.apply(this,arguments)}}(),dt=function(){var e=(0,a.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Jr.Z.update([{key:"password",value:n}]);case 3:r({password:n}),(0,k.Ur)("Changes saved"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),(0,k.lt)(ct,e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,r){return e.apply(this,arguments)}}(),pt=function(){var e=(0,i.Z)(z.Z.useForm(),1)[0],n=(0,i.Z)(Jr.Z.useSystem(),2),r=n[0],s=n[1],u=s.mutateSystem,l=s.errorSystem,d=s.loadingSystem,p={wrapperCol:{offset:8,span:16}};return(0,c.useEffect)((function(){l&&(0,k.lt)(ut,l)}),[l]),(0,c.useEffect)((function(){d||e.setFieldsValue((null===r||void 0===r?void 0:r.password)||{min:ot.yL,max:ot.nq,requireLetter:ot.JT,requireNumber:ot.tE,requireSymbol:ot.ah})}),[d,e,null===r||void 0===r?void 0:r.password]),d?(0,t.jsx)(y.Z.Simple,{}):(0,t.jsxs)(H.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(ie.Z,{title:"Signup",children:(0,t.jsx)(Mr.Z,{checked:null===r||void 0===r?void 0:r.allowsignup,onChange:function(){return lt(r,u)},children:"Allow signup"})}),(0,t.jsx)(ie.Z,{title:"Password",children:(0,t.jsxs)(z.Z,(0,ne.Z)((0,U.Z)({},{labelCol:{span:8},wrapperCol:{span:16}}),{form:e,name:"form",onFinish:function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",dt(n,u));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),children:[(0,t.jsx)(z.Z.Item,{label:"Minimum number of characters",name:"min",rules:[{required:!0,message:"Minimum number of characters is required"}],children:(0,t.jsx)(st.Z,{min:0,max:64})}),(0,t.jsx)(z.Z.Item,{label:"Maximum number of characters",name:"max",rules:[{required:!0,message:"Maximum number of characters is required"}],children:(0,t.jsx)(st.Z,{min:0,max:64})}),(0,t.jsx)(z.Z.Item,(0,ne.Z)((0,U.Z)({},p),{valuePropName:"checked",name:"requireLetter",children:(0,t.jsx)(Mr.Z,{children:"Require letter"})})),(0,t.jsx)(z.Z.Item,(0,ne.Z)((0,U.Z)({},p),{valuePropName:"checked",name:"requireNumber",children:(0,t.jsx)(Mr.Z,{children:"Require number"})})),(0,t.jsx)(z.Z.Item,(0,ne.Z)((0,U.Z)({},p),{valuePropName:"checked",name:"requireSymbol",children:(0,t.jsx)(Mr.Z,{children:"Require symbol"})})),(0,t.jsx)(z.Z.Item,(0,ne.Z)((0,U.Z)({},p),{children:(0,t.jsx)(J.Z,{type:"primary",icon:(0,t.jsx)(_r.Z,{}),htmlType:"submit"})}))]}))})]})},ft="Unable to get plugins",mt="Unable to update system",ht=function(){var e=(0,a.Z)(o().mark((function e(n,r,t,a){var i,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Jr.Z.update([{key:"defaultplugins",type:"array",method:t?"append":"remove",value:r.key}]);case 3:i=(null===n||void 0===n?void 0:n.defaultplugins)||[],s=i.indexOf(r.key),t&&-1===s&&i.push(r.key),t||-1===s||i.splice(s,1),a.mutateSystem({defaultplugins:i}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,k.lt)(mt,e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(n,r,t,a){return e.apply(this,arguments)}}(),vt=function(){var e=(0,c.useRef)(null),n=(0,c.useState)(),r=n[0],s=n[1],u=(0,c.useState)(),l=u[0],d=u[1],p=(0,i.Z)(Jr.Z.useSystem(),2),f=p[0],m=p[1],h=m.mutateSystem,v=m.loadingSystem;(0,c.useEffect)((function(){jn.Z.completeList().then((function(e){s(e)})).catch((function(e){(0,k.lt)(ft,e)}))}),[]);var x=[{title:"Category",dataIndex:"category",key:"category"},{title:"Name",dataIndex:"name",key:"name"},{title:"Default enabled",key:"enable",render:function(e){var n,r=null===f||void 0===f||null===(n=f.defaultplugins)||void 0===n?void 0:n.includes(e.key);return(0,t.jsx)(Mr.Z,{checked:r,onChange:function(){var n=(0,a.Z)(o().mark((function n(r){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ht(f,e,r.target.checked,{mutateSystem:h}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()})}}],g=(0,c.useCallback)((function(){var n=e.current;n&&(n.clientHeight>window.innerHeight-n.offsetTop-59?d({y:window.innerHeight-n.offsetTop-59}):d(null))}),[]);return(0,c.useEffect)((function(){return window.addEventListener("resize",g),function(){window.removeEventListener("resize",g)}}),[g]),(0,c.useEffect)((function(){g()}),[r,g]),(0,t.jsx)(Kn.Z,{loading:!r||v,pagination:!1,size:"small",columns:x,dataSource:r,ref:e,scroll:{y:null===l||void 0===l?void 0:l.y}})},xt={label:"Users",key:"users"},gt={label:"Registration",key:"registration"},wt={label:"Plugins",key:"plugins"},jt="Users error",Zt=function(){var e=(0,u.useRouter)(),n=e.query.tab,r=(0,i.Z)(Ye.Z.useUsers(),2),a=r[0],s=r[1],o=s.addOneUser,d=s.mutateOneUser,f=s.delOneUser,m=s.errorUsers;return(0,c.useEffect)((function(){m&&(0,k.lt)(jt,m)}),[m]),(0,t.jsxs)(l.Z,{className:"inDashboard Administration",children:[(0,t.jsx)(b.Z,{className:"inDashboard-PageHeader",backIcon:!1,title:(0,t.jsx)(p.Z.Title,{level:2,className:"inDashboard-PageHeader-title",children:"Administration"}),footer:(0,t.jsx)(O.Z,{})}),(0,t.jsx)(l.Z.Content,{children:(0,t.jsxs)(C.Z,{className:"inDashboard-Tabs",type:"card",defaultActiveKey:n||"default",onChange:function(n){return function(e,n){e.replace({pathname:"/dashboard",query:{page:"administration",tab:n}})}(e,n)},children:[(0,t.jsx)(C.Z.TabPane,{tab:xt.label,children:(0,t.jsx)(it,{users:a,swr:{addOneUser:o,mutateOneUser:d,delOneUser:f}})},xt.key),(0,t.jsx)(C.Z.TabPane,{tab:gt.label,children:(0,t.jsx)(pt,{})},gt.key),(0,t.jsx)(C.Z.TabPane,{tab:wt.label,children:(0,t.jsx)(vt,{})},wt.key)]})})]})},kt=r(95507),yt=function(){return(0,t.jsx)(ie.Z,{title:"Standard workflow",children:(0,t.jsx)(kt.ZP,{dataSource:["Go to account settings","Fill your first name, last name, change your password if needed","Create an HPC provider, you will need that to run a simulation","Create a new workspace","Create a new project","Upload a geometry (STEP file for 3D or DXF file for 2D)","Select a simulation model","Configure your simulation: geometry, materials, parameters, boundary conditions, depending on your simulation, HPC resource","Run your simulation","Display the results","Depending on your simulation, visualize data","Depending on your simulation, post-process the result"],renderItem:function(e){return(0,t.jsxs)(kt.ZP.Item,{children:[" - ",e]})}})})},bt=function(){return(0,t.jsx)(ie.Z,{title:"Workspace",children:(0,t.jsxs)(p.Z.Text,{children:["The workspace is the place where all the projects are. You can create several workspaces to sort your different projects.",(0,t.jsx)("br",{}),"You can share your workspace with other users or groups throught organizations."]})})},Ot=r(54907),zt=function(){return(0,t.jsxs)(ie.Z,{title:"Project",children:[(0,t.jsx)(p.Z.Text,{children:"The project is used to manage geometries and simulation."}),(0,t.jsx)(Ot.Z,{children:(0,t.jsx)(Ot.Z.Panel,{header:"Archive Project",children:(0,t.jsxs)(p.Z.Text,{children:["You can archive a project to save disk space.",(0,t.jsx)("br",{}),"Once archived, a project is not editable anymore.",(0,t.jsx)("br",{}),"At the archive time, you can download a"," ",(0,t.jsx)("code",{children:".tanatlocarchive"})," file that contains all the data to restore your project later.",(0,t.jsx)("br",{}),"There is several options to manage an archived projects:",(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"Restore the project from the previously downloaded archive file;"}),(0,t.jsx)("li",{children:"Restore the project from the archive file on the server;"}),(0,t.jsx)("li",{children:"Delete the archive file on the server, in the case you will not be able to restore the project from the server archive file."})]})]})},"archive")})]})},Pt=function(){return(0,t.jsx)(ie.Z,{title:"Account / HPC plugins",children:(0,t.jsxs)(Ot.Z,{children:[(0,t.jsxs)(Ot.Z.Panel,{header:"Local plugin",children:[(0,t.jsx)(p.Z.Text,{children:"Allow to compute a simulation directly on the frontal server."}),(0,t.jsx)(p.Z.Text,{children:"This plugin is only reserved for test purposes."})]},"local"),(0,t.jsxs)(Ot.Z.Panel,{header:"Rescale plugin",children:[(0,t.jsxs)(p.Z.Text,{children:["Allow to compute a simulation on"," ",(0,t.jsx)("a",{href:"https://www.rescale.com/",children:"Rescale"}),"."]}),(0,t.jsx)(p.Z.Text,{children:"You have to fill the following informations:"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"Name: a name to retrieve your configuration during the simulation parameterization;"}),(0,t.jsxs)("li",{children:["Token: your API token. You can find it in your"," ",(0,t.jsx)("a",{href:"https://platform.rescale.jp/user/settings/api-key/",children:"Rescale account"}),";"]}),(0,t.jsx)("li",{children:"Platform: the platform you use. USA, Europe or Japan;"}),(0,t.jsx)("li",{children:"[Optional] Organization name: the organization you are in;"}),(0,t.jsx)("li",{children:"[Optional] Project id: the financial project identifier;"}),(0,t.jsx)("li",{children:"[Optional] Default walltime: the default value for the run walltime;"}),(0,t.jsx)("li",{children:"[Optional] Additional files: additional files you have to use with your simulations. Generally FreeFEM custom plugins."})]}),(0,t.jsx)(p.Z.Text,{children:"When you save this informations, Tanatloc will check your API key, the available core types, and the available FreeFEM versions."})]},"rescale")]})})},Ct=function(){return(0,t.jsxs)(ie.Z,{title:"Administration",children:[(0,t.jsx)(p.Z.Text,{children:"Your need to be an administrator to have acces to this part"}),(0,t.jsxs)(Ot.Z,{children:[(0,t.jsx)(Ot.Z.Panel,{header:"Users",children:(0,t.jsx)(p.Z.Text,{children:"You can manage users: create, delete or modify informations."})},"users"),(0,t.jsx)(Ot.Z.Panel,{header:"Registration",children:(0,t.jsx)(p.Z.Text,{children:"Allow you to enable / disable the signup and to manage the required pattern for passwords."})},"registration")]})]})},St=function(){return(0,t.jsxs)(ie.Z,{title:"Organization",children:[(0,t.jsx)(p.Z.Text,{children:"Allow you to manage an organization, and associated groups for sharing purpose."}),(0,t.jsxs)(Ot.Z,{children:[(0,t.jsx)(Ot.Z.Panel,{header:"Users",children:(0,t.jsxs)(p.Z.Text,{children:["Add or remove owners and users.",(0,t.jsx)("br",{}),"Owners and users in an organization can be used to share a workspace or a project."]})},"users"),(0,t.jsx)(Ot.Z.Panel,{header:"Groups",children:(0,t.jsxs)(p.Z.Text,{children:["Add, modify or remove groups.",(0,t.jsx)("br",{}),"Groups in an organization can be used to share a workspace or a project."]})},"groups")]})]})},Nt=function(){return(0,t.jsxs)(l.Z,{className:"inDashboard Help",children:[(0,t.jsx)(b.Z,{className:"inDashboard-PageHeader",backIcon:!1,title:(0,t.jsx)(p.Z.Title,{level:2,className:"inDashboard-PageHeader-title",children:"Help"}),footer:(0,t.jsx)(O.Z,{})}),(0,t.jsx)(l.Z.Content,{className:"scroll",children:(0,t.jsxs)(H.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(yt,{}),(0,t.jsx)(bt,{}),(0,t.jsx)(zt,{}),(0,t.jsx)(Pt,{}),(0,t.jsx)(St,{}),(0,t.jsx)(Ct,{})]})})]})},Tt="User error",Ut="Organizations error",Et="Workspaces error",qt="Unable to logout",It={workspaces:{label:"Workspaces",key:"workspaces"},account:{label:"Account Settings",key:"account"},organizations:{label:"Organizations",key:"organizations"},administration:{label:"Administration",key:"administration"},help:{label:"I Need Help",key:"help"},logout:{label:"Logout",key:"logout"}},Rt=function(e,n,r){n===It.logout.key?At(e,r):e.replace({pathname:"/dashboard",query:{page:n}})},At=function(){var e=(0,a.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,hn();case 3:r(),n.push("/"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),(0,k.lt)(qt,e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,r){return e.apply(this,arguments)}}(),Dt=function(){var e=(0,c.useState)(),n=e[0],r=e[1],a=(0,i.Z)(Ye.Z.useUser(),2),s=a[0],o=a[1],w=o.mutateUser,b=o.clearUser,O=o.errorUser,z=o.loadingUser,P=(0,i.Z)(Xn.useOrganizations(),2),C=P[0],S=P[1],N=S.addOneOrganization,T=S.delOneOrganization,U=S.mutateOneOrganization,E=S.errorOrganizations,q=S.loadingOrganizations,I=(0,i.Z)(F.useWorkspaces(),2),R=I[0],A=I[1],D=A.addOneWorkspace,W=A.delOneWorkspace,H=A.mutateOneWorkspace,L=A.errorWorkspaces,G=A.loadingWorkspaces,_=(0,u.useRouter)();(0,c.useEffect)((function(){z||s||_.replace("/")}),[s,z,_]),(0,c.useEffect)((function(){var e=new URLSearchParams(window.location.search).get("page");e?r(e):(r(It.workspaces.key),Rt(_,It.workspaces.key,b))}),[_,b]),(0,c.useEffect)((function(){O&&(0,k.lt)(Tt,O),E&&(0,k.lt)(Ut,E),L&&(0,k.lt)(Et,L)}),[O,E,L]);var M="";return M="git-dev-11819cd",!s||z||q||G?(0,t.jsx)(y.Z,{}):(0,t.jsxs)(l.Z,{className:"Dashboard",children:[(0,t.jsxs)(l.Z.Sider,{theme:"light",width:"256",className:"Dashboard-Sider",children:[(0,t.jsx)("div",{className:"logo",children:(0,t.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,t.jsx)(d.Z,{className:"Dashboard-Menu",theme:"light",items:[{key:It.workspaces.key,icon:(0,t.jsx)(f.Z,{}),label:It.workspaces.label},{key:It.account.key,icon:(0,t.jsx)(m.Z,{}),label:It.account.label},{key:It.organizations.key,icon:(0,t.jsx)(h.Z,{}),label:It.organizations.label,className:j()()?"display-none":""},{key:It.administration.key,className:s.superuser&&!j()()?"":"display-none",icon:(0,t.jsx)(v.Z,{}),label:It.administration.label},{key:It.help.key,icon:(0,t.jsx)(x.Z,{}),label:It.help.label},{type:"divider"},{key:It.logout.key,danger:!0,icon:(0,t.jsx)(g.Z,{}),label:It.logout.label,className:j()()?"display-none":""},{key:"version",disabled:!0,className:"version",label:(0,t.jsxs)(p.Z.Text,{className:"text-light",ellipsis:{tooltip:!0},children:["version ",Z.i8," ",M&&(0,t.jsxs)(t.Fragment,{children:["(",M,")"]})]})}],onClick:function(e){var n=e.keyPath.pop();r(n),Rt(_,n,b)},mode:"inline"})]}),(0,t.jsxs)(l.Z.Content,{className:"no-scroll",children:[n===It.workspaces.key&&(0,t.jsx)(_e,{user:{id:s.id},workspaces:R,organizations:C,swr:{addOneWorkspace:D,delOneWorkspace:W,mutateOneWorkspace:H}}),n===It.account.key&&(0,t.jsx)(Hn,{user:{email:s.email,firstname:s.firstname,lastname:s.lastname,avatar:s.avatar},swr:{mutateUser:w,clearUser:b}}),n===It.organizations.key&&(0,t.jsx)(Hr,{user:{id:s.id},organizations:C,swr:{addOneOrganization:N,delOneOrganization:T,mutateOneOrganization:U,loadingOrganizations:q}}),n===It.administration.key&&(0,t.jsx)(Zt,{}),n===It.help.key&&(0,t.jsx)(Nt,{})]})]})},Wt=function(){return(0,t.jsx)(Dt,{})}},4147:function(e){"use strict";e.exports=JSON.parse('{"i8":"1.0.0-beta.11"}')}},function(e){e.O(0,[317,880,474,551,220,595,819,909,71,416,695,892,983,381,331,774,888,179],(function(){return n=40528,e(e.s=n);var n}));var n=e.O();_N_E=n}]);