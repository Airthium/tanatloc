(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8026],{40528:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return r(26302)}])},15479:function(e,n,r){"use strict";r.d(n,{JT:function(){return a},ah:function(){return o},nq:function(){return i},tE:function(){return s},yL:function(){return t}});r(83454).env.AUTH_SECRET||new Array(33).join("a");var t=6,i=16,a=!0,s=!0,o=!0},41686:function(e,n,r){"use strict";r.d(n,{Z:function(){return o}});var t=r(47568),i=r(20414),a=r(87492),s=function(){var e=(0,t.Z)((function(e,n){return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,a.R)("/api/avatar",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({file:e,project:n})})];case 1:return[2,r.sent().json()]}}))}));return function(n,r){return e.apply(this,arguments)}}(),o={add:s}},81891:function(e,n,r){"use strict";r.d(n,{H:function(){return o}});var t=r(51438),i=r(28668),a=r(25892),s=r(91224),o=function(e){(0,i.Z)(r,e);var n=(0,s.Z)(r);function r(e){var i;return(0,t.Z)(this,r),(i=n.call(this,e.title)).title=e.title,i.name="APIError",i.render=e.render,i.err=e.err,i.type=e.type||"error",i}return r}((0,a.Z)(Error))},24443:function(e,n,r){"use strict";r.d(n,{Z:function(){return h}});var t=r(47568),i=r(20414),a=r(87492),s=function(){var e=(0,t.Z)((function(e){return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,a.R)("/api/plugin",{method:"POST",body:JSON.stringify(e)})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),o=function(){var e=(0,t.Z)((function(e){return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,a.R)("/api/plugin",{method:"PUT",body:JSON.stringify(e)})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),u=function(){var e=(0,t.Z)((function(e){return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,a.R)("/api/plugin",{method:"DELETE",body:JSON.stringify(e)})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),l=r(26042),c=r(29815),d=r(8100),p=r(67294),h={add:s,update:o,del:u,usePlugins:function(){var e=(0,d.ZP)("/api/plugin",a._),n=e.data,r=e.error,t=e.mutate,i=!n,s=(null===n||void 0===n?void 0:n.plugins)||[],o=(0,p.useCallback)((function(e){var n=(0,c.Z)(s).concat([e]);t({plugins:n})}),[s,t]),u=(0,p.useCallback)((function(e){var n=s.filter((function(n){return n.key!==e.key}));t({plugins:n})}),[s,t]),h=(0,p.useCallback)((function(e){var n=s.map((function(n){return n.key===e.key&&(n=(0,l.Z)({},n,e)),n}));t({plugins:n})}),[s,t]);return[s,{mutatePlugins:t,addOnePlugin:o,delOnePlugin:u,mutateOnePlugin:h,errorPlugins:r,loadingPlugins:i}]}}},4687:function(e,n,r){"use strict";r.d(n,{Z:function(){return u}});var t=r(47568),i=r(20414),a=r(87492),s=function(){var e=(0,t.Z)((function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,a.R)("/api/plugins",{method:"GET",headers:{Accept:"application/json"}})];case 1:return[2,e.sent().json()]}}))}));return function(){return e.apply(this,arguments)}}(),o=function(){var e=(0,t.Z)((function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,a.R)("/api/plugins",{method:"POST",headers:{Accept:"application/json"}})];case 1:return[2,e.sent().json()]}}))}));return function(){return e.apply(this,arguments)}}(),u={list:s,completeList:o}},94370:function(e,n,r){"use strict";r.d(n,{Z:function(){return x}});var t=r(26042),i=r(69396),a=r(29815),s=r(8100),o=r(67294),u=r(87492),l=r(47568),c=r(20414),d=function(){var e=(0,l.Z)((function(e,n){return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,u.R)("/api/project",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({workspace:{id:e.id},project:n})})];case 1:return[2,r.sent().json()]}}))}));return function(n,r){return e.apply(this,arguments)}}(),p=function(){var e=(0,l.Z)((function(e,n){return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,u.R)("/api/project/"+e.id,{method:"PUT",body:JSON.stringify(n)})];case 1:return r.sent(),[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),h=function(){var e=(0,l.Z)((function(e,n){return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,u.R)("/api/project/"+n.id,{method:"DELETE",body:JSON.stringify({id:e.id})})];case 1:return r.sent(),[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),f=function(){var e=(0,l.Z)((function(e){return(0,c.__generator)(this,(function(n){return[2,(0,u.R)("/api/project/"+e.id+"/archive",{method:"GET",headers:{Accept:"application/json"}})]}))}));return function(n){return e.apply(this,arguments)}}(),m=function(){var e=(0,l.Z)((function(e){return(0,c.__generator)(this,(function(n){return[2,(0,u.R)("/api/project/"+e.id+"/archive",{method:"PUT"})]}))}));return function(n){return e.apply(this,arguments)}}(),g=function(){var e=(0,l.Z)((function(e){return(0,c.__generator)(this,(function(n){return[2,(0,u.R)("/api/project/"+e.id+"/archive",{method:"DELETE"})]}))}));return function(n){return e.apply(this,arguments)}}(),v=function(){var e=(0,l.Z)((function(e,n){return(0,c.__generator)(this,(function(r){return[2,(0,u.R)("/api/project/"+e.id+"/archive",{method:"POST",body:JSON.stringify({archive:n})})]}))}));return function(n,r){return e.apply(this,arguments)}}(),j={useProjects:function(e){var n=(0,s.ZP)(["/api/projects",JSON.stringify({ids:e})],u._),r=n.data,l=n.error,c=n.mutate,d=!r,p=(null===r||void 0===r?void 0:r.projects)||[],h=(0,o.useCallback)((function(e){var n=(0,a.Z)(p).concat([(0,i.Z)((0,t.Z)({},e),{users:[],geometries:[],simulations:[],groups:[]})]);c({projects:n})}),[p,c]),f=(0,o.useCallback)((function(e){var n=p.filter((function(n){return n.id!==e.id}));c({projects:n})}),[p,c]),m=(0,o.useCallback)((function(e){var n=p.map((function(n){return n.id===e.id&&(n=(0,t.Z)({},n,e)),n}));c({projects:n})}),[p,c]);return[p,{addOneProject:h,delOneProject:f,mutateOneProject:m,errorProjects:l,loadingProjects:d}]},useProject:function(e){var n=(0,s.ZP)("/api/project"+(e?"/"+e:""),u._),r=n.data,i=n.error,a=n.mutate,l=!r,c=(null===r||void 0===r?void 0:r.project)||{id:"0"},d=(0,o.useCallback)((function(e){var n=(0,t.Z)({},c,e);a({project:n})}),[c,a]);return[c,{mutateProject:d,errorProject:i,loadingProject:l}]},add:d,update:p,del:h,archive:f,unarchiveFromServer:m,deleteArchiveFile:g,unarchiveFromFile:v},x=j},36574:function(e,n,r){"use strict";r.d(n,{Z:function(){return d}});var t=r(26042),i=r(8100),a=r(67294),s=r(87492),o=r(47568),u=r(20414),l=function(){var e=(0,o.Z)((function(e){return(0,u.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,s.R)("/api/system",{method:"PUT",body:JSON.stringify(e)})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),c={useSystem:function(){var e=(0,i.ZP)("/api/system",s._),n=e.data,r=e.error,o=e.mutate,u=!n,l=(null===n||void 0===n?void 0:n.system)||{},c=(0,a.useCallback)((function(e){o({system:(0,t.Z)({},l,e)})}),[l,o]);return[l,{mutateSystem:c,errorSystem:r,loadingSystem:u}]},update:l},d=c},41641:function(e,n,r){"use strict";r.d(n,{HS:function(){return o},Lw:function(){return w},m1:function(){return m},o6:function(){return v},w6:function(){return l},ks:function(){return x},Qj:function(){return y}});var t=r(85893),i=r(84908),a=r(71577),s=r(64789),o=function(e){var n=e.disabled,r=e.primary,o=void 0===r||r,u=e.light,l=e.dark,c=e.fullWidth,d=e.needMargin,p=e.loading,h=e.children,f=e.onAdd;return(0,t.jsx)(i.Z,{title:h||"Add",children:(0,t.jsx)(a.Z,{className:(c?"full-width":"")+(d?" marginLeft-5":"")+(u?" text-light":"")+(l?" text-dark":""),disabled:n,loading:p,type:o?"primary":"default",icon:(0,t.jsx)(s.Z,{}),onClick:function(){return f()},children:h})})},u=r(86548),l=function(e){var n,r=e.disabled,s=e.primary,o=void 0!==s&&s,l=e.bordered,c=e.light,d=e.dark,p=e.needMargin,h=e.loading,f=e.children,m=e.onEdit;return n=r?"link":o?"primary":"default",(0,t.jsx)(i.Z,{title:f||"Edit",children:(0,t.jsx)(a.Z,{className:"no-background "+(p?"marginLeft-5 ":"")+(c?"text-light ":"")+(d?"text-dark ":"")+(l?"":"no-border "),disabled:r,loading:h,type:n,icon:(0,t.jsx)(u.Z,{}),onClick:m,children:f})})},c=r(47568),d=r(20414),p=r(67294),h=r(48689),f=r(32834),m=function(e){var n=e.disabled,r=e.loading,s=e.bordered,o=e.text,u=e.title,l=e.children,m=e.onDelete,g=(0,p.useState)(!1),v=g[0],j=g[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.AN,{visible:v,loading:r,title:u||"Delete",onCancel:function(){return j(!1)},onOk:(0,c.Z)((function(){return(0,d.__generator)(this,(function(e){switch(e.label){case 0:return[4,m()];case 1:return e.sent(),j(!1),[2]}}))})),children:o||"Are you sure?"}),(0,t.jsx)(i.Z,{title:l||"Delete",children:(0,t.jsx)(a.Z,{className:"no-background "+(s?"":"no-border"),danger:!0,disabled:n,type:n?"link":void 0,loading:r,icon:(0,t.jsx)(h.Z,{}),onClick:function(){return j(!0)},children:l})})]})},g=r(23430),v=function(e){var n=e.disabled,r=e.loading,s=e.bordered,o=e.children,u=e.onDownload;return(0,t.jsx)(i.Z,{title:o||"Download",children:(0,t.jsx)(a.Z,{className:"no-background "+(s?"":"no-border"),disabled:n,loading:r,icon:(0,t.jsx)(g.Z,{}),onClick:function(){return u()},children:o})})},j=r(82826),x=function(e){var n=e.children,r=e.onClick;return(0,t.jsx)(a.Z,{className:"no-border",icon:(0,t.jsx)(j.Z,{className:"color-primary"}),onClick:r,children:n||"Go back"})},w=function(e){var n=e.disabled,r=e.loading,s=e.children,o=e.onCancel;return(0,t.jsx)(i.Z,{title:s||"Cancel",children:(0,t.jsx)(a.Z,{disabled:n,loading:r,type:"default",onClick:o,children:s||"Cancel"})})},y=function(e){var n=e.children,r=e.onClick;return(0,t.jsx)(a.Z,{type:"link",onClick:r,style:{padding:0},children:n})}},51986:function(e,n,r){"use strict";r.d(n,{o:function(){return v}});var t=r(828),i=r(85893),a=r(81579),s=r(69677),o=r(15479),u=r(36574),l="Please enter a password",c=function(e){return"Your password is too small (minimum "+e+" characters)"},d=function(e){return"Your password is too long (maximum "+e+" characters)"},p="Your password must contain a letter",h="Your password must contain a number",f="Your password must contain a symbol",m=function(e,n){return-1!==e.search(n)},g=function(e,n,r){(function(e,n){var r,t;return!(null!==(t=null===e||void 0===e||null===(r=e.password)||void 0===r?void 0:r.requireLetter)&&void 0!==t?t:o.JT)||m(n,/[a-zA-Z]/)})(e,n)||r.push(p),function(e,n){var r,t;return!(null!==(t=null===e||void 0===e||null===(r=e.password)||void 0===r?void 0:r.requireNumber)&&void 0!==t?t:o.tE)||m(n,/\d/)}(e,n)||r.push(h),function(e,n){var r,t;return!(null!==(t=null===e||void 0===e||null===(r=e.password)||void 0===r?void 0:r.requireSymbol)&&void 0!==t?t:o.ah)||m(n,/[!@#$%^&*(){}[\]<>?/|.:;_-]/)}(e,n)||r.push(f)},v=function(e){var n,r,p,h,f=e.labelCol,m=e.wrapperCol,v=e.name,j=e.label,x=e.inputPlaceholder,w=e.inputAutoComplete,y=e.edit,Z=e.style,b=e.required,k=e.className,O=(0,t.Z)(u.Z.useSystem(),1)[0],_=null!==(p=null===O||void 0===O||null===(n=O.password)||void 0===n?void 0:n.min)&&void 0!==p?p:o.yL,z=null!==(h=null===O||void 0===O||null===(r=O.password)||void 0===r?void 0:r.max)&&void 0!==h?h:o.nq;return(0,i.jsx)(a.Z.Item,{className:k,labelCol:f,wrapperCol:m,name:v||"password",label:j||"Password",rules:[function(){return{validator:function(e,n){var r=[];return y&&"******"===n?Promise.resolve():n?(function(e,n,r,t){(function(e,n){return!(n.length<e)})(e,r)||t.push(c(e)),function(e,n){return!(n.length>e)}(n,r)||t.push(d(n))}(_,z,n,r),g(O,n,r),r.length?Promise.reject(r):Promise.resolve()):Promise.reject(l)}}},{required:!!b,message:""}],style:Z,children:(0,i.jsx)(s.Z.Password,{placeholder:x,autoComplete:w})})}},60877:function(e,n,r){"use strict";var t=r(85893),i=r(84908),a=r(63922),s=r(24093),o=r(11382),u=r(13023),l=r(48764).lW,c=function(e){return e?"hsl("+Array.from(e).reduce((function(e,n){return n.charCodeAt(0)+((e<<5)-e)}),0)%360+", 100%, 25%)":"#FFFFFF"},d=function(e){var n=e.toString(16);return 1===n.length?"0"+n:n},p={deepCopy:function(e){return JSON.parse(JSON.stringify(e))},stringToColor:c,rgbToHex:function(e){return"#"+d(Math.floor(255*e.r))+d(Math.floor(255*e.g))+d(Math.floor(255*e.b))},rgbToRgba:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e?"rgba("+255*e.r+", "+255*e.g+", "+255*e.b+", "+n+")":"rgba(255, 255, 255, 0)"},userToAvatar:function(e){var n=e.avatar&&l.from(e.avatar).toString(),r="",u="";return e.firstname||e.lastname?(r=e.firstname?e.firstname+" ":"",r+=e.lastname||"",u=e.firstname?e.firstname[0]:"",u+=e.lastname?e.lastname[0]:""):e.email&&(r=e.email,u=e.email[0]),(0,t.jsx)(i.Z,{title:r+(e.pending?" (Invite pending)":""),children:(0,t.jsx)(a.Z,{count:e.pending&&"Pending...",offset:[30,5],style:{backgroundColor:"#ff4d4f",zIndex:10},children:(0,t.jsx)(s.C,{src:n,style:{backgroundColor:c(r)},children:u.toUpperCase()||(0,t.jsx)(o.Z,{})})})},e.id||JSON.stringify(e))},groupToAvatar:function(e){var n=e.name,r="";return n&&(r=n[0]),(0,t.jsx)(i.Z,{title:n,children:(0,t.jsx)(s.C,{style:{backgroundColor:c(n)},children:r.toUpperCase()||(0,t.jsx)(o.Z,{})})},e.id||JSON.stringify(e))},validateEmail:function(e){return!!(0,u.parseOneAddress)(e)},getGitVersion:function(){return"git-front-3d9b281"}};n.Z=p},26302:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return Ft}});var t=r(85893),i=r(47568),a=r(828),s=r(20414),o=r(11163),u=r(67294),l=r(97183),c=r(66516),d=r(6880),p=r(41156),h=r(42952),f=r(55355),m=r(11186),g=r(25035),v=r(92443),j=r(59134),x=r.n(j),w=r(4147),y=r(96844),Z=r(75107),b=r(7614),k=r(27049),O=r(81579),_=r(69677),z=r(80284),C=r(62986),P=50,S=r(32834),N=r(26042),T=r(29815),E=r(8100),R=r(87492),U=function(){var e=(0,i.Z)((function(e){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,R.R)("/api/workspace",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(e)})];case 1:return[2,n.sent().json()]}}))}));return function(n){return e.apply(this,arguments)}}(),A=function(){var e=(0,i.Z)((function(e,n){return(0,s.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,R.R)("/api/workspace",{method:"PUT",body:JSON.stringify({workspace:e,data:n})})];case 1:return r.sent(),[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),I=function(){var e=(0,i.Z)((function(e){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,R.R)("/api/workspace",{method:"DELETE",body:JSON.stringify(e)})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),q={useWorkspaces:function(){var e=(0,E.ZP)("/api/workspace",R._),n=e.data,r=e.error,t=e.mutate,i=!n,a=(null===n||void 0===n?void 0:n.workspaces)||[],s=(0,u.useCallback)((function(e){var n=(0,T.Z)(a).concat([e]);t({workspaces:n})}),[a,t]),o=(0,u.useCallback)((function(e){var n=a.filter((function(n){return n.id!==e.id}));t({workspaces:n})}),[a,t]),l=(0,u.useCallback)((function(e){var n=a.map((function(n){return n.id===e.id&&(n=(0,N.Z)({},n,e)),n}));t({workspaces:n})}),[a,t]);return[a,{addOneWorkspace:s,delOneWorkspace:o,mutateOneWorkspace:l,errorWorkspaces:r,loadingWorkspaces:i}]},add:U,update:A,del:I},D=q,F=r(26713),W=r(24093),L=r(68795),H=r(97986),G=r(84908),J=r(71577),M=r(20046),B=r(41641),Y=r(60877),V=r(94370),X="Unable to share",K=function(){var e=(0,i.Z)((function(e,n,r,t,i){var a,o,u;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,5,,6]),e?[4,D.update({id:e.id},[{key:"groups",value:r},{key:"users",value:t}])]:[3,2];case 1:return s.sent(),(a=Y.Z.deepCopy(e)).groups=r.map((function(e){return{id:e}})),a.users=t.map((function(e){return{id:e}})),i.mutateOneWorkspace(a),[3,4];case 2:return[4,V.Z.update({id:n.id},[{key:"groups",value:r},{key:"users",value:t}])];case 3:s.sent(),(o=Y.Z.deepCopy(n)).groups=r.map((function(e){return{id:e}})),o.users=t.map((function(e){return{id:e}})),i.mutateOneProject(o),s.label=4;case 4:return[3,6];case 5:throw u=s.sent(),(0,y.lt)(X,u),u;case 6:return[2]}}))}));return function(n,r,t,i,a){return e.apply(this,arguments)}}(),Q=function(e){var n=e.email;return(e.lastname||e.firstname)&&(n=e.lastname?e.lastname+" ":"",n+=e.firstname||""),n},$=function(e){var n=e.disabled,r=e.workspace,a=e.project,l=e.organizations,c=e.swr,p=e.style,h=(0,u.useState)(!1),f=h[0],m=h[1],g=(0,u.useState)(!1),v=g[0],j=g[1],w=(0,u.useState)([]),y=w[0],Z=w[1],b=(0,u.useState)([]),k=b[0],_=b[1],z=(0,u.useState)([]),C=z[0],P=z[1],N=(0,u.useState)([]),T=N[0],E=N[1],R=(0,o.useRouter)();(0,u.useEffect)((function(){var e=r||a,n=null===e||void 0===e?void 0:e.groups.map((function(e){return e.id})),t=null===e||void 0===e?void 0:e.users.map((function(e){return e.id}));P(n||[]),E(t||[])}),[r,a]),(0,u.useEffect)((function(){var e=l.map((function(e){var n=e.groups.map((function(e){return{key:e.id,title:e.name,value:e.id,type:"group"}}));return{key:e.id,title:e.name,value:e.id,disabled:!0,checkable:!1,children:n}})),n=[];l.forEach((function(e){e.owners.forEach((function(e){n.push({key:e.id,title:Q(e),value:e.id,type:"user"})})),e.users.forEach((function(e){n.push({key:e.id,title:Q(e),value:e.id,type:"user"})})),e.groups.forEach((function(e){e.users.forEach((function(e){n.push({key:e.id,title:Q(e),value:e.id,type:"user"})}))}))}));var r=n.filter((function(e,n,r){return r.findIndex((function(n){return n.key===e.key}))===n}));Z(e),_(r)}),[l]);var U=null;return U=y.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(O.Z.Item,{label:(0,t.jsxs)(t.Fragment,{children:["Share this ",r?"workspace":"project"," with organizations groups"]}),children:(0,t.jsx)(H.Z,{multiple:!0,treeCheckable:!0,treeDefaultExpandAll:!0,showCheckedStrategy:H.Z.SHOW_ALL,placeholder:"Select groups",dropdownStyle:{maxHeight:400,overflow:"auto"},className:"full-width",treeData:y,value:C,onChange:function(e){return P(e)}})}),(0,t.jsx)(O.Z.Item,{label:(0,t.jsxs)(t.Fragment,{children:["Share this ",r?"workspace":"project"," with organizations users"]}),children:(0,t.jsx)(H.Z,{multiple:!0,treeCheckable:!0,treeDefaultExpandAll:!0,showCheckedStrategy:H.Z.SHOW_ALL,placeholder:"Select users",dropdownStyle:{maxHeight:400,overflow:"auto"},className:"full-width",treeData:k,value:T,onChange:function(e){return E(e)}})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("br",{}),(0,t.jsx)(d.Z.Text,{strong:!0,children:"There is no organization for now"}),(0,t.jsx)("br",{}),(0,t.jsxs)(d.Z.Text,{children:["You can create organizations and groups in the"," ",(0,t.jsx)(B.Qj,{onClick:function(){return R.push({pathname:"/dashboard",query:{page:"organizations"}})},children:"Organization menu"}),"."]})]}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(G.Z,{title:"Share",children:(0,t.jsx)(J.Z,{className:"no-background "+((null===p||void 0===p?void 0:p.buttonLight)?"text-light ":"")+((null===p||void 0===p?void 0:p.buttonDark)?" text-dark ":"")+((null===p||void 0===p?void 0:p.buttonBordered)?" ":"no-border ")+(x()()?"display-none ":" "),disabled:n,type:n?"link":void 0,icon:(0,t.jsx)(M.Z,{}),onClick:function(){return m(!0)}},"share")}),(0,t.jsxs)(S.ZP,{title:"Share "+(r?"workspace":"project"),visible:f,onCancel:function(){return m(!1)},onOk:(0,i.Z)((function(){var e;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:j(!0),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,K(r,a,C,T,c)];case 2:return n.sent(),j(!1),m(!1),[3,4];case 3:throw e=n.sent(),j(!1),e;case 4:return[2]}}))})),loading:v,children:[(0,t.jsxs)(d.Z.Title,{level:5,children:[r?"Workspace: ":"Project: ",(null===r||void 0===r?void 0:r.name)||(null===a||void 0===a?void 0:a.title)]}),U]})]})},ee=r(69396),ne="Unable to add project",re=function(){var e=(0,i.Z)((function(e,n,r){var t,i;return(0,s.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,V.Z.add({id:e.id},n)];case 1:return t=a.sent(),r.addOneProject(t),r.mutateOneWorkspace((0,ee.Z)((0,N.Z)({},e),{projects:(0,T.Z)(e.projects).concat([t.id])})),[2,t];case 2:throw i=a.sent(),(0,y.lt)(ne,i),i;case 3:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),te=function(e){var n=e.workspace,r=e.swr,a=(0,u.useState)(!1),l=a[0],c=a[1],d=(0,u.useState)(!1),p=d[0],h=d[1],f=(0,o.useRouter)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.HS,{primary:!1,dark:!0,onAdd:function(){return c(!0)},children:"Create a new project"}),(0,t.jsxs)(S.ZP,{title:"Create a new project",visible:l,onCancel:function(){return c(!1)},onOk:function(){var e=(0,i.Z)((function(e){var t,i;return(0,s.__generator)(this,(function(a){switch(a.label){case 0:h(!0),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,re(n,e,r)];case 2:return t=a.sent(),h(!1),c(!1),f.push({pathname:"/project",query:{page:"workspaces",workspaceId:n.id,projectId:t.id}}),[3,4];case 3:throw i=a.sent(),h(!1),i;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),loading:p,children:[(0,t.jsx)(O.Z.Item,{label:"Name",name:"title",rules:[{required:!0,message:"Name is required"},{max:P,message:"Max "+P+" characters"}],children:(0,t.jsx)(_.Z,{placeholder:"Project's name"})}),(0,t.jsx)(O.Z.Item,{label:"Description",name:"description",children:(0,t.jsx)(_.Z.TextArea,{showCount:!0,maxLength:120,placeholder:"Project's description"})})]})]})},ie=r(81474),ae=r(20550),se=r(61980),oe="Unable to edit project",ue=function(){var e=(0,i.Z)((function(e,n,r){var t;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,V.Z.update({id:e.id},[{key:"title",value:n.title},{key:"description",value:n.description}])];case 1:return i.sent(),r.mutateOneProject(e),[3,3];case 2:throw t=i.sent(),(0,y.lt)(oe,t),t;case 3:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),le=function(e){var n=e.disabled,r=e.project,a=e.swr,o=(0,u.useState)(!1),l=o[0],c=o[1],d=(0,u.useState)(!1),p=d[0],h=d[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.w6,{disabled:n,dark:!0,onEdit:function(){return c(!0)}}),(0,t.jsxs)(S.ZP,{title:'Edit "'+r.title+'" project',visible:l,onCancel:function(){return c(!1)},onOk:function(){var e=(0,i.Z)((function(e){var n;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:h(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,ue(r,e,a)];case 2:return t.sent(),h(!1),c(!1),[3,4];case 3:throw n=t.sent(),h(!1),n;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),loading:p,initialValues:{title:r.title,description:r.description},children:[(0,t.jsx)(O.Z.Item,{label:"Name",name:"title",rules:[{required:!0,message:"Name is required"},{max:P,message:"Max "+P+" characters"}],children:(0,t.jsx)(_.Z,{placeholder:"Project's name"})}),(0,t.jsx)(O.Z.Item,{label:"Description",name:"description",children:(0,t.jsx)(_.Z.TextArea,{placeholder:"Project's description",showCount:!0,maxLength:120})})]})]})},ce=r(14670),de="Unable to delete project",pe=function(){var e=(0,i.Z)((function(e,n,r){var t,i;return(0,s.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,V.Z.del({id:e.id},{id:n.id})];case 1:return a.sent(),t=e.projects.findIndex((function(e){return e===n.id})),e.projects=(0,T.Z)(e.projects.slice(0,t)).concat((0,T.Z)(e.projects.slice(t+1))),r.mutateOneWorkspace(e),r.delOneProject({id:n.id}),[3,3];case 2:throw i=a.sent(),(0,y.lt)(de,i),i;case 3:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),he=function(e){var n=e.disabled,r=e.workspace,a=e.project,o=e.swr,l=(0,u.useState)(!1),c=l[0],p=l[1];return(0,t.jsx)(B.m1,{disabled:n,loading:c,title:"Delete the project",text:(0,t.jsxs)(t.Fragment,{children:["Are you sure you want to delete the project"," ",(0,t.jsx)(d.Z.Text,{strong:!0,children:a.title}),"?",(0,t.jsx)(ce.Z,{type:"error",message:"If you delete the project, you will no longer be able to restore the archive",style:{marginTop:"16px"}})]}),onDelete:(0,i.Z)((function(){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:p(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,pe(r,a,o)];case 2:return e.sent(),[3,4];case 3:return p(!1),[7];case 4:return[2]}}))}))})},fe=r(78116),me=r(57546),ge=r(238),ve=r(48764).lW,je="Unable to archive project",xe="Unable to unarchive project on server",we="Unable to delete archive",ye="Unable to upload archive",Ze=function(){var e=(0,i.Z)((function(e,n,r){var t,i,a,o;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,V.Z.archive({id:n.id})];case 1:return[4,s.sent().blob()];case 2:return t=s.sent(),i=window.URL.createObjectURL(new Blob([t])),(a=document.createElement("a")).href=i,a.setAttribute("download",n.id+".tanatlocarchive"),a.click(),r.mutateOneProject((0,ee.Z)((0,N.Z)({},n),{archived:!0})),r.mutateOneWorkspace(e),[3,4];case 3:throw o=s.sent(),(0,y.lt)(je,o),o;case 4:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),be=function(){var e=(0,i.Z)((function(e,n,r){var t;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,V.Z.unarchiveFromServer({id:n.id})];case 1:return i.sent(),r.mutateOneProject((0,ee.Z)((0,N.Z)({},n),{archived:!1})),r.mutateOneWorkspace(e),[3,3];case 2:throw t=i.sent(),(0,y.lt)(xe,t),t;case 3:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),ke=function(){var e=(0,i.Z)((function(e){var n;return(0,s.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,V.Z.deleteArchiveFile({id:e.id})];case 1:return r.sent(),[3,3];case 2:return n=r.sent(),(0,y.lt)(we,n),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Oe=function(){var e=(0,i.Z)((function(e){var n;return(0,s.__generator)(this,(function(r){return n=new FileReader,[2,new Promise((function(r){n.addEventListener("load",(function(){r(n.result)})),n.readAsArrayBuffer(e)}))]}))}));return function(n){return e.apply(this,arguments)}}(),_e=function(){var e=(0,i.Z)((function(e,n,r,t){var i,a;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:if("uploading"===r.file.status)return[2,!0];if("done"!==r.file.status)return[3,6];s.label=1;case 1:return s.trys.push([1,4,,5]),[4,Oe(r.file.originFileObj)];case 2:return i=s.sent(),[4,V.Z.unarchiveFromFile({id:n.id},ve.from(i))];case 3:return s.sent(),t.mutateOneProject((0,ee.Z)((0,N.Z)({},n),{archived:!1})),t.mutateOneWorkspace(e),[3,5];case 4:return a=s.sent(),(0,y.lt)(ye,a),[3,5];case 5:case 6:return[2,!1]}}))}));return function(n,r,t,i){return e.apply(this,arguments)}}(),ze=function(e){var n=e.disabled,r=e.workspace,a=e.project,o=e.swr,l=(0,u.useState)(!1),c=l[0],p=l[1],h=(0,u.useState)(!1),f=h[0],m=h[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.ZP,{visible:c,loading:f,title:"Archive",onCancel:function(){return p(!1)},onOk:a.archived?void 0:(0,i.Z)((function(){var e;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:m(!0),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Ze(r,a,o)];case 2:return n.sent(),m(!1),p(!1),[3,4];case 3:throw e=n.sent(),m(!1),e;case 4:return[2]}}))})),okButtonText:"Archive",children:a.archived?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(O.Z.Item,{label:"Restore archive from the server",tooltip:"This will restore the project from the server archive file.",children:(0,t.jsx)(J.Z,{loading:f,onClick:(0,i.Z)((function(){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:m(!0),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,be(r,a,o)];case 2:return e.sent(),m(!1),p(!1),[3,4];case 3:return e.sent(),m(!1),[3,4];case 4:return[2]}}))})),children:"Restore archive from the server"})}),(0,t.jsx)(O.Z.Item,{label:"Restore archive from local file",tooltip:"This will restore the project from your local archive file (.tanatlocarchive file).",children:(0,t.jsx)(fe.Z,{action:"/api/noop",accept:".tanatlocarchive",showUploadList:!1,onChange:function(){var e=(0,i.Z)((function(e){var n;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return[4,_e(r,a,e,o)];case 1:return n=t.sent(),m(n),p(n),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:(0,t.jsx)(J.Z,{children:"Restore archive from archive file"})})}),(0,t.jsx)(O.Z.Item,{label:"Delete archive from the server",tooltip:"This will delete the archive file from the server, you will have to use a local copy to restore the project.",children:(0,t.jsx)(B.m1,{loading:f,bordered:!0,title:"Delete server archive",text:"Are you sure your want to delete the archive from the server?",onDelete:(0,i.Z)((function(){return(0,s.__generator)(this,(function(e){return[2,ke(a)]}))})),children:"Delete server archive"})})]}):(0,t.jsxs)(d.Z.Text,{children:["An archive will be downloaded and the project will not be editable anymore, archive the project \xab",a.title,"\xbb?"]})}),(0,t.jsx)(G.Z,{title:a.archived?"Manage archive":"Archive",children:(0,t.jsx)(J.Z,{disabled:n,type:"link",icon:a.archived?(0,t.jsx)(me.Z,{}):(0,t.jsx)(ge.Z,{}),onClick:function(){return p(!0)}})})]})},Ce=r(48764).lW,Pe=function(e){var n=e.user,r=e.page,i=e.workspace,a=e.projects,s=e.organizations,l=e.filter,c=e.sorter,p=e.swr,h=(0,u.useRef)(null),f=(0,u.useState)(!0),m=f[0],g=f[1],v=(0,u.useState)([]),j=v[0],x=v[1],w=(0,u.useState)(100),y=w[0],b=w[1],O=(0,o.useRouter)();(0,u.useEffect)((function(){var e=h.current;if(e){var n=e.getBoundingClientRect().top,r=window.innerHeight-n;r!==y&&b(r)}})),(0,u.useEffect)((function(){var e=a.map((function(e){var n,r,i,a,s;if(!l||(null===(r=null===(n=e.title)||void 0===n?void 0:n.toLowerCase())||void 0===r?void 0:r.includes(l.toLowerCase()))){var o;o=e.archived?(0,t.jsx)(C.Z,{description:"Archived project"}):e.avatar?(0,t.jsx)("img",{src:e&&Ce.from(e.avatar).toString(),alt:"Tanatloc"}):(0,t.jsx)(C.Z,{image:"images/empty.svg",description:"No preview yet."});var u=(0,t.jsxs)(F.Z,{direction:"vertical",className:"full-width text-left",children:[(0,t.jsxs)(d.Z.Text,{children:[(0,t.jsx)("b",{children:"Created:"})," ",new Date(e.createddate).toLocaleDateString()]}),(0,t.jsxs)(d.Z.Text,{children:[(0,t.jsx)("b",{children:"Last modified:"})," ",new Date(e.lastaccess).toLocaleDateString()]}),e.description&&(0,t.jsx)(d.Z.Paragraph,{ellipsis:{rows:4,tooltip:!0},children:e.description})]}),c=null===e||void 0===e||null===(i=e.owners)||void 0===i?void 0:i.map((function(e){return Y.Z.userToAvatar(e)})),p=null===e||void 0===e||null===(a=e.users)||void 0===a?void 0:a.map((function(e){return Y.Z.userToAvatar(e)})),h=null===e||void 0===e||null===(s=e.groups)||void 0===s?void 0:s.map((function(e){return Y.Z.groupToAvatar(e)}));return(0,ee.Z)((0,N.Z)({},e),{snapshotRender:o,descriptionRender:u,ownersRender:c,usersRender:p,groupsRender:h})}})).filter((function(e){return e}));switch(c){case"alphaAsc":e.sort((function(e,n){return e.title.localeCompare(n.title)}));break;case"alphaDesc":e.sort((function(e,n){return-1*e.title.localeCompare(n.title)}));break;case"modifiedDesc":e.sort((function(e,n){return new Date(n.lastaccess).getTime()-new Date(e.lastaccess).getTime()}))}x(e),g(!1)}),[a,l,c]);var _=function(e){O.push({pathname:"/project",query:{page:r,workspaceId:i.id,projectId:e.id}})};return m||p.loadingProjects?(0,t.jsx)(Z.Z.Simple,{}):j.length?(0,t.jsx)("div",{ref:h,style:{height:y},children:(0,t.jsx)(F.Z,{className:"marginBottom-20",wrap:!0,align:"start",size:20,children:j.map((function(e){var r,a,o,u;return(0,t.jsx)(ie.Z,{title:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z.Paragraph,{ellipsis:{rows:2,tooltip:!0},children:e.title}),e.archived&&(0,t.jsx)(ae.Z,{children:"Archived"})]}),className:"Project-Card"+(e.archived?" archive":""),cover:(0,t.jsxs)(se.Z,{className:"Project-Carousel",dots:{className:"Project-Carousel-dots"},children:[(0,t.jsx)("div",{className:"Project-Carousel-snapshot"+(e.archived?" archive":""),onClick:function(){return!e.archived&&_({id:e.id})},children:e.snapshotRender}),(0,t.jsx)("div",{className:"Project-Carousel-description"+(e.archived?" archive":""),onClick:function(){return!e.archived&&_({id:e.id})},children:e.descriptionRender})]}),actions:[(0,t.jsx)(he,{disabled:!(null===e||void 0===e||null===(r=e.owners)||void 0===r?void 0:r.find((function(e){return e.id===(null===n||void 0===n?void 0:n.id)}))),workspace:{id:i.id,projects:i.projects},project:{id:e.id,title:e.title},swr:{mutateOneWorkspace:p.mutateOneWorkspace,delOneProject:p.delOneProject}},"delete"),(0,t.jsx)(ze,{disabled:!(null===e||void 0===e||null===(a=e.owners)||void 0===a?void 0:a.find((function(e){return e.id===(null===n||void 0===n?void 0:n.id)}))),workspace:{id:i.id},project:{archived:e.archived,id:e.id,title:e.title},swr:{mutateOneWorkspace:p.mutateOneWorkspace,mutateOneProject:p.mutateOneProject}},"archive"),(0,t.jsx)($,{disabled:!(null===e||void 0===e||null===(o=e.owners)||void 0===o?void 0:o.find((function(e){return e.id===(null===n||void 0===n?void 0:n.id)}))),project:{id:e.id,title:e.title,groups:e.groups,users:e.users},organizations:s,swr:{mutateOneProject:p.mutateOneProject},style:{buttonDark:!0}},"share"),(0,t.jsx)(le,{disabled:!(null===e||void 0===e||null===(u=e.owners)||void 0===u?void 0:u.find((function(e){return e.id===(null===n||void 0===n?void 0:n.id)}))),project:{id:e.id,title:e.title,description:e.description},swr:{mutateOneProject:p.mutateOneProject}},"edit")],children:(0,t.jsxs)("div",{style:{padding:"6px 0",display:"grid",gridTemplateColumns:"10fr 1fr 20fr",gridTemplateRows:"auto auto"},children:[(0,t.jsx)("div",{children:"Admin:"}),(0,t.jsx)("div",{}),(0,t.jsx)("div",{children:"Shared with:"}),(0,t.jsx)(W.C.Group,{maxCount:5,children:e.ownersRender}),(0,t.jsx)(k.Z,{type:"vertical",style:{height:"80%",borderColor:"#f0f0f0"}}),(0,t.jsxs)(W.C.Group,{children:[e.usersRender,e.groupsRender]})]})},e.id)}))})}):(0,t.jsx)(C.Z,{image:"images/empty.svg",className:"Project-Empty",description:l?(0,t.jsxs)(t.Fragment,{children:["No project found with the current search"," ",(0,t.jsx)("span",{className:"Project-Empty-search-value",children:l}),"..."]}):(0,t.jsx)(t.Fragment,{children:"No project for now... Get started!"})})},Se="Unable to update workspace",Ne=function(){var e=(0,i.Z)((function(e,n,r){var t,i;return(0,s.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=Y.Z.deepCopy(e),e.name=n.name,[4,D.update({id:e.id},[{key:"name",value:n.name}])];case 1:return a.sent(),r.mutateOneWorkspace(t),[3,3];case 2:throw i=a.sent(),(0,y.lt)(Se,i),i;case 3:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),Te=function(e){var n=e.workspace,r=e.swr,a=(0,u.useState)(!1),o=a[0],l=a[1],c=(0,u.useState)(!1),d=c[0],p=c[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.w6,{bordered:!0,dark:!0,onEdit:function(){return l(!0)}}),(0,t.jsx)(S.ZP,{visible:o,loading:d,title:"Edit the workspace",initialValues:{name:n.name},onCancel:function(){return l(!1)},onOk:function(){var e=(0,i.Z)((function(e){var t;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:p(!0),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Ne(n,e,r)];case 2:return i.sent(),p(!1),l(!1),[3,4];case 3:throw t=i.sent(),p(!1),t;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:(0,t.jsx)(O.Z.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is required"},{max:P,message:"Max "+P+" characters"}],children:(0,t.jsx)(_.Z,{placeholder:"Workspace's name"})})})]})},Ee="Unable to delete workspace",Re=function(){var e=(0,i.Z)((function(e,n){var r;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,D.del({id:e.id})];case 1:return t.sent(),n.delOneWorkspace({id:e.id}),[3,3];case 2:throw r=t.sent(),(0,y.lt)(Ee,r),r;case 3:return[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),Ue=function(e){var n=e.workspace,r=e.swr,a=(0,u.useState)(!1),o=a[0],l=a[1];return(0,t.jsx)(B.m1,{bordered:!0,loading:o,text:"The projects contained in this workspace will be lost.",onDelete:(0,i.Z)((function(){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:l(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Re(n,r)];case 2:return e.sent(),[3,4];case 3:return l(!1),[7];case 4:return[2]}}))}))})},Ae="Error while loading projects",Ie=function(e){var n,r,i,s,o,c,d=e.user,p=e.page,h=e.workspace,f=e.organizations,m=e.swr,g=(0,u.useState)(),v=g[0],j=g[1],x=(0,u.useState)(),w=x[0],Z=x[1],k=(0,a.Z)(V.Z.useProjects(null===h||void 0===h?void 0:h.projects),2),O=k[0],C=k[1],P=C.addOneProject,S=C.delOneProject,N=C.mutateOneProject,T=C.errorProjects,E=C.loadingProjects;return(0,u.useEffect)((function(){T&&(0,y.lt)(Ae,T)}),[T]),(0,t.jsxs)(l.Z,{className:"no-scroll",children:[(0,t.jsx)(b.Z,{className:"inWorkspace-PageHeader",backIcon:!1,footer:(0,t.jsxs)(F.Z,{direction:"horizontal",size:"large",className:"full-width lastchild-marginLeft-auto",children:[(0,t.jsx)(_.Z,{placeholder:"Enter a project name (case sensitive)",value:v,onChange:function(e){return j(e.target.value)},style:{width:500},suffix:(0,t.jsx)(L.Z,{className:"text-light"})}),(null===h||void 0===h||null===(n=h.owners)||void 0===n?void 0:n.find((function(e){return e.id===d.id})))?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(te,{workspace:{id:h.id,projects:h.projects},swr:{mutateOneWorkspace:m.mutateOneWorkspace,addOneProject:P}}),(0,t.jsxs)(F.Z,{size:8,children:[(0,t.jsx)(Te,{workspace:{id:h.id,name:h.name},swr:{mutateOneWorkspace:m.mutateOneWorkspace}}),(0,t.jsx)($,{workspace:{id:h.id,name:h.name,groups:h.groups,users:h.users},organizations:f,swr:{mutateOneWorkspace:m.mutateOneWorkspace},style:{buttonDark:!0,buttonBordered:!0}}),(0,t.jsx)(Ue,{workspace:{id:h.id},swr:{delOneWorkspace:m.delOneWorkspace}})]})]}):(0,t.jsx)("div",{})]}),children:(null===(r=h.users)||void 0===r?void 0:r.length)||(null===(i=h.groups)||void 0===i?void 0:i.length)?(0,t.jsxs)("div",{className:"inWorkspace-shared",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"marginRight-10",children:"Admin:"}),(0,t.jsx)(W.C.Group,{maxCount:5,children:null===(s=h.owners)||void 0===s?void 0:s.map((function(e){return Y.Z.userToAvatar(e)}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"marginRight-10",children:"Shared with:"}),(0,t.jsx)(W.C.Group,{maxCount:5,children:null===(o=h.users)||void 0===o?void 0:o.map((function(e){return Y.Z.userToAvatar(e)}))}),(0,t.jsx)(W.C.Group,{maxCount:5,children:null===(c=h.groups)||void 0===c?void 0:c.map((function(e){return Y.Z.groupToAvatar(e)}))})]})]}):null}),(0,t.jsx)(z.Z,{className:"inWorkspace-Tabs",items:[{key:"modifiedDesc",label:"Last modified"},{key:"alphaAsc",label:"Name (A-Z)"},{key:"alphaDesc",label:"Name (Z-A)"}],defaultActiveKey:"modifiedDesc",onChange:function(e){return Z(e)}}),(0,t.jsx)(l.Z.Content,{className:"scroll",children:(0,t.jsx)(Pe,{user:d,page:p,workspace:{id:h.id,projects:h.projects},projects:O,organizations:f,filter:v,sorter:w,swr:{mutateOneWorkspace:m.mutateOneWorkspace,delOneProject:S,mutateOneProject:N,loadingProjects:E}})})]})},qe="Unable to add workspace",De=function(){var e=(0,i.Z)((function(e,n){var r,t;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,D.add(e)];case 1:return r=i.sent(),n.addOneWorkspace(r),[3,3];case 2:throw t=i.sent(),(0,y.lt)(qe,t),t;case 3:return[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),Fe=function(e){var n=e.swr,r=(0,u.useState)(!1),a=r[0],o=r[1],l=(0,u.useState)(!1),c=l[0],d=l[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.HS,{onAdd:function(){return d(!0)},children:"Create a new workspace"}),(0,t.jsx)(S.ZP,{visible:c,loading:a,title:"Create a new workspace",onCancel:function(){return d(!1)},onOk:function(){var e=(0,i.Z)((function(e){var r;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:o(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,De(e,n)];case 2:return t.sent(),o(!1),d(!1),[3,4];case 3:throw r=t.sent(),o(!1),r;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:(0,t.jsx)(O.Z.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is required"},{max:P,message:"Max "+P+" characters"}],children:(0,t.jsx)(_.Z,{placeholder:"Workspace's name"})})})]})},We="Unable to add workspace",Le=function(){var e=(0,i.Z)((function(e,n,r){var t,i;return(0,s.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,D.add(n)];case 1:return t=a.sent(),r.addOneWorkspace(t),e.push({pathname:"/dashboard",query:{page:"workspaces",workspaceId:t.id}}),[3,3];case 2:throw i=a.sent(),(0,y.lt)(We,i),i;case 3:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),He=function(e){var n=e.user,r=e.workspaces,a=e.organizations,c=e.swr,p=(0,u.useState)(!1),h=p[0],f=p[1],m=(0,u.useState)(!1),g=m[0],v=m[1],j=(0,o.useRouter)(),x=j.query,w=x.page,y=x.workspaceId;return(0,t.jsxs)(l.Z,{className:"inDashboard Workspace no-scroll",children:[(0,t.jsx)(b.Z,{className:"inDashboard-PageHeader",backIcon:!1,title:(0,t.jsx)(d.Z.Title,{level:2,className:"inDashboard-PageHeader-title",children:"Workspaces"}),footer:(0,t.jsx)(k.Z,{})}),(0,t.jsx)(l.Z.Content,{className:"no-scroll",children:r.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.ZP,{visible:h,loading:g,title:"Create a new workspace",onCancel:function(){return f(!1)},onOk:function(){var e=(0,i.Z)((function(e){var n;return(0,s.__generator)(this,(function(r){switch(r.label){case 0:v(!0),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Le(j,e,c)];case 2:return r.sent(),v(!1),f(!1),[3,4];case 3:throw n=r.sent(),v(!1),n;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:(0,t.jsx)(O.Z.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is required"},{max:P,message:"Max "+P+" characters"}],children:(0,t.jsx)(_.Z,{placeholder:"Workspace's name"})})}),(0,t.jsx)(z.Z,{type:"editable-card",className:"inDashboard-Tabs no-scroll",items:r.map((function(e){return{key:e.id,label:e.name,className:"no-scroll",closable:!1,children:(0,t.jsx)(Ie,{user:n,page:w||At.workspaces.key,workspace:{id:e.id,name:e.name,projects:e.projects,owners:e.owners,users:e.users,groups:e.groups},organizations:a,swr:{delOneWorkspace:c.delOneWorkspace,mutateOneWorkspace:c.mutateOneWorkspace}})}})),defaultActiveKey:y||"1",onEdit:function(){return f(!0)}})]}):(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(C.Z,{image:"images/empty.svg",description:"No workspace for now. Get started !",children:(0,t.jsx)(Fe,{swr:{addOneWorkspace:c.addOneWorkspace}})})})})]})},Ge=r(87547),Je=r(88484),Me=r(81891),Be=r(67169),Ye=r(41686),Ve=r(48764).lW,Xe="Unable to update informations",Ke="Unable to upload image",Qe="Supported formats: jpg, png",$e="Image must be smaller than 5MB",en=function(e){var n="image/jpeg"===e.type||"image/png"===e.type;n||(0,y.lt)(Qe);var r=e.size/1024/1024<1;return r||(0,y.lt)($e),n&&r},nn=function(){var e=(0,i.Z)((function(e){var n;return(0,s.__generator)(this,(function(r){return n=new FileReader,[2,new Promise((function(r){n.addEventListener("load",(function(){r(n.result)})),n.readAsDataURL(e)}))]}))}));return function(n){return e.apply(this,arguments)}}(),rn=function(){var e=(0,i.Z)((function(e,n,r){var t,i;return(0,s.__generator)(this,(function(a){switch(a.label){case 0:return"uploading"!==n.file.status?[3,1]:[2,!0];case 1:if("done"!==n.file.status)return[3,7];a.label=2;case 2:return a.trys.push([2,5,,6]),[4,nn(n.file.originFileObj)];case 3:return t=a.sent(),[4,Ye.Z.add({name:n.file.name,uid:n.file.uid,data:t})];case 4:return a.sent(),r.mutateUser((0,ee.Z)((0,N.Z)({},e),{avatar:Ve.from(t)})),[3,6];case 5:return i=a.sent(),(0,y.lt)(Ke,i),[3,6];case 6:case 7:return[2,!1];case 8:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),tn=function(){var e=(0,i.Z)((function(e,n,r){var t,i;return(0,s.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=[],e.email!==n.email&&t.push({key:"email",value:n.email}),e.firstname!==n.firstname&&t.push({key:"firstname",value:n.firstname}),e.lastname!==n.lastname&&t.push({key:"lastname",value:n.lastname}),t.length?[4,Be.Z.update(t)]:[2];case 1:return a.sent(),r.mutateUser({email:n.email,firstname:n.firstname,lastname:n.lastname}),t.find((function(e){return"email"===e.key}))&&(0,y.Ur)("Changes saved","A validation email has been send to "+n.email),[3,3];case 2:throw i=a.sent(),new Me.H({title:Xe,err:i});case 3:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),an=function(e){var n=e.user,r=e.swr,a=(0,u.useState)(!1),o=a[0],l=a[1],c=(0,u.useState)(!1),d=c[0],p=c[1],h=(0,u.useState)(),f=h[0],m=h[1];return(0,t.jsx)(ie.Z,{title:"Contact Details",children:(0,t.jsxs)(F.Z,{direction:"horizontal",className:"Account-Information",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(W.C,{size:128,src:n.avatar&&Ve.from(n.avatar).toString(),icon:(0,t.jsx)(Ge.Z,{})}),(0,t.jsx)(fe.Z,{action:"/api/noop",accept:".jpg,.png",showUploadList:!1,beforeUpload:en,onChange:function(){var e=(0,i.Z)((function(e){var t;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:return[4,rn(n,e,r)];case 1:return t=i.sent(),l(t),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:(0,t.jsx)(J.Z,{loading:o,icon:(0,t.jsx)(Je.Z,{}),children:"Upload new"})})]}),(0,t.jsx)("div",{children:(0,t.jsxs)(O.Z,(0,ee.Z)((0,N.Z)({},{labelCol:{span:4}}),{className:"max-width-500",initialValues:{email:n.email,firstname:n.firstname||"",lastname:n.lastname||""},onFinish:function(){var e=(0,i.Z)((function(e){var t;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:p(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,tn(n,e,r)];case 2:return i.sent(),m(null),[3,5];case 3:return t=i.sent(),m(t),[3,5];case 4:return p(!1),[7];case 5:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:[(0,t.jsx)(O.Z.Item,{label:"Email",name:"email",rules:[x()()?{type:"email",message:"This is not a valid email"}:void 0,{max:P,message:"Max "+P+" characters"}].filter((function(e){return e})),children:(0,t.jsx)(_.Z,{disabled:x()()})}),(0,t.jsx)(O.Z.Item,{label:"First name",name:"firstname",rules:[{max:P,message:"Max "+P+" characters"}],children:(0,t.jsx)(_.Z,{})}),(0,t.jsx)(O.Z.Item,{label:"Last name",name:"lastname",rules:[{max:P,message:"Max "+P+" characters"}],children:(0,t.jsx)(_.Z,{})}),(0,t.jsx)(y.Xq,{error:f}),(0,t.jsx)(O.Z.Item,(0,ee.Z)((0,N.Z)({},{wrapperCol:{offset:4}}),{children:(0,t.jsx)(J.Z,{loading:d,type:"primary",htmlType:"submit",children:"Save changes"})}))]}))})]})})},sn=r(51986),on="Unable to check password",un="Unable to update password",ln="Password and confirmation mismatch",cn="Current password is not valid",dn=function(){var e=(0,i.Z)((function(e,n){var r,t,i;return(0,s.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Be.Z.check({email:e.email,password:n.password})];case 1:return r=a.sent(),[3,3];case 2:throw t=a.sent(),new Me.H({title:on,err:t});case 3:if(!r.valid)throw new Me.H({title:cn});a.label=4;case 4:return a.trys.push([4,6,,7]),[4,Be.Z.update([{type:"crypt",key:"password",value:n.newPassword}])];case 5:return a.sent(),(0,y.Ur)("Your password has been changed successfully"),[3,7];case 6:throw i=a.sent(),new Me.H({title:un,err:i});case 7:return[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),pn=function(e){var n=e.user,r=(0,u.useState)(!1),a=r[0],o=r[1],l=(0,u.useState)(),c=l[0],d=l[1];return(0,t.jsx)(ie.Z,{title:"Your Password",children:(0,t.jsxs)(O.Z,(0,ee.Z)((0,N.Z)({},{labelCol:{offset:2},wrapperCol:{offset:2}}),{className:"max-width-500",layout:"vertical",onFinish:function(){var e=(0,i.Z)((function(e){var r;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:o(!0),t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,dn(n,e)];case 2:return t.sent(),d(null),[3,5];case 3:return r=t.sent(),d(r),[3,5];case 4:return o(!1),[7];case 5:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),name:"passwordForm",children:[(0,t.jsx)(O.Z.Item,{label:"Current password",name:"password",rules:[{required:!0,message:"Current password is required"}],children:(0,t.jsx)(_.Z.Password,{placeholder:"Current password"})}),(0,t.jsx)(sn.o,{name:"newPassword",label:"New password",inputPlaceholder:"Enter a new password",required:!0}),(0,t.jsx)(O.Z.Item,{label:"Password confirmation",name:"passwordConfirm",rules:[{required:!0,message:"Password confirmation is required"},function(e){var n=e.getFieldValue;return{validator:function(e,r){return r&&n("newPassword")!==r?Promise.reject(ln):Promise.resolve()}}}],children:(0,t.jsx)(_.Z.Password,{placeholder:"Confirm your new password"})}),(0,t.jsx)(y.Xq,{error:c}),(0,t.jsx)(O.Z.Item,{children:(0,t.jsx)(F.Z,{children:(0,t.jsx)(J.Z,{type:"primary",htmlType:"submit",loading:a,children:"Modify password"})})})]}))})},hn=x()()?"http://localhost:3000":"",fn=function(){var e=(0,i.Z)((function(){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:return[4,fetch(hn+"/api/logout")];case 1:return e.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),mn="Unable to delete user",gn=function(){var e=(0,i.Z)((function(e){var n;return(0,s.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,Be.Z.del()];case 1:return r.sent(),[4,fn()];case 2:return r.sent(),e.clearUser(),[3,4];case 3:throw n=r.sent(),(0,y.lt)(mn,n),n;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),vn=function(e){var n=e.swr,r=(0,u.useState)(!1),a=r[0],o=r[1];return(0,t.jsx)(ie.Z,{title:"Delete your account",children:(0,t.jsx)(B.m1,{title:"Delete your account",text:"This action cannot be undone. If you delete your account, you will permanently lose your workspaces and projects.",bordered:!0,loading:a,onDelete:(0,i.Z)((function(){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:o(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,gn(n)];case 2:return e.sent(),[3,4];case 3:return o(!1),[7];case 4:return[2]}}))})),children:"Delete your account"})})},jn=r(11382),xn=r(4687),wn=r(45697),yn=r.n(wn),Zn=r(40038),bn=r(24443),kn="Unable to update plugins",On=function(){var e=(0,i.Z)((function(e,n,r,t){var i,a,o,u,l;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,5,,6]),n?(a=Y.Z.deepCopy(e),Object.keys(r).forEach((function(e){a.configuration[e].value=r[e]})),a.needReInit=!0,[4,bn.Z.update(a)]):[3,2];case 1:return s.sent(),null===(i=t.mutateOnePlugin)||void 0===i||i.call(t,a),[3,4];case 2:return u=Y.Z.deepCopy(e),Object.keys(r).forEach((function(e){u.configuration[e].value=r[e]})),[4,bn.Z.add(u)];case 3:s.sent(),null===(o=t.addOnePlugin)||void 0===o||o.call(t,u),s.label=4;case 4:return[3,6];case 5:throw l=s.sent(),(0,y.lt)(kn,l),l;case 6:return[2]}}))}));return function(n,r,t,i){return e.apply(this,arguments)}}(),_n=function(e){var n=e.plugin,r=e.swr,a=e.edit,o=(0,u.useState)(!1),l=o[0],c=o[1],d=(0,u.useState)(!1),p=d[0],h=d[1],f=(0,u.useState)({}),m=f[0],g=f[1];return(0,u.useEffect)((function(){var e={};Object.keys(n.configuration).forEach((function(r){var t;e[r]=null!==(t=n.configuration[r].value)&&void 0!==t?t:n.configuration[r].default})),g(e)}),[null===n||void 0===n?void 0:n.configuration]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.ZP,{title:n.name,visible:l,initialValues:m,onCancel:function(){return c(!1)},onOk:function(){var e=(0,i.Z)((function(e){var t;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:h(!0),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,On(n,!!a,e,r)];case 2:return i.sent(),h(!1),c(!1),[3,4];case 3:throw t=i.sent(),h(!1),t;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),loading:p,children:Object.keys(n.configuration).map((function(e){var r=n.configuration[e];return"input"===r.type?function(e,n){return(0,t.jsx)(O.Z.Item,{name:n,label:e.label,htmlFor:"input-"+n,tooltip:e.tooltip,rules:e.rules,children:(0,t.jsx)(_.Z,(0,N.Z)({id:"input-"+n,autoComplete:"off"},e.props||{}))},e.label)}(r,e):"textarea"===r.type?function(e,n){return(0,t.jsx)(O.Z.Item,{name:n,label:e.label,htmlFor:"input-"+n,tooltip:e.tooltip,rules:e.rules,children:(0,t.jsx)(_.Z.TextArea,(0,N.Z)({id:"input-"+n,autoComplete:"off"},e.props||{}))},e.label)}(r,e):"password"===r.type?function(e,n){return(0,t.jsx)(O.Z.Item,{name:n,label:e.label,htmlFor:"input-"+n,tooltip:e.tooltip,rules:e.rules,children:(0,t.jsx)(_.Z,(0,N.Z)({id:"input-"+n,type:"password",autoComplete:"off"},e.props||{}))},e.label)}(r,e):"select"===r.type?function(e,n){return(0,t.jsx)(O.Z.Item,{name:n,label:e.label,htmlFor:"select-"+n,tooltip:e.tooltip,rules:e.rules,children:(0,t.jsx)(Zn.Z,{id:"select-"+n,children:e.options.map((function(n){return(0,t.jsx)(Zn.Z.Option,(0,ee.Z)((0,N.Z)({value:n},e.props||{}),{children:n}),n)}))})},e.label)}(r,e):(0,t.jsx)(t.Fragment,{})}))}),a?(0,t.jsx)(B.w6,{onEdit:function(){return c(!0)},children:"Edit"}):(0,t.jsxs)(B.HS,{onAdd:function(){return c(!0)},children:["Add a new \xab",n.name,"\xbb configuration"]})]})};_n.propTypes={plugin:yn().exact({uuid:yn().string,key:yn().string.isRequired,name:yn().string.isRequired,needInit:yn().bool,configuration:yn().object.isRequired,inUseConfiguration:yn().object}).isRequired,swr:yn().exact({addOnePlugin:yn().func,mutateOnePlugin:yn().func}).isRequired,edit:yn().bool};var zn=_n,Cn="Unable to delete plugin",Pn=function(){var e=(0,i.Z)((function(e,n){var r;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,bn.Z.del({uuid:e.uuid})];case 1:return t.sent(),n.delOnePlugin(e),[3,3];case 2:throw r=t.sent(),(0,y.lt)(Cn,r),r;case 3:return[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),Sn=function(e){var n,r=e.plugin,a=e.swr,o=(0,u.useState)(!1),l=o[0],c=o[1];return(0,t.jsx)(B.m1,{loading:l,title:"Delete plugin",text:(0,t.jsxs)(t.Fragment,{children:["Are you sure you want to delete the plugin"," ",(0,t.jsx)(d.Z.Text,{strong:!0,children:null===(n=r.configuration.name)||void 0===n?void 0:n.value}),"?"]}),onDelete:(0,i.Z)((function(){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:c(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Pn(r,a)];case 2:return e.sent(),[3,4];case 3:return c(!1),[7];case 4:return[2]}}))})),children:"Delete"})};Sn.propTypes={plugin:yn().exact({uuid:yn().string.isRequired,configuration:yn().object.isRequired}).isRequired,swr:yn().exact({delOnePlugin:yn().func.isRequired}).isRequired};var Nn=Sn,Tn=function(e){var n=e.plugin,r=e.plugins,i=e.swr,a=(0,u.useState)([]),s=a[0],o=a[1];return(0,u.useEffect)((function(){var e=r.map((function(e){var r;if(e.key===n.key){var a=e.configuration,s=Object.keys(a).map((function(e){if("name"!==e){var n;if("textarea"===a[e].type){var r=a[e].value;n=(0,t.jsx)(d.Z.Paragraph,{children:(0,t.jsx)("pre",{children:(0,t.jsx)("code",{children:r})})})}else n="password"===a[e].type?(0,t.jsx)(d.Z.Text,{children:"******"}):(0,t.jsx)(d.Z.Text,{children:a[e].value});return(0,t.jsxs)(d.Z.Paragraph,{children:[(0,t.jsxs)(d.Z.Text,{strong:!0,children:[a[e].label,":"]})," ",n]},e)}})).filter((function(e){return e}));return(0,t.jsx)(ie.Z,{title:null===(r=a.name)||void 0===r?void 0:r.value,actions:[(0,t.jsx)(Nn,{plugin:{uuid:e.uuid,configuration:e.configuration},swr:{delOnePlugin:i.delOnePlugin}},"delete"),(0,t.jsx)(zn,{plugin:{uuid:e.uuid,key:e.key,name:e.name,needInit:e.needInit,configuration:e.configuration,inUseConfiguration:e.inUseConfiguration},swr:{mutateOnePlugin:i.mutateOnePlugin},edit:!0},"plugin")],children:s.length?s:(0,t.jsx)(d.Z.Text,{children:"No configuration data"})},e.uuid)}})).filter((function(e){return e}));o(e)}),[n,r,i]),(0,t.jsx)(F.Z,{direction:"horizontal",wrap:!0,size:20,children:s})};Tn.propTypes={plugin:yn().exact({key:yn().string.isRequired}).isRequired,plugins:yn().arrayOf(yn().exact({key:yn().string.isRequired,uuid:yn().string.isRequired,name:yn().string.isRequired,configuration:yn().object.isRequired,inUseConfiguration:yn().object,data:yn().object,needInit:yn().bool,needReInit:yn().bool}).isRequired).isRequired,swr:yn().exact({delOnePlugin:yn().func.isRequired,mutateOnePlugin:yn().func.isRequired}).isRequired};var En=Tn,Rn="Error while loading plugins",Un=function(e){var n=e.plugin,r=(0,a.Z)(bn.Z.usePlugins(),2),i=r[0],s=r[1],o=s.addOnePlugin,l=s.delOnePlugin,c=s.mutateOnePlugin,d=s.errorPlugins,p=s.loadingPlugins;return(0,u.useEffect)((function(){d&&(0,y.lt)(Rn,d)}),[d]),p?(0,t.jsx)(jn.Z,{}):(0,t.jsxs)(F.Z,{direction:"vertical",className:"full-width",children:[(0,t.jsx)(zn,{plugin:{uuid:n.uuid,key:n.key,name:n.name,needInit:n.needInit,configuration:n.configuration,inUseConfiguration:n.inUseConfiguration},swr:{addOnePlugin:o}}),(0,t.jsx)(En,{plugin:{key:n.key},plugins:i,swr:{delOnePlugin:l,mutateOnePlugin:c}})]})};Un.propTypes={plugin:yn().exact({key:yn().string.isRequired,name:yn().string.isRequired,needInit:yn().bool,configuration:yn().object.isRequired,inUseConfiguration:yn().object}).isRequired};var An=Un,In="Unable to load plugins",qn=function(){var e=(0,i.Z)((function(){var e,n,r;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,xn.Z.list()];case 1:return e=i.sent(),(n=e.filter((function(e){return"HPC"===e.category}))).length?[2,n.map((function(e){return(0,t.jsx)(ie.Z,{title:e.name,children:(0,t.jsx)(An,{plugin:{key:e.key,name:e.name,needInit:!!e.needInit,configuration:e.configuration,inUseConfiguration:e.inUseConfiguration}})},e.key)}))]:[2,[(0,t.jsx)(ie.Z,{title:"No access",children:"You do not have access to any HPC plugin. Request it."},"no-access")]];case 2:return r=i.sent(),(0,y.lt)(In,r),[2,[(0,t.jsx)(ie.Z,{title:"Error",children:"Something led to an error. Please try again later."},"error")]];case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),Dn=function(){var e=(0,u.useState)([(0,t.jsx)(ie.Z,{title:"Loading",children:(0,t.jsx)(jn.Z,{})},"loading")]),n=e[0],r=e[1];return(0,u.useEffect)((function(){qn().then(r)}),[]),(0,t.jsx)(F.Z,{direction:"vertical",className:"full-width scroll",size:20,children:n})},Fn=function(e){var n=e.user,r=e.swr,i=(0,o.useRouter)(),a=i.query.tab,s=[];return s.push({key:"personal",label:"Personal Information",children:(0,t.jsxs)(F.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(an,{user:{email:n.email,firstname:n.firstname,lastname:n.lastname,avatar:n.avatar},swr:{mutateUser:r.mutateUser}}),!x()()&&(0,t.jsx)(vn,{swr:{clearUser:r.clearUser}})]})}),x()()||s.push({key:"security",label:"Security",children:(0,t.jsx)(F.Z,{direction:"vertical",className:"full-width",size:20,children:(0,t.jsx)(pn,{user:{email:n.email}})})}),s.push({key:"hpc",label:"HPC Providers",children:(0,t.jsx)(Dn,{})}),(0,t.jsxs)(l.Z,{className:"inDashboard Account no-scroll",children:[(0,t.jsx)(b.Z,{className:"inDashboard-PageHeader",backIcon:!1,title:(0,t.jsx)(d.Z.Title,{level:2,className:"inDashboard-PageHeader-title",children:"Account Settings"}),footer:(0,t.jsx)(k.Z,{})}),(0,t.jsx)(l.Z.Content,{className:"no-scroll",children:(0,t.jsx)(z.Z,{className:"inDashboard-Tabs no-scroll",type:"card",items:s,defaultActiveKey:a||"personal",onChange:function(e){return function(e,n){e.replace({pathname:"/dashboard",query:{page:"account",tab:n}})}(i,e)}})})]})},Wn=r(82826),Ln=function(){var e=(0,i.Z)((function(e){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,R.R)("/api/organization",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(e)})];case 1:return[2,n.sent().json()]}}))}));return function(n){return e.apply(this,arguments)}}(),Hn=function(){var e=(0,i.Z)((function(e,n){return(0,s.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,R.R)("/api/organization",{method:"PUT",body:JSON.stringify({organization:e,data:n})})];case 1:return r.sent(),[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),Gn=function(){var e=(0,i.Z)((function(e){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,R.R)("/api/organization",{method:"DELETE",body:JSON.stringify(e)})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Jn=function(){var e=(0,i.Z)((function(e){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,R.R)("/api/organization/"+e.id,{method:"PUT"})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Mn=function(){var e=(0,i.Z)((function(e){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,R.R)("/api/organization/"+e.id,{method:"POST"})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Bn=function(){var e=(0,i.Z)((function(e){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,R.R)("/api/organization/"+e.id,{method:"DELETE"})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Yn={useOrganizations:function(){var e=(0,E.ZP)("/api/organizations",R._),n=e.data,r=e.error,t=e.mutate,i=!n,a=(null===n||void 0===n?void 0:n.organizations)||[],s=(0,u.useCallback)((function(e){var n=(0,T.Z)(a).concat([(0,ee.Z)((0,N.Z)({},e),{pendingowners:[],users:[],pendingusers:[],groups:[]})]);t({organizations:n})}),[a,t]),o=(0,u.useCallback)((function(e){var n=a.filter((function(n){return n.id!==e.id}));t({organizations:n})}),[a,t]),l=(0,u.useCallback)((function(e){var n=a.map((function(n){return n.id===e.id&&(n=(0,N.Z)({},n,e)),n}));t({organizations:n})}),[a,t]);return[a,{addOneOrganization:s,delOneOrganization:o,mutateOneOrganization:l,errorOrganizations:r,loadingOrganizations:i}]},add:Ln,update:Hn,del:Gn,accept:Jn,decline:Mn,quit:Bn},Vn=Yn,Xn=r(5027),Kn="Unable to add user",Qn="This user already exists or its invite is pending",$n=function(){var e=(0,i.Z)((function(e,n,r,t){var i,a,o;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:if(i=function(e,n){var r,t,i,a,s=null===(r=n.owners)||void 0===r?void 0:r.find((function(n){return n.email===e.email})),o=null===(t=n.pendingowners)||void 0===t?void 0:t.find((function(n){return n.email===e.email})),u=null===(i=n.users)||void 0===i?void 0:i.find((function(n){return n.email===e.email})),l=null===(a=n.pendingusers)||void 0===a?void 0:a.find((function(n){return n.email===e.email}));return s||o||u||l}(r,e),i)throw(0,y.lt)(Qn),new Error(Qn);s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Vn.update(e,[{key:n,type:"array",method:"append",value:r.email.trim()}])];case 2:return s.sent(),(a=Y.Z.deepCopy(e))[n]=(0,T.Z)(a[n]).concat([{email:r.email}]),t.mutateOneOrganization(a),[3,4];case 3:throw o=s.sent(),(0,y.lt)(Kn,o),o;case 4:return[2]}}))}));return function(n,r,t,i){return e.apply(this,arguments)}}(),er=function(e){var n=e.title,r=e.organization,a=e.dBkey,o=e.swr,l=(0,u.useState)(!1),c=l[0],d=l[1],p=(0,u.useState)(!1),h=p[0],f=p[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.ZP,{visible:c,loading:h,title:n,onCancel:function(){return d(!1)},onOk:function(){var e=(0,i.Z)((function(e){var n;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:f(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,$n(r,a,e,o)];case 2:return t.sent(),f(!1),d(!1),[3,4];case 3:throw n=t.sent(),f(!1),n;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),children:(0,t.jsx)(O.Z.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Email is required"}],children:(0,t.jsx)(_.Z,{})})}),(0,t.jsx)(B.HS,{onAdd:function(){return d(!0)},children:n})]})},nr="Unable to delete user",rr=function(){var e=(0,i.Z)((function(e,n,r,t){var i,a;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,Vn.update(e,[{key:r,type:"array",method:"remove",value:n.id}])];case 1:return s.sent(),(i=Y.Z.deepCopy(e))[r]=i[r].filter((function(e){return e.id!==n.id})),t.mutateOneOrganization(i),[3,3];case 2:throw a=s.sent(),(0,y.lt)(nr,a),a;case 3:return[2]}}))}));return function(n,r,t,i){return e.apply(this,arguments)}}(),tr=function(e){var n=e.disabled,r=e.user,a=e.organization,o=e.dBkey,l=e.swr,c=(0,u.useState)(!1),p=c[0],h=c[1],f=(0,u.useCallback)((function(e){return e.firstname||e.lastname?e.firstname+" "+e.lastname:e.email}),[]);return(0,t.jsx)(B.m1,{bordered:!0,disabled:n,title:"Delete organization",text:(0,t.jsxs)(t.Fragment,{children:["Are you sure you want to delete the user"," ",(0,t.jsx)(d.Z.Text,{strong:!0,children:f(r)}),"?"]}),loading:p,onDelete:(0,i.Z)((function(){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:h(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,rr(a,r,o,l)];case 2:return e.sent(),[3,4];case 3:return h(!1),[7];case 4:return[2]}}))}))})},ir=function(e){var n,r,i,a=e.organization,s=e.swr,o=(0,u.useState)(),l=o[0],c=o[1],d=(0,u.useState)(),p=d[0],h=d[1],f=(0,u.useRef)(null),m=(0,u.useRef)(null),g=(0,u.useRef)(null),v=[{key:"avatar",dataIndex:"avatar",render:function(e,n){return Y.Z.userToAvatar(n)}},{key:"lastname",title:"Lastname",dataIndex:"lastname"},{key:"firstname",title:"Firstname",dataIndex:"firstname"},{key:"email",title:"Email",dataIndex:"email"}],j=(0,T.Z)(v).concat([{key:"actions",title:"Actions",align:"center",fixed:"right",width:75,render:function(e){return(0,t.jsx)(tr,{disabled:a.owners.length<2&&!e.pending,user:{id:e.id,email:e.email},organization:{id:a.id,owners:a.owners,pendingowners:a.pendingowners,users:a.users,pendingusers:a.pendingusers},dBkey:e.pending?"pendingowners":"owners",swr:{mutateOneOrganization:s.mutateOneOrganization}})}}]),x=(0,T.Z)(v).concat([{key:"actions",title:"Actions",align:"center",fixed:"right",width:75,render:function(e){return(0,t.jsx)(tr,{user:{id:e.id,email:e.email,firstname:e.firstname,lastname:e.lastname},organization:{id:a.id,owners:a.owners,pendingowners:a.pendingowners,users:a.users,pendingusers:a.pendingusers},dBkey:e.pending?"pendingusers":"users",swr:{mutateOneOrganization:s.mutateOneOrganization}})}}]),w=(0,u.useCallback)((function(){var e=f.current;if(e){var n=(e.clientHeight-15)/2-39-12-32-20-75,r=e.clientHeight,t=e.clientHeight;c(r>n?{y:n}:void 0),h(t>n?{y:n}:void 0)}}),[]);return(0,u.useEffect)((function(){return window.addEventListener("resize",w),function(){window.removeEventListener("resize",w)}}),[w]),(0,u.useEffect)((function(){w()}),[a,w]),(0,t.jsx)("div",{ref:f,style:{height:"calc(100vh - 228px)"},children:(0,t.jsxs)(F.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(ie.Z,{title:"Administrators",size:"small",children:(0,t.jsxs)(F.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(er,{title:"New administrator",organization:{id:a.id,owners:a.owners,pendingowners:a.pendingowners,pendingusers:a.pendingusers,users:a.users},dBkey:"owners",swr:{mutateOneOrganization:s.mutateOneOrganization}}),(0,t.jsx)(Xn.Z,{loading:s.loadingOrganizations,pagination:!1,size:"small",columns:j,dataSource:(0,T.Z)(a.owners.map((function(e){return(0,ee.Z)((0,N.Z)({},e),{key:e.id})}))).concat((0,T.Z)(null===(n=a.pendingowners)||void 0===n?void 0:n.map((function(e){return(0,ee.Z)((0,N.Z)({},e),{pending:!0,key:e.id})})))),scroll:{y:null===l||void 0===l?void 0:l.y},ref:m})]})}),(0,t.jsx)(ie.Z,{title:"Users",size:"small",children:(0,t.jsxs)(F.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(er,{title:"New user",organization:{id:a.id,owners:a.owners,pendingowners:a.pendingowners,pendingusers:a.pendingusers,users:a.users},dBkey:"users",swr:{mutateOneOrganization:s.mutateOneOrganization}}),(0,t.jsx)(Xn.Z,{loading:null===s||void 0===s?void 0:s.loadingOrganizations,pagination:!1,size:"small",columns:x,dataSource:(0,T.Z)(null===(r=a.users)||void 0===r?void 0:r.map((function(e){return(0,ee.Z)((0,N.Z)({},e),{key:e.id})}))).concat((0,T.Z)(null===(i=a.pendingusers)||void 0===i?void 0:i.map((function(e){return(0,ee.Z)((0,N.Z)({},e),{pending:!0,key:e.id})})))),scroll:{y:null===p||void 0===p?void 0:p.y},ref:g})]})})]})})},ar=function(){var e=(0,i.Z)((function(e,n){return(0,s.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,R.R)("/api/group",{method:"POST",body:JSON.stringify({organization:e,group:n})})];case 1:return[2,r.sent().json()]}}))}));return function(n,r){return e.apply(this,arguments)}}(),sr=function(){var e=(0,i.Z)((function(e,n){return(0,s.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,R.R)("/api/group",{method:"PUT",body:JSON.stringify({group:e,data:n})})];case 1:return r.sent(),[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),or=function(){var e=(0,i.Z)((function(e){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,R.R)("/api/group",{method:"DELETE",body:JSON.stringify(e)})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),ur={useGroups:function(e){var n=(0,E.ZP)("/api/groups/"+e,R._),r=n.data,t=n.error,i=n.mutate,a=!r,s=(null===r||void 0===r?void 0:r.groups)||[],o=(0,u.useCallback)((function(e){var n=(0,T.Z)(s).concat([e]);i({groups:n})}),[s,i]),l=(0,u.useCallback)((function(e){var n=s.filter((function(n){return n.id!==e.id}));i({groups:n})}),[s,i]),c=(0,u.useCallback)((function(e){var n=s.map((function(n){return n.id===e.id&&(n=(0,N.Z)({},n,e)),n}));i({groups:n})}),[s,i]);return[s,{addOneGroup:o,delOneGroup:l,mutateOneGroup:c,errorGroups:t,loadingGroups:a}]},add:ar,update:sr,del:or},lr=ur,cr="Unable to delete group",dr=function(){var e=(0,i.Z)((function(e,n){var r;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,lr.del({id:e.id})];case 1:return t.sent(),n.delOneGroup({id:e.id}),[3,3];case 2:throw r=t.sent(),(0,y.lt)(cr,r),r;case 3:return[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),pr=function(e){var n=e.group,r=e.swr,a=(0,u.useState)(!1),o=a[0],l=a[1];return(0,t.jsx)(B.m1,{bordered:!0,title:"Delete group",text:(0,t.jsxs)(t.Fragment,{children:["Are you sure you want to delete the group"," ",(0,t.jsx)(d.Z.Text,{strong:!0,children:n.name}),"?"]}),loading:o,onDelete:(0,i.Z)((function(){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:l(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,dr(n,r)];case 2:return e.sent(),[3,4];case 3:return l(!1),[7];case 4:return[2]}}))}))})},hr="Unable to add group",fr="Unable to update group",mr=function(){var e=(0,i.Z)((function(e,n,r){var t,i;return(0,s.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,lr.add({id:e.id},{name:n.name,users:n.users})];case 1:return t=a.sent(),r.addOneGroup((0,ee.Z)((0,N.Z)({},t),{name:n.name,users:n.users})),r.mutateOneOrganization({id:e.id,groups:(0,T.Z)(e.groups).concat([t])}),[3,3];case 2:throw i=a.sent(),(0,y.lt)(hr,i),i;case 3:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),gr=function(){var e=(0,i.Z)((function(e,n,r,t){var i,a,o,u,l,c,d;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),l=[],n.name!==r.name&&l.push({key:"name",value:r.name}),(null===(i=n.users)||void 0===i?void 0:i.map((function(e){return e.id})).toString())!==r.users.toString()&&l.push({key:"users",value:r.users}),l.length?[4,lr.update({id:n.id},l)]:[2];case 1:return s.sent(),t.mutateOneGroup((0,N.Z)({},n,r)),c=null===(a=e.groups)||void 0===a?void 0:a.findIndex((function(e){return e.id===n.id})),t.mutateOneOrganization({id:e.id,groups:(0,T.Z)(null===(o=e.groups)||void 0===o?void 0:o.slice(0,c)).concat([n],(0,T.Z)(null===(u=e.groups)||void 0===u?void 0:u.slice(c+1)))}),[3,3];case 2:throw d=s.sent(),(0,y.lt)(fr,d),d;case 3:return[2]}}))}));return function(n,r,t,i){return e.apply(this,arguments)}}(),vr=function(e){var n,r=e.userOptions,a=e.organization,o=e.group,l=e.swr,c=(0,u.useState)(!1),d=c[0],p=c[1],h=(0,u.useState)(!1),f=h[0],m=h[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(S.ZP,{title:o?"Edit group":"New group",visible:d,initialValues:o&&{name:o.name,users:null===(n=o.users)||void 0===n?void 0:n.map((function(e){return e.id}))},onCancel:function(){return p(!1)},onOk:function(){var e=(0,i.Z)((function(e){var n;return(0,s.__generator)(this,(function(r){switch(r.label){case 0:m(!0),r.label=1;case 1:return r.trys.push([1,6,,7]),o?[4,gr(a,o,e,{mutateOneOrganization:l.mutateOneOrganization,mutateOneGroup:l.mutateOneGroup})]:[3,3];case 2:return r.sent(),[3,5];case 3:return[4,mr(a,e,{mutateOneOrganization:l.mutateOneOrganization,addOneGroup:l.addOneGroup})];case 4:r.sent(),r.label=5;case 5:return m(!1),p(!1),[3,7];case 6:throw n=r.sent(),m(!1),n;case 7:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),loading:f,children:[(0,t.jsx)(O.Z.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Name is requried"}],children:(0,t.jsx)(_.Z,{})}),(0,t.jsx)(O.Z.Item,{name:"users",label:"Users",rules:[{required:!0,message:"Users selection is required"}],children:(0,t.jsx)(Zn.Z,{mode:"multiple",placeholder:"Select users",options:r})})]}),o?(0,t.jsx)(B.w6,{bordered:!0,onEdit:function(){return p(!0)},children:"Edit"}):(0,t.jsx)(B.HS,{onAdd:function(){return p(!0)},children:"New group"})]})},jr="Error while loading groups",xr=function(e){var n=e.organization,r=e.swr,i=(0,u.useState)([]),s=i[0],o=i[1],l=(0,u.useState)(null),c=l[0],d=l[1],p=(0,u.useRef)(null),h=(0,a.Z)(lr.useGroups(n.id),2),f=h[0],m=h[1],g=m.addOneGroup,v=m.mutateOneGroup,j=m.delOneGroup,x=m.errorGroups,w=m.loadingGroups;(0,u.useEffect)((function(){var e=n.owners,r=null===n||void 0===n?void 0:n.users,t=(0,T.Z)(e).concat((0,T.Z)(r)).map((function(e){return{label:e.firstname||e.lastname?e.firstname+" "+e.lastname:e.email,value:e.id}}));o(t)}),[n]),(0,u.useEffect)((function(){x&&(0,y.lt)(jr,x)}),[x]);var Z=[{title:"Group name",dataIndex:"name",key:"name"},{title:"Users",dataIndex:"users",key:"users",render:function(e){return(0,t.jsx)(W.C.Group,{maxCount:5,children:e.map((function(e){return Y.Z.userToAvatar(e)}))})}},{title:"Actions",key:"actions",render:function(e,i){return(0,t.jsxs)(F.Z,{children:[(0,t.jsx)(vr,{userOptions:s,organization:{id:n.id,groups:n.groups},group:{id:i.id,name:i.name,users:i.users},swr:{mutateOneOrganization:r.mutateOneOrganization,mutateOneGroup:v}}),(0,t.jsx)(pr,{group:{id:i.id,name:i.name},swr:{delOneGroup:j}})]})}}],b=(0,u.useCallback)((function(){var e=p.current;e&&(e.clientHeight>window.innerHeight-e.offsetTop-59?d({y:window.innerHeight-e.offsetTop-59}):d(null))}),[]);return(0,u.useEffect)((function(){return window.addEventListener("resize",b),function(){window.removeEventListener("resize",b)}}),[b]),(0,u.useEffect)((function(){b()}),[f,b]),(0,t.jsxs)(F.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(vr,{userOptions:s,organization:{id:n.id,groups:n.groups},swr:{mutateOneOrganization:r.mutateOneOrganization,addOneGroup:g}}),(0,t.jsx)(Xn.Z,{loading:w,pagination:!1,size:"small",columns:Z,dataSource:f.map((function(e){return(0,N.Z)({key:e.id},e)})),scroll:{y:null===c||void 0===c?void 0:c.y},ref:p})]})},wr="Unable to update organization's name",yr=function(){var e=(0,i.Z)((function(e,n,r){var t;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Vn.update(e,[{key:"name",value:n}])];case 1:return i.sent(),r.mutateOneOrganization((0,ee.Z)((0,N.Z)({},e),{name:n})),[3,3];case 2:return t=i.sent(),(0,y.lt)(wr,t),[3,3];case 3:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),Zr=function(e){var n=e.organization,r=e.swr,a=e.onClose;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"display-flex",children:[(0,t.jsx)(J.Z,{className:"marginRight-20",icon:(0,t.jsx)(Wn.Z,{}),onClick:function(){return a()}}),(0,t.jsx)(d.Z.Title,{level:3,editable:{onChange:function(){var e=(0,i.Z)((function(e){return(0,s.__generator)(this,(function(t){return[2,yr(n,e,{mutateOneOrganization:r.mutateOneOrganization})]}))}));return function(n){return e.apply(this,arguments)}}()},children:n.name})]}),(0,t.jsx)(z.Z,{items:[{key:"users",label:"Users",children:(0,t.jsx)(ir,{organization:{id:n.id,owners:n.owners,pendingowners:n.pendingowners,users:n.users,pendingusers:n.pendingusers},swr:{mutateOneOrganization:r.mutateOneOrganization,loadingOrganizations:r.loadingOrganizations}})},{key:"groups",label:"Groups",children:(0,t.jsx)(xr,{organization:{id:n.id,owners:n.owners,users:n.users,groups:n.groups},swr:{mutateOneOrganization:r.mutateOneOrganization}})}]})]})},br="Unable to add organization",kr=function(){var e=(0,i.Z)((function(e,n){var r,t;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Vn.add({name:e.name})];case 1:return(r=i.sent()).name=e.name,n.addOneOrganization(r),[3,3];case 2:throw t=i.sent(),(0,y.lt)(br,t),t;case 3:return[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),Or=function(e){var n=e.swr,r=(0,u.useState)(!1),a=r[0],o=r[1],l=(0,u.useState)(!1),c=l[0],d=l[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.ZP,{title:"New organization",visible:a,onCancel:function(){return o(!1)},onOk:function(){var e=(0,i.Z)((function(e){var r;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:d(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,kr(e,n)];case 2:return t.sent(),d(!1),o(!1),[3,4];case 3:throw r=t.sent(),d(!1),r;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),loading:c,children:(0,t.jsx)(O.Z.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Name is required"}],children:(0,t.jsx)(_.Z,{})})}),(0,t.jsx)(B.HS,{onAdd:function(){return o(!0)},children:"New organization"})]})},_r=r(75768),zr=r(8751),Cr=r(18429),Pr="Unable to delete organization",Sr=function(){var e=(0,i.Z)((function(e,n){var r;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Vn.del({id:e.id})];case 1:return t.sent(),n.delOneOrganization({id:e.id}),[3,3];case 2:throw r=t.sent(),(0,y.lt)(Pr,r),r;case 3:return[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),Nr=function(e){var n=e.organization,r=e.swr,a=(0,u.useState)(!1),o=a[0],l=a[1];return(0,t.jsx)(B.m1,{bordered:!0,title:"Delete organization",text:(0,t.jsxs)(t.Fragment,{children:["Are you sure you want to delete the organization"," ",(0,t.jsx)(d.Z.Text,{strong:!0,children:n.name}),"?"]}),onDelete:(0,i.Z)((function(){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:l(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,Sr(n,r)];case 2:return e.sent(),[3,4];case 3:return l(!1),[7];case 4:return[2]}}))})),loading:o})},Tr="Unable to quit organization",Er="Unable to accept invitation",Rr="Unable to decline invitation",Ur=function(){var e=(0,i.Z)((function(e,n,r){var t,i,a;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,Vn.quit({id:e.id})];case 1:return s.sent(),t=Y.Z.deepCopy(e),i=t.users.findIndex((function(e){return e.id===n.id})),t.users.splice(i,1),r.mutateOneOrganization(t),[3,3];case 2:return a=s.sent(),(0,y.lt)(Tr,a),[3,3];case 3:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),Ar=function(){var e=(0,i.Z)((function(e,n,r){var t,i,a,o,u,l;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,Vn.accept(e)];case 1:return s.sent(),t=Y.Z.deepCopy(e),i=t.pendingowners.findIndex((function(e){return e.id===n.id})),a=t.pendingowners[i],-1!==i?(t.pendingowners.splice(i,1),t.owners.push(a)):(o=t.pendingusers.findIndex((function(e){return e.id===n.id})),u=t.pendingusers[o],t.pendingusers.splice(o,1),t.users.push(u)),r.mutateOneOrganization(t),[3,3];case 2:return l=s.sent(),(0,y.lt)(Er,l),[3,3];case 3:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),Ir=function(){var e=(0,i.Z)((function(e,n,r){var t,i,a,o,u,l;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,Vn.decline({id:e.id})];case 1:return s.sent(),i=Y.Z.deepCopy(e),-1!==(a=null===(t=i.pendingowners)||void 0===t?void 0:t.findIndex((function(e){return e.id===n.id})))?i.pendingowners.splice(a,1):(u=null===(o=i.pendingusers)||void 0===o?void 0:o.findIndex((function(e){return e.id===n.id})),i.pendingusers.splice(u,1)),r.mutateOneOrganization(i),[3,3];case 2:return l=s.sent(),(0,y.lt)(Rr,l),[3,3];case 3:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),qr=function(e){var n,r=e.user,a=e.organizations,o=e.swr,l=e.setOrganization,c=(0,u.useState)(null),d=c[0],p=c[1],h=(0,u.useRef)(null),f=[{title:"Name",dataIndex:"name",key:"name",sorter:function(e,n){var r=e.name||"",t=n.name||"";return r.localeCompare(t)}},{title:"Administrators",dataIndex:"owners",key:"owners",render:function(e){return(0,t.jsx)(W.C.Group,{maxCount:5,children:null===e||void 0===e?void 0:e.map((function(e){return Y.Z.userToAvatar(e)}))})}},{title:"Users",dataIndex:"users",key:"users",render:function(e){return(0,t.jsx)(W.C.Group,{maxCount:5,children:null===e||void 0===e?void 0:e.map((function(e){return Y.Z.userToAvatar(e)}))})}},{title:"Groups",dataIndex:"groups",key:"groups",render:function(e){return(0,t.jsx)(W.C.Group,{maxCount:5,children:null===e||void 0===e?void 0:e.map((function(e){return Y.Z.groupToAvatar(e)}))})}},{title:"Actions",key:"actions",render:function(e){return e.owners.find((function(e){return e.id===r.id}))?(0,t.jsxs)(F.Z,{wrap:!0,children:[(0,t.jsx)(J.Z,{icon:(0,t.jsx)(m.Z,{}),onClick:function(){return l(e)},children:"Manage"}),(0,t.jsx)(Nr,{organization:{id:e.id,name:e.name},swr:{delOneOrganization:o.delOneOrganization}})]}):e.users.find((function(e){return e.id===r.id}))?(0,t.jsx)(F.Z,{wrap:!0,children:(0,t.jsx)(J.Z,{danger:!0,icon:(0,t.jsx)(_r.Z,{}),onClick:function(){return Ur({id:e.id,users:e.users},{id:r.id},{mutateOneOrganization:o.mutateOneOrganization})},children:"Quit"})}):e.pendingowners.find((function(e){return e.id===r.id}))||e.pendingusers.find((function(e){return e.id===r.id}))?(0,t.jsxs)(F.Z,{wrap:!0,children:[(0,t.jsx)(J.Z,{type:"primary",icon:(0,t.jsx)(zr.Z,{}),onClick:(0,i.Z)((function(){return(0,s.__generator)(this,(function(n){return[2,Ar({id:e.id,owners:e.owners,pendingowners:e.pendingowners,users:e.users,pendingusers:e.pendingusers},{id:r.id},{mutateOneOrganization:o.mutateOneOrganization})]}))})),children:"Accept invitation"}),(0,t.jsx)(J.Z,{danger:!0,icon:(0,t.jsx)(Cr.Z,{}),onClick:function(){return Ir({id:e.id,pendingowners:e.pendingowners,pendingusers:e.pendingusers},{id:r.id},{mutateOneOrganization:o.mutateOneOrganization})},children:"Decline"})]}):void 0}}],g=(0,u.useCallback)((function(){var e=h.current;e&&(e.clientHeight>window.innerHeight-e.offsetTop-59?p({y:window.innerHeight-e.offsetTop-59}):p(null))}),[]);return(0,u.useEffect)((function(){return window.addEventListener("resize",g),function(){window.removeEventListener("resize",g)}}),[g]),(0,u.useEffect)((function(){g()}),[a,g,null===(n=h.current)||void 0===n?void 0:n.offsetTop]),(0,t.jsx)(Xn.Z,{loading:o.loadingOrganizations,pagination:!1,size:"small",columns:f,dataSource:null===a||void 0===a?void 0:a.map((function(e){return{key:e.id,id:e.id,name:e.name,owners:e.owners,pendingowners:e.pendingowners,users:e.users,pendingusers:e.pendingusers,groups:e.groups}})),ref:h,scroll:{y:null===d||void 0===d?void 0:d.y}})},Dr=function(e){var n=e.user,r=e.organizations,i=e.swr,a=(0,u.useState)(),s=a[0],c=a[1],p=(0,o.useRouter)(),h=p.query.organizationId;return(0,u.useEffect)((function(){if(h){var e=r.find((function(e){return e.id===h}));c(e)}}),[h,r]),(0,u.useEffect)((function(){if(s){var e=r.find((function(e){return e.id===s.id}));JSON.stringify(e)!==JSON.stringify(s)&&c(e)}}),[r,s]),(0,t.jsxs)(l.Z,{className:"inDashboard Organization",children:[(0,t.jsx)(b.Z,{className:"inDashboard-PageHeader",backIcon:!1,title:(0,t.jsx)(d.Z.Title,{level:2,className:"inDashboard-PageHeader-title",children:"Organizations"}),footer:(0,t.jsx)(k.Z,{})}),(0,t.jsx)(l.Z.Content,{className:"no-scroll",children:s?(0,t.jsx)(Zr,{organization:{id:s.id,name:s.name,owners:s.owners,pendingowners:s.pendingowners,users:s.users,pendingusers:s.pendingusers,groups:s.groups},swr:{mutateOneOrganization:i.mutateOneOrganization,loadingOrganizations:i.loadingOrganizations},onClose:function(){p.push({pathname:"dashboard",query:{page:"organizations"}}),c(null)}}):(0,t.jsxs)(F.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(Or,{swr:{addOneOrganization:i.addOneOrganization}}),(0,t.jsx)(qr,{user:{id:n.id},organizations:r,swr:{mutateOneOrganization:i.mutateOneOrganization,delOneOrganization:i.delOneOrganization,loadingOrganizations:i.loadingOrganizations},setOrganization:function(e){p.push({pathname:"dashboard",query:{page:"organizations",organizationId:e.id}}),c(e)}})]})})]})},Fr=r(63922),Wr=r(10808),Lr=r(63606),Hr=r(32808),Gr=r(36574),Jr="Unable to add user",Mr=function(){var e=(0,i.Z)((function(e,n){var r,t,i;return(0,s.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,Be.Z.add({email:e.email,password:e.password})];case 1:if((r=a.sent()).alreadyExists)throw new Error("User already exists");return[4,Be.Z.updateById(r.id,[{key:"firstname",value:e.firstname},{key:"lastname",value:e.lastname},{key:"authorizedplugins",value:e.authorizedplugins},{key:"superuser",value:!!e.superuser}])];case 2:return a.sent(),t=(0,ee.Z)((0,N.Z)({},r),{email:e.email,firstname:e.firstname,lastname:e.firstname,superuser:e.superuser}),n.addOneUser(t),[3,4];case 3:throw i=a.sent(),(0,y.lt)(Jr,i),i;case 4:return[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),Br=function(e){var n=e.plugins,r=e.swr,o=(0,u.useState)(!1),l=o[0],c=o[1],d=(0,u.useState)(!1),p=d[0],h=d[1],f=(0,a.Z)(Gr.Z.useSystem(),1)[0];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(S.ZP,{title:"New user",visible:l,initialValues:f.defaultplugins&&{authorizedplugins:f.defaultplugins},onCancel:function(){return c(!1)},onOk:function(){var e=(0,i.Z)((function(e){var n;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:h(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Mr(e,r)];case 2:return t.sent(),h(!1),c(!1),[3,4];case 3:throw n=t.sent(),h(!1),n;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),loading:p,children:[(0,t.jsx)(O.Z.Item,{name:"firstname",label:"First name",children:(0,t.jsx)(_.Z,{})}),(0,t.jsx)(O.Z.Item,{name:"lastname",label:"Last name",children:(0,t.jsx)(_.Z,{})}),(0,t.jsx)(O.Z.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Email is required"}],children:(0,t.jsx)(_.Z,{})}),(0,t.jsx)(sn.o,{name:"password"}),(0,t.jsx)(O.Z.Item,{name:"authorizedplugins",label:"Plugins",children:(0,t.jsx)(Zn.Z,{mode:"multiple",options:n.map((function(e){return{label:e.name,value:e.key}}))})}),(0,t.jsx)(O.Z.Item,{name:"superuser",label:"Administrator",valuePropName:"checked",children:(0,t.jsx)(Hr.Z,{})})]}),(0,t.jsx)(B.HS,{onAdd:function(){return c(!0)},children:"New user"})]})};Br.propTypes={plugins:yn().arrayOf(yn().exact({key:yn().string.isRequired,name:yn().string.isRequired})).isRequired,swr:yn().exact({addOneUser:yn().func.isRequired}).isRequired};var Yr=Br,Vr="Unable to update user",Xr=function(){var e=(0,i.Z)((function(e,n,r){var t,i,a;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),(t=Object.keys(n).map((function(r){var t=n[r];if(void 0!==t&&"******"!==t&&t!==e[r])return{key:r,value:t,type:"password"===r&&"crypt"}})).filter((function(e){return e}))).length?[4,Be.Z.updateById(e.id,t)]:[2];case 1:return s.sent(),n.password="******",i=(0,N.Z)({},e,n),r.mutateOneUser(i),[3,3];case 2:throw a=s.sent(),(0,y.lt)(Vr,a),a;case 3:return[2]}}))}));return function(n,r,t){return e.apply(this,arguments)}}(),Kr=function(e){var n=e.plugins,r=e.user,a=e.swr,o=(0,u.useState)(!1),l=o[0],c=o[1],d=(0,u.useState)(!1),p=d[0],h=d[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(S.ZP,{title:"Edit user",visible:l,initialValues:(0,ee.Z)((0,N.Z)({},r),{password:"******",authorizedplugins:r.authorizedplugins}),onCancel:function(){return c(!1)},onOk:function(){var e=(0,i.Z)((function(e){var n;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:h(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Xr(r,e,a)];case 2:return t.sent(),h(!1),c(!1),[3,4];case 3:throw n=t.sent(),h(!1),n;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),loading:p,children:[(0,t.jsx)(O.Z.Item,{name:"firstname",label:"First name",children:(0,t.jsx)(_.Z,{})}),(0,t.jsx)(O.Z.Item,{name:"lastname",label:"Last name",children:(0,t.jsx)(_.Z,{})}),(0,t.jsx)(O.Z.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Email is required"}],children:(0,t.jsx)(_.Z,{})}),(0,t.jsx)(sn.o,{name:"password",edit:!0}),(0,t.jsx)(O.Z.Item,{name:"authorizedplugins",label:"Plugins",children:(0,t.jsx)(Zn.Z,{mode:"multiple",options:n.map((function(e){return{label:e.name,value:e.key}}))})}),(0,t.jsx)(O.Z.Item,{name:"superuser",label:"Administrator",valuePropName:"checked",children:(0,t.jsx)(Hr.Z,{})})]}),(0,t.jsx)(B.w6,{bordered:!0,onEdit:function(){return c(!0)},children:"Edit"})]})};Kr.propTypes={plugins:yn().arrayOf(yn().exact({key:yn().string.isRequired,name:yn().string.isRequired})).isRequired,user:yn().exact({id:yn().string.isRequired,email:yn().string.isRequired,firstname:yn().string,lastname:yn().string,authorizedplugins:yn().arrayOf(yn().string).isRequired,superuser:yn().bool.isRequired}).isRequired,swr:yn().exact({mutateOneUser:yn().func.isRequired}).isRequired};var Qr=Kr,$r="Unable to delete user",et=function(){var e=(0,i.Z)((function(e,n){var r;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Be.Z.delById(e.id)];case 1:return t.sent(),n.delOneUser({id:e.id}),[3,3];case 2:throw r=t.sent(),(0,y.lt)($r,r),r;case 3:return[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),nt=function(e){var n=e.user,r=e.swr,a=(0,u.useState)(!1),o=a[0],l=a[1];return(0,t.jsx)(B.m1,{loading:o,bordered:!0,text:(0,t.jsxs)(t.Fragment,{children:["Are you sure you want to delete the user"," ",(0,t.jsx)(d.Z.Text,{strong:!0,children:n.email}),"?"]}),title:"Delete user",onDelete:(0,i.Z)((function(){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:l(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,et(n,r)];case 2:return e.sent(),[3,4];case 3:return l(!1),[7];case 4:return[2]}}))}))})},rt="Unable to load plugins",tt=function(e){var n=e.users,r=e.swr,i=(0,u.useState)(),a=i[0],s=i[1],o=(0,u.useState)(),l=o[0],c=o[1],d=(0,u.useRef)(null),p=[{title:"First name",dataIndex:"firstname",key:"firstname",sorter:function(e,n){var r=e.firstname||"",t=n.firstname||"";return r.localeCompare(t)}},{title:"Last name",dataIndex:"lastname",key:"lastname",sorter:function(e,n){var r=e.lastname||"",t=n.lastname||"";return r.localeCompare(t)}},{title:"Email",dataIndex:"email",key:"email",sorter:function(e,n){var r=e.email,t=n.email;return r.localeCompare(t)}},{title:"Password",key:"password",render:function(){return"******"}},{title:"Plugins",dataIndex:"authorizedplugins",key:"authorizedplugins",render:function(e){e.sort();var n=e.map((function(e){var n=null===a||void 0===a?void 0:a.find((function(n){return n.key===e}));return n?(0,t.jsx)(Fr.Z.Ribbon,{text:n.category,style:{marginTop:"-15px"},children:(0,t.jsx)(ie.Z,{size:"small",children:n.name})},e):void 0})),r=(0,t.jsx)(F.Z,{direction:"vertical",children:n});return(0,t.jsx)(Wr.Z,{content:r,children:(0,t.jsxs)(J.Z,{children:[n.length," plugins"]})})}},{title:"Administrator",dataIndex:"superuser",key:"superuser",render:function(e){return e&&(0,t.jsx)(Lr.Z,{className:"color-green"})}},{title:"Actions",key:"actions",render:function(e,n){return(0,t.jsxs)(F.Z,{children:[(0,t.jsx)(Qr,{plugins:(null===a||void 0===a?void 0:a.map((function(e){return{key:e.key,name:e.name}})))||[],user:{id:n.id,firstname:n.firstname,lastname:n.lastname,email:n.email,authorizedplugins:n.authorizedplugins,superuser:n.superuser},swr:{mutateOneUser:r.mutateOneUser}}),(0,t.jsx)(nt,{user:{id:n.id,email:n.email},swr:{delOneUser:r.delOneUser}})]})}}],h=(0,u.useCallback)((function(){var e=d.current;e&&(e.clientHeight>window.innerHeight-e.offsetTop-59?c({y:window.innerHeight-e.offsetTop-59}):c(void 0))}),[]);return(0,u.useEffect)((function(){xn.Z.completeList().then((function(e){s(e)})).catch((function(e){(0,y.lt)(rt,e)}))}),[]),(0,u.useEffect)((function(){return window.addEventListener("resize",h),function(){window.removeEventListener("resize",h)}}),[h]),(0,u.useEffect)((function(){h()}),[n,h]),(0,t.jsxs)(F.Z,{direction:"vertical",className:"full-width full-height",size:20,children:[(0,t.jsx)(Yr,{plugins:(null===a||void 0===a?void 0:a.map((function(e){return{key:e.key,name:e.name}})))||[],swr:{addOneUser:r.addOneUser}}),(0,t.jsx)(Xn.Z,{loading:!a,pagination:!1,size:"small",columns:p,dataSource:n.map((function(e){return(0,ee.Z)((0,N.Z)({},e),{key:e.id})})),ref:d,scroll:{y:null===l||void 0===l?void 0:l.y}})]})},it=r(79915),at=r(15479),st="Error while loading system",ot="Unable to update system",ut=function(){var e=(0,i.Z)((function(e,n){var r;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Gr.Z.update([{key:"allowsignup",value:!e.allowsignup}])];case 1:return t.sent(),n({allowsignup:!e.allowsignup}),(0,y.Ur)("Changes saved"),[3,3];case 2:return r=t.sent(),(0,y.lt)(ot,r),[3,3];case 3:return[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),lt=function(){var e=(0,i.Z)((function(e,n){var r;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Gr.Z.update([{key:"password",value:e}])];case 1:return t.sent(),n({password:e}),(0,y.Ur)("Changes saved"),[3,3];case 2:return r=t.sent(),(0,y.lt)(ot,r),[3,3];case 3:return[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),ct=function(){var e=(0,a.Z)(O.Z.useForm(),1)[0],n=(0,a.Z)(Gr.Z.useSystem(),2),r=n[0],o=n[1],l=o.mutateSystem,c=o.errorSystem,d=o.loadingSystem,p={wrapperCol:{offset:8,span:16}};return(0,u.useEffect)((function(){c&&(0,y.lt)(st,c)}),[c]),(0,u.useEffect)((function(){d||e.setFieldsValue((null===r||void 0===r?void 0:r.password)||{min:at.yL,max:at.nq,requireLetter:at.JT,requireNumber:at.tE,requireSymbol:at.ah})}),[d,e,null===r||void 0===r?void 0:r.password]),d?(0,t.jsx)(Z.Z.Simple,{}):(0,t.jsxs)(F.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(ie.Z,{title:"Signup",children:(0,t.jsx)(Hr.Z,{checked:null===r||void 0===r?void 0:r.allowsignup,onChange:function(){return ut(r,l)},children:"Allow signup"})}),(0,t.jsx)(ie.Z,{title:"Password",children:(0,t.jsxs)(O.Z,(0,ee.Z)((0,N.Z)({},{labelCol:{span:8},wrapperCol:{span:16}}),{form:e,name:"form",onFinish:function(){var e=(0,i.Z)((function(e){return(0,s.__generator)(this,(function(n){return[2,lt(e,l)]}))}));return function(n){return e.apply(this,arguments)}}(),children:[(0,t.jsx)(O.Z.Item,{label:"Minimum number of characters",name:"min",rules:[{required:!0,message:"Minimum number of characters is required"}],children:(0,t.jsx)(it.Z,{min:0,max:64})}),(0,t.jsx)(O.Z.Item,{label:"Maximum number of characters",name:"max",rules:[{required:!0,message:"Maximum number of characters is required"}],children:(0,t.jsx)(it.Z,{min:0,max:64})}),(0,t.jsx)(O.Z.Item,(0,ee.Z)((0,N.Z)({},p),{valuePropName:"checked",name:"requireLetter",children:(0,t.jsx)(Hr.Z,{children:"Require letter"})})),(0,t.jsx)(O.Z.Item,(0,ee.Z)((0,N.Z)({},p),{valuePropName:"checked",name:"requireNumber",children:(0,t.jsx)(Hr.Z,{children:"Require number"})})),(0,t.jsx)(O.Z.Item,(0,ee.Z)((0,N.Z)({},p),{valuePropName:"checked",name:"requireSymbol",children:(0,t.jsx)(Hr.Z,{children:"Require symbol"})})),(0,t.jsx)(O.Z.Item,(0,ee.Z)((0,N.Z)({},p),{children:(0,t.jsx)(J.Z,{type:"primary",icon:(0,t.jsx)(Lr.Z,{}),htmlType:"submit"})}))]}))})]})},dt="Unable to get plugins",pt="Unable to update system",ht=function(){var e=(0,i.Z)((function(e,n,r,t){var i,a,o;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,Gr.Z.update([{key:"defaultplugins",type:"array",method:r?"append":"remove",value:n.key}])];case 1:return s.sent(),i=(null===e||void 0===e?void 0:e.defaultplugins)||[],a=i.indexOf(n.key),r&&-1===a&&i.push(n.key),r||-1===a||i.splice(a,1),t.mutateSystem({defaultplugins:i}),[3,3];case 2:return o=s.sent(),(0,y.lt)(pt,o),[3,3];case 3:return[2]}}))}));return function(n,r,t,i){return e.apply(this,arguments)}}(),ft=function(){var e=(0,u.useRef)(null),n=(0,u.useState)(),r=n[0],o=n[1],l=(0,u.useState)(),c=l[0],d=l[1],p=(0,a.Z)(Gr.Z.useSystem(),2),h=p[0],f=p[1],m=f.mutateSystem,g=f.loadingSystem;(0,u.useEffect)((function(){xn.Z.completeList().then((function(e){o(e)})).catch((function(e){(0,y.lt)(dt,e)}))}),[]);var v=[{title:"Category",dataIndex:"category",key:"category"},{title:"Name",dataIndex:"name",key:"name"},{title:"Default enabled",key:"enable",render:function(e){var n,r=null===h||void 0===h||null===(n=h.defaultplugins)||void 0===n?void 0:n.includes(e.key);return(0,t.jsx)(Hr.Z,{checked:r,onChange:function(){var n=(0,i.Z)((function(n){return(0,s.__generator)(this,(function(r){return[2,ht(h,e,n.target.checked,{mutateSystem:m})]}))}));return function(e){return n.apply(this,arguments)}}()})}}],j=(0,u.useCallback)((function(){var n=e.current;n&&(n.clientHeight>window.innerHeight-n.offsetTop-59?d({y:window.innerHeight-n.offsetTop-59}):d(null))}),[]);return(0,u.useEffect)((function(){return window.addEventListener("resize",j),function(){window.removeEventListener("resize",j)}}),[j]),(0,u.useEffect)((function(){j()}),[r,j]),(0,t.jsx)(Xn.Z,{loading:!r||g,pagination:!1,size:"small",columns:v,dataSource:r,ref:e,scroll:{y:null===c||void 0===c?void 0:c.y}})},mt={label:"Users",key:"users"},gt={label:"Registration",key:"registration"},vt={label:"Plugins",key:"plugins"},jt="Error while loading users",xt=function(){var e=(0,o.useRouter)(),n=e.query.tab,r=(0,a.Z)(Be.Z.useUsers(),2),i=r[0],s=r[1],c=s.addOneUser,p=s.mutateOneUser,h=s.delOneUser,f=s.errorUsers;return(0,u.useEffect)((function(){f&&(0,y.lt)(jt,f)}),[f]),(0,t.jsxs)(l.Z,{className:"inDashboard Administration",children:[(0,t.jsx)(b.Z,{className:"inDashboard-PageHeader",backIcon:!1,title:(0,t.jsx)(d.Z.Title,{level:2,className:"inDashboard-PageHeader-title",children:"Administration"}),footer:(0,t.jsx)(k.Z,{})}),(0,t.jsx)(l.Z.Content,{children:(0,t.jsx)(z.Z,{className:"inDashboard-Tabs",type:"card",items:[{key:mt.key,label:mt.label,children:(0,t.jsx)(tt,{users:i,swr:{addOneUser:c,mutateOneUser:p,delOneUser:h}})},{key:gt.key,label:gt.label,children:(0,t.jsx)(ct,{})},{key:vt.key,label:vt.label,children:(0,t.jsx)(ft,{})}],defaultActiveKey:n||"default",onChange:function(n){return function(e,n){e.replace({pathname:"/dashboard",query:{page:"administration",tab:n}})}(e,n)}})})]})},wt=r(95507),yt=function(){return(0,t.jsx)(ie.Z,{title:"Standard workflow",children:(0,t.jsx)(wt.ZP,{dataSource:["Go to account settings","Fill your first name, last name, change your password if needed","Create an HPC provider, you will need that to run a simulation","Create a new workspace","Create a new project","Upload a geometry (STEP file for 3D or DXF file for 2D)","Select a simulation model","Configure your simulation: geometry, materials, parameters, boundary conditions, depending on your simulation, HPC resource","Run your simulation","Display the results","Depending on your simulation, visualize data","Depending on your simulation, post-process the result"],renderItem:function(e){return(0,t.jsxs)(wt.ZP.Item,{children:[" - ",e]})}})})},Zt=function(){return(0,t.jsx)(ie.Z,{title:"Workspace",children:(0,t.jsxs)(d.Z.Text,{children:["The workspace is the place where all the projects are. You can create several workspaces to sort your different projects.",(0,t.jsx)("br",{}),"You can share your workspace with other users or groups throught organizations."]})})},bt=r(54907),kt=function(){return(0,t.jsxs)(ie.Z,{title:"Project",children:[(0,t.jsx)(d.Z.Text,{children:"The project is used to manage geometries and simulation."}),(0,t.jsx)(bt.Z,{children:(0,t.jsx)(bt.Z.Panel,{header:"Archive Project",children:(0,t.jsxs)(d.Z.Text,{children:["You can archive a project to save disk space.",(0,t.jsx)("br",{}),"Once archived, a project is not editable anymore.",(0,t.jsx)("br",{}),"At the archive time, you can download a"," ",(0,t.jsx)("code",{children:".tanatlocarchive"})," file that contains all the data to restore your project later.",(0,t.jsx)("br",{}),"There is several options to manage an archived projects:",(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"Restore the project from the previously downloaded archive file;"}),(0,t.jsx)("li",{children:"Restore the project from the archive file on the server;"}),(0,t.jsx)("li",{children:"Delete the archive file on the server, in the case you will not be able to restore the project from the server archive file."})]})]})},"archive")})]})},Ot=function(){return(0,t.jsx)(ie.Z,{title:"Account / HPC plugins",children:(0,t.jsxs)(bt.Z,{children:[(0,t.jsxs)(bt.Z.Panel,{header:"Local plugin",children:[(0,t.jsx)(d.Z.Text,{children:"Allow to compute a simulation directly on the frontal server."}),(0,t.jsx)(d.Z.Text,{children:"This plugin is only reserved for test purposes."})]},"local"),(0,t.jsxs)(bt.Z.Panel,{header:"Rescale plugin",children:[(0,t.jsxs)(d.Z.Text,{children:["Allow to compute a simulation on"," ",(0,t.jsx)("a",{href:"https://www.rescale.com/",children:"Rescale"}),"."]}),(0,t.jsx)(d.Z.Text,{children:"You have to fill the following informations:"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"Name: a name to retrieve your configuration during the simulation parameterization;"}),(0,t.jsxs)("li",{children:["Token: your API token. You can find it in your"," ",(0,t.jsx)("a",{href:"https://platform.rescale.jp/user/settings/api-key/",children:"Rescale account"}),";"]}),(0,t.jsx)("li",{children:"Platform: the platform you use. USA, Europe or Japan;"}),(0,t.jsx)("li",{children:"[Optional] Organization name: the organization you are in;"}),(0,t.jsx)("li",{children:"[Optional] Project id: the financial project identifier;"}),(0,t.jsx)("li",{children:"[Optional] Default walltime: the default value for the run walltime;"}),(0,t.jsx)("li",{children:"[Optional] Additional files: additional files you have to use with your simulations. Generally FreeFEM custom plugins."})]}),(0,t.jsx)(d.Z.Text,{children:"When you save this informations, Tanatloc will check your API key, the available core types, and the available FreeFEM versions."})]},"rescale")]})})},_t=function(){return(0,t.jsxs)(ie.Z,{title:"Administration",children:[(0,t.jsx)(d.Z.Text,{children:"Your need to be an administrator to have acces to this part"}),(0,t.jsxs)(bt.Z,{children:[(0,t.jsx)(bt.Z.Panel,{header:"Users",children:(0,t.jsx)(d.Z.Text,{children:"You can manage users: create, delete or modify informations."})},"users"),(0,t.jsx)(bt.Z.Panel,{header:"Registration",children:(0,t.jsx)(d.Z.Text,{children:"Allow you to enable / disable the signup and to manage the required pattern for passwords."})},"registration")]})]})},zt=function(){return(0,t.jsxs)(ie.Z,{title:"Organization",children:[(0,t.jsx)(d.Z.Text,{children:"Allow you to manage an organization, and associated groups for sharing purpose."}),(0,t.jsxs)(bt.Z,{children:[(0,t.jsx)(bt.Z.Panel,{header:"Users",children:(0,t.jsxs)(d.Z.Text,{children:["Add or remove owners and users.",(0,t.jsx)("br",{}),"Owners and users in an organization can be used to share a workspace or a project."]})},"users"),(0,t.jsx)(bt.Z.Panel,{header:"Groups",children:(0,t.jsxs)(d.Z.Text,{children:["Add, modify or remove groups.",(0,t.jsx)("br",{}),"Groups in an organization can be used to share a workspace or a project."]})},"groups")]})]})},Ct=r(73461),Pt=r.n(Ct),St=function(){return(0,t.jsxs)(ie.Z,{title:"About",children:[(0,t.jsxs)(d.Z,{children:["Version: ",(0,t.jsx)(d.Z.Text,{code:!0,children:w.i8})]}),(0,t.jsx)("br",{}),(0,t.jsxs)(d.Z,{children:["Git version:"," ",(0,t.jsx)(d.Z.Text,{code:!0,children:Y.Z.getGitVersion()})]}),(0,t.jsx)("br",{}),(0,t.jsxs)(d.Z,{children:["Browser: ",(0,t.jsx)(d.Z.Text,{code:!0,children:navigator.userAgent})]}),(0,t.jsx)("br",{}),(0,t.jsxs)(d.Z,{children:["OS: ",(0,t.jsx)(d.Z.Text,{code:!0,children:Pt().platform()})]})]})},Nt=function(){return(0,t.jsxs)(l.Z,{className:"inDashboard Help",children:[(0,t.jsx)(b.Z,{className:"inDashboard-PageHeader",backIcon:!1,title:(0,t.jsx)(d.Z.Title,{level:2,className:"inDashboard-PageHeader-title",children:"Help"}),extra:(0,t.jsx)("a",{href:"https://github.com/Airthium/tanatloc/issues/new/choose",target:"_blank",rel:"noreferrer",children:"Open an issue"}),footer:(0,t.jsx)(k.Z,{})}),(0,t.jsx)(l.Z.Content,{className:"scroll",children:(0,t.jsxs)(F.Z,{direction:"vertical",className:"full-width",size:20,children:[(0,t.jsx)(yt,{}),(0,t.jsx)(Zt,{}),(0,t.jsx)(kt,{}),(0,t.jsx)(Ot,{}),(0,t.jsx)(zt,{}),(0,t.jsx)(_t,{}),(0,t.jsx)(St,{})]})})]})},Tt="Error while loading user",Et="Error while loading organizations",Rt="Error while loading workspaces",Ut="Unable to logout",At={workspaces:{label:"Workspaces",key:"workspaces"},account:{label:"Account Settings",key:"account"},organizations:{label:"Organizations",key:"organizations"},administration:{label:"Administration",key:"administration"},help:{label:"I Need Help",key:"help"},logout:{label:"Logout",key:"logout"}},It=function(e,n,r){n===At.logout.key?qt(e,r):e.replace({pathname:"/dashboard",query:{page:n}})},qt=function(){var e=(0,i.Z)((function(e,n){var r;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,fn()];case 1:return t.sent(),n(),e.push("/"),[3,3];case 2:return r=t.sent(),(0,y.lt)(Ut,r),[3,3];case 3:return[2]}}))}));return function(n,r){return e.apply(this,arguments)}}(),Dt=function(){var e=(0,u.useState)(),n=e[0],r=e[1],i=(0,a.Z)(Be.Z.useUser(),2),s=i[0],j=i[1],b=j.mutateUser,k=j.clearUser,O=j.errorUser,_=j.loadingUser,z=(0,a.Z)(Vn.useOrganizations(),2),C=z[0],P=z[1],S=P.addOneOrganization,N=P.delOneOrganization,T=P.mutateOneOrganization,E=P.errorOrganizations,R=P.loadingOrganizations,U=(0,a.Z)(D.useWorkspaces(),2),A=U[0],I=U[1],q=I.addOneWorkspace,F=I.delOneWorkspace,W=I.mutateOneWorkspace,L=I.errorWorkspaces,H=I.loadingWorkspaces,G=(0,o.useRouter)();return(0,u.useEffect)((function(){_||s||G.replace("/")}),[s,_,G]),(0,u.useEffect)((function(){var e=new URLSearchParams(window.location.search).get("page");e?r(e):(r(At.workspaces.key),It(G,At.workspaces.key,k))}),[G,k]),(0,u.useEffect)((function(){O&&(0,y.lt)(Tt,O),E&&(0,y.lt)(Et,E),L&&(0,y.lt)(Rt,L)}),[O,E,L]),!s||_||R||H?(0,t.jsx)(Z.Z,{}):(0,t.jsxs)(l.Z,{className:"Dashboard",children:[(0,t.jsxs)(l.Z.Sider,{theme:"light",width:"256",className:"Dashboard-Sider",children:[(0,t.jsx)("div",{className:"logo",children:(0,t.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,t.jsx)(c.Z,{className:"Dashboard-Menu",theme:"light",items:[{key:At.workspaces.key,icon:(0,t.jsx)(p.Z,{}),label:At.workspaces.label},{key:At.account.key,icon:(0,t.jsx)(h.Z,{}),label:At.account.label},{key:At.organizations.key,icon:(0,t.jsx)(f.Z,{}),label:At.organizations.label,className:x()()?"display-none":""},{key:At.administration.key,className:s.superuser&&!x()()?"":"display-none",icon:(0,t.jsx)(m.Z,{}),label:At.administration.label},{key:At.help.key,icon:(0,t.jsx)(g.Z,{}),label:At.help.label},{type:"divider"},{key:At.logout.key,danger:!0,icon:(0,t.jsx)(v.Z,{}),label:At.logout.label,className:x()()?"display-none":""},{key:"version",disabled:!0,className:"version",label:(0,t.jsxs)(d.Z.Text,{className:"text-light",ellipsis:{tooltip:!0},children:["version ",w.i8]})}],onClick:function(e){var n=e.keyPath.pop();r(n),It(G,n,k)},mode:"inline"})]}),(0,t.jsxs)(l.Z.Content,{className:"no-scroll",children:[n===At.workspaces.key&&(0,t.jsx)(He,{user:{id:s.id},workspaces:A,organizations:C,swr:{addOneWorkspace:q,delOneWorkspace:F,mutateOneWorkspace:W}}),n===At.account.key&&(0,t.jsx)(Fn,{user:{email:s.email,firstname:s.firstname,lastname:s.lastname,avatar:s.avatar},swr:{mutateUser:b,clearUser:k}}),n===At.organizations.key&&(0,t.jsx)(Dr,{user:{id:s.id},organizations:C,swr:{addOneOrganization:S,delOneOrganization:N,mutateOneOrganization:T,loadingOrganizations:R}}),n===At.administration.key&&(0,t.jsx)(xt,{}),n===At.help.key&&(0,t.jsx)(Nt,{})]})]})},Ft=function(){return(0,t.jsx)(Dt,{})}},4147:function(e){"use strict";e.exports={i8:"1.0.3"}}},function(e){e.O(0,[7841,6362,1474,1266,1220,7666,6690,7909,1756,7040,3175,3666,5507,1735,1997,6381,9774,2888,179],(function(){return n=40528,e(e.s=n);var n}));var n=e.O();_N_E=n}]);