(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4154],{31832:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/editor",function(){return t(22904)}])},55061:function(e,n,t){"use strict";t.d(n,{ET:function(){return o},KJ:function(){return r},j1:function(){return s},pj:function(){return a},zX:function(){return i}});var l=t(11409);let i=e=>({type:l.Hp.SETTEMPLATE,value:e}),s=e=>({type:l.Hp.SETMODEL,value:e}),r=e=>({type:l.Hp.SETCURSOR,value:e}),a=e=>({type:l.Hp.SETTEMPLATEVALID,value:e}),o=e=>({type:l.Hp.SETMODELVALID,value:e})},11409:function(e,n,t){"use strict";t.d(n,{Hp:function(){return r},rU:function(){return a}});var l=t(85893),i=t(67294);let s={template:"",model:"",dispatch:()=>void 0,templateValid:!1,modelValid:!1},r={SETTEMPLATE:"SETTEMPLATE",SETMODEL:"SETMODEL",SETCURSOR:"SETCURSOR",SETTEMPLATEVALID:"SETTEMPLATEVALID",SETMODELVALID:"SETMODELVALID"},a=(0,i.createContext)(s),o=(e,n)=>{switch(n.type){case r.SETTEMPLATE:return{...e,template:n.value};case r.SETMODEL:return{...e,model:n.value};case r.SETCURSOR:return{...e,cursor:n.value};case r.SETTEMPLATEVALID:return{...e,templateValid:n.value};case r.SETMODELVALID:return{...e,modelValid:n.value};default:return e}},c=e=>{let{children:n}=e,[t,r]=(0,i.useReducer)(o,s);return(0,l.jsx)(a.Provider,{value:{...t,dispatch:r},children:n})};n.ZP=c},22904:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return eA}});var l=t(85893),i=t(11163),s=t(67294),r=t(13448),a=t(97183),o=t(66516),c=t(27049),d=t(6880),u=t(26713),m=t(84908),h=t(71577),x=t(20046),j=t(18436),v=t(54666),p=t(55734),f=t(11409),g=t(91756),y=t(55061);let b=e=>{if(!e.category)throw Error("missing category");if(!e.name)throw Error("missing name");if(!e.algorithm)throw Error("missing algorithm");if(!e.code)throw Error("missing code");if(!e.version)throw Error("missing version");if(!e.description)throw Error("missing description");if(!e.configuration)throw Error("missing configuration");E(e.configuration.geometry),w(e.configuration.materials),S(e.configuration.parameters),C(e.configuration.initialization),T(e.configuration.boundaryConditions),N(e.configuration.run)},Z=(e,n)=>{if(e){if(!e.index)throw Error("missing configuration."+n+".index");if(!e.title)throw Error("missing configuration."+n+".title")}},E=e=>{if(!e)throw Error("missing configuration.geometry");if(Z(e,"geometry"),void 0===e.meshable)throw Error("missing configuration.geometry.meshable")},w=e=>{if(e){if(Z(e,"materials"),!e.children)throw Error("missing configuration.materials.children");e.children.forEach((e,n)=>{if(!e.label)throw Error("missing configuration.materials.children["+n+"].label");if(!e.name)throw Error("missing configuration.materials.children["+n+"].name");if(!e.htmlEntity)throw Error("missing configuration.materials.children["+n+"].htmlEntity");if(void 0===e.default)throw Error("missing configuration.materials.children["+n+"].default");if(!e.unit)throw Error("missing configuration.materials.children["+n+"].unit")})}},S=e=>{if(!e)throw Error("missing configuration.parameters");Z(e,"parameters"),Object.keys(e).forEach(n=>{if("index"===n||"title"===n||"done"===n)return;let t=e[n];if(!t.label)throw Error("missing configuration.parameters."+n+".label");if(!t.children)throw Error("missing configuration.parameters."+n+".children");k(t,n)})},k=(e,n)=>{e.children.forEach((e,t)=>{if(!e.label)throw Error("missing configuration.parameters."+n+".children["+t+"].label");if(!e.htmlEntity)throw Error("missing configuration.parameters."+n+".children["+t+"].htmlEntity");if(void 0===e.default)throw Error("missing configuration.parameters."+n+".children["+t+"].default")})},C=e=>{e&&Z(e,"initialization")},T=e=>{if(!e)throw Error("missing configuration.boundaryConditions");Z(e,"boundaryConditions"),Object.keys(e).forEach(n=>{if("title"===n||"index"===n||"done"===n)return;let t=e[n];if(!t.label)throw Error("missing configuration.boundaryConditions."+n+".label")})},N=e=>{if(!e)throw Error("missing configuration.run")},I=e=>{var n,t,i,r,a,o,c,d,u,m,x,j,v;let{setName:p}=e,[Z,E]=(0,s.useState)({}),{template:w,model:S,dispatch:k}=(0,s.useContext)(f.rU);return(0,s.useEffect)(()=>{if(!w){E(e=>({...e,template:{status:"wait",err:""},test:{status:"wait"}})),k((0,y.pj)(!1));return}E(e=>{var n;return{...e,template:{status:"finish"},test:{status:(null===(n=e.model)||void 0===n?void 0:n.status)==="finish"?"process":"wait"}}}),k((0,y.pj)(!0))},[w,k]),(0,s.useEffect)(()=>{if(!S){E(e=>({...e,model:{status:"wait"},test:{status:"wait"}})),k((0,y.ET)(!1));return}try{let e=JSON.parse(S);e.name&&p(e.name),b(e),E(e=>{var n;return{...e,model:{status:"finish"},test:{status:(null===(n=e.template)||void 0===n?void 0:n.status)==="finish"?"process":"wait"}}}),k((0,y.ET)(!0))}catch(n){E(e=>({...e,model:{status:"error",err:n.message},test:{status:"wait"}})),k((0,y.ET)(!1))}},[S,p,k]),(0,l.jsxs)(g.Z,{className:"Editor-Steps",direction:"vertical",children:[(0,l.jsx)(g.Z.Step,{title:"Check template format",description:null!==(u=null===(n=Z.template)||void 0===n?void 0:n.err)&&void 0!==u?u:"EJS + FreeFEM",status:null!==(m=null===(t=Z.template)||void 0===t?void 0:t.status)&&void 0!==m?m:"wait"}),(0,l.jsx)(g.Z.Step,{title:"Check description format",description:null!==(x=null===(i=Z.model)||void 0===i?void 0:null===(r=i.err)||void 0===r?void 0:r.replace(/\./g," > "))&&void 0!==x?x:"JSON",status:null!==(j=null===(a=Z.model)||void 0===a?void 0:a.status)&&void 0!==j?j:"wait"}),(0,l.jsx)(g.Z.Step,{title:"Test template + description",description:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.Z,{disabled:!((null===(o=Z.template)||void 0===o?void 0:o.status)==="finish"&&(null===(c=Z.model)||void 0===c?void 0:c.status)==="finish"),onClick:console.log,children:"Run"})," ","template on Tanatloc server"]}),status:null!==(v=null===(d=Z.test)||void 0===d?void 0:d.status)&&void 0!==v?v:"wait"})]})};var O=t(54907),D=t(81579),P=t(69677),F=t(28345);let M=(e,n,t,l,i)=>{var s;let r;n.includes("include('/blobs/mesh.edp.ejs'")||(ec(n,"<%# Mesh -%>\n<%\nconst mesh = geometry.mesh\nmesh.name = '".concat(e.name,"'\n-%>\n<%- include('/blobs/mesh.edp.ejs', {\n  dimension,\n  mesh\n}) -%>\n"),l,i),i((0,y.KJ)({row:((null==l?void 0:l.row)||0)+9,column:0})));try{r=JSON.parse(t)}catch(a){r={}}let o=Object.keys(r.configuration||{}).length;r.configuration={...r.configuration||{},geometry:{index:o+1,title:"Geometry",mesh:{name:e.name},...(null===(s=r.configuration)||void 0===s?void 0:s.geometry)||{},meshable:!0}},i((0,y.j1)(JSON.stringify(r,null,"	")))},R=()=>{let[e,n]=(0,s.useState)(!1),[t,i]=(0,s.useState)(!1),{template:r,model:a,cursor:o,dispatch:c}=(0,s.useContext)(f.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(F.ZP,{title:"Mesh",visible:e,loading:t,async onOk(e){i(!0),M(e,r,a,o,c),i(!1),n(!1)},onCancel:()=>n(!1),children:(0,l.jsx)(D.Z.Item,{name:"name",label:"Name",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{})})}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>n(!0),children:"Mesh"})]})};var U=t(40038),L=t(3089),J=t(24969),A=t(23226);let V=(e,n,t,l,i)=>{var s,r,a;let o;if(!e.materials||!e.materials.length)return;let c=e.materials.map(e=>{let n=A.j[e.symbol],t=n.label,l=n.symbol,i=n.unit;return{label:t,name:l,default:e.default,unit:i}});n.includes("include('/blobs/materials.edp.ejs'")||(ec(n,"<%# Material -%>\n<%- include('/blobs/materials.edp.ejs', {\n  materials\n}) -%>\n",l,i),i((0,y.KJ)({row:((null==l?void 0:l.row)||4)+0,column:0})));try{o=JSON.parse(t)}catch(d){o={}}let u=Object.keys(o.configuration||{}).length;o.configuration={...o.configuration||{},materials:{index:u+1,title:"Materials",...(null===(s=o.configuration)||void 0===s?void 0:s.materials)||{},children:[...(null===(r=o.configuration)||void 0===r?void 0:null===(a=r.materials)||void 0===a?void 0:a.children)||[],...c.map(e=>({label:e.label,name:e.name,htmlEntity:"formula",default:+e.default,unit:e.unit}))]}},i((0,y.j1)(JSON.stringify(o,null,"	")))},q=()=>{let[e,n]=(0,s.useState)(!1),[t,i]=(0,s.useState)(!1),{template:r,model:a,cursor:o,dispatch:c}=(0,s.useContext)(f.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(F.ZP,{title:"Materials",visible:e,loading:t,async onOk(e){i(!0),V(e,r,a,o,c),i(!1),n(!1)},onCancel:()=>n(!1),children:(0,l.jsx)(D.Z.List,{name:"materials",children(e,n,t){let{add:i,remove:s}=n,{errors:r}=t;return(0,l.jsxs)(l.Fragment,{children:[e.map((e,n)=>(0,l.jsxs)(D.Z.Item,{label:(0,l.jsxs)("div",{children:[(0,l.jsx)(L.Z,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>s(e.name)}),"Material ",n+1]}),children:[(0,l.jsx)(D.Z.Item,{name:[e.name,"symbol"],label:"Physical parameter",rules:[{required:!0}],children:(0,l.jsx)(U.Z,{options:A.j.map((e,n)=>({label:e.symbol+": "+e.label,value:n}))})}),(0,l.jsx)(D.Z.Item,{name:[e.name,"default"],label:"Default",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{})})]},e.key)),(0,l.jsxs)(D.Z.Item,{children:[(0,l.jsx)(h.Z,{type:"dashed",onClick:()=>i(),style:{width:"60%"},icon:(0,l.jsx)(J.Z,{}),children:"Add material"}),(0,l.jsx)(D.Z.ErrorList,{errors:r})]})]})}})}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>n(!0),children:"Materials"})]})},z=(e,n,t,l,i)=>{var s,r,a,o,c,d;let u;if(!e.options||!e.options.length)return;ec(n,"<%# Finite element space -%>\n<%\nconst finiteElementSpace = parameters.finiteElementSpace.children[0]\nfiniteElementSpace.name = '".concat(e.name,"'\n-%>\n<%- include('/blobs/fespace.edp.ejs', {\n  mesh,\n  finiteElementSpace\n}) -%>\n"),l,i),i((0,y.KJ)({row:((null==l?void 0:l.row)||9)+0,column:0}));try{u=JSON.parse(t)}catch(m){u={}}let h=Object.keys(u.configuration||{}).length;u.configuration={...u.configuration||{},parameters:{index:h+1,title:"Parameters",...(null===(s=u.configuration)||void 0===s?void 0:s.parameters)||{},finiteElementSpace:{advanced:!0,label:"Finite element space",...(null===(r=u.configuration)||void 0===r?void 0:null===(a=r.parameters)||void 0===a?void 0:a.finiteElementSpace)||{},children:[...(null===(d=null===(o=u.configuration)||void 0===o?void 0:null===(c=o.parameters)||void 0===c?void 0:c.finiteElementSpace)||void 0===d?void 0:d.children)||[],{label:"Finite element space label",label2D:"Finite element space label (2D)",htmlEntity:"select",options:e.options,default:e.options[0].value,default2D:e.options[0].value2D}]}}},i((0,y.j1)(JSON.stringify(u,null,"	")))},H=()=>{let[e,n]=(0,s.useState)(!1),[t,i]=(0,s.useState)(!1),{template:r,model:a,cursor:o,dispatch:c}=(0,s.useContext)(f.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(F.ZP,{title:"Finite element space",visible:e,loading:t,async onOk(e){i(!0),z(e,r,a,o,c),i(!1),n(!1)},onCancel:()=>n(!1),children:[(0,l.jsx)(D.Z.Item,{name:"name",label:"Name",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{})}),(0,l.jsx)(D.Z.List,{name:"datas",children(e,n,t){let{add:i,remove:s}=n,{errors:r}=t;return(0,l.jsxs)(l.Fragment,{children:[e.map((e,n)=>(0,l.jsxs)(D.Z.Item,{label:(0,l.jsxs)("div",{children:[(0,l.jsx)(L.Z,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>s(e.name)}),"Option ",n+1]}),children:[(0,l.jsx)(D.Z.Item,{name:[e.name,"label"],label:"Display name",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{placeholder:"P1"})}),(0,l.jsx)(D.Z.Item,{name:[e.name,"value"],label:"Value",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{placeholder:"[P1, P1, P1]"})}),(0,l.jsx)(D.Z.Item,{name:[e.name,"value2D"],label:"Value 2D",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{placeholder:"[P1, P1]"})})]},e.key)),(0,l.jsxs)(D.Z.Item,{children:[(0,l.jsx)(h.Z,{type:"dashed",onClick:()=>i(),style:{width:"60%"},icon:(0,l.jsx)(J.Z,{}),children:"Add data"}),(0,l.jsx)(D.Z.ErrorList,{errors:r})]})]})}})]}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>n(!0),children:"Finite element space"})]})},K=(e,n,t)=>{ec(e,"<%# Headers -%>\n<%- include('/blobs/headers.edp.ejs') -%>\n",n,t),t((0,y.KJ)({row:((null==n?void 0:n.row)||0)+2,column:0}))},_=()=>{let{template:e,cursor:n,dispatch:t}=(0,s.useContext)(f.rU);return(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>K(e,n,t),children:"Header"})},X=(e,n,t)=>{ec(e,"<%# Dimension -%>\n<%- include('/blobs/dimensioning.edp.ejs', {\n    dimension\n}) -%>\n",n,t),t((0,y.KJ)({row:((null==n?void 0:n.row)||0)+4,column:0}))},G=()=>{let{template:e,cursor:n,dispatch:t}=(0,s.useContext)(f.rU);return(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>X(e,n,t),children:"Dimension"})},Y=(e,n,t,l)=>{ec(n,"<%# Finite element function -%>\n<%\nconst testFunction = dimension === 2 ? '[".concat(e.test1,", ").concat(e.test2,"]' : '[").concat(e.test1,", ").concat(e.test2,", ").concat(e.test3,"]'\nconst unknownFunction = dimension === 2 ? '[").concat(e.unknown1,", ").concat(e.unknown2,"]' : '[").concat(e.unknown1,", ").concat(e.unknown2,", ").concat(e.unknown3,"]'\n-%>\n<%- include('/blobs/fespaceFunction.edp.ejs', {\n    finiteElementSpace,\n    finiteElementFunction: testFunction\n  }) -%>\n  <%- include('/blobs/fespaceFunction.edp.ejs', {\n    finiteElementSpace,\n    finiteElementFunction: unknownFunction\n}) -%>\n"),t,l),l((0,y.KJ)({row:((null==t?void 0:t.row)||9)+0,column:0}))},B=()=>{let[e,n]=(0,s.useState)(!1),[t,i]=(0,s.useState)(!1),{template:r,cursor:a,dispatch:o}=(0,s.useContext)(f.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(F.ZP,{title:"Finite element function",visible:e,loading:t,async onOk(e){i(!0),Y(e,r,a,o),i(!1),n(!1)},onCancel:()=>n(!1),children:[(0,l.jsxs)(D.Z.Item,{label:(0,l.jsx)(d.Z.Text,{strong:!0,children:"Test function"}),children:[(0,l.jsx)(D.Z.Item,{label:"First coordinate",name:"test1",children:(0,l.jsx)(P.Z,{placeholder:"Ux"})}),(0,l.jsx)(D.Z.Item,{label:"Second coordinate",name:"test2",children:(0,l.jsx)(P.Z,{placeholder:"Uy"})}),(0,l.jsx)(D.Z.Item,{label:"Third coordinate",name:"test3",children:(0,l.jsx)(P.Z,{placeholder:"Uz"})})]}),(0,l.jsxs)(D.Z.Item,{label:(0,l.jsx)(d.Z.Text,{strong:!0,children:"Unknows function"}),children:[(0,l.jsx)(D.Z.Item,{label:"First coordinate",name:"unknown1",children:(0,l.jsx)(P.Z,{placeholder:"Uhx"})}),(0,l.jsx)(D.Z.Item,{label:"Second coordinate",name:"unknown2",children:(0,l.jsx)(P.Z,{placeholder:"Uhy"})}),(0,l.jsx)(D.Z.Item,{label:"Third coordinate",name:"unknown3",children:(0,l.jsx)(P.Z,{placeholder:"Uhz"})})]})]}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>n(!0),children:"Finite element function"})]})};var W=t(32808);let Q=(e,n,t,l)=>{let i=e.macros.map(e=>"'"+e+"'").join(", ");ec(n,"<%# Macro -%>\n<%- include('/blobs/macro.edp.ejs', {\n    dimension,\n    type: [".concat(i,"]\n}) -%>\n"),t,l),l((0,y.KJ)({row:((null==t?void 0:t.row)||5)+0,column:0}))},$=()=>{let[e,n]=(0,s.useState)(!1),[t,i]=(0,s.useState)(!1),{template:r,cursor:a,dispatch:o}=(0,s.useContext)(f.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(F.ZP,{title:"Macros",visible:e,loading:t,async onOk(e){i(!0),Q(e,r,a,o),i(!1),n(!1)},onCancel:()=>n(!1),children:(0,l.jsx)(D.Z.Item,{label:"Type",name:"macros",children:(0,l.jsx)(W.Z.Group,{options:[{label:"Scalar gradient",value:"scalarGradient"},{label:"Vectorial divergence",value:"vectorialDivergence"},{label:"Vectorial divergence axisymmetric",value:"vectorialDivergenceRZ"},{label:"Vectorial epsilon",value:"vectorialEpsilon"},{label:"Vectorial gradient",value:"vectorialGradient"},{label:"Vectorial R divergence axisymmetric",value:"vectorialRdivergenceRZ"}],style:{display:"flex",flexDirection:"column"}})})}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>n(!0),children:"Macros"})]})},ee=(e,n,t,l,i)=>{var s,r,a,o,c,d;let u;ec(n,"<%# Solver -%>\n<% const solver = parameters.solver.children[0].value ?? parameters.solver.children[0].default -%>\n<%- include('/blobs/solver.edp.ejs', {\n    solver\n}) -%>",l,i),i((0,y.KJ)({row:((null==l?void 0:l.row)||9)+0,column:0}));try{u=JSON.parse(t)}catch(m){u={}}let h=Object.keys(u.configuration||{}).length;u.configuration={...u.configuration||{},parameters:{index:h+1,title:"Parameters",...(null===(s=u.configuration)||void 0===s?void 0:s.parameters)||{},solver:{advanced:!0,label:"Solver",...(null===(r=u.configuration)||void 0===r?void 0:null===(a=r.parameters)||void 0===a?void 0:a.solver)||{},children:[...(null===(d=null===(o=u.configuration)||void 0===o?void 0:null===(c=o.parameters)||void 0===c?void 0:c.solver)||void 0===d?void 0:d.children)||[],{label:"System resolution",htmlEntity:"select",options:e.solvers.map(e=>({label:e,value:e})),default:"MUMPS"}]}}},i((0,y.j1)(JSON.stringify(u,null,"	")))},en=()=>{let[e,n]=(0,s.useState)(!1),[t,i]=(0,s.useState)(!1),{template:r,model:a,cursor:o,dispatch:c}=(0,s.useContext)(f.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(F.ZP,{title:"Solver",visible:e,loading:t,async onOk(e){i(!0),ee(e,r,a,o,c),i(!1),n(!1)},onCancel:()=>n(!1),children:(0,l.jsx)(D.Z.Item,{name:"solvers",label:"Availables",children:(0,l.jsx)(W.Z.Group,{options:["UMFPCK","CG","Cholesky","Crout","GMRES","LU","sparsesolver","MUMPS"],style:{display:"flex",flexDirection:"column"}})})}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>n(!0),children:"Solver"})]})},et=e=>{var n,t,l,i,s,r,a,o;let c=null===(t=null===(n=e.scalarResults)||void 0===n?void 0:n.map(e=>"'".concat(e.variable,"'")))||void 0===t?void 0:t.join(", "),d=null===(i=null===(l=e.vectorialResults)||void 0===l?void 0:l.map(e=>"dimension === 2 ? ['".concat(e.variable1,"', '").concat(e.variable2,"', '0'] : ['").concat(e.variable1,"', '").concat(e.variable2,"', '").concat(e.variable3,"']")))||void 0===i?void 0:i.join(", "),u=null===(r=null===(s=e.scalarResults)||void 0===s?void 0:s.map(e=>1))||void 0===r?void 0:r.join(", "),m=null===(o=null===(a=e.vectorialResults)||void 0===a?void 0:a.map(e=>1))||void 0===o?void 0:o.join(", ");return{results:(c?c+", ":"")+(null!=d?d:""),order:(u?u+", ":"")+(null!=m?m:"")}},el=(e,n,t,l,i)=>{var s,r,a,o,c,d,u,m;let h;if(!e.scalarResults&&!e.vectorialResults||!(null===(s=e.scalarResults)||void 0===s?void 0:s.length)&&!(null===(r=e.vectorialResults)||void 0===r?void 0:r.length))return;let x=et(e);ec(n,"<%# Save -%>\n<%- include('/blobs/save.edp.ejs', {\n    solution: {\n        path: run.resultPath,\n        name: '\"Result\"',\n        mesh: mesh.name,\n        sol: [".concat(x.results,"],\n        dataName: run.results.map(r => r.name),\n        order: [").concat(x.order,"]\n    }\n}) -%>\n"),l,i),i((0,y.KJ)({row:((null==l?void 0:l.row)||4)+0,column:0}));try{h=JSON.parse(t)}catch(j){h={}}let v=Object.keys(h.configuration||{}).length;h.configuration={...h.configuration||{},run:{index:v+1,title:"Run",...null!==(m=null===(a=h.configuration)||void 0===a?void 0:a.run)&&void 0!==m?m:{},results:[...(null===(o=h.configuration)||void 0===o?void 0:null===(c=o.run)||void 0===c?void 0:c.results)||[],...(null===(d=e.scalarResults)||void 0===d?void 0:d.map(e=>({name:e.name})))||[],...(null===(u=e.vectorialResults)||void 0===u?void 0:u.map(e=>({name:e.name})))||[]]}},i((0,y.j1)(JSON.stringify(h,null,"	")))},ei=()=>{let[e,n]=(0,s.useState)(!1),[t,i]=(0,s.useState)(!1),{template:r,model:a,cursor:o,dispatch:c}=(0,s.useContext)(f.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(F.ZP,{title:"Save",visible:e,loading:t,async onOk(e){i(!0),el(e,r,a,o,c),i(!1),n(!1)},onCancel:()=>n(!1),children:[(0,l.jsx)(D.Z.List,{name:"scalarResults",children(e,n,t){let{add:i,remove:s}=n,{errors:r}=t;return(0,l.jsxs)(l.Fragment,{children:[e.map((e,n)=>(0,l.jsxs)(D.Z.Item,{label:(0,l.jsxs)("div",{children:[(0,l.jsx)(L.Z,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>s(e.name)}),"Scalar result ",n+1]}),children:[(0,l.jsx)(D.Z.Item,{name:[e.name,"name"],label:"Display name",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{})}),(0,l.jsx)(D.Z.Item,{name:[e.name,"variable"],label:"Variable name",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{})})]},e.key)),(0,l.jsxs)(D.Z.Item,{children:[(0,l.jsx)(h.Z,{type:"dashed",onClick:()=>i(),style:{width:"60%"},icon:(0,l.jsx)(J.Z,{}),children:"Add scalar result"}),(0,l.jsx)(D.Z.ErrorList,{errors:r})]})]})}}),(0,l.jsx)(D.Z.List,{name:"vectorialResults",children(e,n,t){let{add:i,remove:s}=n,{errors:r}=t;return(0,l.jsxs)(l.Fragment,{children:[e.map((e,n)=>(0,l.jsxs)(D.Z.Item,{label:(0,l.jsxs)("div",{children:[(0,l.jsx)(L.Z,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>s(e.name)}),"Vectorial result ",n+1]}),children:[(0,l.jsx)(D.Z.Item,{name:[e.name,"name"],label:"Display name",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{})}),(0,l.jsx)(D.Z.Item,{name:[e.name,"variable1"],label:"First component variable name",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{})}),(0,l.jsx)(D.Z.Item,{name:[e.name,"variable2"],label:"Second component variable name",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{})}),(0,l.jsx)(D.Z.Item,{name:[e.name,"variable3"],label:"Third component variable name",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{})})]},e.key)),(0,l.jsxs)(D.Z.Item,{children:[(0,l.jsx)(h.Z,{type:"dashed",onClick:()=>i(),style:{width:"60%"},icon:(0,l.jsx)(J.Z,{}),children:"Add vectorial result"}),(0,l.jsx)(D.Z.ErrorList,{errors:r})]})]})}})]}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>n(!0),children:"Save"})]})},es=(e,n,t,l)=>{e.datas&&e.datas.length&&(ec(n,"<%- include('/blobs/data.edp.ejs', {\n    path: run.dataPath,\n    fileName: '\"iter_\"+timeIter',\n    dataNames: [".concat(e.datas.map(e=>"'".concat(e.name,"'")).join(", "),"],\n    x: '").concat(e.x,"',\n    ys: [").concat(e.datas.map(e=>"'".concat(e.y,"'")).join(", "),"]\n}) -%>"),t,l),l((0,y.KJ)({row:((null==t?void 0:t.row)||4)+0,column:0})))},er=()=>{let[e,n]=(0,s.useState)(!1),[t,i]=(0,s.useState)(!1),{template:r,cursor:a,dispatch:o}=(0,s.useContext)(f.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(F.ZP,{title:"Data",visible:e,loading:t,async onOk(e){i(!0),es(e,r,a,o),i(!1),n(!1)},onCancel:()=>n(!1),children:[(0,l.jsx)(D.Z.Item,{label:"X axis variable",name:"x",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{})}),(0,l.jsx)(D.Z.List,{name:"datas",children(e,n,t){let{add:i,remove:s}=n,{errors:r}=t;return(0,l.jsxs)(l.Fragment,{children:[e.map((e,n)=>(0,l.jsxs)(D.Z.Item,{label:(0,l.jsxs)("div",{children:[(0,l.jsx)(L.Z,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>s(e.name)}),"Data ",n+1]}),children:[(0,l.jsx)(D.Z.Item,{name:[e.name,"name"],label:"Display name",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{})}),(0,l.jsx)(D.Z.Item,{name:[e.name,"y"],label:"Y axis variable",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{})})]},e.key)),(0,l.jsxs)(D.Z.Item,{children:[(0,l.jsx)(h.Z,{type:"dashed",onClick:()=>i(),style:{width:"60%"},icon:(0,l.jsx)(J.Z,{}),children:"Add data"}),(0,l.jsx)(D.Z.ErrorList,{errors:r})]})]})}})]}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>n(!0),children:"Data"})]})},ea=(e,n,t,l)=>{ec(n,"<%# Sensors -%>\n<%- helpers.indent(include('/blobs/sensors.edp.ejs', {\n    path: run.dataPath,\n    x: '".concat(e.x,"',\n    sensors: run.sensors\n}), 2) -%>"),t,l),l((0,y.KJ)({row:((null==t?void 0:t.row)||4)+0,column:0}))},eo=()=>{let[e,n]=(0,s.useState)(!1),[t,i]=(0,s.useState)(!1),{template:r,cursor:a,dispatch:o}=(0,s.useContext)(f.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(F.ZP,{title:"Sensors",visible:e,loading:t,async onOk(e){i(!0),ea(e,r,a,o),i(!1),n(!1)},onCancel:()=>n(!1),children:(0,l.jsx)(D.Z.Item,{label:"X axis variable",name:"x",rules:[{required:!0}],children:(0,l.jsx)(P.Z,{})})}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>n(!0),children:"Sensors"})]})},ec=(e,n,t,l)=>{if(t){let i=t.row,s=(e||"").split("\n"),r=[...s.slice(0,i+1),...n.split("\n"),...s.slice(i+1)];l((0,y.zX)(r.join("\n")))}else l((0,y.zX)((e||"")+n))},ed=()=>(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(O.Z,{style:{overflow:"auto",maxHeight:"calc(100% - 443px)"},children:[(0,l.jsx)(O.Z.Panel,{header:"Head",children:(0,l.jsxs)(u.Z,{direction:"vertical",className:"full-width",children:[(0,l.jsx)(_,{}),(0,l.jsx)(G,{})]})},"head"),(0,l.jsx)(O.Z.Panel,{header:"Components",children:(0,l.jsxs)(u.Z,{direction:"vertical",className:"full-width",children:[(0,l.jsx)(R,{}),(0,l.jsx)(q,{}),(0,l.jsx)(H,{}),(0,l.jsx)(B,{}),(0,l.jsx)($,{}),(0,l.jsx)(en,{})]})},"components"),(0,l.jsx)(O.Z.Panel,{header:"Results",children:(0,l.jsxs)(u.Z,{direction:"vertical",className:"full-width",children:[(0,l.jsx)(ei,{}),(0,l.jsx)(er,{}),(0,l.jsx)(eo,{})]})},"results")]})});var eu=t(43008);let em=e=>{e((0,y.zX)("try{\n<%# Headers -%>\n<%- include('/blobs/headers.edp.ejs') -%>\n\n<%# Dimension -%>\n<%- include('/blobs/dimensioning.edp.ejs', {\n	dimension\n}) -%>\n\n// WRITE YOUR TEMPLATE HERE\n\n} catch(...) {\n	appendError(\"An internal error occurs\");\n	exit(-1);\n}\n")),e((0,y.j1)(JSON.stringify({category:"Category",name:"My new model",algorithm:"Algorithm",code:"FreeFEM",version:"1.0.0",description:"",configuration:{}},null,"	")+"\n"))},eh=()=>{let{dispatch:e}=(0,s.useContext)(f.rU);return(0,l.jsx)(m.Z,{title:"New model",children:(0,l.jsx)(h.Z,{icon:(0,l.jsx)(eu.Z,{}),onClick:()=>em(e)})})};var ex=t(90575),ej=t(95591),ev=t(52402),ep={gmsh2D:"gmsh2D.geo.ejs",gmsh3D:"gmsh3D.geo.ejs",poisson:"poisson.edp.ejs",linearElasticity:"linearElasticity.edp.ejs",linearElasticityTime:"linearElasticityTime.edp.ejs",stokes:"stokes.edp.ejs",navierStokesTime:"navierStokesTime.edp.ejs",thermicDiffusion:"thermicDiffusion.edp.ejs"},ef=t(67582),eg=t(64376);let ey={delete:"Unable to delete model"},eb=async(e,n,t)=>{try{let l=e.models[n],i=e.templates[n];await p.Z.update([{key:"models",type:"array",method:"remove",value:l},{key:"templates",type:"array",method:"remove",value:i}]);let s=eg.Z.deepCopy(e);s.models=[...s.models.slice(0,n),...s.models.slice(n+1)],s.templates=[...s.templates.slice(0,n),...s.templates.slice(n+1)],t.mutateUser(s)}catch(r){throw(0,ef.lt)(ey.delete,r),r}},eZ=e=>{let{user:n,index:t,swr:i}=e;return(0,l.jsx)(j.m1,{onDelete:async()=>eb(n,t,i)})},eE={load:"Unable to load current model"},ew=async(e,n)=>{try{let t=ev.Z[e];n((0,y.j1)(JSON.stringify(t,null,"	")));let l=t.algorithm,i=ep[l],s=await fetch("/templates/"+i),r=await s.text();n((0,y.zX)(r))}catch(a){(0,ef.lt)(eE.load,a)}},eS=async(e,n,t)=>{try{e.user&&delete e.user,t((0,y.j1)(JSON.stringify(e,null,"	"))),t((0,y.zX)(n))}catch(l){(0,ef.lt)(eE.load,l)}},ek=e=>{let{user:n,swr:t}=e,[i,r]=(0,s.useState)(!1),[a,o]=(0,s.useState)(!1),{dispatch:c}=(0,s.useContext)(f.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(F.ZP,{title:"Models browser",visible:i,loading:a,onCancel:()=>r(!1),children:(0,l.jsx)(ex.Z,{items:[{key:"models",label:"Tanatloc models",children:(0,l.jsx)(u.Z,{direction:"vertical",className:"full-width",children:ev.Z.map((e,n)=>(0,l.jsxs)("div",{className:"display-flex",style:{justifyContent:"space-between",alignItems:"center"},children:[e.name,(0,l.jsx)(m.Z,{title:"Open",children:(0,l.jsx)(h.Z,{async onClick(){o(!0);try{await ew(n,c)}finally{o(!1),r(!1)}},icon:(0,l.jsx)(ej.Z,{})})})]},n))})},{key:"personalModels",label:"My models",children:(0,l.jsx)(u.Z,{direction:"vertical",className:"full-width",children:n.models.map((e,i)=>(0,l.jsxs)("div",{className:"display-flex",style:{justifyContent:"space-between",alignItems:"center"},children:[e.name,(0,l.jsxs)("div",{children:[(0,l.jsx)(m.Z,{title:"Open",children:(0,l.jsx)(h.Z,{async onClick(){o(!0);try{await eS(e,n.templates[i],c)}finally{o(!1),r(!1)}},icon:(0,l.jsx)(ej.Z,{})})}),(0,l.jsx)(eZ,{user:n,index:i,swr:t})]})]},i))})}]})}),(0,l.jsx)(m.Z,{title:"Browse existing model",children:(0,l.jsx)(h.Z,{icon:(0,l.jsx)(ej.Z,{}),onClick:()=>r(!0)})})]})};var eC=t(67040),eT=t(60219);let eN={json:"Model definition is not valid",check:"Unable to check",save:"Unable to save"},eI=async(e,n,t,l)=>{let i;try{i=JSON.parse(t)}catch(s){(0,ef.lt)(eN.json,s);return}try{let r=e.models.find(e=>e.algorithm===i.algorithm);r?eC.Z.confirm({title:"A model with the same algorithm entry already exists. Do you want to override it?",async onOk(){let t=e.models.findIndex(e=>e.algorithm===i.algorithm);await eO(e,n,i,l,t)}}):await eO(e,n,i,l)}catch(a){(0,ef.lt)(eN.check,a)}},eO=async(e,n,t,l,i)=>{if(void 0===i)try{await p.Z.update([{key:"models",type:"array",method:"append",value:{...t,user:e.id}},{key:"templates",type:"array",method:"append",value:l}]);let s=eg.Z.deepCopy(e);s.models.push(t),n.mutateUser(s)}catch(r){(0,ef.lt)(eN.save,r)}else try{await p.Z.update([{key:"models",type:"array",method:"set",index:i,value:{...t,user:e.id}},{key:"templates",type:"array",method:"set",index:i,value:l}]);let a=eg.Z.deepCopy(e);a.models[i]=t,n.mutateUser(a)}catch(o){(0,ef.lt)(eN.save,o)}},eD=e=>{let{user:n,swr:t}=e,[i,r]=(0,s.useState)(!1),[a,o]=(0,s.useState)(!1),{model:c,template:d,templateValid:u,modelValid:x}=(0,s.useContext)(f.rU);return(0,s.useEffect)(()=>{u&&x?r(!1):r(!0)},[u,x]),(0,l.jsx)(m.Z,{title:"Save",children:(0,l.jsx)(h.Z,{disabled:i,loading:a,icon:(0,l.jsx)(eT.Z,{}),async onClick(){o(!0),await eI(n,t,c,d),o(!1)}})})};var eP=t(5152),eF=t.n(eP);let eM=eF()(()=>Promise.all([t.e(6052),t.e(3700),t.e(4716)]).then(t.bind(t,34716)),{loadableGenerated:{webpack:()=>[34716]},ssr:!1}),eR=eF()(()=>Promise.all([t.e(6052),t.e(3700),t.e(1119)]).then(t.bind(t,71119)),{loadableGenerated:{webpack:()=>[71119]},ssr:!1}),eU=()=>(0,l.jsxs)("div",{className:"Editor-code",children:[(0,l.jsx)(eM,{}),(0,l.jsx)(eR,{})]}),eL=()=>{let[e,n]=(0,s.useState)(),t=(0,i.useRouter)(),[g,{loadingUser:y,mutateUser:b}]=p.Z.useUser();(0,s.useEffect)(()=>{y||g||t.replace("/")},[g,y,t]),(0,s.useEffect)(()=>{r.Z.warning({message:"This is a beta version",description:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("br",{}),"- You may encounter unexpected bugs",(0,l.jsx)("br",{}),"- Some features are not totally functionnal"]}),placement:"top",duration:0})},[]);let Z=(0,s.useCallback)(()=>{t.push({pathname:"/dashboard"})},[t]);return y||!g?(0,l.jsx)(v.Z,{}):(0,l.jsx)(f.ZP,{children:(0,l.jsxs)(a.Z,{className:"Editor",children:[(0,l.jsxs)(a.Z.Sider,{theme:"light",width:"256",children:[(0,l.jsx)("div",{className:"logo",children:(0,l.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,l.jsx)(o.Z,{mode:"inline",items:[{key:"menu-go-back",disabled:!0,style:{cursor:"unset",margin:"10px 0",paddingLeft:10},label:(0,l.jsx)(j.ks,{onClick:Z,children:"Return to dashboard"})},{type:"divider",className:"Editor-Menu-Divider"}]}),(0,l.jsx)(I,{setName:n}),(0,l.jsx)(c.Z,{}),(0,l.jsx)(ed,{})]}),(0,l.jsxs)(a.Z.Content,{className:"no-scroll",children:[(0,l.jsx)(a.Z.Header,{className:"Editor-Header",children:(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,l.jsx)(d.Z.Text,{strong:!0,children:e}),(0,l.jsxs)(u.Z,{children:[(0,l.jsx)(eh,{}),(0,l.jsx)(ek,{user:{id:g.id,models:g.models,templates:g.templates},swr:{mutateUser:b}}),(0,l.jsx)(eD,{user:{id:g.id,models:g.models},swr:{mutateUser:b}}),(0,l.jsx)(m.Z,{title:"Coming soon",children:(0,l.jsx)(h.Z,{disabled:!0,icon:(0,l.jsx)(x.Z,{})})})]})]})}),(0,l.jsx)(eU,{})]})]})})},eJ=()=>(0,l.jsx)(eL,{});var eA=eJ}},function(e){e.O(0,[6040,6362,1474,1266,6495,4362,6690,2650,1756,7040,6326,2620,2645,3407,9785,9774,2888,179],function(){return e(e.s=31832)}),_N_E=e.O()}]);