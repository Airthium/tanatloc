(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[154],{95591:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var l=n(1413),i=n(67294),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"},a=n(42135),s=function(e,t){return i.createElement(a.Z,(0,l.Z)((0,l.Z)({},e),{},{ref:t,icon:r}))};s.displayName="FolderOpenOutlined";var o=i.forwardRef(s)},20046:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var l=n(1413),i=n(67294),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.68 160.68 0 000-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3 0 66.2 53.8 120 120 120s120-53.8 120-120-53.8-120-120-120zm0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52-52-23.3-52-52 23.3-52 52-52zM312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88 88 39.5 88 88-39.5 88-88 88zm440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52 52 23.3 52 52-23.3 52-52 52z"}}]},name:"share-alt",theme:"outlined"},a=n(42135),s=function(e,t){return i.createElement(a.Z,(0,l.Z)((0,l.Z)({},e),{},{ref:t,icon:r}))};s.displayName="ShareAltOutlined";var o=i.forwardRef(s)},31832:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/editor",function(){return n(66635)}])},37645:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){let n=r.default,i=(null==t?void 0:t.suspense)?{}:{loading(e){let{error:t,isLoading:n,pastDelay:l}=e;return null}};if(e instanceof Promise?i.loader=()=>e:"function"==typeof e?i.loader=e:"object"==typeof e&&(i=l({},i,e)),(i=l({},i,t)).suspense&&(delete i.ssr,delete i.loading),i.loadableGenerated&&delete(i=l({},i,i.loadableGenerated)).loadableGenerated,"boolean"==typeof i.ssr&&!i.suspense){if(!i.ssr)return delete i.ssr,a(n,i);delete i.ssr}return n(i)},t.noSSR=a;var l=n(6495).Z,i=n(92648).Z,r=(i(n(67294)),i(n(14588)));function a(e,t){return delete t.webpack,delete t.modules,e(t)}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},33644:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadableContext=void 0;var l=(0,n(92648).Z)(n(67294));let i=l.default.createContext(null);t.LoadableContext=i},14588:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(6495).Z,i=(0,n(91598).Z)(n(67294)),r=n(33644);let a=[],s=[],o=!1;function d(e){let t=e(),n={loading:!0,loaded:null,error:null};return n.promise=t.then(e=>(n.loading=!1,n.loaded=e,e)).catch(e=>{throw n.loading=!1,n.error=e,e}),n}class c{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state=l({},this._state,{error:this._res.error,loaded:this._res.loaded,loading:this._res.loading},e),this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function u(e){return function(e,t){let n=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null,suspense:!1},t);n.suspense&&(n.lazy=i.default.lazy(n.loader));let a=null;function d(){if(!a){let t=new c(e,n);a={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return a.promise()}if(!o){let u=n.webpack?n.webpack():n.modules;u&&s.push(e=>{for(let t of u)if(-1!==e.indexOf(t))return d()})}function m(){d();let e=i.default.useContext(r.LoadableContext);e&&Array.isArray(n.modules)&&n.modules.forEach(t=>{e(t)})}let h=n.suspense?function(e,t){return m(),i.default.createElement(n.lazy,l({},e,{ref:t}))}:function(e,t){m();let l=i.useSyncExternalStore(a.subscribe,a.getCurrentValue,a.getCurrentValue);return i.default.useImperativeHandle(t,()=>({retry:a.retry}),[]),i.default.useMemo(()=>{var t;return l.loading||l.error?i.default.createElement(n.loading,{isLoading:l.loading,pastDelay:l.pastDelay,timedOut:l.timedOut,error:l.error,retry:a.retry}):l.loaded?i.default.createElement((t=l.loaded)&&t.__esModule?t.default:t,e):null},[e,l])};return h.preload=()=>d(),h.displayName="LoadableComponent",i.default.forwardRef(h)}(d,e)}function m(e,t){let n=[];for(;e.length;){let l=e.pop();n.push(l(t))}return Promise.all(n).then(()=>{if(e.length)return m(e,t)})}u.preloadAll=()=>new Promise((e,t)=>{m(a).then(e,t)}),u.preloadReady=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise(t=>{let n=()=>(o=!0,t());m(s,e).then(n,n)})},window.__NEXT_PRELOADREADY=u.preloadReady,t.default=u},55061:function(e,t,n){"use strict";n.d(t,{ET:function(){return o},KJ:function(){return a},j1:function(){return r},pj:function(){return s},zX:function(){return i}});var l=n(11409);let i=e=>({type:l.Hp.SETTEMPLATE,value:e}),r=e=>({type:l.Hp.SETMODEL,value:e}),a=e=>({type:l.Hp.SETCURSOR,value:e}),s=e=>({type:l.Hp.SETTEMPLATEVALID,value:e}),o=e=>({type:l.Hp.SETMODELVALID,value:e})},11409:function(e,t,n){"use strict";n.d(t,{Hp:function(){return a},rU:function(){return s}});var l=n(85893),i=n(67294);let r={template:"",model:"",dispatch:()=>void 0,templateValid:!1,modelValid:!1},a={SETTEMPLATE:"SETTEMPLATE",SETMODEL:"SETMODEL",SETCURSOR:"SETCURSOR",SETTEMPLATEVALID:"SETTEMPLATEVALID",SETMODELVALID:"SETMODELVALID"},s=(0,i.createContext)(r),o=(e,t)=>{switch(t.type){case a.SETTEMPLATE:return{...e,template:t.value};case a.SETMODEL:return{...e,model:t.value};case a.SETCURSOR:return{...e,cursor:t.value};case a.SETTEMPLATEVALID:return{...e,templateValid:t.value};case a.SETMODELVALID:return{...e,modelValid:t.value};default:return e}},d=e=>{let{children:t}=e,[n,a]=(0,i.useReducer)(o,r);return(0,l.jsx)(s.Provider,{value:{...n,dispatch:a},children:t})};t.ZP=d},66635:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eX}});var l=n(85893),i=n(11163),r=n(67294),a=n(13448),s=n(97183),o=n(66516),d=n(27049),c=n(6880),u=n(26713),m=n(84908),h=n(71577),p=n(20046),f=n(18436),v=n(54666),x=n(55734),j=n(11409),g=n(1485),y=n(55061);let b=e=>{if(!e.category)throw Error("missing category");if(!e.name)throw Error("missing name");if(!e.algorithm)throw Error("missing algorithm");if(!e.code)throw Error("missing code");if(!e.version)throw Error("missing version");if(!e.description)throw Error("missing description");if(!e.configuration)throw Error("missing configuration");w(e.configuration.geometry),E(e.configuration.materials),S(e.configuration.parameters),C(e.configuration.initialization),T(e.configuration.boundaryConditions),O(e.configuration.run)},Z=(e,t)=>{if(e){if(!e.index)throw Error("missing configuration."+t+".index");if(!e.title)throw Error("missing configuration."+t+".title")}},w=e=>{if(!e)throw Error("missing configuration.geometry");if(Z(e,"geometry"),void 0===e.meshable)throw Error("missing configuration.geometry.meshable")},E=e=>{if(e){if(Z(e,"materials"),!e.children)throw Error("missing configuration.materials.children");e.children.forEach((e,t)=>{if(!e.label)throw Error("missing configuration.materials.children["+t+"].label");if(!e.name)throw Error("missing configuration.materials.children["+t+"].name");if(!e.htmlEntity)throw Error("missing configuration.materials.children["+t+"].htmlEntity");if(void 0===e.default)throw Error("missing configuration.materials.children["+t+"].default");if(!e.unit)throw Error("missing configuration.materials.children["+t+"].unit")})}},S=e=>{if(!e)throw Error("missing configuration.parameters");Z(e,"parameters"),Object.keys(e).forEach(t=>{if("index"===t||"title"===t||"done"===t)return;let n=e[t];if(!n.label)throw Error("missing configuration.parameters."+t+".label");if(!n.children)throw Error("missing configuration.parameters."+t+".children");k(n,t)})},k=(e,t)=>{e.children.forEach((e,n)=>{if(!e.label)throw Error("missing configuration.parameters."+t+".children["+n+"].label");if(!e.htmlEntity)throw Error("missing configuration.parameters."+t+".children["+n+"].htmlEntity");if(void 0===e.default)throw Error("missing configuration.parameters."+t+".children["+n+"].default")})},C=e=>{e&&Z(e,"initialization")},T=e=>{if(!e)throw Error("missing configuration.boundaryConditions");Z(e,"boundaryConditions"),Object.keys(e).forEach(t=>{if("title"===t||"index"===t||"done"===t)return;let n=e[t];if(!n.label)throw Error("missing configuration.boundaryConditions."+t+".label")})},O=e=>{if(!e)throw Error("missing configuration.run")},_=e=>{var t,n,i,a,s,o,d,c,u,m,p,f,v;let{setName:x}=e,[Z,w]=(0,r.useState)({}),{template:E,model:S,dispatch:k}=(0,r.useContext)(j.rU);return(0,r.useEffect)(()=>{if(!E){w(e=>({...e,template:{status:"wait",err:""},test:{status:"wait"}})),k((0,y.pj)(!1));return}w(e=>{var t;return{...e,template:{status:"finish"},test:{status:(null===(t=e.model)||void 0===t?void 0:t.status)==="finish"?"process":"wait"}}}),k((0,y.pj)(!0))},[E,k]),(0,r.useEffect)(()=>{if(!S){w(e=>({...e,model:{status:"wait"},test:{status:"wait"}})),k((0,y.ET)(!1));return}try{let e=JSON.parse(S);e.name&&x(e.name),b(e),w(e=>{var t;return{...e,model:{status:"finish"},test:{status:(null===(t=e.template)||void 0===t?void 0:t.status)==="finish"?"process":"wait"}}}),k((0,y.ET)(!0))}catch(t){w(e=>({...e,model:{status:"error",err:t.message},test:{status:"wait"}})),k((0,y.ET)(!1))}},[S,x,k]),(0,l.jsxs)(g.Z,{className:"Editor-Steps",direction:"vertical",children:[(0,l.jsx)(g.Z.Step,{title:"Check template format",description:null!==(u=null===(t=Z.template)||void 0===t?void 0:t.err)&&void 0!==u?u:"EJS + FreeFEM",status:null!==(m=null===(n=Z.template)||void 0===n?void 0:n.status)&&void 0!==m?m:"wait"}),(0,l.jsx)(g.Z.Step,{title:"Check description format",description:null!==(p=null===(i=Z.model)||void 0===i?void 0:null===(a=i.err)||void 0===a?void 0:a.replace(/\./g," > "))&&void 0!==p?p:"JSON",status:null!==(f=null===(s=Z.model)||void 0===s?void 0:s.status)&&void 0!==f?f:"wait"}),(0,l.jsx)(g.Z.Step,{title:"Test template + description",description:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.Z,{disabled:!((null===(o=Z.template)||void 0===o?void 0:o.status)==="finish"&&(null===(d=Z.model)||void 0===d?void 0:d.status)==="finish"),onClick:console.log,children:"Run"})," ","template on Tanatloc server"]}),status:null!==(v=null===(c=Z.test)||void 0===c?void 0:c.status)&&void 0!==v?v:"wait"})]})};var M=n(54907),N=n(81579),D=n(69677),P=n(28345);let I=(e,t,n,l,i)=>{var r;let a;t.includes("include('/blobs/mesh.edp.ejs'")||(eh(t,"<%# Mesh -%>\n<%\nconst mesh = geometry.mesh\nmesh.name = '".concat(e.name,"'\n-%>\n<%- include('/blobs/mesh.edp.ejs', {\n  dimension,\n  mesh\n}) -%>\n"),l,i),i((0,y.KJ)({row:((null==l?void 0:l.row)||0)+9,column:0})));try{a=JSON.parse(n)}catch(s){a={}}let o=Object.keys(a.configuration||{}).length;a.configuration={...a.configuration||{},geometry:{index:o+1,title:"Geometry",mesh:{name:e.name},...(null===(r=a.configuration)||void 0===r?void 0:r.geometry)||{},meshable:!0}},i((0,y.j1)(JSON.stringify(a,null,"	")))},L=()=>{let[e,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),{template:a,model:s,cursor:o,dispatch:d}=(0,r.useContext)(j.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(P.ZP,{title:"Mesh",visible:e,loading:n,async onOk(e){i(!0),I(e,a,s,o,d),i(!1),t(!1)},onCancel:()=>t(!1),children:(0,l.jsx)(N.Z.Item,{name:"name",label:"Name",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{})})}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>t(!0),children:"Mesh"})]})};var R=n(40038),F=n(1413),U={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"},V=n(42135),z=function(e,t){return r.createElement(V.Z,(0,F.Z)((0,F.Z)({},e),{},{ref:t,icon:U}))};z.displayName="MinusCircleOutlined";var A=r.forwardRef(z),J=n(24969),H=n(23226);let q=(e,t,n,l,i)=>{var r,a,s;let o;if(!e.materials||!e.materials.length)return;let d=e.materials.map(e=>{let t=H.j[e.symbol],n=t.label,l=t.symbol,i=t.unit;return{label:n,name:l,default:e.default,unit:i}});t.includes("include('/blobs/materials.edp.ejs'")||(eh(t,"<%# Material -%>\n<%- include('/blobs/materials.edp.ejs', {\n  materials\n}) -%>\n",l,i),i((0,y.KJ)({row:((null==l?void 0:l.row)||4)+0,column:0})));try{o=JSON.parse(n)}catch(c){o={}}let u=Object.keys(o.configuration||{}).length;o.configuration={...o.configuration||{},materials:{index:u+1,title:"Materials",...(null===(r=o.configuration)||void 0===r?void 0:r.materials)||{},children:[...(null===(a=o.configuration)||void 0===a?void 0:null===(s=a.materials)||void 0===s?void 0:s.children)||[],...d.map(e=>({label:e.label,name:e.name,htmlEntity:"formula",default:+e.default,unit:e.unit}))]}},i((0,y.j1)(JSON.stringify(o,null,"	")))},K=()=>{let[e,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),{template:a,model:s,cursor:o,dispatch:d}=(0,r.useContext)(j.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(P.ZP,{title:"Materials",visible:e,loading:n,async onOk(e){i(!0),q(e,a,s,o,d),i(!1),t(!1)},onCancel:()=>t(!1),children:(0,l.jsx)(N.Z.List,{name:"materials",children(e,t,n){let{add:i,remove:r}=t,{errors:a}=n;return(0,l.jsxs)(l.Fragment,{children:[e.map((e,t)=>(0,l.jsxs)(N.Z.Item,{label:(0,l.jsxs)("div",{children:[(0,l.jsx)(A,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>r(e.name)}),"Material ",t+1]}),children:[(0,l.jsx)(N.Z.Item,{name:[e.name,"symbol"],label:"Physical parameter",rules:[{required:!0}],children:(0,l.jsx)(R.Z,{options:H.j.map((e,t)=>({label:e.symbol+": "+e.label,value:t}))})}),(0,l.jsx)(N.Z.Item,{name:[e.name,"default"],label:"Default",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{})})]},e.key)),(0,l.jsxs)(N.Z.Item,{children:[(0,l.jsx)(h.Z,{type:"dashed",onClick:()=>i(),style:{width:"60%"},icon:(0,l.jsx)(J.Z,{}),children:"Add material"}),(0,l.jsx)(N.Z.ErrorList,{errors:a})]})]})}})}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>t(!0),children:"Materials"})]})},G=(e,t,n,l,i)=>{var r,a,s,o,d,c;let u;if(!e.options||!e.options.length)return;eh(t,"<%# Finite element space -%>\n<%\nconst finiteElementSpace = parameters.finiteElementSpace.children[0]\nfiniteElementSpace.name = '".concat(e.name,"'\n-%>\n<%- include('/blobs/fespace.edp.ejs', {\n  mesh,\n  finiteElementSpace\n}) -%>\n"),l,i),i((0,y.KJ)({row:((null==l?void 0:l.row)||9)+0,column:0}));try{u=JSON.parse(n)}catch(m){u={}}let h=Object.keys(u.configuration||{}).length;u.configuration={...u.configuration||{},parameters:{index:h+1,title:"Parameters",...(null===(r=u.configuration)||void 0===r?void 0:r.parameters)||{},finiteElementSpace:{advanced:!0,label:"Finite element space",...(null===(a=u.configuration)||void 0===a?void 0:null===(s=a.parameters)||void 0===s?void 0:s.finiteElementSpace)||{},children:[...(null===(c=null===(o=u.configuration)||void 0===o?void 0:null===(d=o.parameters)||void 0===d?void 0:d.finiteElementSpace)||void 0===c?void 0:c.children)||[],{label:"Finite element space label",label2D:"Finite element space label (2D)",htmlEntity:"select",options:e.options,default:e.options[0].value,default2D:e.options[0].value2D}]}}},i((0,y.j1)(JSON.stringify(u,null,"	")))},X=()=>{let[e,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),{template:a,model:s,cursor:o,dispatch:d}=(0,r.useContext)(j.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(P.ZP,{title:"Finite element space",visible:e,loading:n,async onOk(e){i(!0),G(e,a,s,o,d),i(!1),t(!1)},onCancel:()=>t(!1),children:[(0,l.jsx)(N.Z.Item,{name:"name",label:"Name",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{})}),(0,l.jsx)(N.Z.List,{name:"datas",children(e,t,n){let{add:i,remove:r}=t,{errors:a}=n;return(0,l.jsxs)(l.Fragment,{children:[e.map((e,t)=>(0,l.jsxs)(N.Z.Item,{label:(0,l.jsxs)("div",{children:[(0,l.jsx)(A,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>r(e.name)}),"Option ",t+1]}),children:[(0,l.jsx)(N.Z.Item,{name:[e.name,"label"],label:"Display name",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{placeholder:"P1"})}),(0,l.jsx)(N.Z.Item,{name:[e.name,"value"],label:"Value",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{placeholder:"[P1, P1, P1]"})}),(0,l.jsx)(N.Z.Item,{name:[e.name,"value2D"],label:"Value 2D",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{placeholder:"[P1, P1]"})})]},e.key)),(0,l.jsxs)(N.Z.Item,{children:[(0,l.jsx)(h.Z,{type:"dashed",onClick:()=>i(),style:{width:"60%"},icon:(0,l.jsx)(J.Z,{}),children:"Add data"}),(0,l.jsx)(N.Z.ErrorList,{errors:a})]})]})}})]}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>t(!0),children:"Finite element space"})]})},B=(e,t,n)=>{eh(e,"<%# Headers -%>\n<%- include('/blobs/headers.edp.ejs') -%>\n",t,n),n((0,y.KJ)({row:((null==t?void 0:t.row)||0)+2,column:0}))},Y=()=>{let{template:e,cursor:t,dispatch:n}=(0,r.useContext)(j.rU);return(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>B(e,t,n),children:"Header"})},W=(e,t,n)=>{eh(e,"<%# Dimension -%>\n<%- include('/blobs/dimensioning.edp.ejs', {\n    dimension\n}) -%>\n",t,n),n((0,y.KJ)({row:((null==t?void 0:t.row)||0)+4,column:0}))},Q=()=>{let{template:e,cursor:t,dispatch:n}=(0,r.useContext)(j.rU);return(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>W(e,t,n),children:"Dimension"})},$=(e,t,n,l)=>{eh(t,"<%# Finite element function -%>\n<%\nconst testFunction = dimension === 2 ? '[".concat(e.test1,", ").concat(e.test2,"]' : '[").concat(e.test1,", ").concat(e.test2,", ").concat(e.test3,"]'\nconst unknownFunction = dimension === 2 ? '[").concat(e.unknown1,", ").concat(e.unknown2,"]' : '[").concat(e.unknown1,", ").concat(e.unknown2,", ").concat(e.unknown3,"]'\n-%>\n<%- include('/blobs/fespaceFunction.edp.ejs', {\n    finiteElementSpace,\n    finiteElementFunction: testFunction\n  }) -%>\n  <%- include('/blobs/fespaceFunction.edp.ejs', {\n    finiteElementSpace,\n    finiteElementFunction: unknownFunction\n}) -%>\n"),n,l),l((0,y.KJ)({row:((null==n?void 0:n.row)||9)+0,column:0}))},ee=()=>{let[e,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),{template:a,cursor:s,dispatch:o}=(0,r.useContext)(j.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(P.ZP,{title:"Finite element function",visible:e,loading:n,async onOk(e){i(!0),$(e,a,s,o),i(!1),t(!1)},onCancel:()=>t(!1),children:[(0,l.jsxs)(N.Z.Item,{label:(0,l.jsx)(c.Z.Text,{strong:!0,children:"Test function"}),children:[(0,l.jsx)(N.Z.Item,{label:"First coordinate",name:"test1",children:(0,l.jsx)(D.Z,{placeholder:"Ux"})}),(0,l.jsx)(N.Z.Item,{label:"Second coordinate",name:"test2",children:(0,l.jsx)(D.Z,{placeholder:"Uy"})}),(0,l.jsx)(N.Z.Item,{label:"Third coordinate",name:"test3",children:(0,l.jsx)(D.Z,{placeholder:"Uz"})})]}),(0,l.jsxs)(N.Z.Item,{label:(0,l.jsx)(c.Z.Text,{strong:!0,children:"Unknows function"}),children:[(0,l.jsx)(N.Z.Item,{label:"First coordinate",name:"unknown1",children:(0,l.jsx)(D.Z,{placeholder:"Uhx"})}),(0,l.jsx)(N.Z.Item,{label:"Second coordinate",name:"unknown2",children:(0,l.jsx)(D.Z,{placeholder:"Uhy"})}),(0,l.jsx)(N.Z.Item,{label:"Third coordinate",name:"unknown3",children:(0,l.jsx)(D.Z,{placeholder:"Uhz"})})]})]}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>t(!0),children:"Finite element function"})]})};var et=n(32808);let en=(e,t,n,l)=>{let i=e.macros.map(e=>"'"+e+"'").join(", ");eh(t,"<%# Macro -%>\n<%- include('/blobs/macro.edp.ejs', {\n    dimension,\n    type: [".concat(i,"]\n}) -%>\n"),n,l),l((0,y.KJ)({row:((null==n?void 0:n.row)||5)+0,column:0}))},el=()=>{let[e,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),{template:a,cursor:s,dispatch:o}=(0,r.useContext)(j.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(P.ZP,{title:"Macros",visible:e,loading:n,async onOk(e){i(!0),en(e,a,s,o),i(!1),t(!1)},onCancel:()=>t(!1),children:(0,l.jsx)(N.Z.Item,{label:"Type",name:"macros",children:(0,l.jsx)(et.Z.Group,{options:[{label:"Scalar gradient",value:"scalarGradient"},{label:"Vectorial divergence",value:"vectorialDivergence"},{label:"Vectorial divergence axisymmetric",value:"vectorialDivergenceRZ"},{label:"Vectorial epsilon",value:"vectorialEpsilon"},{label:"Vectorial gradient",value:"vectorialGradient"},{label:"Vectorial R divergence axisymmetric",value:"vectorialRdivergenceRZ"}],style:{display:"flex",flexDirection:"column"}})})}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>t(!0),children:"Macros"})]})},ei=(e,t,n,l,i)=>{var r,a,s,o,d,c;let u;eh(t,"<%# Solver -%>\n<% const solver = parameters.solver.children[0].value ?? parameters.solver.children[0].default -%>\n<%- include('/blobs/solver.edp.ejs', {\n    solver\n}) -%>",l,i),i((0,y.KJ)({row:((null==l?void 0:l.row)||9)+0,column:0}));try{u=JSON.parse(n)}catch(m){u={}}let h=Object.keys(u.configuration||{}).length;u.configuration={...u.configuration||{},parameters:{index:h+1,title:"Parameters",...(null===(r=u.configuration)||void 0===r?void 0:r.parameters)||{},solver:{advanced:!0,label:"Solver",...(null===(a=u.configuration)||void 0===a?void 0:null===(s=a.parameters)||void 0===s?void 0:s.solver)||{},children:[...(null===(c=null===(o=u.configuration)||void 0===o?void 0:null===(d=o.parameters)||void 0===d?void 0:d.solver)||void 0===c?void 0:c.children)||[],{label:"System resolution",htmlEntity:"select",options:e.solvers.map(e=>({label:e,value:e})),default:"MUMPS"}]}}},i((0,y.j1)(JSON.stringify(u,null,"	")))},er=()=>{let[e,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),{template:a,model:s,cursor:o,dispatch:d}=(0,r.useContext)(j.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(P.ZP,{title:"Solver",visible:e,loading:n,async onOk(e){i(!0),ei(e,a,s,o,d),i(!1),t(!1)},onCancel:()=>t(!1),children:(0,l.jsx)(N.Z.Item,{name:"solvers",label:"Availables",children:(0,l.jsx)(et.Z.Group,{options:["UMFPCK","CG","Cholesky","Crout","GMRES","LU","sparsesolver","MUMPS"],style:{display:"flex",flexDirection:"column"}})})}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>t(!0),children:"Solver"})]})},ea=e=>{var t,n,l,i,r,a,s,o;let d=null===(n=null===(t=e.scalarResults)||void 0===t?void 0:t.map(e=>"'".concat(e.variable,"'")))||void 0===n?void 0:n.join(", "),c=null===(i=null===(l=e.vectorialResults)||void 0===l?void 0:l.map(e=>"dimension === 2 ? ['".concat(e.variable1,"', '").concat(e.variable2,"', '0'] : ['").concat(e.variable1,"', '").concat(e.variable2,"', '").concat(e.variable3,"']")))||void 0===i?void 0:i.join(", "),u=null===(a=null===(r=e.scalarResults)||void 0===r?void 0:r.map(e=>1))||void 0===a?void 0:a.join(", "),m=null===(o=null===(s=e.vectorialResults)||void 0===s?void 0:s.map(e=>1))||void 0===o?void 0:o.join(", ");return{results:(d?d+", ":"")+(null!=c?c:""),order:(u?u+", ":"")+(null!=m?m:"")}},es=(e,t,n,l,i)=>{var r,a,s,o,d,c,u,m;let h;if(!e.scalarResults&&!e.vectorialResults||!(null===(r=e.scalarResults)||void 0===r?void 0:r.length)&&!(null===(a=e.vectorialResults)||void 0===a?void 0:a.length))return;let p=ea(e);eh(t,"<%# Save -%>\n<%- include('/blobs/save.edp.ejs', {\n    solution: {\n        path: run.resultPath,\n        name: '\"Result\"',\n        mesh: mesh.name,\n        sol: [".concat(p.results,"],\n        dataName: run.results.map(r => r.name),\n        order: [").concat(p.order,"]\n    }\n}) -%>\n"),l,i),i((0,y.KJ)({row:((null==l?void 0:l.row)||4)+0,column:0}));try{h=JSON.parse(n)}catch(f){h={}}let v=Object.keys(h.configuration||{}).length;h.configuration={...h.configuration||{},run:{index:v+1,title:"Run",...null!==(m=null===(s=h.configuration)||void 0===s?void 0:s.run)&&void 0!==m?m:{},results:[...(null===(o=h.configuration)||void 0===o?void 0:null===(d=o.run)||void 0===d?void 0:d.results)||[],...(null===(c=e.scalarResults)||void 0===c?void 0:c.map(e=>({name:e.name})))||[],...(null===(u=e.vectorialResults)||void 0===u?void 0:u.map(e=>({name:e.name})))||[]]}},i((0,y.j1)(JSON.stringify(h,null,"	")))},eo=()=>{let[e,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),{template:a,model:s,cursor:o,dispatch:d}=(0,r.useContext)(j.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(P.ZP,{title:"Save",visible:e,loading:n,async onOk(e){i(!0),es(e,a,s,o,d),i(!1),t(!1)},onCancel:()=>t(!1),children:[(0,l.jsx)(N.Z.List,{name:"scalarResults",children(e,t,n){let{add:i,remove:r}=t,{errors:a}=n;return(0,l.jsxs)(l.Fragment,{children:[e.map((e,t)=>(0,l.jsxs)(N.Z.Item,{label:(0,l.jsxs)("div",{children:[(0,l.jsx)(A,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>r(e.name)}),"Scalar result ",t+1]}),children:[(0,l.jsx)(N.Z.Item,{name:[e.name,"name"],label:"Display name",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{})}),(0,l.jsx)(N.Z.Item,{name:[e.name,"variable"],label:"Variable name",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{})})]},e.key)),(0,l.jsxs)(N.Z.Item,{children:[(0,l.jsx)(h.Z,{type:"dashed",onClick:()=>i(),style:{width:"60%"},icon:(0,l.jsx)(J.Z,{}),children:"Add scalar result"}),(0,l.jsx)(N.Z.ErrorList,{errors:a})]})]})}}),(0,l.jsx)(N.Z.List,{name:"vectorialResults",children(e,t,n){let{add:i,remove:r}=t,{errors:a}=n;return(0,l.jsxs)(l.Fragment,{children:[e.map((e,t)=>(0,l.jsxs)(N.Z.Item,{label:(0,l.jsxs)("div",{children:[(0,l.jsx)(A,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>r(e.name)}),"Vectorial result ",t+1]}),children:[(0,l.jsx)(N.Z.Item,{name:[e.name,"name"],label:"Display name",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{})}),(0,l.jsx)(N.Z.Item,{name:[e.name,"variable1"],label:"First component variable name",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{})}),(0,l.jsx)(N.Z.Item,{name:[e.name,"variable2"],label:"Second component variable name",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{})}),(0,l.jsx)(N.Z.Item,{name:[e.name,"variable3"],label:"Third component variable name",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{})})]},e.key)),(0,l.jsxs)(N.Z.Item,{children:[(0,l.jsx)(h.Z,{type:"dashed",onClick:()=>i(),style:{width:"60%"},icon:(0,l.jsx)(J.Z,{}),children:"Add vectorial result"}),(0,l.jsx)(N.Z.ErrorList,{errors:a})]})]})}})]}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>t(!0),children:"Save"})]})},ed=(e,t,n,l)=>{e.datas&&e.datas.length&&(eh(t,"<%- include('/blobs/data.edp.ejs', {\n    path: run.dataPath,\n    fileName: '\"iter_\"+timeIter',\n    dataNames: [".concat(e.datas.map(e=>"'".concat(e.name,"'")).join(", "),"],\n    x: '").concat(e.x,"',\n    ys: [").concat(e.datas.map(e=>"'".concat(e.y,"'")).join(", "),"]\n}) -%>"),n,l),l((0,y.KJ)({row:((null==n?void 0:n.row)||4)+0,column:0})))},ec=()=>{let[e,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),{template:a,cursor:s,dispatch:o}=(0,r.useContext)(j.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(P.ZP,{title:"Data",visible:e,loading:n,async onOk(e){i(!0),ed(e,a,s,o),i(!1),t(!1)},onCancel:()=>t(!1),children:[(0,l.jsx)(N.Z.Item,{label:"X axis variable",name:"x",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{})}),(0,l.jsx)(N.Z.List,{name:"datas",children(e,t,n){let{add:i,remove:r}=t,{errors:a}=n;return(0,l.jsxs)(l.Fragment,{children:[e.map((e,t)=>(0,l.jsxs)(N.Z.Item,{label:(0,l.jsxs)("div",{children:[(0,l.jsx)(A,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>r(e.name)}),"Data ",t+1]}),children:[(0,l.jsx)(N.Z.Item,{name:[e.name,"name"],label:"Display name",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{})}),(0,l.jsx)(N.Z.Item,{name:[e.name,"y"],label:"Y axis variable",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{})})]},e.key)),(0,l.jsxs)(N.Z.Item,{children:[(0,l.jsx)(h.Z,{type:"dashed",onClick:()=>i(),style:{width:"60%"},icon:(0,l.jsx)(J.Z,{}),children:"Add data"}),(0,l.jsx)(N.Z.ErrorList,{errors:a})]})]})}})]}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>t(!0),children:"Data"})]})},eu=(e,t,n,l)=>{eh(t,"<%# Sensors -%>\n<%- helpers.indent(include('/blobs/sensors.edp.ejs', {\n    path: run.dataPath,\n    x: '".concat(e.x,"',\n    sensors: run.sensors\n}), 2) -%>"),n,l),l((0,y.KJ)({row:((null==n?void 0:n.row)||4)+0,column:0}))},em=()=>{let[e,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),{template:a,cursor:s,dispatch:o}=(0,r.useContext)(j.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(P.ZP,{title:"Sensors",visible:e,loading:n,async onOk(e){i(!0),eu(e,a,s,o),i(!1),t(!1)},onCancel:()=>t(!1),children:(0,l.jsx)(N.Z.Item,{label:"X axis variable",name:"x",rules:[{required:!0}],children:(0,l.jsx)(D.Z,{})})}),(0,l.jsx)(h.Z,{className:"full-width",onClick:()=>t(!0),children:"Sensors"})]})},eh=(e,t,n,l)=>{if(n){let i=n.row,r=(e||"").split("\n"),a=[...r.slice(0,i+1),...t.split("\n"),...r.slice(i+1)];l((0,y.zX)(a.join("\n")))}else l((0,y.zX)((e||"")+t))},ep=()=>(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(M.Z,{style:{overflow:"auto",maxHeight:"calc(100% - 443px)"},children:[(0,l.jsx)(M.Z.Panel,{header:"Head",children:(0,l.jsxs)(u.Z,{direction:"vertical",className:"full-width",children:[(0,l.jsx)(Y,{}),(0,l.jsx)(Q,{})]})},"head"),(0,l.jsx)(M.Z.Panel,{header:"Components",children:(0,l.jsxs)(u.Z,{direction:"vertical",className:"full-width",children:[(0,l.jsx)(L,{}),(0,l.jsx)(K,{}),(0,l.jsx)(X,{}),(0,l.jsx)(ee,{}),(0,l.jsx)(el,{}),(0,l.jsx)(er,{})]})},"components"),(0,l.jsx)(M.Z.Panel,{header:"Results",children:(0,l.jsxs)(u.Z,{direction:"vertical",className:"full-width",children:[(0,l.jsx)(eo,{}),(0,l.jsx)(ec,{}),(0,l.jsx)(em,{})]})},"results")]})});var ef={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM544 472c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v108H372c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h108v108c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V644h108c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V472z"}}]},name:"file-add",theme:"outlined"},ev=function(e,t){return r.createElement(V.Z,(0,F.Z)((0,F.Z)({},e),{},{ref:t,icon:ef}))};ev.displayName="FileAddOutlined";var ex=r.forwardRef(ev);let ej=e=>{e((0,y.zX)("try{\n<%# Headers -%>\n<%- include('/blobs/headers.edp.ejs') -%>\n\n<%# Dimension -%>\n<%- include('/blobs/dimensioning.edp.ejs', {\n	dimension\n}) -%>\n\n// WRITE YOUR TEMPLATE HERE\n\n} catch(...) {\n	appendError(\"An internal error occurs\");\n	exit(-1);\n}\n")),e((0,y.j1)(JSON.stringify({category:"Category",name:"My new model",algorithm:"Algorithm",code:"FreeFEM",version:"1.0.0",description:"",configuration:{}},null,"	")+"\n"))},eg=()=>{let{dispatch:e}=(0,r.useContext)(j.rU);return(0,l.jsx)(m.Z,{title:"New model",children:(0,l.jsx)(h.Z,{icon:(0,l.jsx)(ex,{}),onClick:()=>ej(e)})})};var ey=n(90575),eb=n(95591),eZ=n(52402),ew={gmsh2D:"gmsh2D.geo.ejs",gmsh3D:"gmsh3D.geo.ejs",poisson:"poisson.edp.ejs",linearElasticity:"linearElasticity.edp.ejs",linearElasticityTime:"linearElasticityTime.edp.ejs",stokes:"stokes.edp.ejs",navierStokesTime:"navierStokesTime.edp.ejs",thermicDiffusion:"thermicDiffusion.edp.ejs"},eE=n(67582),eS=n(64376);let ek={delete:"Unable to delete model"},eC=async(e,t,n)=>{try{let l=e.models[t],i=e.templates[t];await x.Z.update([{key:"models",type:"array",method:"remove",value:l},{key:"templates",type:"array",method:"remove",value:i}]);let r=eS.Z.deepCopy(e);r.models=[...r.models.slice(0,t),...r.models.slice(t+1)],r.templates=[...r.templates.slice(0,t),...r.templates.slice(t+1)],n.mutateUser(r)}catch(a){throw(0,eE.lt)(ek.delete,a),a}},eT=e=>{let{user:t,index:n,swr:i}=e;return(0,l.jsx)(f.m1,{onDelete:async()=>eC(t,n,i)})},eO={load:"Unable to load current model"},e_=async(e,t)=>{try{let n=eZ.Z[e];t((0,y.j1)(JSON.stringify(n,null,"	")));let l=n.algorithm,i=ew[l],r=await fetch("/templates/"+i),a=await r.text();t((0,y.zX)(a))}catch(s){(0,eE.lt)(eO.load,s)}},eM=async(e,t,n)=>{try{e.user&&delete e.user,n((0,y.j1)(JSON.stringify(e,null,"	"))),n((0,y.zX)(t))}catch(l){(0,eE.lt)(eO.load,l)}},eN=e=>{let{user:t,swr:n}=e,[i,a]=(0,r.useState)(!1),[s,o]=(0,r.useState)(!1),{dispatch:d}=(0,r.useContext)(j.rU);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(P.ZP,{title:"Models browser",visible:i,loading:s,onCancel:()=>a(!1),children:(0,l.jsx)(ey.Z,{items:[{key:"models",label:"Tanatloc models",children:(0,l.jsx)(u.Z,{direction:"vertical",className:"full-width",children:eZ.Z.map((e,t)=>(0,l.jsxs)("div",{className:"display-flex",style:{justifyContent:"space-between",alignItems:"center"},children:[e.name,(0,l.jsx)(m.Z,{title:"Open",children:(0,l.jsx)(h.Z,{async onClick(){o(!0);try{await e_(t,d)}finally{o(!1),a(!1)}},icon:(0,l.jsx)(eb.Z,{})})})]},t))})},{key:"personalModels",label:"My models",children:(0,l.jsx)(u.Z,{direction:"vertical",className:"full-width",children:t.models.map((e,i)=>(0,l.jsxs)("div",{className:"display-flex",style:{justifyContent:"space-between",alignItems:"center"},children:[e.name,(0,l.jsxs)("div",{children:[(0,l.jsx)(m.Z,{title:"Open",children:(0,l.jsx)(h.Z,{async onClick(){o(!0);try{await eM(e,t.templates[i],d)}finally{o(!1),a(!1)}},icon:(0,l.jsx)(eb.Z,{})})}),(0,l.jsx)(eT,{user:t,index:i,swr:n})]})]},i))})}]})}),(0,l.jsx)(m.Z,{title:"Browse existing model",children:(0,l.jsx)(h.Z,{icon:(0,l.jsx)(eb.Z,{}),onClick:()=>a(!0)})})]})};var eD=n(67040),eP={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},eI=function(e,t){return r.createElement(V.Z,(0,F.Z)((0,F.Z)({},e),{},{ref:t,icon:eP}))};eI.displayName="SaveOutlined";var eL=r.forwardRef(eI);let eR={json:"Model definition is not valid",check:"Unable to check",save:"Unable to save"},eF=async(e,t,n,l)=>{let i;try{i=JSON.parse(n)}catch(r){(0,eE.lt)(eR.json,r);return}try{let a=e.models.find(e=>e.algorithm===i.algorithm);a?eD.Z.confirm({title:"A model with the same algorithm entry already exists. Do you want to override it?",async onOk(){let n=e.models.findIndex(e=>e.algorithm===i.algorithm);await eU(e,t,i,l,n)}}):await eU(e,t,i,l)}catch(s){(0,eE.lt)(eR.check,s)}},eU=async(e,t,n,l,i)=>{if(void 0===i)try{await x.Z.update([{key:"models",type:"array",method:"append",value:{...n,user:e.id}},{key:"templates",type:"array",method:"append",value:l}]);let r=eS.Z.deepCopy(e);r.models.push(n),t.mutateUser(r)}catch(a){(0,eE.lt)(eR.save,a)}else try{await x.Z.update([{key:"models",type:"array",method:"set",index:i,value:{...n,user:e.id}},{key:"templates",type:"array",method:"set",index:i,value:l}]);let s=eS.Z.deepCopy(e);s.models[i]=n,t.mutateUser(s)}catch(o){(0,eE.lt)(eR.save,o)}},eV=e=>{let{user:t,swr:n}=e,[i,a]=(0,r.useState)(!1),[s,o]=(0,r.useState)(!1),{model:d,template:c,templateValid:u,modelValid:p}=(0,r.useContext)(j.rU);return(0,r.useEffect)(()=>{u&&p?a(!1):a(!0)},[u,p]),(0,l.jsx)(m.Z,{title:"Save",children:(0,l.jsx)(h.Z,{disabled:i,loading:s,icon:(0,l.jsx)(eL,{}),async onClick(){o(!0),await eF(t,n,d,c),o(!1)}})})};var ez=n(5152),eA=n.n(ez);let eJ=eA()(()=>Promise.all([n.e(52),n.e(700),n.e(716)]).then(n.bind(n,34716)).catch(e=>{let t=()=>(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{children:"Unable to load FreeFEM-EJS editor"}),(0,l.jsx)("p",{children:e.message})]});return t}),{loadableGenerated:{webpack:()=>[34716]},ssr:!1}),eH=eA()(()=>Promise.all([n.e(52),n.e(700),n.e(119)]).then(n.bind(n,71119)).catch(e=>{let t=()=>(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{children:"Unable to load JSON editor"}),(0,l.jsx)("p",{children:e.message})]});return t}),{loadableGenerated:{webpack:()=>[71119]},ssr:!1}),eq=()=>(0,l.jsxs)("div",{className:"Editor-code",children:[(0,l.jsx)(eJ,{}),(0,l.jsx)(eH,{})]}),eK=()=>{let[e,t]=(0,r.useState)(),n=(0,i.useRouter)(),[g,{loadingUser:y,mutateUser:b}]=x.Z.useUser();(0,r.useEffect)(()=>{y||g||n.replace("/")},[g,y,n]),(0,r.useEffect)(()=>{a.Z.warning({message:"This is a beta version",description:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("br",{}),"- You may encounter unexpected bugs",(0,l.jsx)("br",{}),"- Some features are not totally functionnal"]}),placement:"top",duration:0})},[]);let Z=(0,r.useCallback)(()=>{n.push({pathname:"/dashboard"})},[n]);return y||!g?(0,l.jsx)(v.Z,{}):(0,l.jsx)(j.ZP,{children:(0,l.jsxs)(s.Z,{className:"Editor",children:[(0,l.jsxs)(s.Z.Sider,{theme:"light",width:"256",children:[(0,l.jsx)("div",{className:"logo",children:(0,l.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,l.jsx)(o.Z,{mode:"inline",items:[{key:"menu-go-back",disabled:!0,style:{cursor:"unset",margin:"10px 0",paddingLeft:10},label:(0,l.jsx)(f.ks,{onClick:Z,children:"Return to dashboard"})},{type:"divider",className:"Editor-Menu-Divider"}]}),(0,l.jsx)(_,{setName:t}),(0,l.jsx)(d.Z,{}),(0,l.jsx)(ep,{})]}),(0,l.jsxs)(s.Z.Content,{className:"no-scroll",children:[(0,l.jsx)(s.Z.Header,{className:"Editor-Header",children:(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,l.jsx)(c.Z.Text,{strong:!0,children:e}),(0,l.jsxs)(u.Z,{children:[(0,l.jsx)(eg,{}),(0,l.jsx)(eN,{user:{id:g.id,models:g.models,templates:g.templates},swr:{mutateUser:b}}),(0,l.jsx)(eV,{user:{id:g.id,models:g.models},swr:{mutateUser:b}}),(0,l.jsx)(m.Z,{title:"Coming soon",children:(0,l.jsx)(h.Z,{disabled:!0,icon:(0,l.jsx)(p.Z,{})})})]})]})}),(0,l.jsx)(eq,{})]})]})})},eG=()=>(0,l.jsx)(eK,{});var eX=eG},5152:function(e,t,n){e.exports=n(37645)}},function(e){e.O(0,[305,362,474,266,495,347,690,485,650,566,40,326,620,407,785,774,888,179],function(){return e(e.s=31832)}),_N_E=e.O()}]);