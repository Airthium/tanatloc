(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[154],{95591:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return icons_FolderOpenOutlined}});var objectSpread2=__webpack_require__(1413),react=__webpack_require__(67294),asn_FolderOpenOutlined={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"},AntdIcon=__webpack_require__(42135),FolderOpenOutlined_FolderOpenOutlined=function(props,ref){return react.createElement(AntdIcon.Z,(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{ref:ref,icon:asn_FolderOpenOutlined}))};FolderOpenOutlined_FolderOpenOutlined.displayName="FolderOpenOutlined";var icons_FolderOpenOutlined=react.forwardRef(FolderOpenOutlined_FolderOpenOutlined)},20046:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return icons_ShareAltOutlined}});var objectSpread2=__webpack_require__(1413),react=__webpack_require__(67294),asn_ShareAltOutlined={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.68 160.68 0 000-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3 0 66.2 53.8 120 120 120s120-53.8 120-120-53.8-120-120-120zm0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52-52-23.3-52-52 23.3-52 52-52zM312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88 88 39.5 88 88-39.5 88-88 88zm440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52 52 23.3 52 52-23.3 52-52 52z"}}]},name:"share-alt",theme:"outlined"},AntdIcon=__webpack_require__(42135),ShareAltOutlined_ShareAltOutlined=function(props,ref){return react.createElement(AntdIcon.Z,(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{ref:ref,icon:asn_ShareAltOutlined}))};ShareAltOutlined_ShareAltOutlined.displayName="ShareAltOutlined";var icons_ShareAltOutlined=react.forwardRef(ShareAltOutlined_ShareAltOutlined)},31832:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){(window.__NEXT_P=window.__NEXT_P||[]).push(["/editor",function(){return __webpack_require__(66635)}])},37645:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(dynamicOptions,options){let loadableFn=_loadable.default,loadableOptions=(null==options?void 0:options.suspense)?{}:{loading(param){let{error,isLoading,pastDelay}=param;return null}};if(dynamicOptions instanceof Promise?loadableOptions.loader=()=>dynamicOptions:"function"==typeof dynamicOptions?loadableOptions.loader=dynamicOptions:"object"==typeof dynamicOptions&&(loadableOptions=_extends({},loadableOptions,dynamicOptions)),(loadableOptions=_extends({},loadableOptions,options)).suspense&&(delete loadableOptions.ssr,delete loadableOptions.loading),loadableOptions.loadableGenerated&&delete(loadableOptions=_extends({},loadableOptions,loadableOptions.loadableGenerated)).loadableGenerated,"boolean"==typeof loadableOptions.ssr&&!loadableOptions.suspense){if(!loadableOptions.ssr)return delete loadableOptions.ssr,noSSR(loadableFn,loadableOptions);delete loadableOptions.ssr}return loadableFn(loadableOptions)},exports.noSSR=noSSR;var _extends=__webpack_require__(6495).Z,_interop_require_default=__webpack_require__(92648).Z,_loadable=(_interop_require_default(__webpack_require__(67294)),_interop_require_default(__webpack_require__(14588)));function noSSR(LoadableInitializer,loadableOptions){return delete loadableOptions.webpack,delete loadableOptions.modules,LoadableInitializer(loadableOptions)}("function"==typeof exports.default||"object"==typeof exports.default&&null!==exports.default)&&void 0===exports.default.__esModule&&(Object.defineProperty(exports.default,"__esModule",{value:!0}),Object.assign(exports.default,exports),module.exports=exports.default)},33644:function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LoadableContext=void 0;var _react=(0,__webpack_require__(92648).Z)(__webpack_require__(67294));let LoadableContext=_react.default.createContext(null);exports.LoadableContext=LoadableContext},14588:function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends=__webpack_require__(6495).Z,_react=(0,__webpack_require__(91598).Z)(__webpack_require__(67294)),_loadableContext=__webpack_require__(33644);let ALL_INITIALIZERS=[],READY_INITIALIZERS=[],initialized=!1;function load(loader){let promise=loader(),state={loading:!0,loaded:null,error:null};return state.promise=promise.then(loaded=>(state.loading=!1,state.loaded=loaded,loaded)).catch(err=>{throw state.loading=!1,state.error=err,err}),state}class LoadableSubscription{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:res,_opts:opts}=this;res.loading&&("number"==typeof opts.delay&&(0===opts.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},opts.delay)),"number"==typeof opts.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},opts.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(_err=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(partial){this._state=_extends({},this._state,{error:this._res.error,loaded:this._res.loaded,loading:this._res.loading},partial),this._callbacks.forEach(callback=>callback())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(callback){return this._callbacks.add(callback),()=>{this._callbacks.delete(callback)}}constructor(loadFn,opts){this._loadFn=loadFn,this._opts=opts,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function Loadable(opts){return function(loadFn,options){let opts=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null,suspense:!1},options);opts.suspense&&(opts.lazy=_react.default.lazy(opts.loader));let subscription=null;function init(){if(!subscription){let sub=new LoadableSubscription(loadFn,opts);subscription={getCurrentValue:sub.getCurrentValue.bind(sub),subscribe:sub.subscribe.bind(sub),retry:sub.retry.bind(sub),promise:sub.promise.bind(sub)}}return subscription.promise()}if(!initialized){let moduleIds=opts.webpack?opts.webpack():opts.modules;moduleIds&&READY_INITIALIZERS.push(ids=>{for(let moduleId of moduleIds)if(-1!==ids.indexOf(moduleId))return init()})}function useLoadableModule(){init();let context=_react.default.useContext(_loadableContext.LoadableContext);context&&Array.isArray(opts.modules)&&opts.modules.forEach(moduleName=>{context(moduleName)})}let LoadableComponent=opts.suspense?function(props,ref){return useLoadableModule(),_react.default.createElement(opts.lazy,_extends({},props,{ref}))}:function(props,ref){useLoadableModule();let state=_react.useSyncExternalStore(subscription.subscribe,subscription.getCurrentValue,subscription.getCurrentValue);return _react.default.useImperativeHandle(ref,()=>({retry:subscription.retry}),[]),_react.default.useMemo(()=>{var obj;return state.loading||state.error?_react.default.createElement(opts.loading,{isLoading:state.loading,pastDelay:state.pastDelay,timedOut:state.timedOut,error:state.error,retry:subscription.retry}):state.loaded?_react.default.createElement((obj=state.loaded)&&obj.__esModule?obj.default:obj,props):null},[props,state])};return LoadableComponent.preload=()=>init(),LoadableComponent.displayName="LoadableComponent",_react.default.forwardRef(LoadableComponent)}(load,opts)}function flushInitializers(initializers,ids){let promises=[];for(;initializers.length;){let init=initializers.pop();promises.push(init(ids))}return Promise.all(promises).then(()=>{if(initializers.length)return flushInitializers(initializers,ids)})}Loadable.preloadAll=()=>new Promise((resolveInitializers,reject)=>{flushInitializers(ALL_INITIALIZERS).then(resolveInitializers,reject)}),Loadable.preloadReady=function(){let ids=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise(resolvePreload=>{let res=()=>(initialized=!0,resolvePreload());flushInitializers(READY_INITIALIZERS,ids).then(res,res)})},window.__NEXT_PRELOADREADY=Loadable.preloadReady,exports.default=Loadable},55061:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{ET:function(){return setModelValid},KJ:function(){return setCursor},j1:function(){return setModel},pj:function(){return setTemplateValid},zX:function(){return setTemplate}});var ___WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(11409);let setTemplate=template=>({type:___WEBPACK_IMPORTED_MODULE_0__.Hp.SETTEMPLATE,value:template}),setModel=model=>({type:___WEBPACK_IMPORTED_MODULE_0__.Hp.SETMODEL,value:model}),setCursor=cursor=>({type:___WEBPACK_IMPORTED_MODULE_0__.Hp.SETCURSOR,value:cursor}),setTemplateValid=valid=>({type:___WEBPACK_IMPORTED_MODULE_0__.Hp.SETTEMPLATEVALID,value:valid}),setModelValid=valid=>({type:___WEBPACK_IMPORTED_MODULE_0__.Hp.SETMODELVALID,value:valid})},11409:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Hp:function(){return actionTypes},rU:function(){return EditorContext}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(85893),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(67294);let initialState={template:"",model:"",dispatch:()=>void 0,templateValid:!1,modelValid:!1},actionTypes={SETTEMPLATE:"SETTEMPLATE",SETMODEL:"SETMODEL",SETCURSOR:"SETCURSOR",SETTEMPLATEVALID:"SETTEMPLATEVALID",SETMODELVALID:"SETMODELVALID"},EditorContext=(0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(initialState),editorReducer=(state,action)=>{switch(action.type){case actionTypes.SETTEMPLATE:return{...state,template:action.value};case actionTypes.SETMODEL:return{...state,model:action.value};case actionTypes.SETCURSOR:return{...state,cursor:action.value};case actionTypes.SETTEMPLATEVALID:return{...state,templateValid:action.value};case actionTypes.SETMODELVALID:return{...state,modelValid:action.value};default:return state}},EditorProvider=param=>{let{children}=param,[editorState,editorDispatch]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useReducer)(editorReducer,initialState);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(EditorContext.Provider,{value:{...editorState,dispatch:editorDispatch},children:children})};__webpack_exports__.ZP=EditorProvider},66635:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return pages_editor}});var jsx_runtime=__webpack_require__(85893),next_router=__webpack_require__(11163),react=__webpack_require__(67294),notification=__webpack_require__(13448),layout=__webpack_require__(97183),menu=__webpack_require__(66516),divider=__webpack_require__(27049),typography=__webpack_require__(6880),space=__webpack_require__(26713),tooltip=__webpack_require__(84908),es_button=__webpack_require__(71577),ShareAltOutlined=__webpack_require__(20046),assets_button=__webpack_require__(18436),loading=__webpack_require__(54666),api_user=__webpack_require__(55734),editor=__webpack_require__(11409),steps=__webpack_require__(1485),actions=__webpack_require__(55061);let checkModel=model=>{if(!model.category)throw Error("missing category");if(!model.name)throw Error("missing name");if(!model.algorithm)throw Error("missing algorithm");if(!model.code)throw Error("missing code");if(!model.version)throw Error("missing version");if(!model.description)throw Error("missing description");if(!model.configuration)throw Error("missing configuration");checkModelGeometry(model.configuration.geometry),checkModelMaterials(model.configuration.materials),checkModelParameters(model.configuration.parameters),checkModelInitialization(model.configuration.initialization),checkModelBoundaryConditions(model.configuration.boundaryConditions),checkModelRun(model.configuration.run)},checkModelCommon=(common,key)=>{if(common){if(!common.index)throw Error("missing configuration."+key+".index");if(!common.title)throw Error("missing configuration."+key+".title")}},checkModelGeometry=geometry=>{if(!geometry)throw Error("missing configuration.geometry");if(checkModelCommon(geometry,"geometry"),void 0===geometry.meshable)throw Error("missing configuration.geometry.meshable")},checkModelMaterials=materials=>{if(materials){if(checkModelCommon(materials,"materials"),!materials.children)throw Error("missing configuration.materials.children");materials.children.forEach((material,index)=>{if(!material.label)throw Error("missing configuration.materials.children["+index+"].label");if(!material.name)throw Error("missing configuration.materials.children["+index+"].name");if(!material.htmlEntity)throw Error("missing configuration.materials.children["+index+"].htmlEntity");if(void 0===material.default)throw Error("missing configuration.materials.children["+index+"].default");if(!material.unit)throw Error("missing configuration.materials.children["+index+"].unit")})}},checkModelParameters=parameters=>{if(!parameters)throw Error("missing configuration.parameters");checkModelCommon(parameters,"parameters"),Object.keys(parameters).forEach(key=>{if("index"===key||"title"===key||"done"===key)return;let parameter=parameters[key];if(!parameter.label)throw Error("missing configuration.parameters."+key+".label");if(!parameter.children)throw Error("missing configuration.parameters."+key+".children");checkModelParameterChildren(parameter,key)})},checkModelParameterChildren=(parameter,key)=>{parameter.children.forEach((child,index)=>{if(!child.label)throw Error("missing configuration.parameters."+key+".children["+index+"].label");if(!child.htmlEntity)throw Error("missing configuration.parameters."+key+".children["+index+"].htmlEntity");if(void 0===child.default)throw Error("missing configuration.parameters."+key+".children["+index+"].default")})},checkModelInitialization=initialization=>{initialization&&checkModelCommon(initialization,"initialization")},checkModelBoundaryConditions=boundaryConditions=>{if(!boundaryConditions)throw Error("missing configuration.boundaryConditions");checkModelCommon(boundaryConditions,"boundaryConditions"),Object.keys(boundaryConditions).forEach(key=>{if("title"===key||"index"===key||"done"===key)return;let boundaryCondition=boundaryConditions[key];if(!boundaryCondition.label)throw Error("missing configuration.boundaryConditions."+key+".label")})},checkModelRun=run=>{if(!run)throw Error("missing configuration.run")},StatusSteps=param=>{var ref,ref1,ref2,ref3,ref4,ref5,ref6,ref7,ref8,ref9,ref10,ref11,ref12;let{setName}=param,[status,setStatus]=(0,react.useState)({}),{template,model,dispatch}=(0,react.useContext)(editor.rU);return(0,react.useEffect)(()=>{if(!template){setStatus(prev=>({...prev,template:{status:"wait",err:""},test:{status:"wait"}})),dispatch((0,actions.pj)(!1));return}setStatus(prev=>{var ref;return{...prev,template:{status:"finish"},test:{status:(null===(ref=prev.model)||void 0===ref?void 0:ref.status)==="finish"?"process":"wait"}}}),dispatch((0,actions.pj)(!0))},[template,dispatch]),(0,react.useEffect)(()=>{if(!model){setStatus(prev=>({...prev,model:{status:"wait"},test:{status:"wait"}})),dispatch((0,actions.ET)(!1));return}try{let modelJSON=JSON.parse(model);modelJSON.name&&setName(modelJSON.name),checkModel(modelJSON),setStatus(prev=>{var ref;return{...prev,model:{status:"finish"},test:{status:(null===(ref=prev.template)||void 0===ref?void 0:ref.status)==="finish"?"process":"wait"}}}),dispatch((0,actions.ET)(!0))}catch(err){setStatus(prev=>({...prev,model:{status:"error",err:err.message},test:{status:"wait"}})),dispatch((0,actions.ET)(!1))}},[model,setName,dispatch]),(0,jsx_runtime.jsxs)(steps.Z,{className:"Editor-Steps",direction:"vertical",children:[(0,jsx_runtime.jsx)(steps.Z.Step,{title:"Check template format",description:null!==(ref8=null===(ref=status.template)||void 0===ref?void 0:ref.err)&&void 0!==ref8?ref8:"EJS + FreeFEM",status:null!==(ref9=null===(ref1=status.template)||void 0===ref1?void 0:ref1.status)&&void 0!==ref9?ref9:"wait"}),(0,jsx_runtime.jsx)(steps.Z.Step,{title:"Check description format",description:null!==(ref10=null===(ref2=status.model)||void 0===ref2?void 0:null===(ref3=ref2.err)||void 0===ref3?void 0:ref3.replace(/\./g," > "))&&void 0!==ref10?ref10:"JSON",status:null!==(ref11=null===(ref4=status.model)||void 0===ref4?void 0:ref4.status)&&void 0!==ref11?ref11:"wait"}),(0,jsx_runtime.jsx)(steps.Z.Step,{title:"Test template + description",description:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(es_button.Z,{disabled:!((null===(ref5=status.template)||void 0===ref5?void 0:ref5.status)==="finish"&&(null===(ref6=status.model)||void 0===ref6?void 0:ref6.status)==="finish"),onClick:console.log,children:"Run"})," ","template on Tanatloc server"]}),status:null!==(ref12=null===(ref7=status.test)||void 0===ref7?void 0:ref7.status)&&void 0!==ref12?ref12:"wait"})]})};var collapse=__webpack_require__(54907),es_form=__webpack_require__(81579),input=__webpack_require__(69677),dialog=__webpack_require__(28345);let onAdd=(values,template,model,cursor,dispatch)=>{var ref;let modelJSON;template.includes("include('/blobs/mesh.edp.ejs'")||(addOnCursor(template,"<%# Mesh -%>\n<%\nconst mesh = geometry.mesh\nmesh.name = '".concat(values.name,"'\n-%>\n<%- include('/blobs/mesh.edp.ejs', {\n  dimension,\n  mesh\n}) -%>\n"),cursor,dispatch),dispatch((0,actions.KJ)({row:((null==cursor?void 0:cursor.row)||0)+9,column:0})));try{modelJSON=JSON.parse(model)}catch(err){modelJSON={}}let index=Object.keys(modelJSON.configuration||{}).length;modelJSON.configuration={...modelJSON.configuration||{},geometry:{index:index+1,title:"Geometry",mesh:{name:values.name},...(null===(ref=modelJSON.configuration)||void 0===ref?void 0:ref.geometry)||{},meshable:!0}},dispatch((0,actions.j1)(JSON.stringify(modelJSON,null,"	")))},Mesh=()=>{let[visible,setVisible]=(0,react.useState)(!1),[loading,setLoading]=(0,react.useState)(!1),{template,model,cursor,dispatch}=(0,react.useContext)(editor.rU);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(dialog.ZP,{title:"Mesh",visible:visible,loading:loading,async onOk(values){setLoading(!0),onAdd(values,template,model,cursor,dispatch),setLoading(!1),setVisible(!1)},onCancel:()=>setVisible(!1),children:(0,jsx_runtime.jsx)(es_form.Z.Item,{name:"name",label:"Name",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{})})}),(0,jsx_runtime.jsx)(es_button.Z,{className:"full-width",onClick:()=>setVisible(!0),children:"Mesh"})]})};var es_select=__webpack_require__(40038),objectSpread2=__webpack_require__(1413),asn_MinusCircleOutlined={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"},AntdIcon=__webpack_require__(42135),MinusCircleOutlined_MinusCircleOutlined=function(props,ref){return react.createElement(AntdIcon.Z,(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{ref:ref,icon:asn_MinusCircleOutlined}))};MinusCircleOutlined_MinusCircleOutlined.displayName="MinusCircleOutlined";var icons_MinusCircleOutlined=react.forwardRef(MinusCircleOutlined_MinusCircleOutlined),PlusOutlined=__webpack_require__(24969),config_materials=__webpack_require__(23226);let materials_onAdd=(values,template,model,cursor,dispatch)=>{var ref,ref1,ref2;let modelJSON;if(!values.materials||!values.materials.length)return;let materials=values.materials.map(material=>{let symbol=config_materials.j[material.symbol],label=symbol.label,name=symbol.symbol,unit=symbol.unit;return{label,name,default:material.default,unit}});template.includes("include('/blobs/materials.edp.ejs'")||(addOnCursor(template,"<%# Material -%>\n<%- include('/blobs/materials.edp.ejs', {\n  materials\n}) -%>\n",cursor,dispatch),dispatch((0,actions.KJ)({row:((null==cursor?void 0:cursor.row)||4)+0,column:0})));try{modelJSON=JSON.parse(model)}catch(err){modelJSON={}}let index=Object.keys(modelJSON.configuration||{}).length;modelJSON.configuration={...modelJSON.configuration||{},materials:{index:index+1,title:"Materials",...(null===(ref=modelJSON.configuration)||void 0===ref?void 0:ref.materials)||{},children:[...(null===(ref1=modelJSON.configuration)||void 0===ref1?void 0:null===(ref2=ref1.materials)||void 0===ref2?void 0:ref2.children)||[],...materials.map(material=>({label:material.label,name:material.name,htmlEntity:"formula",default:+material.default,unit:material.unit}))]}},dispatch((0,actions.j1)(JSON.stringify(modelJSON,null,"	")))},Materials=()=>{let[visible,setVisible]=(0,react.useState)(!1),[loading,setLoading]=(0,react.useState)(!1),{template,model,cursor,dispatch}=(0,react.useContext)(editor.rU);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(dialog.ZP,{title:"Materials",visible:visible,loading:loading,async onOk(values){setLoading(!0),materials_onAdd(values,template,model,cursor,dispatch),setLoading(!1),setVisible(!1)},onCancel:()=>setVisible(!1),children:(0,jsx_runtime.jsx)(es_form.Z.List,{name:"materials",children(fields,param,param1){let{add,remove}=param,{errors}=param1;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[fields.map((field,index)=>(0,jsx_runtime.jsxs)(es_form.Z.Item,{label:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(icons_MinusCircleOutlined,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>remove(field.name)}),"Material ",index+1]}),children:[(0,jsx_runtime.jsx)(es_form.Z.Item,{name:[field.name,"symbol"],label:"Physical parameter",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(es_select.Z,{options:config_materials.j.map((symbol,sindex)=>({label:symbol.symbol+": "+symbol.label,value:sindex}))})}),(0,jsx_runtime.jsx)(es_form.Z.Item,{name:[field.name,"default"],label:"Default",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{})})]},field.key)),(0,jsx_runtime.jsxs)(es_form.Z.Item,{children:[(0,jsx_runtime.jsx)(es_button.Z,{type:"dashed",onClick:()=>add(),style:{width:"60%"},icon:(0,jsx_runtime.jsx)(PlusOutlined.Z,{}),children:"Add material"}),(0,jsx_runtime.jsx)(es_form.Z.ErrorList,{errors:errors})]})]})}})}),(0,jsx_runtime.jsx)(es_button.Z,{className:"full-width",onClick:()=>setVisible(!0),children:"Materials"})]})},finiteElementSpace_onAdd=(values,template,model,cursor,dispatch)=>{var ref,ref1,ref2,ref3,ref4,ref5;let modelJSON;if(!values.options||!values.options.length)return;addOnCursor(template,"<%# Finite element space -%>\n<%\nconst finiteElementSpace = parameters.finiteElementSpace.children[0]\nfiniteElementSpace.name = '".concat(values.name,"'\n-%>\n<%- include('/blobs/fespace.edp.ejs', {\n  mesh,\n  finiteElementSpace\n}) -%>\n"),cursor,dispatch),dispatch((0,actions.KJ)({row:((null==cursor?void 0:cursor.row)||9)+0,column:0}));try{modelJSON=JSON.parse(model)}catch(err){modelJSON={}}let index=Object.keys(modelJSON.configuration||{}).length;modelJSON.configuration={...modelJSON.configuration||{},parameters:{index:index+1,title:"Parameters",...(null===(ref=modelJSON.configuration)||void 0===ref?void 0:ref.parameters)||{},finiteElementSpace:{advanced:!0,label:"Finite element space",...(null===(ref1=modelJSON.configuration)||void 0===ref1?void 0:null===(ref2=ref1.parameters)||void 0===ref2?void 0:ref2.finiteElementSpace)||{},children:[...(null===(ref5=null===(ref3=modelJSON.configuration)||void 0===ref3?void 0:null===(ref4=ref3.parameters)||void 0===ref4?void 0:ref4.finiteElementSpace)||void 0===ref5?void 0:ref5.children)||[],{label:"Finite element space label",label2D:"Finite element space label (2D)",htmlEntity:"select",options:values.options,default:values.options[0].value,default2D:values.options[0].value2D}]}}},dispatch((0,actions.j1)(JSON.stringify(modelJSON,null,"	")))},FiniteElementSpace=()=>{let[visible,setVisible]=(0,react.useState)(!1),[loading,setLoading]=(0,react.useState)(!1),{template,model,cursor,dispatch}=(0,react.useContext)(editor.rU);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(dialog.ZP,{title:"Finite element space",visible:visible,loading:loading,async onOk(values){setLoading(!0),finiteElementSpace_onAdd(values,template,model,cursor,dispatch),setLoading(!1),setVisible(!1)},onCancel:()=>setVisible(!1),children:[(0,jsx_runtime.jsx)(es_form.Z.Item,{name:"name",label:"Name",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{})}),(0,jsx_runtime.jsx)(es_form.Z.List,{name:"datas",children(fields,param,param1){let{add,remove}=param,{errors}=param1;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[fields.map((field,index)=>(0,jsx_runtime.jsxs)(es_form.Z.Item,{label:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(icons_MinusCircleOutlined,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>remove(field.name)}),"Option ",index+1]}),children:[(0,jsx_runtime.jsx)(es_form.Z.Item,{name:[field.name,"label"],label:"Display name",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{placeholder:"P1"})}),(0,jsx_runtime.jsx)(es_form.Z.Item,{name:[field.name,"value"],label:"Value",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{placeholder:"[P1, P1, P1]"})}),(0,jsx_runtime.jsx)(es_form.Z.Item,{name:[field.name,"value2D"],label:"Value 2D",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{placeholder:"[P1, P1]"})})]},field.key)),(0,jsx_runtime.jsxs)(es_form.Z.Item,{children:[(0,jsx_runtime.jsx)(es_button.Z,{type:"dashed",onClick:()=>add(),style:{width:"60%"},icon:(0,jsx_runtime.jsx)(PlusOutlined.Z,{}),children:"Add data"}),(0,jsx_runtime.jsx)(es_form.Z.ErrorList,{errors:errors})]})]})}})]}),(0,jsx_runtime.jsx)(es_button.Z,{className:"full-width",onClick:()=>setVisible(!0),children:"Finite element space"})]})},header_onAdd=(template,cursor,dispatch)=>{addOnCursor(template,"<%# Headers -%>\n<%- include('/blobs/headers.edp.ejs') -%>\n",cursor,dispatch),dispatch((0,actions.KJ)({row:((null==cursor?void 0:cursor.row)||0)+2,column:0}))},Header=()=>{let{template,cursor,dispatch}=(0,react.useContext)(editor.rU);return(0,jsx_runtime.jsx)(es_button.Z,{className:"full-width",onClick:()=>header_onAdd(template,cursor,dispatch),children:"Header"})},dimension_onAdd=(template,cursor,dispatch)=>{addOnCursor(template,"<%# Dimension -%>\n<%- include('/blobs/dimensioning.edp.ejs', {\n    dimension\n}) -%>\n",cursor,dispatch),dispatch((0,actions.KJ)({row:((null==cursor?void 0:cursor.row)||0)+4,column:0}))},Dimension=()=>{let{template,cursor,dispatch}=(0,react.useContext)(editor.rU);return(0,jsx_runtime.jsx)(es_button.Z,{className:"full-width",onClick:()=>dimension_onAdd(template,cursor,dispatch),children:"Dimension"})},finiteElementFunction_onAdd=(values,template,cursor,dispatch)=>{addOnCursor(template,"<%# Finite element function -%>\n<%\nconst testFunction = dimension === 2 ? '[".concat(values.test1,", ").concat(values.test2,"]' : '[").concat(values.test1,", ").concat(values.test2,", ").concat(values.test3,"]'\nconst unknownFunction = dimension === 2 ? '[").concat(values.unknown1,", ").concat(values.unknown2,"]' : '[").concat(values.unknown1,", ").concat(values.unknown2,", ").concat(values.unknown3,"]'\n-%>\n<%- include('/blobs/fespaceFunction.edp.ejs', {\n    finiteElementSpace,\n    finiteElementFunction: testFunction\n  }) -%>\n  <%- include('/blobs/fespaceFunction.edp.ejs', {\n    finiteElementSpace,\n    finiteElementFunction: unknownFunction\n}) -%>\n"),cursor,dispatch),dispatch((0,actions.KJ)({row:((null==cursor?void 0:cursor.row)||9)+0,column:0}))},FiniteElementFunction=()=>{let[visible,setVisible]=(0,react.useState)(!1),[loading,setLoading]=(0,react.useState)(!1),{template,cursor,dispatch}=(0,react.useContext)(editor.rU);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(dialog.ZP,{title:"Finite element function",visible:visible,loading:loading,async onOk(values){setLoading(!0),finiteElementFunction_onAdd(values,template,cursor,dispatch),setLoading(!1),setVisible(!1)},onCancel:()=>setVisible(!1),children:[(0,jsx_runtime.jsxs)(es_form.Z.Item,{label:(0,jsx_runtime.jsx)(typography.Z.Text,{strong:!0,children:"Test function"}),children:[(0,jsx_runtime.jsx)(es_form.Z.Item,{label:"First coordinate",name:"test1",children:(0,jsx_runtime.jsx)(input.Z,{placeholder:"Ux"})}),(0,jsx_runtime.jsx)(es_form.Z.Item,{label:"Second coordinate",name:"test2",children:(0,jsx_runtime.jsx)(input.Z,{placeholder:"Uy"})}),(0,jsx_runtime.jsx)(es_form.Z.Item,{label:"Third coordinate",name:"test3",children:(0,jsx_runtime.jsx)(input.Z,{placeholder:"Uz"})})]}),(0,jsx_runtime.jsxs)(es_form.Z.Item,{label:(0,jsx_runtime.jsx)(typography.Z.Text,{strong:!0,children:"Unknows function"}),children:[(0,jsx_runtime.jsx)(es_form.Z.Item,{label:"First coordinate",name:"unknown1",children:(0,jsx_runtime.jsx)(input.Z,{placeholder:"Uhx"})}),(0,jsx_runtime.jsx)(es_form.Z.Item,{label:"Second coordinate",name:"unknown2",children:(0,jsx_runtime.jsx)(input.Z,{placeholder:"Uhy"})}),(0,jsx_runtime.jsx)(es_form.Z.Item,{label:"Third coordinate",name:"unknown3",children:(0,jsx_runtime.jsx)(input.Z,{placeholder:"Uhz"})})]})]}),(0,jsx_runtime.jsx)(es_button.Z,{className:"full-width",onClick:()=>setVisible(!0),children:"Finite element function"})]})};var es_checkbox=__webpack_require__(32808);let macros_onAdd=(values,template,cursor,dispatch)=>{let inTemplateMacros=values.macros.map(macro=>"'"+macro+"'").join(", ");addOnCursor(template,"<%# Macro -%>\n<%- include('/blobs/macro.edp.ejs', {\n    dimension,\n    type: [".concat(inTemplateMacros,"]\n}) -%>\n"),cursor,dispatch),dispatch((0,actions.KJ)({row:((null==cursor?void 0:cursor.row)||5)+0,column:0}))},Macros=()=>{let[visible,setVisible]=(0,react.useState)(!1),[loading,setLoading]=(0,react.useState)(!1),{template,cursor,dispatch}=(0,react.useContext)(editor.rU);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(dialog.ZP,{title:"Macros",visible:visible,loading:loading,async onOk(values){setLoading(!0),macros_onAdd(values,template,cursor,dispatch),setLoading(!1),setVisible(!1)},onCancel:()=>setVisible(!1),children:(0,jsx_runtime.jsx)(es_form.Z.Item,{label:"Type",name:"macros",children:(0,jsx_runtime.jsx)(es_checkbox.Z.Group,{options:[{label:"Scalar gradient",value:"scalarGradient"},{label:"Vectorial divergence",value:"vectorialDivergence"},{label:"Vectorial divergence axisymmetric",value:"vectorialDivergenceRZ"},{label:"Vectorial epsilon",value:"vectorialEpsilon"},{label:"Vectorial gradient",value:"vectorialGradient"},{label:"Vectorial R divergence axisymmetric",value:"vectorialRdivergenceRZ"}],style:{display:"flex",flexDirection:"column"}})})}),(0,jsx_runtime.jsx)(es_button.Z,{className:"full-width",onClick:()=>setVisible(!0),children:"Macros"})]})},solver_onAdd=(values,template,model,cursor,dispatch)=>{var ref,ref1,ref2,ref3,ref4,ref5;let modelJSON;addOnCursor(template,"<%# Solver -%>\n<% const solver = parameters.solver.children[0].value ?? parameters.solver.children[0].default -%>\n<%- include('/blobs/solver.edp.ejs', {\n    solver\n}) -%>",cursor,dispatch),dispatch((0,actions.KJ)({row:((null==cursor?void 0:cursor.row)||9)+0,column:0}));try{modelJSON=JSON.parse(model)}catch(err){modelJSON={}}let index=Object.keys(modelJSON.configuration||{}).length;modelJSON.configuration={...modelJSON.configuration||{},parameters:{index:index+1,title:"Parameters",...(null===(ref=modelJSON.configuration)||void 0===ref?void 0:ref.parameters)||{},solver:{advanced:!0,label:"Solver",...(null===(ref1=modelJSON.configuration)||void 0===ref1?void 0:null===(ref2=ref1.parameters)||void 0===ref2?void 0:ref2.solver)||{},children:[...(null===(ref5=null===(ref3=modelJSON.configuration)||void 0===ref3?void 0:null===(ref4=ref3.parameters)||void 0===ref4?void 0:ref4.solver)||void 0===ref5?void 0:ref5.children)||[],{label:"System resolution",htmlEntity:"select",options:values.solvers.map(solver=>({label:solver,value:solver})),default:"MUMPS"}]}}},dispatch((0,actions.j1)(JSON.stringify(modelJSON,null,"	")))},Solver=()=>{let[visible,setVisible]=(0,react.useState)(!1),[loading,setLoading]=(0,react.useState)(!1),{template,model,cursor,dispatch}=(0,react.useContext)(editor.rU);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(dialog.ZP,{title:"Solver",visible:visible,loading:loading,async onOk(values){setLoading(!0),solver_onAdd(values,template,model,cursor,dispatch),setLoading(!1),setVisible(!1)},onCancel:()=>setVisible(!1),children:(0,jsx_runtime.jsx)(es_form.Z.Item,{name:"solvers",label:"Availables",children:(0,jsx_runtime.jsx)(es_checkbox.Z.Group,{options:["UMFPCK","CG","Cholesky","Crout","GMRES","LU","sparsesolver","MUMPS"],style:{display:"flex",flexDirection:"column"}})})}),(0,jsx_runtime.jsx)(es_button.Z,{className:"full-width",onClick:()=>setVisible(!0),children:"Solver"})]})},getInTemplate=values=>{var ref,ref1,ref2,ref3,ref4,ref5,ref6,ref7;let scalarResults=null===(ref1=null===(ref=values.scalarResults)||void 0===ref?void 0:ref.map(result=>"'".concat(result.variable,"'")))||void 0===ref1?void 0:ref1.join(", "),vectorialResults=null===(ref3=null===(ref2=values.vectorialResults)||void 0===ref2?void 0:ref2.map(result=>"dimension === 2 ? ['".concat(result.variable1,"', '").concat(result.variable2,"', '0'] : ['").concat(result.variable1,"', '").concat(result.variable2,"', '").concat(result.variable3,"']")))||void 0===ref3?void 0:ref3.join(", "),scalarOrder=null===(ref5=null===(ref4=values.scalarResults)||void 0===ref4?void 0:ref4.map(_=>1))||void 0===ref5?void 0:ref5.join(", "),vectorialOrder=null===(ref7=null===(ref6=values.vectorialResults)||void 0===ref6?void 0:ref6.map(_=>1))||void 0===ref7?void 0:ref7.join(", ");return{results:(scalarResults?scalarResults+", ":"")+(null!=vectorialResults?vectorialResults:""),order:(scalarOrder?scalarOrder+", ":"")+(null!=vectorialOrder?vectorialOrder:"")}},save_onAdd=(values,template,model,cursor,dispatch)=>{var ref,ref1,ref2,ref3,ref4,ref5,ref6,ref7;let modelJSON;if(!values.scalarResults&&!values.vectorialResults||!(null===(ref=values.scalarResults)||void 0===ref?void 0:ref.length)&&!(null===(ref1=values.vectorialResults)||void 0===ref1?void 0:ref1.length))return;let inTemplate=getInTemplate(values);addOnCursor(template,"<%# Save -%>\n<%- include('/blobs/save.edp.ejs', {\n    solution: {\n        path: run.resultPath,\n        name: '\"Result\"',\n        mesh: mesh.name,\n        sol: [".concat(inTemplate.results,"],\n        dataName: run.results.map(r => r.name),\n        order: [").concat(inTemplate.order,"]\n    }\n}) -%>\n"),cursor,dispatch),dispatch((0,actions.KJ)({row:((null==cursor?void 0:cursor.row)||4)+0,column:0}));try{modelJSON=JSON.parse(model)}catch(err){modelJSON={}}let index=Object.keys(modelJSON.configuration||{}).length;modelJSON.configuration={...modelJSON.configuration||{},run:{index:index+1,title:"Run",...null!==(ref7=null===(ref2=modelJSON.configuration)||void 0===ref2?void 0:ref2.run)&&void 0!==ref7?ref7:{},results:[...(null===(ref3=modelJSON.configuration)||void 0===ref3?void 0:null===(ref4=ref3.run)||void 0===ref4?void 0:ref4.results)||[],...(null===(ref5=values.scalarResults)||void 0===ref5?void 0:ref5.map(result=>({name:result.name})))||[],...(null===(ref6=values.vectorialResults)||void 0===ref6?void 0:ref6.map(result=>({name:result.name})))||[]]}},dispatch((0,actions.j1)(JSON.stringify(modelJSON,null,"	")))},Save=()=>{let[visible,setVisible]=(0,react.useState)(!1),[loading,setLoading]=(0,react.useState)(!1),{template,model,cursor,dispatch}=(0,react.useContext)(editor.rU);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(dialog.ZP,{title:"Save",visible:visible,loading:loading,async onOk(values){setLoading(!0),save_onAdd(values,template,model,cursor,dispatch),setLoading(!1),setVisible(!1)},onCancel:()=>setVisible(!1),children:[(0,jsx_runtime.jsx)(es_form.Z.List,{name:"scalarResults",children(fields,param,param1){let{add,remove}=param,{errors}=param1;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[fields.map((field,index)=>(0,jsx_runtime.jsxs)(es_form.Z.Item,{label:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(icons_MinusCircleOutlined,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>remove(field.name)}),"Scalar result ",index+1]}),children:[(0,jsx_runtime.jsx)(es_form.Z.Item,{name:[field.name,"name"],label:"Display name",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{})}),(0,jsx_runtime.jsx)(es_form.Z.Item,{name:[field.name,"variable"],label:"Variable name",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{})})]},field.key)),(0,jsx_runtime.jsxs)(es_form.Z.Item,{children:[(0,jsx_runtime.jsx)(es_button.Z,{type:"dashed",onClick:()=>add(),style:{width:"60%"},icon:(0,jsx_runtime.jsx)(PlusOutlined.Z,{}),children:"Add scalar result"}),(0,jsx_runtime.jsx)(es_form.Z.ErrorList,{errors:errors})]})]})}}),(0,jsx_runtime.jsx)(es_form.Z.List,{name:"vectorialResults",children(fields,param,param1){let{add,remove}=param,{errors}=param1;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[fields.map((field,index)=>(0,jsx_runtime.jsxs)(es_form.Z.Item,{label:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(icons_MinusCircleOutlined,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>remove(field.name)}),"Vectorial result ",index+1]}),children:[(0,jsx_runtime.jsx)(es_form.Z.Item,{name:[field.name,"name"],label:"Display name",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{})}),(0,jsx_runtime.jsx)(es_form.Z.Item,{name:[field.name,"variable1"],label:"First component variable name",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{})}),(0,jsx_runtime.jsx)(es_form.Z.Item,{name:[field.name,"variable2"],label:"Second component variable name",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{})}),(0,jsx_runtime.jsx)(es_form.Z.Item,{name:[field.name,"variable3"],label:"Third component variable name",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{})})]},field.key)),(0,jsx_runtime.jsxs)(es_form.Z.Item,{children:[(0,jsx_runtime.jsx)(es_button.Z,{type:"dashed",onClick:()=>add(),style:{width:"60%"},icon:(0,jsx_runtime.jsx)(PlusOutlined.Z,{}),children:"Add vectorial result"}),(0,jsx_runtime.jsx)(es_form.Z.ErrorList,{errors:errors})]})]})}})]}),(0,jsx_runtime.jsx)(es_button.Z,{className:"full-width",onClick:()=>setVisible(!0),children:"Save"})]})},data_onAdd=(values,template,cursor,dispatch)=>{values.datas&&values.datas.length&&(addOnCursor(template,"<%- include('/blobs/data.edp.ejs', {\n    path: run.dataPath,\n    fileName: '\"iter_\"+timeIter',\n    dataNames: [".concat(values.datas.map(data=>"'".concat(data.name,"'")).join(", "),"],\n    x: '").concat(values.x,"',\n    ys: [").concat(values.datas.map(data=>"'".concat(data.y,"'")).join(", "),"]\n}) -%>"),cursor,dispatch),dispatch((0,actions.KJ)({row:((null==cursor?void 0:cursor.row)||4)+0,column:0})))},Data=()=>{let[visible,setVisible]=(0,react.useState)(!1),[loading,setLoading]=(0,react.useState)(!1),{template,cursor,dispatch}=(0,react.useContext)(editor.rU);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(dialog.ZP,{title:"Data",visible:visible,loading:loading,async onOk(values){setLoading(!0),data_onAdd(values,template,cursor,dispatch),setLoading(!1),setVisible(!1)},onCancel:()=>setVisible(!1),children:[(0,jsx_runtime.jsx)(es_form.Z.Item,{label:"X axis variable",name:"x",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{})}),(0,jsx_runtime.jsx)(es_form.Z.List,{name:"datas",children(fields,param,param1){let{add,remove}=param,{errors}=param1;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[fields.map((field,index)=>(0,jsx_runtime.jsxs)(es_form.Z.Item,{label:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(icons_MinusCircleOutlined,{style:{fontSize:"16px",color:"red",marginRight:"10px"},onClick:()=>remove(field.name)}),"Data ",index+1]}),children:[(0,jsx_runtime.jsx)(es_form.Z.Item,{name:[field.name,"name"],label:"Display name",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{})}),(0,jsx_runtime.jsx)(es_form.Z.Item,{name:[field.name,"y"],label:"Y axis variable",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{})})]},field.key)),(0,jsx_runtime.jsxs)(es_form.Z.Item,{children:[(0,jsx_runtime.jsx)(es_button.Z,{type:"dashed",onClick:()=>add(),style:{width:"60%"},icon:(0,jsx_runtime.jsx)(PlusOutlined.Z,{}),children:"Add data"}),(0,jsx_runtime.jsx)(es_form.Z.ErrorList,{errors:errors})]})]})}})]}),(0,jsx_runtime.jsx)(es_button.Z,{className:"full-width",onClick:()=>setVisible(!0),children:"Data"})]})},sensors_onAdd=(values,template,cursor,dispatch)=>{addOnCursor(template,"<%# Sensors -%>\n<%- helpers.indent(include('/blobs/sensors.edp.ejs', {\n    path: run.dataPath,\n    x: '".concat(values.x,"',\n    sensors: run.sensors\n}), 2) -%>"),cursor,dispatch),dispatch((0,actions.KJ)({row:((null==cursor?void 0:cursor.row)||4)+0,column:0}))},Sensors=()=>{let[visible,setVisible]=(0,react.useState)(!1),[loading,setLoading]=(0,react.useState)(!1),{template,cursor,dispatch}=(0,react.useContext)(editor.rU);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(dialog.ZP,{title:"Sensors",visible:visible,loading:loading,async onOk(values){setLoading(!0),sensors_onAdd(values,template,cursor,dispatch),setLoading(!1),setVisible(!1)},onCancel:()=>setVisible(!1),children:(0,jsx_runtime.jsx)(es_form.Z.Item,{label:"X axis variable",name:"x",rules:[{required:!0}],children:(0,jsx_runtime.jsx)(input.Z,{})})}),(0,jsx_runtime.jsx)(es_button.Z,{className:"full-width",onClick:()=>setVisible(!0),children:"Sensors"})]})},addOnCursor=(template,text,cursor,dispatch)=>{if(cursor){let row=cursor.row,rows=(template||"").split("\n"),newTemplate=[...rows.slice(0,row+1),...text.split("\n"),...rows.slice(row+1)];dispatch((0,actions.zX)(newTemplate.join("\n")))}else dispatch((0,actions.zX)((template||"")+text))},Blobs=()=>(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)(collapse.Z,{style:{overflow:"auto",maxHeight:"calc(100% - 443px)"},children:[(0,jsx_runtime.jsx)(collapse.Z.Panel,{header:"Head",children:(0,jsx_runtime.jsxs)(space.Z,{direction:"vertical",className:"full-width",children:[(0,jsx_runtime.jsx)(Header,{}),(0,jsx_runtime.jsx)(Dimension,{})]})},"head"),(0,jsx_runtime.jsx)(collapse.Z.Panel,{header:"Components",children:(0,jsx_runtime.jsxs)(space.Z,{direction:"vertical",className:"full-width",children:[(0,jsx_runtime.jsx)(Mesh,{}),(0,jsx_runtime.jsx)(Materials,{}),(0,jsx_runtime.jsx)(FiniteElementSpace,{}),(0,jsx_runtime.jsx)(FiniteElementFunction,{}),(0,jsx_runtime.jsx)(Macros,{}),(0,jsx_runtime.jsx)(Solver,{})]})},"components"),(0,jsx_runtime.jsx)(collapse.Z.Panel,{header:"Results",children:(0,jsx_runtime.jsxs)(space.Z,{direction:"vertical",className:"full-width",children:[(0,jsx_runtime.jsx)(Save,{}),(0,jsx_runtime.jsx)(Data,{}),(0,jsx_runtime.jsx)(Sensors,{})]})},"results")]})});var asn_FileAddOutlined={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM544 472c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v108H372c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h108v108c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V644h108c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V472z"}}]},name:"file-add",theme:"outlined"},FileAddOutlined_FileAddOutlined=function(props,ref){return react.createElement(AntdIcon.Z,(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{ref:ref,icon:asn_FileAddOutlined}))};FileAddOutlined_FileAddOutlined.displayName="FileAddOutlined";var icons_FileAddOutlined=react.forwardRef(FileAddOutlined_FileAddOutlined);let onNew=dispatch=>{dispatch((0,actions.zX)("try{\n<%# Headers -%>\n<%- include('/blobs/headers.edp.ejs') -%>\n\n<%# Dimension -%>\n<%- include('/blobs/dimensioning.edp.ejs', {\n	dimension\n}) -%>\n\n// WRITE YOUR TEMPLATE HERE\n\n} catch(...) {\n	appendError(\"An internal error occurs\");\n	exit(-1);\n}\n")),dispatch((0,actions.j1)(JSON.stringify({category:"Category",name:"My new model",algorithm:"Algorithm",code:"FreeFEM",version:"1.0.0",description:"",configuration:{}},null,"	")+"\n"))},New=()=>{let{dispatch}=(0,react.useContext)(editor.rU);return(0,jsx_runtime.jsx)(tooltip.Z,{title:"New model",children:(0,jsx_runtime.jsx)(es_button.Z,{icon:(0,jsx_runtime.jsx)(icons_FileAddOutlined,{}),onClick:()=>onNew(dispatch)})})};var tabs=__webpack_require__(50741),FolderOpenOutlined=__webpack_require__(95591),models=__webpack_require__(52402),templates={gmsh2D:"gmsh2D.geo.ejs",gmsh3D:"gmsh3D.geo.ejs",poisson:"poisson.edp.ejs",linearElasticity:"linearElasticity.edp.ejs",linearElasticityTime:"linearElasticityTime.edp.ejs",stokes:"stokes.edp.ejs",navierStokesTime:"navierStokesTime.edp.ejs",thermicDiffusion:"thermicDiffusion.edp.ejs"},assets_notification=__webpack_require__(67582),utils=__webpack_require__(64376);let errors={delete:"Unable to delete model"},onDelete=async(user,index,swr)=>{try{let model=user.models[index],template=user.templates[index];await api_user.Z.update([{key:"models",type:"array",method:"remove",value:model},{key:"templates",type:"array",method:"remove",value:template}]);let newUser=utils.Z.deepCopy(user);newUser.models=[...newUser.models.slice(0,index),...newUser.models.slice(index+1)],newUser.templates=[...newUser.templates.slice(0,index),...newUser.templates.slice(index+1)],swr.mutateUser(newUser)}catch(err){throw(0,assets_notification.lt)(errors.delete,err),err}},Delete=param=>{let{user,index,swr}=param;return(0,jsx_runtime.jsx)(assets_button.m1,{onDelete:async()=>onDelete(user,index,swr)})},browser_errors={load:"Unable to load current model"},onTanatlocLoad=async(key,dispatch)=>{try{let currentModel=models.Z[key];dispatch((0,actions.j1)(JSON.stringify(currentModel,null,"	")));let modelKey=currentModel.algorithm,templateFile=templates[modelKey],res=await fetch("/templates/"+templateFile),text=await res.text();dispatch((0,actions.zX)(text))}catch(err){(0,assets_notification.lt)(browser_errors.load,err)}},onMyLoad=async(model,template,dispatch)=>{try{model.user&&delete model.user,dispatch((0,actions.j1)(JSON.stringify(model,null,"	"))),dispatch((0,actions.zX)(template))}catch(err){(0,assets_notification.lt)(browser_errors.load,err)}},Browser=param=>{let{user,swr}=param,[visible,setVisible]=(0,react.useState)(!1),[loading,setLoading]=(0,react.useState)(!1),{dispatch}=(0,react.useContext)(editor.rU);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(dialog.ZP,{title:"Models browser",visible:visible,loading:loading,onCancel:()=>setVisible(!1),children:(0,jsx_runtime.jsx)(tabs.Z,{items:[{key:"models",label:"Tanatloc models",children:(0,jsx_runtime.jsx)(space.Z,{direction:"vertical",className:"full-width",children:models.Z.map((m,index)=>(0,jsx_runtime.jsxs)("div",{className:"display-flex",style:{justifyContent:"space-between",alignItems:"center"},children:[m.name,(0,jsx_runtime.jsx)(tooltip.Z,{title:"Open",children:(0,jsx_runtime.jsx)(es_button.Z,{async onClick(){setLoading(!0);try{await onTanatlocLoad(index,dispatch)}finally{setLoading(!1),setVisible(!1)}},icon:(0,jsx_runtime.jsx)(FolderOpenOutlined.Z,{})})})]},index))})},{key:"personalModels",label:"My models",children:(0,jsx_runtime.jsx)(space.Z,{direction:"vertical",className:"full-width",children:user.models.map((m,index)=>(0,jsx_runtime.jsxs)("div",{className:"display-flex",style:{justifyContent:"space-between",alignItems:"center"},children:[m.name,(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(tooltip.Z,{title:"Open",children:(0,jsx_runtime.jsx)(es_button.Z,{async onClick(){setLoading(!0);try{await onMyLoad(m,user.templates[index],dispatch)}finally{setLoading(!1),setVisible(!1)}},icon:(0,jsx_runtime.jsx)(FolderOpenOutlined.Z,{})})}),(0,jsx_runtime.jsx)(Delete,{user:user,index:index,swr:swr})]})]},index))})}]})}),(0,jsx_runtime.jsx)(tooltip.Z,{title:"Browse existing model",children:(0,jsx_runtime.jsx)(es_button.Z,{icon:(0,jsx_runtime.jsx)(FolderOpenOutlined.Z,{}),onClick:()=>setVisible(!0)})})]})};var modal=__webpack_require__(67040),asn_SaveOutlined={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},SaveOutlined_SaveOutlined=function(props,ref){return react.createElement(AntdIcon.Z,(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{ref:ref,icon:asn_SaveOutlined}))};SaveOutlined_SaveOutlined.displayName="SaveOutlined";var icons_SaveOutlined=react.forwardRef(SaveOutlined_SaveOutlined);let save_errors={json:"Model definition is not valid",check:"Unable to check",save:"Unable to save"},onSave=async(user,swr,model,template)=>{let modelJSON;try{modelJSON=JSON.parse(model)}catch(err){(0,assets_notification.lt)(save_errors.json,err);return}try{let existing=user.models.find(m=>m.algorithm===modelJSON.algorithm);existing?modal.Z.confirm({title:"A model with the same algorithm entry already exists. Do you want to override it?",async onOk(){let index=user.models.findIndex(m=>m.algorithm===modelJSON.algorithm);await save_save(user,swr,modelJSON,template,index)}}):await save_save(user,swr,modelJSON,template)}catch(err1){(0,assets_notification.lt)(save_errors.check,err1)}},save_save=async(user,swr,model,template,index)=>{if(void 0===index)try{await api_user.Z.update([{key:"models",type:"array",method:"append",value:{...model,user:user.id}},{key:"templates",type:"array",method:"append",value:template}]);let newUser=utils.Z.deepCopy(user);newUser.models.push(model),swr.mutateUser(newUser)}catch(err){(0,assets_notification.lt)(save_errors.save,err)}else try{await api_user.Z.update([{key:"models",type:"array",method:"set",index:index,value:{...model,user:user.id}},{key:"templates",type:"array",method:"set",index:index,value:template}]);let newUser1=utils.Z.deepCopy(user);newUser1.models[index]=model,swr.mutateUser(newUser1)}catch(err1){(0,assets_notification.lt)(save_errors.save,err1)}},save_Save=param=>{let{user,swr}=param,[disabled,setDisabled]=(0,react.useState)(!1),[loading,setLoading]=(0,react.useState)(!1),{model,template,templateValid,modelValid}=(0,react.useContext)(editor.rU);return(0,react.useEffect)(()=>{templateValid&&modelValid?setDisabled(!1):setDisabled(!0)},[templateValid,modelValid]),(0,jsx_runtime.jsx)(tooltip.Z,{title:"Save",children:(0,jsx_runtime.jsx)(es_button.Z,{disabled:disabled,loading:loading,icon:(0,jsx_runtime.jsx)(icons_SaveOutlined,{}),async onClick(){setLoading(!0),await onSave(user,swr,model,template),setLoading(!1)}})})};var dynamic=__webpack_require__(5152),dynamic_default=__webpack_require__.n(dynamic);let FreeFEMCode=dynamic_default()(()=>Promise.all([__webpack_require__.e(52),__webpack_require__.e(700),__webpack_require__.e(716)]).then(__webpack_require__.bind(__webpack_require__,34716)).catch(err=>{let ErrorComponent=()=>(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("p",{children:"Unable to load FreeFEM-EJS editor"}),(0,jsx_runtime.jsx)("p",{children:err.message})]});return ErrorComponent}),{loadableGenerated:{webpack:()=>[34716]},ssr:!1}),JSONCode=dynamic_default()(()=>Promise.all([__webpack_require__.e(52),__webpack_require__.e(700),__webpack_require__.e(119)]).then(__webpack_require__.bind(__webpack_require__,71119)).catch(err=>{let ErrorComponent=()=>(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("p",{children:"Unable to load JSON editor"}),(0,jsx_runtime.jsx)("p",{children:err.message})]});return ErrorComponent}),{loadableGenerated:{webpack:()=>[71119]},ssr:!1}),Code=()=>(0,jsx_runtime.jsxs)("div",{className:"Editor-code",children:[(0,jsx_runtime.jsx)(FreeFEMCode,{}),(0,jsx_runtime.jsx)(JSONCode,{})]}),Editor=()=>{let[name,setName]=(0,react.useState)(),router=(0,next_router.useRouter)(),[user,{loadingUser,mutateUser}]=api_user.Z.useUser();(0,react.useEffect)(()=>{loadingUser||user||router.replace("/")},[user,loadingUser,router]),(0,react.useEffect)(()=>{notification.Z.warning({message:"This is a beta version",description:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("br",{}),"- You may encounter unexpected bugs",(0,jsx_runtime.jsx)("br",{}),"- Some features are not totally functionnal"]}),placement:"top",duration:0})},[]);let handleDashboard=(0,react.useCallback)(()=>{router.push({pathname:"/dashboard"})},[router]);return loadingUser||!user?(0,jsx_runtime.jsx)(loading.Z,{}):(0,jsx_runtime.jsx)(editor.ZP,{children:(0,jsx_runtime.jsxs)(layout.Z,{className:"Editor",children:[(0,jsx_runtime.jsxs)(layout.Z.Sider,{theme:"light",width:"256",children:[(0,jsx_runtime.jsx)("div",{className:"logo",children:(0,jsx_runtime.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,jsx_runtime.jsx)(menu.Z,{mode:"inline",items:[{key:"menu-go-back",disabled:!0,style:{cursor:"unset",margin:"10px 0",paddingLeft:10},label:(0,jsx_runtime.jsx)(assets_button.ks,{onClick:handleDashboard,children:"Return to dashboard"})},{type:"divider",className:"Editor-Menu-Divider"}]}),(0,jsx_runtime.jsx)(StatusSteps,{setName:setName}),(0,jsx_runtime.jsx)(divider.Z,{}),(0,jsx_runtime.jsx)(Blobs,{})]}),(0,jsx_runtime.jsxs)(layout.Z.Content,{className:"no-scroll",children:[(0,jsx_runtime.jsx)(layout.Z.Header,{className:"Editor-Header",children:(0,jsx_runtime.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,jsx_runtime.jsx)(typography.Z.Text,{strong:!0,children:name}),(0,jsx_runtime.jsxs)(space.Z,{children:[(0,jsx_runtime.jsx)(New,{}),(0,jsx_runtime.jsx)(Browser,{user:{id:user.id,models:user.models,templates:user.templates},swr:{mutateUser}}),(0,jsx_runtime.jsx)(save_Save,{user:{id:user.id,models:user.models},swr:{mutateUser}}),(0,jsx_runtime.jsx)(tooltip.Z,{title:"Coming soon",children:(0,jsx_runtime.jsx)(es_button.Z,{disabled:!0,icon:(0,jsx_runtime.jsx)(ShareAltOutlined.Z,{})})})]})]})}),(0,jsx_runtime.jsx)(Code,{})]})]})})},editor_Editor=()=>(0,jsx_runtime.jsx)(Editor,{});var pages_editor=editor_Editor},5152:function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__(37645)}},function(__webpack_require__){__webpack_require__.O(0,[305,362,474,266,495,347,690,485,650,566,40,326,620,407,785,774,888,179],function(){return __webpack_require__(__webpack_require__.s=31832)}),_N_E=__webpack_require__.O()}]);