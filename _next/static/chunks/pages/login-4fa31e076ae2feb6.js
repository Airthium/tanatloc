(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{40262:function(e,r,t){"use strict";t.d(r,{Z:function(){return c}});var n=t(1413),a=t(67294),s={icon:function(e,r){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:e}},{tag:"path",attrs:{d:"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm-32 156c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z",fill:r}},{tag:"path",attrs:{d:"M488 576h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8zm-24 112a48 48 0 1096 0 48 48 0 10-96 0z",fill:e}}]}},name:"exclamation-circle",theme:"twotone"},i=t(42135),o=function(e,r){return a.createElement(i.Z,(0,n.Z)((0,n.Z)({},e),{},{ref:r,icon:s}))};o.displayName="ExclamationCircleTwoTone";var c=a.forwardRef(o)},83236:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return t(69405)}])},10851:function(e,r,t){"use strict";t.d(r,{EQ:function(){return s},kD:function(){return n},x_:function(){return a}});t(83454).env.EMAIL_TOKEN;var n="subscribe",a="passwordRecovery",s="revalidate"},81891:function(e,r,t){"use strict";t.d(r,{H:function(){return o}});var n=t(51438),a=t(28668),s=t(25892),i=t(91224),o=function(e){(0,a.Z)(t,e);var r=(0,i.Z)(t);function t(e){var a;return(0,n.Z)(this,t),(a=r.call(this,e.title)).title=e.title,a.name="APIError",a.render=e.render,a.err=e.err,a.type=e.type||"error",a}return t}((0,s.Z)(Error))},1344:function(e,r,t){"use strict";t.d(r,{x:function(){return u}});var n=t(47568),a=t(26042),s=t(34051),i=t.n(s),o=t(59134),c=t.n(o)()()?"http://localhost:3000":"",u=function(){var e=(0,n.Z)(i().mark((function e(r){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(c+"/api/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:r.email,password:r.password})});case 2:if(200!==(t=e.sent).status){e.next=10;break}return e.t0=a.Z,e.t1={ok:!0},e.next=8,t.json();case 8:return e.t2=e.sent,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 10:return e.abrupt("return",{ok:!1});case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},69405:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return A}});var n=t(85893),a=t(47568),s=t(828),i=t(34051),o=t.n(i),c=t(11163),u=t(67294),l=t(97183),d=t(81474),p=t(26713),f=t(6880),h=t(71577),m=t(81579),v=t(69677),x=t(59134),w=t.n(x),Z=t(75107),y=t(96844),b=t(81891),g=t(1344),j=t(67169),k=t(32834),E=t(87492),_=t(10851),T=function(){var e=(0,a.Z)(o().mark((function e(r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,E.R)("/api/email",{method:"PUT",body:JSON.stringify({type:_.x_,email:r})});case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),N={recover:T},C="Unable to recover password",I=function(){var e=(0,a.Z)(o().mark((function e(r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.recover(r.email);case 3:(0,y.Ur)("An email has been send to recover your password","If you entered a valid email"),e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),(0,y.lt)(C,e.t0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(r){return e.apply(this,arguments)}}(),S=function(){var e=(0,u.useState)(!1),r=e[0],t=e[1],s=(0,u.useState)(!1),i=s[0],c=s[1];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.ZP,{title:"Forgot your password ?",visible:r,onCancel:function(){return t(!1)},onOk:function(){var e=(0,a.Z)(o().mark((function e(r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,e.next=4,I(r);case 4:c(!1),t(!1),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),c(!1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}(),loading:i,children:(0,n.jsx)(m.Z.Item,{name:"email",label:"Your email address",rules:[{required:!0,message:"Email is required"}],children:(0,n.jsx)(v.Z,{placeholder:"Email address",autoComplete:"email"})})}),(0,n.jsx)(f.Z.Text,{children:(0,n.jsx)(h.Z,{type:"link",onClick:function(){return t(!0)},children:"Forgot your password ?"})})]})},P="User error",q="Server issue : try again shortly.",z="Incorrect credentials.",U=function(){var e=(0,a.Z)(o().mark((function e(r,t,n){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,(0,g.x)(t);case 4:a=e.sent,e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(1),new b.H({title:q,err:e.t0});case 10:if(!a.ok){e.next=14;break}n({id:a.id}),r.push("/dashboard"),e.next=15;break;case 14:throw new b.H({title:z,type:"warning"});case 15:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(r,t,n){return e.apply(this,arguments)}}(),O=function(){var e=(0,u.useState)(!1),r=e[0],t=e[1],i=(0,u.useState)(),x=i[0],b=i[1],k=(0,s.Z)(j.Z.useUser(),2),E=k[0],_=k[1],T=_.mutateUser,N=_.errorUser,C=_.loadingUser,I=(0,c.useRouter)();return(0,u.useEffect)((function(){w()()&&(0,g.x)({email:"admin",password:"password"}).then((function(){I.push("/dashboard")})).catch()}),[I]),(0,u.useEffect)((function(){N&&(0,y.lt)(P,N)}),[N]),(0,u.useEffect)((function(){E&&I.push("/dashboard")}),[E,I]),(0,u.useEffect)((function(){I.prefetch("/signup"),I.prefetch("/dashboard")}),[I]),C||E?(0,n.jsx)(Z.Z,{}):(0,n.jsx)(l.Z,{children:(0,n.jsx)(d.Z,{bordered:!1,className:"Login",children:(0,n.jsxs)(p.Z,{direction:"vertical",size:"large",className:"full-width",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(f.Z.Title,{level:1,style:{padding:0,marginBottom:16,fontWeight:500},children:"Log In"}),(0,n.jsxs)(f.Z.Text,{children:["Your first time ?"," ",(0,n.jsx)(h.Z,{type:"link",onClick:function(){return function(e){e.push("/signup")}(I)},children:"Sign up"})]})]}),(0,n.jsxs)(m.Z,{requiredMark:"optional",onFinish:function(){var e=(0,a.Z)(o().mark((function e(r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(!0),e.prev=1,e.next=4,U(I,r,T);case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),b(e.t0),t(!1);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(r){return e.apply(this,arguments)}}(),layout:"vertical",children:[(0,n.jsx)(m.Z.Item,{name:"email",label:"Your email address",rules:[{required:!0,message:"Email is required"}],children:(0,n.jsx)(v.Z,{placeholder:"Email address",autoComplete:"email"})}),(0,n.jsx)(m.Z.Item,{name:"password",label:"Your password",rules:[{required:!0,message:"Password is required"}],style:{marginBottom:"14px"},children:(0,n.jsx)(v.Z.Password,{placeholder:"Password",autoComplete:"current-password"})}),(0,n.jsx)(S,{}),(0,n.jsx)(y.Xq,{error:x}),(0,n.jsx)(m.Z.Item,{className:"Login-submit",children:(0,n.jsx)(h.Z,{type:"primary",loading:r,htmlType:"submit",children:"Log in"})})]})]})})})},A=function(){return(0,n.jsx)(O,{})}},29815:function(e,r,t){"use strict";t.d(r,{Z:function(){return i}});var n=t(20943);var a=t(13375);var s=t(91566);function i(e){return function(e){if(Array.isArray(e))return(0,n.Z)(e)}(e)||(0,a.Z)(e)||(0,s.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}},function(e){e.O(0,[841,880,474,551,220,595,819,909,40,695,381,774,888,179],(function(){return r=83236,e(e.s=r);var r}));var r=e.O();_N_E=r}]);