(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9323],{66829:(e,r,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/password",function(){return s(20420)}])},21722:(e,r,s)=>{"use strict";var t;s.d(r,{F:()=>n,TL:()=>o,Vt:()=>a,bJ:()=>l,gv:()=>i}),null!==(t=s(65606).env.AUTH_SECRET)&&void 0!==t||Array(33).join("a");let o=6,a=16,l=!0,i=!0,n=!0},30498:(e,r,s)=>{"use strict";var t;s.d(r,{CV:()=>o,Rn:()=>a,k0:()=>l,kK:()=>i});let o=null!==(t=s(65606).env.EMAIL_TOKEN)&&void 0!==t?t:"",a="subscribe",l="passwordRecovery",i="revalidate"},50641:(e,r,s)=>{"use strict";s.d(r,{G:()=>n,T:()=>d});var t=s(4866),o=s.n(t),a=s(65606);let l=a.env.PORT?parseInt(a.env.PORT):3e3,i=o()()?"http://localhost:"+l:"",n=async(e,r)=>{let s=await fetch(i+e,{method:r?"POST":"GET",headers:{accept:"application/json","Content-Type":"application/json"},...r&&{body:r}}),t=s.headers.get("Content-Type");if(!s.ok){let e=Error("An error occured while fetching data.");throw e.info=(null==t?void 0:t.includes("application/json"))&&await s.json(),e.status=s.status,e}return s.json()},d=async(e,r)=>{var s;let t=await fetch(i+e,{...r,method:null!==(s=null==r?void 0:r.method)&&void 0!==s?s:"GET",headers:{...null==r?void 0:r.headers,"Content-Type":"application/json"}}),o=t.headers.get("Content-Type");if(!t.ok){let e=Error("An error occured while fetching data.");throw e.info=(null==o?void 0:o.includes("application/json"))&&await t.json(),e.status=t.status,e}return t}},28952:(e,r,s)=>{"use strict";s.d(r,{L:()=>t});class t extends Error{constructor(e){var r;super(e.title),this.title=e.title,this.name="APIError",this.render=e.render,this.err=e.err,this.type=null!==(r=e.type)&&void 0!==r?r:"error"}}},41349:(e,r,s)=>{"use strict";s.d(r,{A:()=>o});var t=s(50641);let o={get:async(e,r)=>(await (0,t.T)("/api/link",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({id:e,data:r})})).json(),process:async(e,r)=>{await (0,t.T)("/api/link",{method:"PUT",body:JSON.stringify({id:e,data:r})})}}},5337:(e,r,s)=>{"use strict";s.d(r,{A:()=>l});var t=s(8065),o=s(96540),a=s(50641);let l={useSystem:()=>{var e;let{data:r,error:s,mutate:l}=(0,t.Ay)("/api/system",a.G),i=!r,n=null!==(e=null==r?void 0:r.system)&&void 0!==e?e:{},d=(0,o.useCallback)(async e=>{await l({system:{...n,...e}})},[n,l]);return[n,{mutateSystem:d,errorSystem:s,loadingSystem:i}]},update:async e=>{await (0,a.T)("/api/system",{method:"PUT",body:JSON.stringify(e)})}}},87180:(e,r,s)=>{"use strict";s.d(r,{r:()=>_});var t=s(74848),o=s(61580),a=s(26603),l=s(21722),i=s(5337);let n={password:"Please enter a password",passwordTooSmall:e=>"Your password is too small (minimum "+e+" characters)",passwordTooLong:e=>"Your password is too long (maximum "+e+" characters)",passwordRequireLetter:"Your password must contain a letter",passwordRequireNumber:"Your password must contain a number",passwordRequireSymbol:"Your password must contain a symbol"},d=(e,r)=>!(r.length<e),u=(e,r)=>!(r.length>e),c=(e,r)=>-1!==e.search(r),p=(e,r)=>{var s,t;return(null!==(t=null==e?void 0:null===(s=e.password)||void 0===s?void 0:s.requireLetter)&&void 0!==t?!t:!l.bJ)||c(r,/[a-zA-Z]/)},m=(e,r)=>{var s,t;return(null!==(t=null==e?void 0:null===(s=e.password)||void 0===s?void 0:s.requireNumber)&&void 0!==t?!t:!l.gv)||c(r,/\d/)},y=(e,r)=>{var s,t;return(null!==(t=null==e?void 0:null===(s=e.password)||void 0===s?void 0:s.requireSymbol)&&void 0!==t?!t:!l.F)||c(r,/[!@#$%^&*(){}[\]<>?/|.:;_-]/)},h=(e,r,s,t)=>{d(e,s)||t.push(n.passwordTooSmall(e)),u(r,s)||t.push(n.passwordTooLong(r))},w=(e,r,s)=>{p(e,r)||s.push(n.passwordRequireLetter),m(e,r)||s.push(n.passwordRequireNumber),y(e,r)||s.push(n.passwordRequireSymbol)},_=e=>{var r,s,d,u;let{labelCol:c,wrapperCol:p,name:m,label:y,inputPlaceholder:_,inputAutoComplete:v,edit:g,style:x,required:j}=e,[b]=i.A.useSystem(),A=null!==(d=null==b?void 0:null===(r=b.password)||void 0===r?void 0:r.min)&&void 0!==d?d:l.TL,f=null!==(u=null==b?void 0:null===(s=b.password)||void 0===s?void 0:s.max)&&void 0!==u?u:l.Vt;return(0,t.jsx)(o.A.Item,{labelCol:c,wrapperCol:p,name:null!=m?m:"password",label:null!=y?y:"Password",rules:[()=>({validator(e,r){let s=[];return g&&"******"===r?Promise.resolve():r?(h(A,f,r,s),w(b,r,s),s.length)?Promise.reject(Error(s.join("; "))):Promise.resolve():Promise.reject(Error(n.password))}}),{required:!!j,message:""}],style:x,children:(0,t.jsx)(a.A.Password,{placeholder:_,autoComplete:v})})}},20420:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>S});var t=s(74848),o=s(96540),a=s(86715),l=s(21807),i=s(8331),n=s(8350),d=s(17004),u=s(75654),c=s(61580),p=s(26603),m=s(43508),y=s(30498),h=s(78252),w=s(40889),_=s(70551),v=s(87180),g=s(57628),x=s(28952),j=s(41349),b=s(66188),A=s.n(b),f=s(69670),T=s.n(f);let P={wrongLink:"Wrong link",incorrect:"Incorrect data",internal:"Internal error, please try again shortly",passwordMismatch:"Passwords mismatch"},C=async(e,r,s,t)=>{if(t.email!==r)throw new x.L({title:P.incorrect});try{await j.A.process(s,{email:t.email,password:t.password}),await e.push("/login").catch()}catch(e){throw new x.L({title:P.internal,err:e})}},k=()=>{let[e,r]=(0,o.useState)(!0),[s,x]=(0,o.useState)(),[b,f]=(0,o.useState)(!1),[k,S]=(0,o.useState)(),{dispatch:E}=(0,o.useContext)(h.V2),N=(0,a.useRouter)(),{id:L}=N.query;(0,o.useEffect)(()=>{(0,_.g)(async()=>{if(L)try{let e=await j.A.get(L,["type","email"]);e.type===y.k0?(x(e.email),r(!1)):E((0,w.CN)({title:P.wrongLink}))}catch(e){E((0,w.CN)({title:P.internal,err:e}))}})},[L,E]);let q=(0,o.useCallback)(e=>{(0,_.g)(async()=>{f(!0);try{await C(N,s,L,e)}catch(e){S(e),f(!1)}})},[N,s,L]);return e?(0,t.jsx)(l.A,{children:(0,t.jsxs)(i.A,{bordered:!1,className:T().password,children:[(0,t.jsx)(n.A,{})," Loading..."]})}):(0,t.jsx)(l.A,{children:(0,t.jsx)(i.A,{bordered:!1,className:T().password,children:(0,t.jsxs)(d.A,{direction:"vertical",size:"large",className:A().fullWidth,children:[(0,t.jsx)("div",{children:(0,t.jsx)(u.A.Title,{level:1,style:{padding:0,marginBottom:16,fontWeight:500},children:"Password recovery"})}),(0,t.jsxs)(c.A,{requiredMark:"optional",onFinish:q,layout:"vertical",children:[(0,t.jsx)(c.A.Item,{name:"email",label:"Enter your email address",rules:[{required:!0,message:"Email is required"}],children:(0,t.jsx)(p.A,{placeholder:"Email address",autoComplete:"email"})}),(0,t.jsx)(v.r,{name:"password",label:"Choose your password",inputPlaceholder:"Password",style:{marginBottom:"14px"}}),(0,t.jsx)(c.A.Item,{name:"passwordConfirmation",label:"Confirm your password",rules:[{required:!0,message:"Password confirmation is required"},e=>{let{getFieldValue:r}=e;return{validator:(e,s)=>s&&r("password")!==s?Promise.reject(Error(P.passwordMismatch)):Promise.resolve()}}],style:{marginBottom:"14px"},children:(0,t.jsx)(p.A.Password,{placeholder:"Password"})}),(0,t.jsx)(g.jQ,{error:k}),(0,t.jsx)(c.A.Item,{className:T().submit,children:(0,t.jsx)(m.Ay,{type:"primary",loading:b,htmlType:"submit",children:"Finish"})})]})]})})})},S=()=>(0,t.jsx)(k,{})},69670:e=>{e.exports={password:"password_password__ju1vM",submit:"password_submit__bQX9G"}},66188:e=>{e.exports={variables:'"./variables.css"',colorPrimary:"#fad114",textColorDark:"rgba(0, 0, 0, 0.65)",textColorLight:"rgba(0, 0, 0, 0.45)",logo:"styles_logo__a_88m",displayNone:"styles_displayNone__X5JML",displayFlex:"styles_displayFlex__pvl0H",fullWidth:"styles_fullWidth__ig6Zi",fullHeight:"styles_fullHeight__aD1qp",noScroll:"styles_noScroll__jJYvq",scroll:"styles_scroll___zuDw",noBackground:"styles_noBackground__QOpQc",noBorder:"styles_noBorder__T5mw6",noBorderBottom:"styles_noBorderBottom__5ori7",textWhite:"styles_textWhite__yojx2",textLight:"styles_textLight__QglC7",textDark:"styles_textDark__xPmmk",textOrange:"styles_textOrange__TYZ4a",textGreen:"styles_textGreen__M8GsP",textAlignLeft:"styles_textAlignLeft__Da1jw",textAlignCenter:"styles_textAlignCenter__DSN8m",primaryColor:"styles_primaryColor__lHC0K",backgroundPrimary:"styles_backgroundPrimary__5S8pd"}}},e=>{var r=r=>e(e.s=r);e.O(0,[1807,5391,8331,6603,8065,636,6593,8792],()=>r(66829)),_N_E=e.O()}]);