(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8322],{47839:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/password",function(){return t(19318)}])},11863:function(e,r,t){"use strict";var s;t.d(r,{JT:function(){return a},ah:function(){return l},nq:function(){return n},tE:function(){return i},yL:function(){return o}}),null!==(s=t(34155).env.AUTH_SECRET)&&void 0!==s||Array(33).join("a");let o=6,n=16,a=!0,i=!0,l=!0},70265:function(e,r,t){"use strict";var s;t.d(r,{EQ:function(){return i},kD:function(){return n},o3:function(){return o},x_:function(){return a}});let o=null!==(s=t(34155).env.EMAIL_TOKEN)&&void 0!==s?s:"",n="subscribe",a="passwordRecovery",i="revalidate"},16647:function(e,r,t){"use strict";t.d(r,{R:function(){return u},_:function(){return l}});var s=t(37643),o=t.n(s),n=t(34155);let a=n.env.PORT?parseInt(n.env.PORT):3e3,i=o()()?"http://localhost:"+a:"",l=async(e,r)=>{let t=await fetch(i+e,{method:r?"POST":"GET",headers:{accept:"application/json","Content-Type":"application/json"},...r&&{body:r}}),s=t.headers.get("Content-Type");if(!t.ok){let e=Error("An error occured while fetching data.");throw e.info=(null==s?void 0:s.includes("application/json"))&&await t.json(),e.status=t.status,e}return t.json()},u=async(e,r)=>{var t;let s=await fetch(i+e,{...r,method:null!==(t=null==r?void 0:r.method)&&void 0!==t?t:"GET",headers:{...null==r?void 0:r.headers,"Content-Type":"application/json"}}),o=s.headers.get("Content-Type");if(!s.ok){let e=Error("An error occured while fetching data.");throw e.info=(null==o?void 0:o.includes("application/json"))&&await s.json(),e.status=s.status,e}return s}},6964:function(e,r,t){"use strict";t.d(r,{H:function(){return s}});class s extends Error{constructor(e){var r;super(e.title),this.title=e.title,this.name="APIError",this.render=e.render,this.err=e.err,this.type=null!==(r=e.type)&&void 0!==r?r:"error"}}},76134:function(e,r,t){"use strict";t.d(r,{Z:function(){return o}});var s=t(16647),o={get:async(e,r)=>(await (0,s.R)("/api/link",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify({id:e,data:r})})).json(),process:async(e,r)=>{await (0,s.R)("/api/link",{method:"PUT",body:JSON.stringify({id:e,data:r})})}}},80866:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});var s=t(81758),o=t(67294),n=t(16647),a={useSystem:()=>{var e;let{data:r,error:t,mutate:a}=(0,s.ZP)("/api/system",n._),i=null!==(e=null==r?void 0:r.system)&&void 0!==e?e:{},l=(0,o.useCallback)(async e=>{await a({system:{...i,...e}})},[i,a]);return[i,{mutateSystem:l,errorSystem:t,loadingSystem:!r}]},update:async e=>{await (0,n.R)("/api/system",{method:"PUT",body:JSON.stringify(e)})}}},32671:function(e,r,t){"use strict";t.d(r,{o:function(){return w}});var s=t(85893),o=t(79505),n=t(59935),a=t(11863),i=t(80866);let l={password:"Please enter a password",passwordTooSmall:e=>"Your password is too small (minimum "+e+" characters)",passwordTooLong:e=>"Your password is too long (maximum "+e+" characters)",passwordRequireLetter:"Your password must contain a letter",passwordRequireNumber:"Your password must contain a number",passwordRequireSymbol:"Your password must contain a symbol"},u=(e,r)=>!(r.length<e),d=(e,r)=>!(r.length>e),c=(e,r)=>-1!==e.search(r),p=(e,r)=>{var t,s;return(null!==(s=null==e?void 0:null===(t=e.password)||void 0===t?void 0:t.requireLetter)&&void 0!==s?!s:!a.JT)||c(r,/[a-zA-Z]/)},m=(e,r)=>{var t,s;return(null!==(s=null==e?void 0:null===(t=e.password)||void 0===t?void 0:t.requireNumber)&&void 0!==s?!s:!a.tE)||c(r,/\d/)},y=(e,r)=>{var t,s;return(null!==(s=null==e?void 0:null===(t=e.password)||void 0===t?void 0:t.requireSymbol)&&void 0!==s?!s:!a.ah)||c(r,/[!@#$%^&*(){}[\]<>?/|.:;_-]/)},h=(e,r,t,s)=>{u(e,t)||s.push(l.passwordTooSmall(e)),d(r,t)||s.push(l.passwordTooLong(r))},_=(e,r,t)=>{p(e,r)||t.push(l.passwordRequireLetter),m(e,r)||t.push(l.passwordRequireNumber),y(e,r)||t.push(l.passwordRequireSymbol)};var w=e=>{var r,t,u,d;let{labelCol:c,wrapperCol:p,name:m,label:y,inputPlaceholder:w,inputAutoComplete:v,edit:f,style:g,required:x}=e,[j]=i.Z.useSystem(),b=null!==(u=null==j?void 0:null===(r=j.password)||void 0===r?void 0:r.min)&&void 0!==u?u:a.yL,P=null!==(d=null==j?void 0:null===(t=j.password)||void 0===t?void 0:t.max)&&void 0!==d?d:a.nq;return(0,s.jsx)(o.Z.Item,{labelCol:c,wrapperCol:p,name:null!=m?m:"password",label:null!=y?y:"Password",rules:[()=>({validator(e,r){let t=[];return f&&"******"===r?Promise.resolve():r?(h(b,P,r,t),_(j,r,t),t.length)?Promise.reject(Error(t.join("; "))):Promise.resolve():Promise.reject(Error(l.password))}}),{required:!!x,message:""}],style:g,children:(0,s.jsx)(n.Z.Password,{placeholder:w,autoComplete:v})})}},19318:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return S}});var s=t(85893),o=t(67294),n=t(11163),a=t(81384),i=t(91951),l=t(11892),u=t(62481),d=t(90941),c=t(79505),p=t(59935),m=t(53533),y=t(70265),h=t(97992),_=t(49),w=t(25946),v=t(32671),f=t(74642),g=t(6964),x=t(76134),j=t(58650),b=t.n(j),P=t(46668),T=t.n(P);let C={wrongLink:"Wrong link",incorrect:"Incorrect data",internal:"Internal error, please try again shortly",passwordMismatch:"Passwords mismatch"},E=async(e,r,t,s)=>{if(s.email!==r)throw new g.H({title:C.incorrect});try{await x.Z.process(t,{email:s.email,password:s.password}),await e.push("/login").catch()}catch(e){throw new g.H({title:C.internal,err:e})}};var Z=()=>{let[e,r]=(0,o.useState)(!0),[t,g]=(0,o.useState)(),[j,P]=(0,o.useState)(!1),[Z,S]=(0,o.useState)(),{dispatch:k}=(0,o.useContext)(h.uj),q=(0,n.useRouter)(),{id:N}=q.query;(0,o.useEffect)(()=>{(0,w.u)(async()=>{if(N)try{let e=await x.Z.get(N,["type","email"]);e.type===y.x_?(g(e.email),r(!1)):k((0,_.iT)({title:C.wrongLink}))}catch(e){k((0,_.iT)({title:C.internal,err:e}))}})},[N,k]);let L=(0,o.useCallback)(e=>{(0,w.u)(async()=>{P(!0);try{await E(q,t,N,e)}catch(e){S(e),P(!1)}})},[q,t,N]);return e?(0,s.jsx)(a.Z,{children:(0,s.jsxs)(i.Z,{bordered:!1,className:T().password,children:[(0,s.jsx)(l.Z,{})," Loading..."]})}):(0,s.jsx)(a.Z,{children:(0,s.jsx)(i.Z,{bordered:!1,className:T().password,children:(0,s.jsxs)(u.Z,{direction:"vertical",size:"large",className:b().fullWidth,children:[(0,s.jsx)("div",{children:(0,s.jsx)(d.Z.Title,{level:1,style:{padding:0,marginBottom:16,fontWeight:500},children:"Password recovery"})}),(0,s.jsxs)(c.Z,{requiredMark:"optional",onFinish:L,layout:"vertical",children:[(0,s.jsx)(c.Z.Item,{name:"email",label:"Enter your email address",rules:[{required:!0,message:"Email is required"}],children:(0,s.jsx)(p.Z,{placeholder:"Email address",autoComplete:"email"})}),(0,s.jsx)(v.o,{name:"password",label:"Choose your password",inputPlaceholder:"Password",style:{marginBottom:"14px"}}),(0,s.jsx)(c.Z.Item,{name:"passwordConfirmation",label:"Confirm your password",rules:[{required:!0,message:"Password confirmation is required"},e=>{let{getFieldValue:r}=e;return{validator:(e,t)=>t&&r("password")!==t?Promise.reject(Error(C.passwordMismatch)):Promise.resolve()}}],style:{marginBottom:"14px"},children:(0,s.jsx)(p.Z.Password,{placeholder:"Password"})}),(0,s.jsx)(f.Xq,{error:Z}),(0,s.jsx)(c.Z.Item,{className:T().submit,children:(0,s.jsx)(m.ZP,{type:"primary",loading:j,htmlType:"submit",children:"Finish"})})]})]})})})},S=()=>(0,s.jsx)(Z,{})},46668:function(e){e.exports={password:"password_password__ju1vM",submit:"password_submit__bQX9G"}},58650:function(e){e.exports={variables:'"./variables.css"',colorPrimary:"#fad114",textColorDark:"rgba(0, 0, 0, 0.65)",textColorLight:"rgba(0, 0, 0, 0.45)",logo:"styles_logo__a_88m",displayNone:"styles_displayNone__X5JML",displayFlex:"styles_displayFlex__pvl0H",fullWidth:"styles_fullWidth__ig6Zi",fullHeight:"styles_fullHeight__aD1qp",noScroll:"styles_noScroll__jJYvq",scroll:"styles_scroll___zuDw",noBackground:"styles_noBackground__QOpQc",noBorder:"styles_noBorder__T5mw6",noBorderBottom:"styles_noBorderBottom__5ori7",textWhite:"styles_textWhite__yojx2",textLight:"styles_textLight__QglC7",textDark:"styles_textDark__xPmmk",textOrange:"styles_textOrange__TYZ4a",textGreen:"styles_textGreen__M8GsP",textAlignLeft:"styles_textAlignLeft__Da1jw",textAlignCenter:"styles_textAlignCenter__DSN8m",primaryColor:"styles_primaryColor__lHC0K",backgroundPrimary:"styles_backgroundPrimary__5S8pd"}}},function(e){e.O(0,[1384,4120,1951,9935,1758,2888,9774,179],function(){return e(e.s=47839)}),_N_E=e.O()}]);