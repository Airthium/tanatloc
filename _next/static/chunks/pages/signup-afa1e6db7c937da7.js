(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[616],{47805:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/signup",function(){return n(17451)}])},15479:function(e,r,n){"use strict";n.d(r,{JT:function(){return i},ah:function(){return a},nq:function(){return s},tE:function(){return o},yL:function(){return t}});n(83454).env.AUTH_SECRET||new Array(33).join("a");var t=6,s=16,i=!0,o=!0,a=!0},87492:function(e,r,n){"use strict";n.d(r,{R:function(){return h},_:function(){return f}});var t=n(47568),s=n(26042),i=n(69396),o=n(34051),a=n.n(o),u=n(59134),c=n.n(u),l=n(83454),d=l.env.PORT?parseInt(l.env.PORT):3e3,p=c()()?"http://localhost:"+d:"",f=function(){var e=(0,t.Z)(a().mark((function e(r,n){var t,i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(p+r,(0,s.Z)({method:n?"POST":"GET",headers:{accept:"application/json","Content-Type":"application/json"}},n&&{body:n}));case 2:if(t=e.sent,i=t.headers.get("Content-Type"),t.ok){e.next=14;break}if(o=new Error("An error occured while fetching data."),e.t0=null===i||void 0===i?void 0:i.includes("application/json"),!e.t0){e.next=11;break}return e.next=10,t.json();case 10:e.t0=e.sent;case 11:throw o.info=e.t0,o.status=t.status,o;case 14:return e.abrupt("return",t.json());case 15:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),h=function(){var e=(0,t.Z)(a().mark((function e(r,n){var t,o,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(p+r,(0,i.Z)((0,s.Z)({},n),{method:n&&n.method||"GET",headers:(0,i.Z)((0,s.Z)({},n&&n.headers),{"Content-Type":"application/json"})}));case 2:if(t=e.sent,o=t.headers.get("Content-Type"),t.ok){e.next=14;break}if(u=new Error("An error occured while fetching data."),e.t0=null===o||void 0===o?void 0:o.includes("application/json"),!e.t0){e.next=11;break}return e.next=10,t.json();case 10:e.t0=e.sent;case 11:throw u.info=e.t0,u.status=t.status,u;case 14:return e.abrupt("return",t);case 15:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()},81891:function(e,r,n){"use strict";n.d(r,{H:function(){return a}});var t=n(51438),s=n(28668),i=n(25892),o=n(91224),a=function(e){(0,s.Z)(n,e);var r=(0,o.Z)(n);function n(e){var s;return(0,t.Z)(this,n),(s=r.call(this,e.title)).title=e.title,s.name="APIError",s.render=e.render,s.err=e.err,s.type=e.type||"error",s}return n}((0,i.Z)(Error))},36574:function(e,r,n){"use strict";n.d(r,{Z:function(){return p}});var t=n(26042),s=n(8100),i=n(67294),o=n(87492),a=n(47568),u=n(34051),c=n.n(u),l=function(){var e=(0,a.Z)(c().mark((function e(r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.R)("/api/system",{method:"PUT",body:JSON.stringify(r)});case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),d={useSystem:function(){var e=(0,s.ZP)("/api/system",o._),r=e.data,n=e.error,a=e.mutate,u=!r,c=(null===r||void 0===r?void 0:r.system)||{},l=(0,i.useCallback)((function(e){a({system:(0,t.Z)({},c,e)})}),[c,a]);return[c,{mutateSystem:l,errorSystem:n,loadingSystem:u}]},update:l},p=d},67169:function(e,r,n){"use strict";n.d(r,{Z:function(){return y}});var t=n(26042),s=n(8100),i=n(67294),o=n(87492),a=n(69396),u=n(29815),c=n(47568),l=n(34051),d=n.n(l),p=function(){var e=(0,c.Z)(d().mark((function e(r){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.R)("/api/user",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(r)});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),f=function(){var e=(0,c.Z)(d().mark((function e(r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.R)("/api/user",{method:"PUT",body:JSON.stringify(r)});case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),h=function(){var e=(0,c.Z)(d().mark((function e(r,n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.R)("/api/user/"+r,{method:"PUT",body:JSON.stringify(n)});case 2:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),m=function(){var e=(0,c.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.R)("/api/user",{method:"DELETE"});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=(0,c.Z)(d().mark((function e(r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.R)("/api/user/"+r,{method:"DELETE"});case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),x=function(){var e=(0,c.Z)(d().mark((function e(r){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.R)("/api/user/check",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(r)});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Z={useUser:function(){var e=(0,s.ZP)("/api/user",o._),r=e.data,n=e.error,a=e.mutate,u=!r,c=null===r||void 0===r?void 0:r.user,l=(0,i.useCallback)((function(e){a({user:(0,t.Z)({},c,e)})}),[c,a]),d=(0,i.useCallback)((function(){a({user:void 0})}),[a]);return[c,{mutateUser:l,clearUser:d,errorUser:401===(null===n||void 0===n?void 0:n.status)?void 0:n,loadingUser:401!==(null===n||void 0===n?void 0:n.status)&&u}]},useUsers:function(){var e=(0,s.ZP)("/api/users",o._),r=e.data,n=e.error,c=e.mutate,l=!r,d=(null===r||void 0===r?void 0:r.users)||[],p=(0,i.useCallback)((function(e){var r=(0,u.Z)(d).concat([(0,a.Z)((0,t.Z)({},e),{authorizedplugins:[]})]);c({users:r})}),[d,c]),f=(0,i.useCallback)((function(e){var r=d.filter((function(r){return r.id!==e.id}));c({users:r})}),[d,c]),h=(0,i.useCallback)((function(e){var r=d.map((function(r){return r.id===e.id&&(r=(0,t.Z)({},r,e)),r}));c({users:r})}),[d,c]);return[d,{addOneUser:p,delOneUser:f,mutateOneUser:h,errorUsers:n,loadingUsers:l}]},add:p,update:f,updateById:h,del:m,delById:v,check:x},y=Z},51986:function(e,r,n){"use strict";n.d(r,{o:function(){return x}});var t=n(828),s=n(85893),i=n(81579),o=n(69677),a=n(15479),u=n(36574),c="Please enter a password",l=function(e){return"Your password is too small (minimum "+e+" characters)"},d=function(e){return"Your password is too long (maximum "+e+" characters)"},p="Your password must contain a letter",f="Your password must contain a number",h="Your password must contain a symbol",m=function(e,r){return-1!==e.search(r)},v=function(e,r,n){(function(e,r){var n,t;return!(null!==(t=null===e||void 0===e||null===(n=e.password)||void 0===n?void 0:n.requireLetter)&&void 0!==t?t:a.JT)||m(r,/[a-zA-Z]/)})(e,r)||n.push(p),function(e,r){var n,t;return!(null!==(t=null===e||void 0===e||null===(n=e.password)||void 0===n?void 0:n.requireNumber)&&void 0!==t?t:a.tE)||m(r,/\d/)}(e,r)||n.push(f),function(e,r){var n,t;return!(null!==(t=null===e||void 0===e||null===(n=e.password)||void 0===n?void 0:n.requireSymbol)&&void 0!==t?t:a.ah)||m(r,/[!@#$%^&*(){}[\]<>?/|.:;_-]/)}(e,r)||n.push(h)},x=function(e){var r,n,p,f,h=e.labelCol,m=e.wrapperCol,x=e.name,Z=e.label,y=e.inputPlaceholder,g=e.inputAutoComplete,w=e.edit,j=e.style,b=e.required,k=e.className,T=(0,t.Z)(u.Z.useSystem(),1)[0],S=null!==(p=null===T||void 0===T||null===(r=T.password)||void 0===r?void 0:r.min)&&void 0!==p?p:a.yL,C=null!==(f=null===T||void 0===T||null===(n=T.password)||void 0===n?void 0:n.max)&&void 0!==f?f:a.nq;return(0,s.jsx)(i.Z.Item,{className:k,labelCol:h,wrapperCol:m,name:x||"password",label:Z||"Password",rules:[function(){return{validator:function(e,r){var n=[];return w&&"******"===r?Promise.resolve():r?(function(e,r,n,t){(function(e,r){return!(r.length<e)})(e,n)||t.push(l(e)),function(e,r){return!(r.length>e)}(r,n)||t.push(d(r))}(S,C,r,n),v(T,r,n),n.length?Promise.reject(n):Promise.resolve()):Promise.reject(c)}}},{required:!!b,message:""}],style:j,children:(0,s.jsx)(o.Z.Password,{placeholder:y,autoComplete:g})})}},96844:function(e,r,n){"use strict";n.d(r,{lt:function(){return x},Xq:function(){return g},Ur:function(){return s}});var t=n(13448),s=function(e,r){t.Z.success({message:e,description:r,duration:10})},i=n(85893),o=n(6880),a=n(54907),u=n(26713),c=n(71577),l=n(79074),d=n(60274);l.S1({dsn:"https://3bb27cb32e55433696022ba93cb32430@o394613.ingest.sentry.io/5428383"});var p,f,h=d,m=[],v=function(){p&&(t.Z.close(p),p=void 0),m.forEach((function(e){return t.Z.close(e)})),m.length=0,t.Z.close(f),f=void 0},x=function(e,r){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("Failed to fetch"!==(null===r||void 0===r?void 0:r.message)){if(n){var s,l,d="error_"+m.length;m.push(d),t.Z.error({key:d,message:e,description:r&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.Z.Text,{code:!0,children:r.message}),(r.status||r.info)&&(0,i.jsx)(a.Z,{children:(0,i.jsx)(a.Z.Panel,{header:"More information",children:(0,i.jsxs)(u.Z,{direction:"vertical",children:[r.status&&(0,i.jsxs)(o.Z.Text,{children:["Status: ",r.status]}),(null===(s=r.info)||void 0===s?void 0:s.message)&&(0,i.jsxs)(o.Z.Text,{children:["Description: ",null===(l=r.info)||void 0===l?void 0:l.message]})]})},"information")})]}),duration:0})}if(r&&console.error(r),r&&h.captureException(r),m.length>1&&!f){var x="close_all";t.Z.info({key:x,message:(0,i.jsx)(c.Z,{type:"primary",onClick:v,children:"Close all"}),description:"Close all error notifications",duration:0,placement:"top"}),f=x}}else if(!p){var Z="server_error";m.push(Z),t.Z.error({key:Z,message:"Server error",description:"Server is disconnected, please check your internet connection.",duration:0,onClose:function(){p=void 0}}),p=Z}},Z=n(81579),y=n(14670),g=function(e){var r,n,t=e.error;return t?(0,i.jsx)(Z.Z.Item,{children:(0,i.jsx)(y.Z,{message:t.render||t.title,type:t.type,showIcon:!0,description:t.err&&(0,i.jsxs)(i.Fragment,{children:[t.err.message&&(0,i.jsxs)(o.Z.Text,{type:"danger",children:["Message: ",(0,i.jsx)("code",{children:t.err.message})]}),t.err.status&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("br",{}),(0,i.jsxs)(o.Z.Text,{type:"danger",children:["Status: ",(0,i.jsx)("code",{children:t.err.status})]})]}),(null===(r=t.err.info)||void 0===r?void 0:r.message)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("br",{}),(0,i.jsxs)(o.Z.Text,{type:"danger",children:["Information: ",(0,i.jsx)("code",{children:null===(n=t.err.info)||void 0===n?void 0:n.message})]})]})]})})}):null}},75107:function(e,r,n){"use strict";var t=n(85893),s=n(26713),i=n(81474),o=n(11382),a=n(97183),u=function(e){var r=e.text;return(0,t.jsxs)(a.Z,{className:"tanatloc-gradient",children:[(0,t.jsx)("div",{className:"logo",children:(0,t.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,t.jsx)(i.Z,{className:"Loading",children:(0,t.jsxs)(s.Z,{children:[(0,t.jsx)(o.Z,{size:"large"}),null!==r&&void 0!==r?r:"Loading, please wait..."]})})]})};u.Simple=function(){return(0,t.jsx)(s.Z,{style:{height:"100%",width:"100%",justifyContent:"center",alignItems:"center"},children:(0,t.jsx)(i.Z,{children:(0,t.jsxs)(s.Z,{children:[(0,t.jsx)(o.Z,{}),"Loading, please wait..."]})})})},r.Z=u},17451:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return _}});var t=n(85893),s=n(47568),i=n(828),o=n(34051),a=n.n(o),u=n(11163),c=n(67294),l=n(97183),d=n(81474),p=n(26713),f=n(6880),h=n(81579),m=n(69677),v=n(71577),x=n(51986),Z=n(96844),y=n(75107),g=n(81891),w=n(67169),j=n(36574),b="User error",k="System error",T="Server issue : try again shortly.",S="This email is already registered",C="Passwords mismatch",E=function(){var e=(0,s.Z)(a().mark((function e(r,n){var s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,w.Z.add(n);case 4:s=e.sent,e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(1),new g.H({title:T,err:e.t0});case 10:if(!s.alreadyExists){e.next=12;break}throw new g.H({title:S,render:(0,t.jsxs)(t.Fragment,{children:["We know you! ",(0,t.jsx)("a",{onClick:function(){return P(r)},children:"Log in ?"})]}),type:"warning"});case 12:r.push("/signup/send");case 13:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(r,n){return e.apply(this,arguments)}}(),P=function(e){e.push("/login")},U=function(){var e=(0,c.useState)(!1),r=e[0],n=e[1],o=(0,c.useState)(),g=o[0],T=o[1],S=(0,u.useRouter)(),P=(0,i.Z)(w.Z.useUser(),2),U=P[0],_=P[1],N=_.errorUser,O=_.loadingUser,q=(0,i.Z)(j.Z.useSystem(),2),I=q[0],A=q[1],R=A.errorSystem,F=A.loadingSystem;return(0,c.useEffect)((function(){N&&(0,Z.lt)(b,N),R&&(0,Z.lt)(k,R)}),[N,R]),(0,c.useEffect)((function(){U&&S.push("/dashboard")}),[U,S]),(0,c.useEffect)((function(){S.prefetch("/dashboard"),S.prefetch("/login")}),[S]),O||F||U?(0,t.jsx)(y.Z,{}):(null===I||void 0===I?void 0:I.allowsignup)?(0,t.jsx)(l.Z,{children:(0,t.jsx)(d.Z,{bordered:!1,className:"Signup",children:(0,t.jsxs)(p.Z,{direction:"vertical",size:"large",className:"full-width",children:[(0,t.jsx)("div",{children:(0,t.jsx)(f.Z.Title,{level:1,style:{padding:0,marginBottom:16,fontWeight:500},children:"Sign Up"})}),(0,t.jsxs)(h.Z,{requiredMark:"optional",onFinish:function(){var e=(0,s.Z)(a().mark((function e(r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!0),e.prev=1,e.next=4,E(S,r);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),T(e.t0);case 9:return e.prev=9,n(!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[1,6,9,12]])})));return function(r){return e.apply(this,arguments)}}(),layout:"vertical",children:[(0,t.jsx)(h.Z.Item,{name:"email",label:"Enter your email address",rules:[{required:!0,message:"Email is required"}],children:(0,t.jsx)(m.Z,{placeholder:"Email address",autoComplete:"email"})}),(0,t.jsx)(x.o,{name:"password",label:"Choose your password",inputPlaceholder:"Password",inputAutoComplete:"current-password",style:{marginBottom:"14px"}}),(0,t.jsx)(h.Z.Item,{name:"passwordConfirmation",label:"Confirm your password",rules:[{required:!0,message:"Password confirmation is required"},function(e){var r=e.getFieldValue;return{validator:function(e,n){return n&&r("password")!==n?Promise.reject(C):Promise.resolve()}}}],style:{marginBottom:"14px"},children:(0,t.jsx)(m.Z.Password,{placeholder:"Password",autoComplete:"current-password"})}),(0,t.jsx)(Z.Xq,{error:g}),(0,t.jsx)(h.Z.Item,{className:"Signup-submit",children:(0,t.jsx)(v.Z,{type:"primary",loading:r,htmlType:"submit",children:"Finish"})})]})]})})}):(0,t.jsx)(l.Z,{children:(0,t.jsx)(d.Z,{className:"Signup",children:"The server does not allow signup for now"})})},_=function(){return(0,t.jsx)(U,{})}},29815:function(e,r,n){"use strict";n.d(r,{Z:function(){return o}});var t=n(20943);var s=n(13375);var i=n(91566);function o(e){return function(e){if(Array.isArray(e))return(0,t.Z)(e)}(e)||(0,s.Z)(e)||(0,i.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}},function(e){e.O(0,[841,880,474,551,220,595,819,909,695,774,888,179],(function(){return r=47805,e(e.s=r);var r}));var r=e.O();_N_E=r}]);