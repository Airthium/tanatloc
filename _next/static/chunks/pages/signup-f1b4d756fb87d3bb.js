(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7616],{90420:function(e,r,t){"use strict";t.d(r,{Z:function(){return l}});var n=t(1413),s=t(67294),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"},i=t(42135),a=function(e,r){return s.createElement(i.Z,(0,n.Z)((0,n.Z)({},e),{},{ref:r,icon:o}))};a.displayName="EyeInvisibleOutlined";var l=s.forwardRef(a)},99611:function(e,r,t){"use strict";t.d(r,{Z:function(){return l}});var n=t(1413),s=t(67294),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"},i=t(42135),a=function(e,r){return s.createElement(i.Z,(0,n.Z)((0,n.Z)({},e),{},{ref:r,icon:o}))};a.displayName="EyeOutlined";var l=s.forwardRef(a)},28058:function(e,r,t){"use strict";t.d(r,{Z:function(){return l}});var n=t(1413),s=t(67294),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},i=t(42135),a=function(e,r){return s.createElement(i.Z,(0,n.Z)((0,n.Z)({},e),{},{ref:r,icon:o}))};a.displayName="WarningOutlined";var l=s.forwardRef(a)},69677:function(e,r,t){"use strict";t.d(r,{Z:function(){return O}});var n=t(87462),s=t(4942),o=t(94184),i=t.n(o),a=t(67294),l=t(53124),u=t(65223),c=function(e){var r,t=(0,a.useContext)(l.E_),o=t.getPrefixCls,c=t.direction,d=e.prefixCls,p=e.className,m=o("input-group",d),h=i()(m,(r={},(0,s.Z)(r,"".concat(m,"-lg"),"large"===e.size),(0,s.Z)(r,"".concat(m,"-sm"),"small"===e.size),(0,s.Z)(r,"".concat(m,"-compact"),e.compact),(0,s.Z)(r,"".concat(m,"-rtl"),"rtl"===c),r),void 0===p?"":p),f=(0,a.useContext)(u.aM),v=(0,a.useMemo)(function(){return(0,n.Z)((0,n.Z)({},f),{isFormItemInput:!1})},[f]);return a.createElement("span",{className:h,style:e.style,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onFocus:e.onFocus,onBlur:e.onBlur},a.createElement(u.aM.Provider,{value:v},e.children))},d=t(16591),p=t(97685),m=t(90420),h=t(99611),f=t(98423),v=t(42550),g=t(72922),y=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>r.indexOf(n)&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)0>r.indexOf(n[s])&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(t[n[s]]=e[n[s]]);return t},x=function(e){return e?a.createElement(h.Z,null):a.createElement(m.Z,null)},w={click:"onClick",hover:"onMouseOver"},Z=a.forwardRef(function(e,r){var t=(0,a.useState)(!1),o=(0,p.Z)(t,2),u=o[0],c=o[1],m=(0,a.useRef)(null),h=(0,g.Z)(m),Z=function(){e.disabled||(u&&h(),c(function(e){return!e}))},j=function(r){var t,n=e.action,o=e.iconRender,i=w[void 0===n?"click":n]||"",l=(void 0===o?x:o)(u),c=(t={},(0,s.Z)(t,i,Z),(0,s.Z)(t,"className","".concat(r,"-icon")),(0,s.Z)(t,"key","passwordIcon"),(0,s.Z)(t,"onMouseDown",function(e){e.preventDefault()}),(0,s.Z)(t,"onMouseUp",function(e){e.preventDefault()}),t);return a.cloneElement(a.isValidElement(l)?l:a.createElement("span",null,l),c)},b=function(t){var o=t.getPrefixCls,l=e.className,c=e.prefixCls,p=e.inputPrefixCls,h=e.size,g=e.visibilityToggle,x=y(e,["className","prefixCls","inputPrefixCls","size","visibilityToggle"]),w=o("input",p),Z=o("input-password",c),b=(void 0===g||g)&&j(Z),E=i()(Z,l,(0,s.Z)({},"".concat(Z,"-").concat(h),!!h)),C=(0,n.Z)((0,n.Z)({},(0,f.Z)(x,["suffix","iconRender"])),{type:u?"text":"password",className:E,prefixCls:w,suffix:b});return h&&(C.size=h),a.createElement(d.ZP,(0,n.Z)({ref:(0,v.sQ)(r,m)},C))};return a.createElement(l.C,null,b)}),j=t(68795),b=t(71577),E=t(97647),C=t(96159),P=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>r.indexOf(n)&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)0>r.indexOf(n[s])&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(t[n[s]]=e[n[s]]);return t},T=a.forwardRef(function(e,r){var t,o,u=e.prefixCls,c=e.inputPrefixCls,p=e.className,m=e.size,h=e.suffix,f=e.enterButton,g=void 0!==f&&f,y=e.addonAfter,x=e.loading,w=e.disabled,Z=e.onSearch,T=e.onChange,S=e.onCompositionStart,N=e.onCompositionEnd,O=P(e,["prefixCls","inputPrefixCls","className","size","suffix","enterButton","addonAfter","loading","disabled","onSearch","onChange","onCompositionStart","onCompositionEnd"]),k=a.useContext(l.E_),R=k.getPrefixCls,z=k.direction,_=a.useContext(E.Z),L=a.useRef(!1),M=m||_,q=a.useRef(null),U=function(e){e&&e.target&&"click"===e.type&&Z&&Z(e.target.value,e),T&&T(e)},A=function(e){var r;document.activeElement===(null===(r=q.current)||void 0===r?void 0:r.input)&&e.preventDefault()},I=function(e){var r,t;Z&&Z(null===(t=null===(r=q.current)||void 0===r?void 0:r.input)||void 0===t?void 0:t.value,e)},B=function(e){L.current||I(e)},F=R("input-search",u),D=R("input",c),H="boolean"==typeof g?a.createElement(j.Z,null):null,J="".concat(F,"-button"),Q=g||{},Y=Q.type&&!0===Q.type.__ANT_BUTTON;o=Y||"button"===Q.type?(0,C.Tm)(Q,(0,n.Z)({onMouseDown:A,onClick:function(e){var r,t;null===(t=null===(r=null==Q?void 0:Q.props)||void 0===r?void 0:r.onClick)||void 0===t||t.call(r,e),I(e)},key:"enterButton"},Y?{className:J,size:M}:{})):a.createElement(b.Z,{className:J,type:g?"primary":void 0,size:M,disabled:w,key:"enterButton",onMouseDown:A,onClick:I,loading:x,icon:H},g),y&&(o=[o,(0,C.Tm)(y,{key:"addonAfter"})]);var X=i()(F,(t={},(0,s.Z)(t,"".concat(F,"-rtl"),"rtl"===z),(0,s.Z)(t,"".concat(F,"-").concat(M),!!M),(0,s.Z)(t,"".concat(F,"-with-button"),!!g),t),p),G=function(e){L.current=!0,null==S||S(e)},W=function(e){L.current=!1,null==N||N(e)};return a.createElement(d.ZP,(0,n.Z)({ref:(0,v.sQ)(q,r),onPressEnter:B},O,{size:M,onCompositionStart:G,onCompositionEnd:W,prefixCls:D,addonAfter:o,suffix:h,onChange:U,className:X,disabled:w}))}),S=t(3008),N=d.ZP;N.Group=c,N.Search=T,N.TextArea=S.Z,N.Password=Z;var O=N},47805:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/signup",function(){return t(36149)}])},37404:function(e,r,t){"use strict";t.d(r,{JT:function(){return o},ah:function(){return a},nq:function(){return s},tE:function(){return i},yL:function(){return n}}),t(83454).env.AUTH_SECRET||Array(33).join("a");let n=6,s=16,o=!0,i=!0,a=!0},11425:function(e,r,t){"use strict";t.d(r,{R:function(){return u},_:function(){return l}});var n=t(59134),s=t.n(n),o=t(83454);let i=o.env.PORT?parseInt(o.env.PORT):3e3,a=s()()?"http://localhost:"+i:"",l=async(e,r)=>{let t=await fetch(a+e,{method:r?"POST":"GET",headers:{accept:"application/json","Content-Type":"application/json"},...r&&{body:r}}),n=t.headers.get("Content-Type");if(!t.ok){let s=Error("An error occured while fetching data.");throw s.info=(null==n?void 0:n.includes("application/json"))&&await t.json(),s.status=t.status,s}return t.json()},u=async(e,r)=>{let t=await fetch(a+e,{...r,method:r&&r.method||"GET",headers:{...r&&r.headers,"Content-Type":"application/json"}}),n=t.headers.get("Content-Type");if(!t.ok){let s=Error("An error occured while fetching data.");throw s.info=(null==n?void 0:n.includes("application/json"))&&await t.json(),s.status=t.status,s}return t}},4415:function(e,r,t){"use strict";t.d(r,{H:function(){return n}});class n extends Error{constructor(e){super(e.title),this.title=e.title,this.name="APIError",this.render=e.render,this.err=e.err,this.type=e.type||"error"}}},92288:function(e,r,t){"use strict";t.d(r,{Z:function(){return l}});var n=t(8100),s=t(67294),o=t(11425);let i=()=>{let{data:e,error:r,mutate:t}=(0,n.ZP)("/api/system",o._),i=(null==e?void 0:e.system)||{},a=(0,s.useCallback)(e=>{t({system:{...i,...e}})},[i,t]);return[i,{mutateSystem:a,errorSystem:r,loadingSystem:!e}]},a=async e=>{await (0,o.R)("/api/system",{method:"PUT",body:JSON.stringify(e)})};var l={useSystem:i,update:a}},55734:function(e,r,t){"use strict";t.d(r,{Z:function(){return h}});var n=t(8100),s=t(67294),o=t(11425);let i=()=>{let{data:e,error:r,mutate:t}=(0,n.ZP)("/api/user",o._),i=null==e?void 0:e.user,a=(0,s.useCallback)(e=>{t({user:{...i,...e}})},[i,t]),l=(0,s.useCallback)(()=>{t({user:void 0})},[t]);return[i,{mutateUser:a,clearUser:l,errorUser:(null==r?void 0:r.status)===401?void 0:r,loadingUser:(null==r?void 0:r.status)!==401&&!e}]},a=()=>{let{data:e,error:r,mutate:t}=(0,n.ZP)("/api/users",o._),i=(null==e?void 0:e.users)||[],a=(0,s.useCallback)(e=>{let r=[...i,{...e,authorizedplugins:[]}];t({users:r})},[i,t]),l=(0,s.useCallback)(e=>{let r=i.filter(r=>r.id!==e.id);t({users:r})},[i,t]),u=(0,s.useCallback)(e=>{let r=i.map(r=>(r.id===e.id&&(r={...r,...e}),r));t({users:r})},[i,t]);return[i,{addOneUser:a,delOneUser:l,mutateOneUser:u,errorUsers:r,loadingUsers:!e}]},l=async e=>{let r=await (0,o.R)("/api/user",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(e)});return r.json()},u=async e=>{await (0,o.R)("/api/user",{method:"PUT",body:JSON.stringify(e)})},c=async(e,r)=>{await (0,o.R)("/api/user/"+e,{method:"PUT",body:JSON.stringify(r)})},d=async()=>{await (0,o.R)("/api/user",{method:"DELETE"})},p=async e=>{await (0,o.R)("/api/user/"+e,{method:"DELETE"})},m=async e=>{let r=await (0,o.R)("/api/user/check",{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(e)});return r.json()};var h={useUser:i,useUsers:a,add:l,update:u,updateById:c,del:d,delById:p,check:m}},47455:function(e,r,t){"use strict";t.d(r,{o:function(){return y}});var n=t(85893),s=t(81579),o=t(69677),i=t(37404),a=t(92288);let l={password:"Please enter a password",passwordTooSmall:e=>"Your password is too small (minimum "+e+" characters)",passwordTooLong:e=>"Your password is too long (maximum "+e+" characters)",passwordRequireLetter:"Your password must contain a letter",passwordRequireNumber:"Your password must contain a number",passwordRequireSymbol:"Your password must contain a symbol"},u=(e,r)=>!(r.length<e),c=(e,r)=>!(r.length>e),d=(e,r)=>-1!==e.search(r),p=(e,r)=>{var t,n;return(null!==(n=null==e?void 0:null===(t=e.password)||void 0===t?void 0:t.requireLetter)&&void 0!==n?!n:!i.JT)||d(r,/[a-zA-Z]/)},m=(e,r)=>{var t,n;return(null!==(n=null==e?void 0:null===(t=e.password)||void 0===t?void 0:t.requireNumber)&&void 0!==n?!n:!i.tE)||d(r,/\d/)},h=(e,r)=>{var t,n;return(null!==(n=null==e?void 0:null===(t=e.password)||void 0===t?void 0:t.requireSymbol)&&void 0!==n?!n:!i.ah)||d(r,/[!@#$%^&*(){}[\]<>?/|.:;_-]/)},f=(e,r,t,n)=>{u(e,t)||n.push(l.passwordTooSmall(e)),c(r,t)||n.push(l.passwordTooLong(r))},v=(e,r,t)=>{p(e,r)||t.push(l.passwordRequireLetter),m(e,r)||t.push(l.passwordRequireNumber),h(e,r)||t.push(l.passwordRequireSymbol)},g=e=>{var r,t,u,c;let{labelCol:d,wrapperCol:p,name:m,label:h,inputPlaceholder:g,inputAutoComplete:y,edit:x,style:w,required:Z,className:j}=e,[b]=a.Z.useSystem(),E=null!==(u=null==b?void 0:null===(r=b.password)||void 0===r?void 0:r.min)&&void 0!==u?u:i.yL,C=null!==(c=null==b?void 0:null===(t=b.password)||void 0===t?void 0:t.max)&&void 0!==c?c:i.nq;return(0,n.jsx)(s.Z.Item,{className:j,labelCol:d,wrapperCol:p,name:m||"password",label:h||"Password",rules:[()=>({validator(e,r){let t=[];return x&&"******"===r?Promise.resolve():r?(f(E,C,r,t),v(b,r,t),t.length)?Promise.reject(t):Promise.resolve():Promise.reject(l.password)}}),{required:!!Z,message:""}],style:w,children:(0,n.jsx)(o.Z.Password,{placeholder:g,autoComplete:y})})};var y=g},67582:function(e,r,t){"use strict";let n,s;t.d(r,{lt:function(){return y},Xq:function(){return j},Ur:function(){return a}});var o=t(13448);let i=(e,r)=>{o.Z.success({message:e,description:r,duration:10})};var a=i,l=t(85893),u=t(6880),c=t(54907),d=t(26713),p=t(71577),m=t(79074),h=t(60274);m.S1({dsn:"https://3bb27cb32e55433696022ba93cb32430@o394613.ingest.sentry.io/5428383"});let f=[],v=()=>{n&&(o.Z.close(n),n=void 0),f.forEach(e=>o.Z.close(e)),f.length=0,o.Z.close(s),s=void 0},g=function(e,r){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if((null==r?void 0:r.message)==="Failed to fetch"){if(!n){let i="server_error";f.push(i),o.Z.error({key:i,message:"Server error",description:"Server is disconnected, please check your internet connection.",duration:0,onClose(){n=void 0}}),n=i}return}if(t){var a,m;let g="error_"+f.length;f.push(g),o.Z.error({key:g,message:e,description:r&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(u.Z.Text,{code:!0,children:r.message}),(r.status||r.info)&&(0,l.jsx)(c.Z,{children:(0,l.jsx)(c.Z.Panel,{header:"More information",children:(0,l.jsxs)(d.Z,{direction:"vertical",children:[r.status&&(0,l.jsxs)(u.Z.Text,{children:["Status: ",r.status]}),(null===(a=r.info)||void 0===a?void 0:a.message)&&(0,l.jsxs)(u.Z.Text,{children:["Description: ",null===(m=r.info)||void 0===m?void 0:m.message]})]})},"information")})]}),duration:0})}if(r&&console.error(r),r&&h.captureException(r),f.length>1&&!s){let y="close_all";o.Z.info({key:y,message:(0,l.jsx)(p.Z,{type:"primary",onClick:v,children:"Close all"}),description:"Close all error notifications",duration:0,placement:"top"}),s=y}};var y=g,x=t(81579),w=t(14670);let Z=e=>{var r,t;let{error:n}=e;return n?(0,l.jsx)(x.Z.Item,{children:(0,l.jsx)(w.Z,{message:n.render||n.title,type:n.type,showIcon:!0,description:n.err&&(0,l.jsxs)(l.Fragment,{children:[n.err.message&&(0,l.jsxs)(u.Z.Text,{type:"danger",children:["Message: ",(0,l.jsx)("code",{children:n.err.message})]}),n.err.status&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("br",{}),(0,l.jsxs)(u.Z.Text,{type:"danger",children:["Status: ",(0,l.jsx)("code",{children:n.err.status})]})]}),(null===(r=n.err.info)||void 0===r?void 0:r.message)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("br",{}),(0,l.jsxs)(u.Z.Text,{type:"danger",children:["Information: ",(0,l.jsx)("code",{children:null===(t=n.err.info)||void 0===t?void 0:t.message})]})]})]})})}):null};var j=Z},54666:function(e,r,t){"use strict";var n=t(85893),s=t(67294),o=t(26713),i=t(81474),a=t(11382),l=t(91756),u=t(6880),c=t(97183),d=t(28058);let p=()=>(0,n.jsx)(o.Z,{style:{height:"100%",width:"100%",justifyContent:"center",alignItems:"center"},children:(0,n.jsx)(i.Z,{children:(0,n.jsxs)(o.Z,{children:[(0,n.jsx)(a.Z,{}),"Loading, please wait..."]})})}),m=e=>{let{text:r,status:t,errors:p}=e,m=(0,s.useRef)(null),[h,f]=(0,s.useState)(),[v,g]=(0,s.useState)();(0,s.useEffect)(()=>{if(!(null==t?void 0:t.length)){f(void 0);return}let e=(null==p?void 0:p.length)?"error":"process";f((0,n.jsx)("div",{className:"Loading-status",children:(0,n.jsx)(l.Z,{direction:"vertical",children:t.map((r,s)=>(0,n.jsx)(l.Z.Step,{status:s===t.length-1?e:"finish",title:r},s)).reverse()})}))},[t,p]),(0,s.useEffect)(()=>{if(!(null==p?void 0:p.length)){g(void 0);return}g((0,n.jsxs)("div",{className:"Loading-errors",children:[p.map((e,r)=>{let t=null;return e.includes("docker: command not found")||e.includes("Is the docker daemon running")?t=(0,n.jsxs)(i.Z,{children:["There is an error with your Docker installation.",(0,n.jsx)("br",{}),"Please verify that Docker is correctly installed and running."]}):(e.includes("EHOSTUNREACH")||e.includes("ENETUNREACH")||e.includes("ETIMEOUT"))&&(t=(0,n.jsxs)(i.Z,{children:["There is an error with your PostgreSQL installation.",(0,n.jsx)("br",{}),'Please verify that postgres Docker container "tanatloc-postgres" is correctly installed and running.']})),(0,n.jsxs)("div",{children:[e,t]},r)}),(0,n.jsx)(u.Z.Title,{level:5,style:{color:"red"},children:"Please restart the application"})]}))},[p]);let y=!!(null==t?void 0:t.length)||!!(null==p?void 0:p.length);return(0,n.jsxs)(c.Z,{className:"tanatloc-gradient",children:[(0,n.jsx)("div",{className:"logo",children:(0,n.jsx)("img",{src:"/images/logo.svg",alt:"Tanatloc"})}),(0,n.jsx)(i.Z,{className:"Loading",bodyStyle:{padding:0},title:(0,n.jsx)(o.Z,{children:(null==p?void 0:p.length)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.Z,{style:{fontSize:"32px",color:"red"}}),(0,n.jsx)(u.Z.Title,{level:3,className:"no-margin",children:"An error occurs"}),(0,n.jsx)("a",{href:"https://github.com/Airthium/tanatloc/issues/new/choose",target:"_blank",rel:"noreferrer",children:"Open an issue"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Z,{size:"large"}),null!=r?r:"Loading, please wait..."]})}),children:y?(0,n.jsxs)("div",{ref:m,className:"Loading-content",children:[v,h]}):null})]})};m.Simple=p,r.Z=m},36149:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return E}});var n=t(85893),s=t(11163),o=t(67294),i=t(97183),a=t(81474),l=t(26713),u=t(6880),c=t(81579),d=t(69677),p=t(71577),m=t(47455),h=t(67582),f=t(54666),v=t(4415),g=t(55734),y=t(92288);let x={user:"Error while loading user",system:"Error while loading system",internal:"Server issue : please try again shortly",alreadyExists:"This email is already registered",passwordMismatch:"Passwords mismatch"},w=async(e,r)=>{let t;try{t=await g.Z.add(r)}catch(s){throw new v.H({title:x.internal,err:s})}if(t.alreadyExists)throw new v.H({title:x.alreadyExists,render:(0,n.jsxs)(n.Fragment,{children:["We know you! ",(0,n.jsx)("a",{onClick:()=>Z(e),children:"Log in ?"})]}),type:"warning"});e.push("/signup/send")},Z=e=>{e.push("/login")},j=()=>{let[e,r]=(0,o.useState)(!1),[t,v]=(0,o.useState)(),Z=(0,s.useRouter)(),[j,{errorUser:b,loadingUser:E}]=g.Z.useUser(),[C,{errorSystem:P,loadingSystem:T}]=y.Z.useSystem();return((0,o.useEffect)(()=>{b&&(0,h.lt)(x.user,b),P&&(0,h.lt)(x.system,P)},[b,P]),(0,o.useEffect)(()=>{j&&Z.push("/dashboard")},[j,Z]),(0,o.useEffect)(()=>{Z.prefetch("/dashboard"),Z.prefetch("/login")},[Z]),E||T||j)?(0,n.jsx)(f.Z,{}):(null==C?void 0:C.allowsignup)?(0,n.jsx)(i.Z,{children:(0,n.jsx)(a.Z,{bordered:!1,className:"Signup",children:(0,n.jsxs)(l.Z,{direction:"vertical",size:"large",className:"full-width",children:[(0,n.jsx)("div",{children:(0,n.jsx)(u.Z.Title,{level:1,style:{padding:0,marginBottom:16,fontWeight:500},children:"Sign Up"})}),(0,n.jsxs)(c.Z,{requiredMark:"optional",async onFinish(e){r(!0);try{await w(Z,e)}catch(t){v(t)}finally{r(!1)}},layout:"vertical",children:[(0,n.jsx)(c.Z.Item,{name:"email",label:"Enter your email address",rules:[{required:!0,message:"Email is required"}],children:(0,n.jsx)(d.Z,{placeholder:"Email address",autoComplete:"email"})}),(0,n.jsx)(m.o,{name:"password",label:"Choose your password",inputPlaceholder:"Password",inputAutoComplete:"current-password",style:{marginBottom:"14px"}}),(0,n.jsx)(c.Z.Item,{name:"passwordConfirmation",label:"Confirm your password",rules:[{required:!0,message:"Password confirmation is required"},e=>{let{getFieldValue:r}=e;return{validator:(e,t)=>t&&r("password")!==t?Promise.reject(x.passwordMismatch):Promise.resolve()}}],style:{marginBottom:"14px"},children:(0,n.jsx)(d.Z.Password,{placeholder:"Password",autoComplete:"current-password"})}),(0,n.jsx)(h.Xq,{error:t}),(0,n.jsx)(c.Z.Item,{className:"Signup-submit",children:(0,n.jsx)(p.Z,{type:"primary",loading:e,htmlType:"submit",children:"Finish"})})]})]})})}):(0,n.jsx)(i.Z,{children:(0,n.jsx)(a.Z,{className:"Signup",children:"The server does not allow signup for now"})})},b=()=>(0,n.jsx)(j,{});var E=b}},function(e){e.O(0,[6040,6362,1474,1266,6495,4362,6690,2650,1756,9774,2888,179],function(){return e(e.s=47805)}),_N_E=e.O()}]);