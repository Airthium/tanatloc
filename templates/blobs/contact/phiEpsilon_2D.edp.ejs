// Phi_{epsilon} function approximating the vector module

// Definition of the function Phi_{epsilon}
func real phiEpsilon(real xx, real yy, real epsilon) {
    return (xx^2 + yy^2 + epsilon)^0.5;
}

// ax Derivative of the function Phi_{epsilon}
func real axPhiEpsilon(real xx, real yy, real epsilon) {
    return xx / ((xx^2 + yy^2 + epsilon)^0.5);
}

// ay Derivative of the function Phi_{epsilon}
func real ayPhiEpsilon(real xx, real yy, real epsilon) {
    return yy / ((xx^2 + yy^2 + epsilon)^0.5);
}

// axx Derivative of the function Phi_{epsilon}
func real axxPhiEpsilon(real xx, real yy, real epsilon) {
    return (yy^2 + epsilon) / (((xx^2 + yy^2 + epsilon)^0.5) * (xx^2 + yy^2 + epsilon));
}

// ayy Derivative of the function Phi_{epsilon}
func real ayyPhiEpsilon(real xx, real yy, real epsilon) {
    return (xx^2 + epsilon) / (((xx^2 + yy^2 + epsilon)^0.5) * (xx^2 + yy^2 + epsilon));
}

// axy Derivative of the function Phi_{epsilon}
func real axyPhiEpsilon(real xx, real yy, real epsilon) {
    return -xx * yy / (((xx^2 + yy^2 + epsilon)^0.5) * (xx^2 + yy^2 + epsilon));
}
