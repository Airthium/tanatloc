// Materials
appendLog("Define materials...");

<% materials.values = materials.values.filter(value => {
	if (value.material.key === 'fundation') {
		meshes[value.geometryIndex].tag = 'fundation'
		return false
	}
	return true
}) -%>

<% materials.children.forEach(material => { -%>
<% let firstValue = 0 -%>
// <%- material.label %> 
func <%= material.name -%><%= geometry?.index ?? '' -%> = 
<% materials.values.forEach((value, index) => { -%>
<% let child = value.material.children.find(child => child.symbol === material.name) || material -%>
<% if (index === 0) { -%>
<% firstValue = child.value ?? material.default -%>
	<%= child.value ?? material.default %>
<% } else { -%>
	+ (<%= child.value ?? material.default -%> - <%= firstValue -%>)
<% value.selected.forEach(select => { -%>
		* (region == <%= select.label -%>)
<% }) -%>
<% } -%>
<% }) -%>
	;
<% }) -%>
// End Materials